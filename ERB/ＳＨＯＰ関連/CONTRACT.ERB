
@SHOPCOMABLE_150
LOCAL:1 = 1
FOR LOCAL,0,CHARANUM
	SIF LOCAL == MASTER
		CONTINUE
	SIF 함락(LOCAL) == 2
		LOCAL:1 += 1
NEXT
RESULT:1 = 1
IF LOCAL:1 > 0  && MONEY > 1000000
	RESULTS = 계약
	RETURN 1
ELSE
	RESULTS = ？？？？？
	RETURN 0
ENDIF

@SHOP_COM_150
CUSTOMDRAWLINE =
PRINTL 노예와 특별한 계약을 합니다
PRINTL 계약한 캐릭터는 통상의 악마합체나 조마・마정장비 작성의 소재로 사용할 수 없습니다。
DRAWLINE
LOCAL:1 = 0
LOCAL:2 = 0
LOCAL:3 = 0
LOCAL:4 = 0
FOR LOCAL,0,CHARANUM
	SIF LOCAL == MASTER
		CONTINUE
	SIF TALENT:LOCAL:친애 && !TALENT:LOCAL:아내 && !TALENT:LOCAL:남편
		LOCAL:1 += 1
	SIF TALENT:LOCAL:창부 && !TALENT:LOCAL:음마
		LOCAL:2 += 1
	SIF TALENT:LOCAL:예속 && !TALENT:LOCAL:노리개
		LOCAL:3 += 1
	SIF TALENT:LOCAL:동료 && !TALENT:LOCAL:맹우
		LOCAL:4 += 1
NEXT

SIF LOCAL:1 && MONEY > 1000000
	PRINTL [1] 결혼한다 (100만￥)
SIF LOCAL:2 && MONEY > 1000000
	PRINTL [2] 음마로 만든다 (100만￥)
SIF LOCAL:3 && MONEY > 1000000
	PRINTL [3] 개목걸이를 준다 (100만￥)
SIF LOCAL:4 && MONEY > 1000000
	PRINTL [4] 맹우와 맹세한다 (100만￥)
;PRINTL [4] 사역마로 만든다 (50만￥)
DRAWLINE
PRINTL [0] 돌아간다

$INPUT_LOOP
INPUT

IF RESULT == 0
	RETURN 0
ELSEIF ((RESULT == 1 && LOCAL:1) || (RESULT == 2 && LOCAL:2) || (RESULT == 3 && LOCAL:3) || (RESULT == 4 && LOCAL:4)) && MONEY > 1000000
	CALL CONTRACT,RESULT
ELSE
	GOTO INPUT_LOOP
ENDIF
IF RESULT == 1
	RETURN 0
ELSE
	RESTART
ENDIF


@CONTRACT,ARG
Z = ARG
IF ARG == 1
	CALL INPUT_CHARA_LIST("결혼하고 싶은 캐릭터를 선택하세요", "CASTING_CONTRACT")
ELSEIF ARG == 2
	CALL INPUT_CHARA_LIST("음마로 타락시키고 싶은 캐릭터를 선택하세요", "CASTING_CONTRACT")
ELSEIF ARG == 3
	CALL INPUT_CHARA_LIST("개목걸이를 채워주고 싶은 캐릭터를 선택하세요", "CASTING_CONTRACT")
ELSE
	CALL INPUT_CHARA_LIST("맹세를 주고받고 싶은 캐릭터를 선택하세요", "CASTING_CONTRACT")
ENDIF
IF RESULT == 1000
	RETURN 0
ENDIF
PRINTL
PRINTW ………
PRINTW ……
PRINTW …
PRINTL


LOCAL = RESULT
IF ARG == 1
	IF TALENT:LOCAL:남자
		TALENT:LOCAL:남편 = 1
	ELSE
		TALENT:LOCAL:아내 = 1
	ENDIF
	MONEY -= 1000000
	TFLAG:13 = 40
	LOCAL:1 = TARGET
	TARGET = LOCAL
	CALL KOJO_MESSAGE_EVENT
	TARGET = LOCAL:1
	
	RETURN 1
ELSEIF ARG == 2
	MONEY -= 1000000
	TALENT:LOCAL:음마 = 1
	TFLAG:13 = 41
	LOCAL:1 = TARGET
	TARGET = LOCAL
	CALL KOJO_MESSAGE_EVENT
	TARGET = LOCAL:1
	RETURN 1
ELSEIF ARG == 3
	MONEY -= 1000000
	TALENT:LOCAL:노리개 = 1
	TFLAG:13 = 42
	LOCAL:1 = TARGET
	TARGET = LOCAL
	CALL KOJO_MESSAGE_EVENT
	TARGET = LOCAL:1
	RETURN 1
ELSEIF ARG == 4
	MONEY -= 1000000
	TALENT:LOCAL:맹우 = 1
	TFLAG:13 = 92
	LOCAL:1 = TARGET
	TARGET = LOCAL
	CALL KOJO_MESSAGE_EVENT
	TARGET = LOCAL:1
	SIF TARGET == LOCAL
		TARGET = -1
	IF TALENT:LOCAL:연모
		PRINTFORMW %조사만처리(NAME:LOCAL,"는")% 【연모】를 잃었다
		TALENT:LOCAL:연모 = 0
	ENDIF
	
	RETURN 1
ENDIF


@CASTING_CONTRACT(ARG)
SIF ARG == MASTER
	RETURN 0
SIF TALENT:ARG:아내 || TALENT:ARG:남편 || TALENT:ARG:음마 || TALENT:ARG:노리개 || TALENT:ARG:맹우
	RETURN 0
SIF Z == 1 && TALENT:ARG:친애 == 0
	RETURN 0
SIF Z == 2 && TALENT:ARG:창부 == 0
	RETURN 0
SIF Z == 3 && TALENT:ARG:예속 == 0
	RETURN 0
SIF Z == 4 && TALENT:ARG:동료 == 0
	RETURN 0
SIF CFLAG:ARG:この場に居ないフラグ == 1
	RETURN 0
SIF CFLAG:ARG:필터링フラグ
	RETURN 0
RETURN 1
