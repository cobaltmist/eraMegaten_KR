;_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/#
;
;	Module		:SELF.ERB
;	Facility	:奴隷からの奉仕などのイベント
;
;	
;	Licence		:ライセンスフリー
;
;	Edit	Date			Author					Reason
;	001		20XX/XX/XX		----					新規作成
;	002		2022/02/23		JK好き					ヘッダー新規作成、処理を整理統合、マジックナンバーを整理、朝Vレイプ・調教後セックス(逆転)追加
;	003		2022/03/12		JK好き					受け側男、攻め側女時の就寝時素股イベントで精液経験が受け側にも加算される問題を修正
;													調教後セックス(逆転)時に存在しない経験を与えてエラー落ちする問題を修正
;													調教後助手プレイ時に存在しない経験を与えてエラー落ちする問題を修正
;_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/#

;-------------------------------------------------
;夜종료시及び朝に起こる이벤트 타겟選択
;-------------------------------------------------
@EVENT_NIGHT_SELF
#DIM 요바이리스트 , MAX_PLAYER_CHARA
#DIM 요바이가능인수 , 1
#DIM LCOUNT

;キャラ등록数が1以下の時は引き返す
SIF CHARANUM <= 1
	RETURN 1
VARSET 요바이리스트 , -1
요바이가능인수 = 0
B = 0
FOR LCOUNT, 0, CHARANUM
	;主人ならスキップ
	SIF LCOUNT == MASTER
		CONTINUE
	SIF CFLAG:LCOUNT:요바이불허가
		CONTINUE
	;대상がその場にいないなら除外
	SIF CFLAG:LCOUNT:이자리에없는플래그 == 1
		CONTINUE
	;렌탈中は除外
	SIF CFLAG:LCOUNT:노역플래그 == 3
		CONTINUE
	;上司に連れて行かれると除外
	SIF CFLAG:LCOUNT:상사내습 == 1
		CONTINUE
	;체력が500以下なら除外
	SIF BASE:LCOUNT:체력 <= 500
		CONTINUE
	;반발각인がある場合は除外
	SIF MARK:LCOUNT:반발각인 >= 1
		CONTINUE
	;함락소질が無い場合は除外
	SIF 함락(LCOUNT) == 0
		CONTINUE
	;신뢰系함락素質の場合は除外
	SIF 신뢰(LCOUNT) || 동료(LCOUNT)
		CONTINUE
	;他の所に行ってる伽羅は除外
	SIF CFLAG:LCOUNT:ＮＴＲ요바이
		CONTINUE
	;最も호감도の高いキャラのIDが0未満である場合は除外
	SIF FAVORITE_1_ID(LCOUNT) < 0
		CONTINUE
	요바이리스트:요바이가능인수 = LCOUNT
	요바이가능인수 += 1
NEXT
IF 요바이가능인수 == 0
	B = -1
	RETURN 1
ENDIF

;まず、メインキャラを選ぶ
B = 0

;Bに랜덤選択されたキャラのキャラ등록번호を入れる・0の時はやり直し
$REPLAY0
B = 요바이리스트:(RAND:요바이가능인수)
;대상판정,Bが行動者,Eが被害者,Gが판정用
E = FAVORITE_1(B)
;FOR G, 0, CHARANUM
;	SIF CFLAG:B:(CFLAG:G:캐릭터고유번호+2000) > CFLAG:B:(CFLAG:E:캐릭터고유번호+2000)
;	E = G
;NEXT
;대상の호감도が行動者より主人が高かった場合요바이無し
SIF E != MASTER && FAVORITE(E,MASTER)  > FAVORITE(E,B)
	RETURN 1
;대상が사정ができる場合
IF HAVE_PENIS(E)
	Y = 1
;できない場合
ELSE
	Y = 0
ENDIF

;相手が主人の場合は신경썼다플래그
IF FLAG:ＮＴＲ기능
	SIF E == MASTER
		CFLAG:B:신경썼다플래그 = 1
ENDIF

;-------------------------------------------------
;夜종료시に起こる이벤트
;-------------------------------------------------

;7種8패턴
;대상C 相手V
;대상C 相手A
;대상V 相手C
;대상A 相手C
;両者C（素）・両者C（貝）
;자위
;一緒に寝る

;7つの組み合わせ
;대상（男）*相手（男）
	;대상C 相手A
	;대상A 相手C
;대상（男）*相手（フタ）
	;대상C 相手V
	;대상C 相手A
	;대상A 相手C
	;両者C（素）
;대상（フタ）*相手（男）
	;대상C 相手A
	;대상V 相手C
	;대상A 相手C
	;両者C（素）
;대상（フタ）*相手（フタ）
	;대상C 相手V
	;대상C 相手A
	;대상V 相手C
	;대상A 相手C
	;両者C（素）
;대상（女）*相手（男・フタ）
	;대상V 相手C
	;대상A 相手C
	;両者C（素）
;대상（男・フタ）*相手（女）
	;대상C 相手V
	;대상C 相手A
	;両者C（素）
;대상（女）*相手（女）
	;両者C（貝）
;※자위は조건無し、一緒に寝るは性別の조건無し

;랜덤に発生するかと체크し、実行不可ならば再度체크
;当たり7ハズレ2。実行가능に当たる前にハズレに当たったら종료
;ただし、上位の함락소질ががあれば必ず発生

LOCAL = TARGET
TARGET = B

$LOOP_N
IF TALENT:B:친애 || TALENT:B:창부 || TALENT:B:예속
	R = RAND:7
ELSE
	R = RAND:9
ENDIF

IF R == 0
	;대상C 相手V（처녀及び재생처녀を持たず、V감각2이상、욕망3이상で男でない、대상が男또는フタナリ場合）
	IF TALENT:B:처녀 == 0 && TALENT:B:재생처녀 == 0 && ABL:B:Ｖ감각 >= 2 && ABL:B:욕망 >= 3 && Y == 1 && !IS_MALE(B)
		CALL SELF_NIGHT6
	ELSE
		GOTO LOOP_N
	ENDIF
ELSEIF R == 1
	;대상C 相手A（A감각3이상、욕망4이상、대상が男또는フタナリ場合）
	IF ABL:B:Ａ감각 >= 3 && ABL:B:욕망 >= 4 && Y == 1
		CALL SELF_NIGHT31
	ELSE
		GOTO LOOP_N
	ENDIF
ELSEIF R == 2
	;대상V 相手C（대상が처녀及び재생처녀を持たず男でない、타겟のＣ감각3이상、욕망3이상で男또는フタナリの場合）
	IF TALENT:E:처녀 == 0 && TALENT:E:재생처녀 == 0 && IS_MALE(E) == 0 && ABL:B:Ｃ감각 >= 3 && ABL:B:욕망 >= 3 && HAVE_PENIS(B)
		CALL SELF_NIGHT32
	ELSE
		GOTO LOOP_N
	ENDIF
ELSEIF R == 3
	;대상A 相手C（대상のA감각3이상、타겟のＣ감각3이상、욕망4이상で男또는フタナリの場合）
	IF ABL:E:Ａ감각 >= 3 && ABL:B:Ｃ감각 >= 3 && ABL:B:욕망 >= 4 && HAVE_PENIS(B)
		CALL SELF_NIGHT33
	ELSE
		GOTO LOOP_N
	ENDIF
ELSEIF R == 4
	;（両者C（스마타）・両者C（貝合わせ））（どちらか片方でも男でない場合）
	IF !IS_MALE(E) || !IS_MALE(B)
		CALL SELF_NIGHT34
	ELSE
		GOTO LOOP_N
	ENDIF
ELSEIF R == 5
	;夜自慰
	CALL SELF_NIGHT35
ELSEIF R == 6
	;一緒に寝る(연모または친애が필요)
	IF TALENT:B:연모 || TALENT:B:친애
		CALL SELF_NIGHT36
	ELSE
		GOTO LOOP_N
	ENDIF
ELSE
	TARGET = LOCAL
	RETURN 0
ENDIF
TARGET = LOCAL

;-------------------------------------------------
;夜이벤트 ソースの計算
;-------------------------------------------------
;요바이（대상C 相手V）
@SELF_NIGHT6
DRAWLINE

;욕망
IF ABL:B:욕망 <= 2
	A = 1
ELSEIF ABL:B:욕망 <= 4
	A = 2
ELSEIF ABL:B:욕망 <= 7
	A = 3
ELSEIF ABL:B:욕망 <= 10
	A = 4
ELSE
	A = 4 + (ABL:B:욕망 - 10) / 4
ENDIF

;Ｖ감각
IF ABL:B:Ｖ감각 <= 2
	A += 1
ELSEIF ABL:B:Ｖ감각 <= 4
	A += 2
ELSEIF ABL:B:Ｖ감각 <= 7
	A += 3
ELSEIF ABL:B:Ｖ감각 <= 10
	A += 4
ELSE
	A += 4 + (ABL:B:Ｖ감각 - 10) / 3
ENDIF

;Ｃ감각（대상）
IF ABL:E:Ｃ감각 <= 2
	A += 1
ELSEIF ABL:E:Ｃ감각 <= 4
	A += 2
ELSEIF ABL:E:Ｃ감각 <= 7
	A += 3
ELSEIF ABL:E:Ｃ감각 <= 10
	A += 4
ELSE
	A += 4 + (ABL:E:Ｃ감각 - 10) / 3
ENDIF

;정액중독
IF ABL:B:정액중독 <= 1
	A += 1
ELSEIF ABL:B:정액중독 <= 2
	A += 2
ELSEIF ABL:B:정액중독 <= 5
	A += 3
ELSEIF ABL:B:정액중독 <= 7
	A += 4
ELSEIF ABL:B:정액중독 <= 10
	A += 5
ELSE
	A += 5 + (ABL:B:정액중독 - 10) / 4
ENDIF

;섹스중독
IF ABL:B:섹스중독 <= 1
	A += 1
ELSEIF ABL:B:섹스중독 <= 2
	A += 2
ELSEIF ABL:B:섹스중독 <= 4
	A += 3
ELSEIF ABL:B:섹스중독 <= 6
	A += 4
ELSEIF ABL:B:섹스중독 <= 8
	A += 5
ELSEIF ABL:B:섹스중독 <= 10
	A += 6
ELSE
	A += 6 + (ABL:B:섹스중독 - 10) / 3
ENDIF

;창부
SIF TALENT:B:창부
	A += 1
;섹스광
SIF TALENT:B:섹스광
	A += 2
;Ｖ민감
SIF TALENT:B:Ｖ민감
	A += 1
;헌신적
SIF TALENT:B:헌신적
	A += 1
;영맹또는교활
SIF TALENT:B:영맹 || TALENT:B:교활
	A += 1

SIF A == 0
	A = 1

IF IS_LESBIAN(B,E)
	CALL ADDS_EXP("레즈경험", A, B)
	CALL ADDS_EXP("레즈경험", A, E)
ENDIF

IF HAVE_PENIS(B)
	CALL ADDS_EXP("사정경험", A/2, B)
ENDIF

IF CFLAG:B:노예의질내사정에의한임신판정 > 1 && CFLAG:B:자궁내피임결계 == 0
	CALL ADDS_EXP("질사경험", A/2, E)
	CFLAG:B:노예의질내사정에의한임신판정 += A/2
ENDIF

CALL ADDS_EXP("사정경험", A/2, E)
CALL ADDS_EXP("Ｖ경험", A/2, B)
CALL ADDS_EXP("절정경험", A/4, B)
CALL ADDS_EXP("절정경험", A/4, E)
CALL ADDS_EXP("성교경험", A/2, B)
;CALL ADDS_EXP("性交経験", A/2, E)
CALL ADDS_EXP("정액경험", A/2, B)
GOTJUEL:B:쾌Ｖ += A*100
GOTJUEL:B:복종 += A*60
GOTJUEL:B:굴복 += A*40
GOTJUEL:B:습득 += A*40
TFLAG:13 = 9
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:E%---
CALL SHOW_ADD_EXP(E, "단순")
CALL SHOW_JUEL_CHECK, E
PRINTFORMW {A/2}회의 행위를 마친 뒤, 마음이 통한 두사람은 연결된 채로 얼싸안고 깊은 잠에 빠졌다……

DRAWLINE

RETURN 0


;요바이（대상C 相手A）
@SELF_NIGHT31
DRAWLINE

;욕망
IF ABL:B:욕망 <= 2
	A = 1
ELSEIF ABL:B:욕망 <= 4
	A = 2
ELSEIF ABL:B:욕망 <= 7
	A = 3
ELSEIF ABL:B:욕망 <= 10
	A = 4
ELSE
	A = 4 + (ABL:B:욕망 - 10) / 4
ENDIF

;Ａ감각
IF ABL:B:Ａ감각 <= 2
	A += 1
ELSEIF ABL:B:Ａ감각 <= 4
	A += 2
ELSEIF ABL:B:Ａ감각 <= 7
	A += 3
ELSEIF ABL:B:Ａ감각 <= 10
	A += 4
ELSE
	A += 4 + (ABL:B:Ａ감각 - 10) / 3
ENDIF

;Ｃ감각（대상）
IF ABL:E:Ｃ감각 <= 2
	A += 1
ELSEIF ABL:E:Ｃ감각 <= 4
	A += 2
ELSEIF ABL:E:Ｃ감각 <= 7
	A += 3
ELSEIF ABL:E:Ｃ감각 <= 10
	A += 4
ELSE
	A += 4 + (ABL:E:Ｃ감각 - 10) / 3
ENDIF

;정액중독
IF ABL:B:정액중독 <= 1
	A += 1
ELSEIF ABL:B:정액중독 <= 2
	A += 2
ELSEIF ABL:B:정액중독 <= 5
	A += 3
ELSEIF ABL:B:정액중독 <= 7
	A += 4
ELSEIF ABL:B:정액중독 <= 10
	A += 5
ELSE
	A += 5 + (ABL:B:정액중독 - 10) / 3
ENDIF

;섹스중독
IF ABL:B:섹스중독 <= 1
	A += 1
ELSEIF ABL:B:섹스중독 <= 2
	A += 2
ELSEIF ABL:B:섹스중독 <= 4
	A += 3
ELSEIF ABL:B:섹스중독 <= 6
	A += 4
ELSEIF ABL:B:섹스중독 <= 8
	A += 5
ELSEIF ABL:B:섹스중독 <= 10
	A += 6
ELSE
	A += 6 + (ABL:B:섹스중독 - 10) / 3
ENDIF

;창부
SIF TALENT:B:창부
	A += 1
;헌신적
SIF TALENT:B:헌신적
	A += 1
;애널광
SIF TALENT:B:애널광
	A += 2
;Ａ민감
SIF TALENT:B:Ａ민감
	A += 1
;영맹또는교활
SIF TALENT:B:영맹 || TALENT:B:교활
	A += 1

SIF A == 0
	A = 1

IF IS_LESBIAN(B,E)
	CALL ADDS_EXP("레즈경험", A, B)
	CALL ADDS_EXP("레즈경험", A, E)
ELSEIF IS_GAY(B,E)
	CALL ADDS_EXP("ＢＬ경험", A, B)
	CALL ADDS_EXP("ＢＬ경험", A, E)
ENDIF

CALL ADDS_EXP("사정경험", A/2, E)

IF HAVE_PENIS(B)
	CALL ADDS_EXP("사정경험", A/2, B)
ENDIF

CALL ADDS_EXP("Ａ경험", A/2, B)
CALL ADDS_EXP("절정경험", A/4, B)
CALL ADDS_EXP("절정경험", A/4, E)
CALL ADDS_EXP("성교경험", A/2, B)
;CALL ADDS_EXP("성교경험", A/2, E)
CALL ADDS_EXP("정액경험", A/2, B)
GOTJUEL:B:쾌Ａ += A*100
GOTJUEL:B:복종 += A*70
GOTJUEL:B:굴복 += A*30
GOTJUEL:B:습득 += A*40
TFLAG:13 = 31
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:E%---
CALL SHOW_ADD_EXP(E, "단순")
CALL SHOW_JUEL_CHECK, E
PRINTFORMW {A/2}회의 행위를 마친 뒤, 그대로 당신의 가슴 위에서 잠들어버렸다……

DRAWLINE

RETURN 0


;요바이（대상V 相手C）
@SELF_NIGHT32
DRAWLINE

;욕망
IF ABL:B:욕망 <= 2
	A = 2
ELSEIF ABL:B:욕망 <= 4
	A = 3
ELSEIF ABL:B:욕망 <= 7
	A = 4
ELSEIF ABL:B:욕망 <= 10
	A = 5
ELSE
	A = 5 + (ABL:B:욕망 - 10) / 4
ENDIF

;Ｃ감각
IF ABL:B:Ｃ감각 <= 2
	A += 2
ELSEIF ABL:B:Ｃ감각 <= 4
	A += 3
ELSEIF ABL:B:Ｃ감각 <= 7
	A += 4
ELSEIF ABL:B:Ｃ감각 <= 10
	A += 5
ELSE
	A += 5 + (ABL:B:Ｃ감각 - 10) / 3
ENDIF

;Ｖ감각（대상）
IF ABL:E:Ｖ감각 <= 2
	A += 1
ELSEIF ABL:E:Ｖ감각 <= 4
	A += 2
ELSEIF ABL:E:Ｖ감각 <= 7
	A += 3
ELSEIF ABL:E:Ｖ감각 <= 10
	A += 4
ELSE
	A += 4 + (ABL:E:Ｖ감각 - 10) / 3
ENDIF

;섹스중독
IF ABL:B:섹스중독 <= 1
	A += 1
ELSEIF ABL:B:섹스중독 <= 2
	A += 2
ELSEIF ABL:B:섹스중독 <= 4
	A += 3
ELSEIF ABL:B:섹스중독 <= 6
	A += 4
ELSEIF ABL:B:섹스중독 <= 8
	A += 5
ELSEIF ABL:B:섹스중독 <= 10
	A += 6
ELSE
	A += 6 + (ABL:B:섹스중독 - 10) / 3
ENDIF

;자위광
SIF TALENT:B:자위광
	A += 2
;Ｃ민감
SIF TALENT:B:Ｃ민감
	A += 1
;영맹또는잔학
SIF TALENT:B:영맹 || TALENT:B:잔학
	A += 1

SIF A == 0
	A = 1

IF IS_LESBIAN(B,E)
	CALL ADDS_EXP("레즈경험", A, B)
	CALL ADDS_EXP("레즈경험", A, E)
ELSEIF IS_GAY(B,E)
	CALL ADDS_EXP("ＢＬ경험", A, B)
	CALL ADDS_EXP("ＢＬ경험", A, E)
ENDIF

CALL ADDS_EXP("사정경험", A/2, B)

IF HAVE_PENIS(E)
	CALL ADDS_EXP("사정경험", A/2, E)
ENDIF

IF CFLAG:E:노예의질내사정에의한임신판정 > 1 && CFLAG:E:자궁내피임결계 == 0
	CALL ADDS_EXP("질사경험", A/2, E)
	CFLAG:E:노예의질내사정에의한임신판정 += A/2
ENDIF

CALL ADDS_EXP("Ｖ경험", A/2, E)
CALL ADDS_EXP("절정경험", A/4, B)
CALL ADDS_EXP("절정경험", A/4, E)
;CALL ADDS_EXP("성교경험", A/2, B)
CALL ADDS_EXP("성교경험", A/2, E)
GOTJUEL:B:쾌Ｃ += A*100
GOTJUEL:B:복종 += A*50
GOTJUEL:B:욕정 += A*60
GOTJUEL:B:습득 += A*40
TFLAG:13 = 32
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:E%---
CALL SHOW_ADD_EXP(E, "단순")
CALL SHOW_JUEL_CHECK, E
PRINTFORMW %조사처리(CALLNAME:B,"는")% 질내에 {A/2}회 정액을 쏟아내고는, 두 사람은 그 상태로 잠들었다……

DRAWLINE

RETURN 0


;요바이（대상A 相手C）
@SELF_NIGHT33
DRAWLINE

;욕망
IF ABL:B:욕망 <= 2
	A = 2
ELSEIF ABL:B:욕망 <= 4
	A = 3
ELSEIF ABL:B:욕망 <= 7
	A = 4
ELSEIF ABL:B:욕망 <= 10
	A = 5
ELSE
	A = 5 + (ABL:B:욕망 - 10) / 4
ENDIF

;Ｃ감각
IF ABL:B:Ｃ감각 <= 2
	A += 2
ELSEIF ABL:B:Ｃ감각 <= 4
	A += 3
ELSEIF ABL:B:Ｃ감각 <= 7
	A += 4
ELSEIF ABL:B:Ｃ감각 <= 10
	A += 5
ELSE
	A += 5 + (ABL:B:Ｃ감각 - 10) / 3
ENDIF

;Ａ감각（대상）
IF ABL:E:Ａ감각 <= 2
	A += 1
ELSEIF ABL:E:Ａ감각 <= 4
	A += 2
ELSEIF ABL:E:Ａ감각 <= 7
	A += 3
ELSEIF ABL:E:Ａ감각 <= 10
	A += 4
ELSE
	A += 4 + (ABL:E:Ａ감각 - 10) / 3
ENDIF

;섹스중독
IF ABL:B:섹스중독 <= 1
	A += 1
ELSEIF ABL:B:섹스중독 <= 2
	A += 2
ELSEIF ABL:B:섹스중독 <= 4
	A += 3
ELSEIF ABL:B:섹스중독 <= 6
	A += 4
ELSEIF ABL:B:섹스중독 <= 8
	A += 5
ELSEIF ABL:B:섹스중독 <= 10
	A += 6
ELSE
	A += 6 + (ABL:B:섹스중독 - 10) / 3
ENDIF

;자위광
SIF TALENT:B:자위광
	A += 2
;Ｃ민감
SIF TALENT:B:Ｃ민감
	A += 1
;영맹또는잔학
SIF TALENT:B:영맹 || TALENT:B:잔학
	A += 1

SIF A == 0
	A = 1

IF IS_LESBIAN(B,E)
	CALL ADDS_EXP("레즈경험", A, B)
	CALL ADDS_EXP("레즈경험", A, E)
ELSEIF IS_GAY(B,E)
	CALL ADDS_EXP("ＢＬ경험", A, B)
	CALL ADDS_EXP("ＢＬ경험", A, E)
ENDIF

CALL ADDS_EXP("사정경험", A/2, B)

IF HAVE_PENIS(E)
	CALL ADDS_EXP("사정경험", A/2, E)
ENDIF

CALL ADDS_EXP("Ａ경험", A/2, E)
CALL ADDS_EXP("절정경험", A/4, B)
CALL ADDS_EXP("절정경험", A/4, E)
;CALL ADDS_EXP("성교경험", A/2, B)
CALL ADDS_EXP("성교경험", A/2, E)
GOTJUEL:B:쾌Ｃ += A*100
GOTJUEL:B:복종 += A*40
GOTJUEL:B:욕정 += A*70
GOTJUEL:B:습득 += A*40
TFLAG:13 = 33
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:E%---
CALL SHOW_ADD_EXP(E, "단순")
CALL SHOW_JUEL_CHECK, E
PRINTFORMW %CALLNAME:E%의 장내에 {A/2}회 정액을 쏟아내고는, 만족해하며 잠들었다……

DRAWLINE

RETURN 0


;요바이（両者C（스마타）・両者C（貝合わせ））
@SELF_NIGHT34
DRAWLINE

;욕망
IF ABL:B:욕망 <= 2
	A = 2
ELSEIF ABL:B:욕망 <= 4
	A = 3
ELSEIF ABL:B:욕망 <= 7
	A = 4
ELSEIF ABL:B:욕망 <= 10
	A = 5
ELSE
	A = 5 + (ABL:B:욕망 - 10) / 4
ENDIF

;봉사정신
IF ABL:B:봉사정신 <= 2
	A += 1
ELSEIF ABL:B:봉사정신 <= 4
	A += 2
ELSEIF ABL:B:봉사정신 <= 7
	A += 3
ELSEIF ABL:B:봉사정신 <= 10
	A += 4
ELSE
	A += 4 + (ABL:B:봉사정신 - 10) / 3
ENDIF

;Ｃ감각
IF ABL:B:Ｃ감각 <= 2
	A += 2
ELSEIF ABL:B:Ｃ감각 <= 4
	A += 3
ELSEIF ABL:B:Ｃ감각 <= 7
	A += 4
ELSEIF ABL:B:Ｃ감각 <= 10
	A += 5
ELSE
	A += 5 + (ABL:B:Ｃ감각 - 10) / 3
ENDIF

;Ｃ감각（대상）
IF ABL:E:Ｃ감각 <= 2
	A += 1
ELSEIF ABL:E:Ｃ감각 <= 4
	A += 2
ELSEIF ABL:E:Ｃ감각 <= 7
	A += 3
ELSEIF ABL:E:Ｃ감각 <= 10
	A += 4
ELSE
	A += 4 + (ABL:E:Ｃ감각 - 10) / 3
ENDIF

;자위광
SIF TALENT:B:자위광
	A += 2
;Ｃ민감
SIF TALENT:B:Ｃ민감
	A += 1

SIF A == 0
	A = 1

IF IS_LESBIAN(B,E)
	CALL ADDS_EXP("레즈경험", A, B)
	CALL ADDS_EXP("레즈경험", A, E)
ELSEIF IS_GAY(B,E)
	CALL ADDS_EXP("ＢＬ경험", A, B)
	CALL ADDS_EXP("ＢＬ경험", A, E)
ENDIF

IF HAVE_PENIS(E)
	CALL ADDS_EXP("사정경험", A/2, E)
	CALL ADDS_EXP("정액경험", A, B)
ENDIF
IF HAVE_PENIS(B)
	CALL ADDS_EXP("사정경험", A/2, B)
	CALL ADDS_EXP("정액경험", A, E)
ENDIF

CALL ADDS_EXP("절정경험", A/4, B)
CALL ADDS_EXP("절정경험", A/4, E)
GOTJUEL:B:쾌Ｃ += A*100
GOTJUEL:B:복종 += A*50
GOTJUEL:B:욕정 += A*50
GOTJUEL:B:습득 += A*40
TFLAG:13 = 34
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:E%---
CALL SHOW_ADD_EXP(E, "단순")
CALL SHOW_JUEL_CHECK, E
PRINTFORMW 그 뒤, 두 사람은 서로 얼싸안은 채로 잠에 빠져들었다……

DRAWLINE

RETURN 0


;夜자위
@SELF_NIGHT35
DRAWLINE

;욕망
IF ABL:B:욕망 <= 2
	A = 1
ELSEIF ABL:B:욕망 <= 4
	A = 2
ELSEIF ABL:B:욕망 <= 7
	A = 3
ELSEIF ABL:B:욕망 <= 10
	A = 4
ELSE
	A = 4 + (ABL:B:욕망 - 10) / 4
ENDIF

;노출증
IF ABL:B:노출증 <= 2
	A += 1
ELSEIF ABL:B:노출증 <= 4
	A += 2
ELSEIF ABL:B:노출증 <= 7
	A += 3
ELSEIF ABL:B:노출증 <= 10
	A += 4
ELSE
	A += 4 + (ABL:B:노출증 - 10) / 4
ENDIF

;자위중독
IF ABL:B:자위중독 <= 2
	A += 2
ELSEIF ABL:B:자위중독 <= 4
	A += 3
ELSEIF ABL:B:자위중독 <= 7
	A += 4
ELSEIF ABL:B:자위중독 <= 10
	A += 5
ELSE
	A += 5 + (ABL:B:자위중독 - 10) / 4
ENDIF

;자위하기쉬움
SIF TALENT:B:자위하기쉬움
	A += 2
;자위광（Cだと重複するので他より弱く）
SIF TALENT:B:자위광
	A += 1

;CVAB판정
$LOOP_N_M
IF TALENT:B:남자
	R = RAND:3
ELSE
	R = RAND:4
ENDIF

IF R == 0
	;C판정
	;Ｃ감각
	IF ABL:B:Ｃ감각 <= 2
		A += 1
	ELSEIF ABL:B:Ｃ감각 <= 4
		A += 2
	ELSEIF ABL:B:Ｃ감각 <= 7
		A += 3
	ELSEIF ABL:B:Ｃ감각 <= 10
		A += 4
	ELSE
		A += 4 + (ABL:B:Ｃ감각 - 10) / 3
	ENDIF
	;자위광
	SIF TALENT:B:자위광
		A += 2
	;Ｃ민감
	SIF TALENT:B:Ｃ민감
		A += 1
	SIF A == 0
		A = 1
	IF HAVE_PENIS(B)
		CALL ADDS_EXP("사정경험", A/2, B)
		IF ABL:B:노출증 >= 5
			;BUKKAKE
			CALL ADDS_EXP("정액경험", A/2, E)
		ENDIF
	ENDIF
	GOTJUEL:B:쾌Ｃ += A*60
ELSEIF R == 1
	;A판정（A감각2이상）
	IF  ABL:B:Ａ감각 >= 2
		;Ａ감각
		IF ABL:B:Ａ감각 <= 2
			A += 1
		ELSEIF ABL:B:Ａ감각 <= 4
			A += 2
		ELSEIF ABL:B:Ａ감각 <= 7
			A += 3
		ELSEIF ABL:B:Ａ감각 <= 10
			A += 4
		ELSE
			A += 4 + (ABL:B:Ａ감각 - 10) / 3
		ENDIF
		;애널광
		SIF TALENT:B:애널광
			A += 2
		;Ａ민감
		SIF TALENT:B:Ａ민감
			A += 1
		SIF A == 0
			A = 1
		CALL ADDS_EXP("Ａ경험", A/2, B)
		GOTJUEL:B:쾌Ａ += A*60
	ELSE
		GOTO LOOP_N_M
	ENDIF
ELSEIF R == 2
	;B판정
	;Ｂ감각
	IF ABL:B:Ｂ감각 <= 2
		A += 1
	ELSEIF ABL:B:Ｂ감각 <= 4
		A += 2
	ELSEIF ABL:B:Ｂ감각 <= 7
		A += 3
	ELSEIF ABL:B:Ｂ감각 <= 10
		A += 4
	ELSE
		A += 4 + (ABL:B:Ｂ감각 - 10) / 3
	ENDIF
	;음유
	SIF TALENT:B:음유
		A += 2
	;Ｂ민감
	SIF TALENT:B:Ｂ민감
		A += 1
	SIF A == 0
		A = 1
	IF TALENT:B:모유체질
		CALL ADDS_EXP("분유경험", A/2, B)
	ENDIF
	GOTJUEL:B:쾌Ｂ += A*60
ELSEIF R == 3
	;V판정（처녀及び재생처녀を持っていない）
	IF TALENT:B:처녀 == 0 && TALENT:B:재생처녀 == 0
		;Ｖ감각
		IF ABL:B:Ｖ감각 <= 2
			A += 1
		ELSEIF ABL:B:Ｖ감각 <= 4
			A += 2
		ELSEIF ABL:B:Ｖ감각 <= 7
			A += 3
		ELSEIF ABL:B:Ｖ감각 <= 10
			A += 4
		ELSE
			A += 4 + (ABL:B:Ｖ감각 - 10) / 3
		ENDIF
		;섹스광
		SIF TALENT:B:섹스광
			A += 2
		;Ｖ민감
		SIF TALENT:B:Ｖ민감
			A += 1
		SIF A == 0
			A = 1
		CALL ADDS_EXP("Ｖ경험", A/2, B)
		GOTJUEL:B:쾌Ｖ += A*60
	ELSE
		GOTO LOOP_N_M
	ENDIF
ENDIF

CALL ADDS_EXP("절정경험", A/4, B)
CALL ADDS_EXP("자위경험", A/2, B)
GOTJUEL:B:욕정 += A*50
GOTJUEL:B:굴복 += A*30
GOTJUEL:B:습득 += A*40
GOTJUEL:B:치정 += A*30
TFLAG:13 = 35
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:E%---
CALL SHOW_ADD_EXP(E, "단순")
CALL SHOW_JUEL_CHECK, E
PRINTFORMW 행위가 끝나자, %조사처리(CALLNAME:B,"는")% 작은 한숨을 내쉬며 잠에 빠져들었다

DRAWLINE

RETURN 0


;一緒に寝る
@SELF_NIGHT36
DRAWLINE

;순종
IF ABL:B:순종 <= 6
	A = 3
ELSEIF ABL:B:순종 <= 8
	A = 4
ELSEIF ABL:B:순종 <= 10
	A = 5
ELSE
	A = 5 + (ABL:B:순종 - 10) / 4
ENDIF

;봉사정신
IF ABL:B:봉사정신 <= 6
	A += 4
ELSEIF ABL:B:봉사정신 <= 8
	A += 5
ELSEIF ABL:B:봉사정신 <= 10
	A += 6
ELSE
	A += 6 + (ABL:B:봉사정신 - 10) / 3
ENDIF

;친애
SIF TALENT:B:친애
	A += 1
;유아／유아퇴행または유치
SIF TALENT:B:유아／유아퇴행 || TALENT:B:유치
	A += 2
;아내または남편
SIF TALENT:B:아내 || TALENT:B:남편
	A += 1
;아이
SIF TALENT:B:아이
	A += 2
;우애
SIF TALENT:B:우애
	A += 1

SIF A == 0
	A = 1

CALL ADDS_EXP("애정경험", A/4, B)
CALL ADDS_EXP("애정경험", A/4, E)

;유아／유아퇴행または유치且つ대상が가창기능3이상
IF (TALENT:B:유아／유아퇴행 || TALENT:B:유치) && ABL:E:가창기능 >= 3
	CALL ADDS_EXP("가창경험", A/5, E)
ENDIF

GOTJUEL:B:복종 += A*100
TFLAG:13 = 36
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:E%---
CALL SHOW_ADD_EXP(E, "단순")
CALL SHOW_JUEL_CHECK, E
IF TALENT:B:유아／유아퇴행 || TALENT:B:유치
	PRINTFORMW %조사처리(CALLNAME:B,"는")% 편안한 표정으로 숨소리를 내고 있다
ELSE
	PRINTFORMW %조사처리(CALLNAME:B,"는")% 작은 목소리로 잘 자라고 말하며 잠들었다
ENDIF

DRAWLINE

RETURN 0

;-------------------------------------------------
;朝이벤트1
;-------------------------------------------------
@EVENT_NEWDAY_SELF
;랜덤に発生するかと체크し、実行不可ならば再度체크
;当たり9ハズレ2。実行가능に当たる前にハズレに当たったら종료
;ただし、上位の함락소질ががあれば必ず発生
SIF B == -1
	RETURN 0
;上司に連れて行かれると除外
SIF CFLAG:B:상사내습 == 1
	RETURN 0
	
LOCAL = TARGET
TARGET = B
$LOOP_M
IF TALENT:B:친애 || TALENT:B:창부 || TALENT:B:예속
	R = RAND:10
ELSE
	R = RAND:12
ENDIF
;実行者の主人への호감도が他のキャラへの호감도より高いと必ずハズレ
	FOR G, 0, CHARANUM
		SIF G != MASTER && FAVORITE(B,G) > FAVORITE(B,MASTER)
			R = 12
	NEXT
	
;신경썼다플래그
IF FLAG:ＮＴＲ기능
	CFLAG:B:신경썼다플래그 = 1
ENDIF
	
IF R == 0
	;朝기승위/貝合わせ판정
	IF ((TALENT:B:처녀 == 0 && TALENT:B:재생처녀 == 0 && ABL:B:Ｖ감각 >= 3 && ABL:B:봉사정신 >= 7 && Y == 1) || (ABL:B:Ｃ감각 >= 3 && ABL:B:봉사정신 >= 7 && Y == 0)) && !IS_MALE(B)
		CALL SELF_MORNING_3
	ELSE
		GOTO LOOP_M
	ENDIF
ELSEIF R == 1
	;朝기승위A판정(VかAか、처녀か남자か판정以外기본的に기승위と同じ)
	IF ABL:B:Ａ감각 >= 3 && ABL:B:봉사정신 >= 7 && Y == 1
		CALL SELF_MORNING_24
	ELSE
		GOTO LOOP_M
	ENDIF
ELSEIF R == 2
	;朝파이즈리판정
	IF ABL:B:봉사정신 >= 5 && TALENT:B:절벽 == 0 && !IS_MALE(B) && Y == 1
		CALL SELF_MORNING_2
	ELSE
		GOTO LOOP_M
	ENDIF
ELSEIF R == 3
	;朝키스판정(봉사정신が6이상、연모または친애が필요)
	IF ABL:B:봉사정신 >= 6 && (TALENT:B:연모 || TALENT:B:친애)
		CALL SELF_MORNING_25
	ELSE
		GOTO LOOP_M
	ENDIF
ELSEIF R == 4
	;朝フェラ/커닐링구스판정
	CALL SELF_MORNING_1
ELSEIF R == 5
	;朝食판정(봉사정신が6이상、요리기능3이상が필요)
	IF ABL:B:봉사정신 >= 6 && ABL:B:요리기능 >= 3
		CALL SELF_MORNING_26
	ELSE
		GOTO LOOP_M
	ENDIF
ELSEIF R == 6
	;起きたら隣で寝てる판정(연모または친애が필요)
	IF TALENT:B:연모 || TALENT:B:친애
		CALL SELF_MORNING_27
	ELSE
		GOTO LOOP_M
	ENDIF
ELSEIF R == 7
	;朝の발コキ판정(새드끼1이상が필요)
	IF ABL:B:새드끼 >= 1 && (HAVE_PENIS(MASTER))
		CALL SELF_MORNING_28
	ELSE
		GOTO LOOP_M
	ENDIF
ELSEIF R == 8
	;お寝小판정(오줌싸개버릇が필요)
	IF TALENT:B:57 == 1
		CALL SELF_MORNING_30
	ELSE
		GOTO LOOP_M
	ENDIF
ELSEIF R == 9
	;朝Vレイプ(対象C攻め MASTER V受け)
	IF (TALENT:MASTER:처녀 == 0 && TALENT:MASTER:재생처녀 == 0) && (HAVE_PENIS(B)  || (ABL:B:Ｃ감각 >= 3 && ABL:B:레즈중독 >= 3 && ITEM:페니스밴드)) && !IS_MALE(MASTER)
		CALL SELF_MORNING_68
	ELSE
		GOTO LOOP_M
	ENDIF
ELSE
	TARGET = LOCAL
	RETURN 0
ENDIF

;-------------------------------------------------
;朝이벤트2
;-------------------------------------------------
;上位の함락소질があれば半分の확률로発生
IF TALENT:B:친애 || TALENT:B:창부 || TALENT:B:예속
	R = RAND:2
ELSE
	R = RAND:4
ENDIF

IF R == 0
	;朝の搾りたてミルク판정(봉사정신が6이상、모유체질、분유중독1이상、が필요)
	IF ABL:B:봉사정신 >= 6 && TALENT:B:모유체질 && ABL:B:분유중독 >= 1
		CALL SELF_MORNING_29
	ENDIF
ENDIF
TARGET = LOCAL
RETURN 0

;-------------------------------------------------
;朝이벤트 ソースの計算
;-------------------------------------------------
;朝기승위/貝合わせ
@SELF_MORNING_3
DRAWLINE

;욕망
IF ABL:B:욕망 <= 2
	A = 1
ELSEIF ABL:B:욕망 <= 4
	A = 2
ELSEIF ABL:B:욕망 <= 7
	A = 3
ELSEIF ABL:B:욕망 <= 10
	A = 4
ELSE
	A = 4 + (ABL:B:욕망 - 10) / 4
ENDIF

IF Y == 1
;기승위
	;Ｖ감각
	IF ABL:B:Ｖ감각 <= 2
		A += 1
	ELSEIF ABL:B:Ｖ감각 <= 4
		A += 2
	ELSEIF ABL:B:Ｖ감각 <= 7
		A += 3
	ELSEIF ABL:B:Ｖ감각 <= 10
		A += 4
	ELSE
		A += 4 + (ABL:B:Ｖ감각 - 10) / 3
	ENDIF

	;정액중독
	IF ABL:B:정액중독 <= 1
		A += 1
	ELSEIF ABL:B:정액중독 <= 2
		A += 2
	ELSEIF ABL:B:정액중독 <= 5
		A += 3
	ELSEIF ABL:B:정액중독 <= 7
		A += 4
	ELSEIF ABL:B:정액중독 <= 10
		A += 5
	ELSE
		A += 5 + (ABL:B:정액중독 - 10) / 4
	ENDIF

	;섹스중독
	IF ABL:B:섹스중독 <= 1
		A += 1
	ELSEIF ABL:B:섹스중독 <= 2
		A += 2
	ELSEIF ABL:B:섹스중독 <= 4
		A += 3
	ELSEIF ABL:B:섹스중독 <= 6
		A += 4
	ELSEIF ABL:B:섹스중독 <= 8
		A += 5
	ELSEIF ABL:B:섹스중독 <= 10
		A += 6
	ELSE
		A += 6 + (ABL:B:섹스중독 - 10) / 3
	ENDIF

	;섹스광
	SIF TALENT:B:섹스광
		A += 2
	;Ｖ민감
	SIF TALENT:B:Ｖ민감
		A += 1
ELSE
;貝合わせの場合暫定措置で、레즈끼及び레즈중독を代入
;コマンド貝合わせは성교경험入らないので…
	;Ｃ감각
	IF ABL:B:Ｃ감각 <= 2
		A += 1
	ELSEIF ABL:B:Ｃ감각 <= 4
		A += 2
	ELSEIF ABL:B:Ｃ감각 <= 7
		A += 3
	ELSEIF ABL:B:Ｃ감각 <= 10
		A += 4
	ELSE
		A += 4 + (ABL:B:Ｃ감각 - 10) / 3
	ENDIF

	;레즈끼
	IF ABL:B:레즈끼 <= 1
		A += 1
	ELSEIF ABL:B:레즈끼 <= 2
		A += 2
	ELSEIF ABL:B:레즈끼 <= 5
		A += 3
	ELSEIF ABL:B:레즈끼 <= 7
		A += 4
	ELSEIF ABL:B:레즈끼 <= 11
		A += 5
	ELSE
		A += 5 + (ABL:B:레즈끼 - 10) / 4
	ENDIF

	;레즈중독
	IF ABL:B:레즈중독 <= 1
		A += 1
	ELSEIF ABL:B:레즈중독 <= 2
		A += 2
	ELSEIF ABL:B:레즈중독 <= 4
		A += 3
	ELSEIF ABL:B:레즈중독 <= 6
		A += 4
	ELSEIF ABL:B:레즈중독 <= 8
		A += 5
	ELSEIF ABL:B:레즈중독 <= 10
		A += 6
	ELSE
		A += 6 + (ABL:B:레즈중독 - 10) / 3
	ENDIF

	;Ｃ민감
	SIF TALENT:B:Ｃ민감
		A += 1
ENDIF

;창부
SIF TALENT:B:창부
	A += 1
;헌신적
SIF TALENT:B:헌신적
	A += 1

SIF A == 0
	A = 1

IF IS_LESBIAN(B,MASTER)
	CALL ADDS_EXP("레즈경험", A, B)
	CALL ADDS_EXP("레즈경험", A, MASTER)
ELSEIF IS_GAY(B,MASTER)
	CALL ADDS_EXP("ＢＬ경험", A, B)
	CALL ADDS_EXP("ＢＬ경험", A, MASTER)
ENDIF

IF Y == 1
	;기승위
	CALL ADDS_EXP("사정경험", A/2, MASTER)
	IF HAVE_PENIS(B) && !IS_MALE(MASTER)
		CALL ADDS_EXP("사정경험", A/2, B)
		CALL ADDS_EXP("정액경험", A, MASTER)
	ENDIF

	IF CFLAG:B:주인의질내사정에의한임신판정 > 1 && CFLAG:B:자궁내피임결계 == 0 && (TALENT:B:연모 || TALENT:B:친애)
		CALL ADDS_EXP("질사경험", A/2, B)
		CFLAG:B:주인의질내사정에의한임신판정 += A/2
	ENDIF

	CALL ADDS_EXP("정액경험", A/2, B)
	CALL ADDS_EXP("Ｖ경험", A/2, B)
	CALL ADDS_EXP("성교경험", A/2, B)
	GOTJUEL:B:쾌Ｖ += A*100
ELSE
	;貝合わせ
	GOTJUEL:B:쾌Ｃ += A*100
ENDIF

GOTJUEL:B:복종 += A*70
GOTJUEL:B:굴복 += A*30
GOTJUEL:B:습득 += A*40
TFLAG:13 = 3
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:MASTER%---
CALL SHOW_ADD_EXP(MASTER, "단순")
CALL SHOW_JUEL_CHECK, MASTER
DRAWLINE

RETURN 0


;朝기승위A
@SELF_MORNING_24
DRAWLINE

;욕망
IF ABL:B:욕망 <= 2
	A = 1
ELSEIF ABL:B:욕망 <= 4
	A = 2
ELSEIF ABL:B:욕망 <= 7
	A = 3
ELSEIF ABL:B:욕망 <= 10
	A = 4
ELSE
	A = 4 + (ABL:B:욕망 - 10) / 4
ENDIF

;Ａ감각
IF ABL:B:Ａ감각 <= 2
	A += 1
ELSEIF ABL:B:Ａ감각 <= 4
	A += 2
ELSEIF ABL:B:Ａ감각 <= 7
	A += 3
ELSEIF ABL:B:Ａ감각 <= 10
	A += 4
ELSE
	A += 4 + (ABL:B:Ａ감각 - 10) / 3
ENDIF

;정액중독
IF ABL:B:정액중독 <= 1
	A += 1
ELSEIF ABL:B:정액중독 <= 2
	A += 2
ELSEIF ABL:B:정액중독 <= 5
	A += 3
ELSEIF ABL:B:정액중독 <= 7
	A += 4
ELSEIF ABL:B:정액중독 <= 10
	A += 5
ELSE
	A += 5 + (ABL:B:정액중독 - 10) / 3
ENDIF

;섹스중독
IF ABL:B:섹스중독 <= 1
	A += 1
ELSEIF ABL:B:섹스중독 <= 2
	A += 2
ELSEIF ABL:B:섹스중독 <= 4
	A += 3
ELSEIF ABL:B:섹스중독 <= 6
	A += 4
ELSEIF ABL:B:섹스중독 <= 8
	A += 5
ELSEIF ABL:B:섹스중독 <= 10
	A += 6
ELSE
	A += 6 + (ABL:B:섹스중독 - 10) / 3
ENDIF

;창부
SIF TALENT:B:창부
	A += 1
;헌신적
SIF TALENT:B:헌신적
	A += 1
;애널광
SIF TALENT:B:애널광
	A += 2
;Ａ민감
SIF TALENT:B:Ａ민감
	A += 1

SIF A == 0
	A = 1

IF IS_LESBIAN(B,MASTER)
	CALL ADDS_EXP("레즈경험", A, B)
	CALL ADDS_EXP("레즈경험", A, MASTER)
ELSEIF IS_GAY(B,MASTER)
	CALL ADDS_EXP("ＢＬ경험", A, B)
	CALL ADDS_EXP("ＢＬ경험", A, MASTER)
ENDIF

CALL ADDS_EXP("사정경험", A/2, MASTER)

IF HAVE_PENIS(B)
	CALL ADDS_EXP("사정경험", A/2, B)
	CALL ADDS_EXP("정액경험", A, MASTER)
ENDIF

CALL ADDS_EXP("정액경험", A/2, B)
CALL ADDS_EXP("Ａ경험", A/2, B)
CALL ADDS_EXP("성교경험", A/2, B)
GOTJUEL:B:쾌Ａ += A*100
GOTJUEL:B:복종 += A*70
GOTJUEL:B:굴복 += A*30
GOTJUEL:B:습득 += A*40
TFLAG:13 = 24
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:MASTER%---
CALL SHOW_ADD_EXP(MASTER, "단순")
CALL SHOW_JUEL_CHECK, MASTER
DRAWLINE

RETURN 0


;朝파이즈리
@SELF_MORNING_2
DRAWLINE

;욕망
IF ABL:B:욕망 <= 2
	A = 1
ELSEIF ABL:B:욕망 <= 4
	A = 2
ELSEIF ABL:B:욕망 <= 7
	A = 3
ELSEIF ABL:B:욕망 <= 10
	A = 4
ELSE
	A = 4 + (ABL:B:욕망 - 10) / 4
ENDIF

;Ｂ감각
IF ABL:B:Ｂ감각 <= 2
	A += 1
ELSEIF ABL:B:Ｂ감각 <= 4
	A += 2
ELSEIF ABL:B:Ｂ감각 <= 7
	A += 3
ELSEIF ABL:B:Ｂ감각 <= 10
	A += 4
ELSE
	A += 4 + (ABL:B:Ｂ감각 - 10) / 3
ENDIF

;정액중독
IF ABL:B:정액중독 <= 1
	A += 1
ELSEIF ABL:B:정액중독 <= 2
	A += 2
ELSEIF ABL:B:정액중독 <= 5
	A += 3
ELSEIF ABL:B:정액중독 <= 7
	A += 4
ELSEIF ABL:B:정액중독 <= 10
	A += 5
ELSE
	A += 5 + (ABL:B:정액중독 - 10) / 3
ENDIF

;분유중독
IF TALENT:B:모유체질
	IF ABL:B:분유중독 <= 2
		A += 1
	ELSEIF ABL:B:분유중독 <= 4
		A += 2
	ELSEIF ABL:B:분유중독 <= 7
		A += 3
	ELSEIF ABL:B:분유중독 <= 10
		A += 4
	ELSE
		A += 4 + (ABL:B:분유중독 - 10) / 4
	ENDIF
ENDIF

;예속
SIF TALENT:B:예속
	A += 1
;악취둔감
SIF TALENT:B:악취둔감
	A += 1
;악취민감
SIF TALENT:B:악취민감
	A -= 1
;헌신적
SIF TALENT:B:헌신적
	A += 1
;음유
SIF TALENT:B:음유
	A += 2
;Ｂ민감
SIF TALENT:B:Ｂ민감
	A += 1

SIF A == 0
	A = 1

IF IS_LESBIAN(B,MASTER)
	CALL ADDS_EXP("레즈경험", A, B)
	CALL ADDS_EXP("레즈경험", A, MASTER)
ENDIF

CALL ADDS_EXP("사정경험", A/2, MASTER)

CALL ADDS_EXP("펠라경험", A, B)
CALL ADDS_EXP("정액경험", A/2, B)
SIF TALENT:B:모유체질
	CALL ADDS_EXP("분유경험", A/2, B)
GOTJUEL:B:쾌Ｂ += A*80
GOTJUEL:B:복종 += A*100
GOTJUEL:B:굴복 += A*30
GOTJUEL:B:습득 += A*70
TFLAG:13 = 2
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:MASTER%---
CALL SHOW_ADD_EXP(MASTER, "단순")
CALL SHOW_JUEL_CHECK, MASTER
DRAWLINE

RETURN 0


;朝키스
@SELF_MORNING_25
DRAWLINE

;순종
IF ABL:B:순종 <= 6
	A = 3
ELSEIF ABL:B:순종 <= 8
	A = 4
ELSEIF ABL:B:순종 <= 10
	A = 5
ELSE
	A = 5 + (ABL:B:순종 - 10) / 3
ENDIF

;봉사정신
IF ABL:B:봉사정신 == 6
	A += 4
ELSEIF ABL:B:봉사정신 <= 8
	A += 5
ELSEIF ABL:B:봉사정신 <= 10
	A += 6
ELSE
	A += 6 + (ABL:B:봉사정신 - 10) / 2
ENDIF

;친애
SIF TALENT:B:친애
	A += 3
;헌신적
SIF TALENT:B:헌신적
	A += 1

SIF A == 0
	A = 1

IF IS_LESBIAN(B,MASTER)
	CALL ADDS_EXP("레즈경험", A, B)
	CALL ADDS_EXP("레즈경험", A, MASTER)
ELSEIF IS_GAY(B,MASTER)
	CALL ADDS_EXP("ＢＬ경험", A, B)
	CALL ADDS_EXP("ＢＬ경험", A, MASTER)
ENDIF

CALL ADDS_EXP("애정경험", A/2, B)
CALL ADDS_EXP("키스경험", A/2, B)
CALL ADDS_EXP("애정경험", A/2, MASTER)
CALL ADDS_EXP("키스경험", A/2, MASTER)
GOTJUEL:B:복종 += A*80
GOTJUEL:B:습득 += A*20
TFLAG:13 = 25
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:MASTER%---
CALL SHOW_ADD_EXP(MASTER, "단순")
CALL SHOW_JUEL_CHECK, MASTER
DRAWLINE

RETURN 0


;朝フェラ/커닐링구스
@SELF_MORNING_1
DRAWLINE

;욕망
IF ABL:B:욕망 <= 2
	A = 1
ELSEIF ABL:B:욕망 <= 4
	A = 2
ELSEIF ABL:B:욕망 <= 7
	A = 3
ELSEIF ABL:B:욕망 <= 10
	A = 4
ELSE
	A = 4 + (ABL:B:욕망 - 10) / 4
ENDIF

;봉사정신
IF ABL:B:봉사정신 <= 2
	A += 1
ELSEIF ABL:B:봉사정신 <= 4
	A += 2
ELSEIF ABL:B:봉사정신 <= 7
	A += 3
ELSEIF ABL:B:봉사정신 <= 10
	A += 4
ELSE
	A += 4 + (ABL:B:봉사정신 - 10) / 3
ENDIF

IF Y == 1
;フェラ
	;정액중독
	IF ABL:B:정액중독 <= 1
		A += 1
	ELSEIF ABL:B:정액중독 <= 2
		A += 2
	ELSEIF ABL:B:정액중독 <= 5
		A += 3
	ELSEIF ABL:B:정액중독 <= 7
		A += 4
	ELSEIF ABL:B:정액중독 <= 10
		A += 5
	ELSE
		A += 5 + (ABL:B:정액중독 - 10) / 2
	ENDIF
ELSE
;커닐링구스
	;とりあえず레즈중독
	IF ABL:B:레즈중독 <= 1
		A += 1
	ELSEIF ABL:B:레즈중독 <= 2
		A += 2
	ELSEIF ABL:B:레즈중독 <= 4
		A += 3
	ELSEIF ABL:B:레즈중독 <= 6
		A += 4
	ELSEIF ABL:B:레즈중독 <= 8
		A += 5
	ELSEIF ABL:B:레즈중독 <= 10
		A += 6
	ELSE
		A += 6 + (ABL:B:레즈중독 - 10) / 2
	ENDIF
ENDIF

;예속
SIF TALENT:B:예속
	A += 1
;악취둔감
SIF TALENT:B:악취둔감
	A += 1
;악취민감
SIF TALENT:B:악취민감
	A -= 1
;헌신적
SIF TALENT:B:헌신적
	A += 1

SIF A == 0
	A = 1

IF IS_LESBIAN(B,MASTER)
	CALL ADDS_EXP("레즈경험", A, B)
	CALL ADDS_EXP("레즈경험", A, MASTER)
ELSEIF (IS_GAY(B,MASTER) && 0)
	CALL ADDS_EXP("ＢＬ경험", A, B)
	CALL ADDS_EXP("ＢＬ경험", A, MASTER)
ENDIF

IF Y == 1
;フェラ
	CALL ADDS_EXP("사정경험", A/2, MASTER)

	CALL ADDS_EXP("펠라경험", A, B)
	CALL ADDS_EXP("정액경험", A/2, B)
;クンニには特に無し
ENDIF

GOTJUEL:B:복종 += A*70
GOTJUEL:B:굴복 += A*30
GOTJUEL:B:습득 += A*80
TFLAG:13 = 1
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:MASTER%---
CALL SHOW_ADD_EXP(MASTER, "단순")
CALL SHOW_JUEL_CHECK, MASTER
DRAWLINE

RETURN 0


;朝食
@SELF_MORNING_26
DRAWLINE

;순종
IF ABL:B:순종 <= 6
	A = 1
ELSEIF ABL:B:순종 <= 8
	A = 2
ELSEIF ABL:B:순종 <= 10
	A = 3
ELSE
	A = 3 + (ABL:B:순종 - 10) / 4
ENDIF

;봉사정신
IF ABL:B:봉사정신 <= 6
	A += 2
ELSEIF ABL:B:봉사정신 <= 8
	A += 3
ELSEIF ABL:B:봉사정신 <= 10
	A += 4
ELSE
	A += 4 + (ABL:B:봉사정신 - 10) / 3
ENDIF

;요리기능
IF ABL:B:요리기능 <= 2
	A += 2
ELSEIF ABL:B:요리기능 <= 4
	A += 3
ELSEIF ABL:B:요리기능 <= 7
	A += 4
ELSEIF ABL:B:요리기능 <= 10
	A += 5
ELSE
	A += 5 + (ABL:B:요리기능 - 10) / 2
ENDIF

;낙관적または눈에띄고싶어함且つ가창기능2이상
IF (TALENT:B:낙관적 || TALENT:B:눈에띄고싶어함) && ABL:B:가창기능 >= 2
	IF ABL:B:가창기능 <= 4
		A += 1
	ELSEIF ABL:B:가창기능 <= 7
		A += 2
	ELSEIF ABL:B:가창기능 <= 10
		A += 3
	ELSE
		A += 3 + (ABL:B:가창기능 - 10) / 4
	ENDIF
ENDIF

;연모
SIF TALENT:B:연모
	A += 1
;친애
SIF TALENT:B:친애
	A += 2
;헌신적
SIF TALENT:B:헌신적
	A += 1

;에이프런有り
SIF ITEM:에이프런 == 1
	A += 1

SIF A == 0
	A = 1

IF TALENT:B:연모 || TALENT:B:친애
	CALL ADDS_EXP("애정경험", A/3, B)
	CALL ADDS_EXP("애정경험", A/3, MASTER)
ENDIF
CALL ADDS_EXP("가사경험", A/3, B)
SIF (TALENT:B:낙관적 || TALENT:B:눈에띄고싶어함) && ABL:B:가창기능 >= 2
	CALL ADDS_EXP("가창경험", A/5, B)
GOTJUEL:B:복종 += A*60
GOTJUEL:B:습득 += A*70
TFLAG:13 = 26
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:MASTER%---
CALL SHOW_ADD_EXP(MASTER, "단순")
CALL SHOW_JUEL_CHECK, MASTER
DRAWLINE

RETURN 0


;起きたら隣で寝てる
@SELF_MORNING_27
DRAWLINE

;순종
IF ABL:B:순종 <= 2
	A = 2
ELSEIF ABL:B:순종 <= 4
	A = 3
ELSEIF ABL:B:순종 <= 7
	A = 4
ELSEIF ABL:B:순종 <= 10
	A = 5
ELSE
	A = 5 + (ABL:B:순종 - 10) / 3
ENDIF

;봉사정신
IF ABL:B:봉사정신 <= 2
	A += 1
ELSEIF ABL:B:봉사정신 <= 4
	A += 2
ELSEIF ABL:B:봉사정신 <= 7
	A += 3
ELSEIF ABL:B:봉사정신 <= 10
	A += 4
ELSE
	A += 4 + (ABL:B:봉사정신 - 10) / 4
ENDIF

;친애
SIF TALENT:B:친애
	A += 2
;유아／유아퇴행または유치
SIF TALENT:B:유아／유아퇴행 || TALENT:B:유치
	A += 1
;아이
SIF TALENT:B:아이
	A += 2

SIF A == 0
	A = 1

;とりあえず레즈경험、ＢＬ경험は無しで
CALL ADDS_EXP("애정경험", A/4, B)
CALL ADDS_EXP("애정경험", A/4, MASTER)
GOTJUEL:B:복종 += A*60
TFLAG:13 = 27
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:MASTER%---
CALL SHOW_ADD_EXP(MASTER, "단순")
CALL SHOW_JUEL_CHECK, MASTER
DRAWLINE

RETURN 0


;朝の발コキ
@SELF_MORNING_28
DRAWLINE

;욕망
IF ABL:B:욕망 <= 2
	A = 1
ELSEIF ABL:B:욕망 <= 4
	A = 2
ELSEIF ABL:B:욕망 <= 7
	A = 3
ELSEIF ABL:B:욕망 <= 10
	A = 4
ELSE
	A = 4 + (ABL:B:욕망 - 10) / 4
ENDIF

;봉사정신
IF ABL:B:봉사정신 <= 6
	A += 2
ELSEIF ABL:B:봉사정신 <= 8
	A += 3
ELSEIF ABL:B:봉사정신 <= 10
	A += 4
ELSE
	A += 4 + (ABL:B:봉사정신 - 10) / 4
ENDIF

;새드끼
IF ABL:B:새드끼 <= 1
	A += 2
ELSEIF ABL:B:새드끼 <= 3
	A += 3
ELSEIF ABL:B:새드끼 <= 6
	A += 4
ELSEIF ABL:B:새드끼 <= 10
	A += 5
ELSE
	A += 5 + (ABL:B:새드끼 - 10) / 2
ENDIF

;새드
SIF TALENT:B:새드
	A += 1

SIF A == 0
	A = 1

IF IS_LESBIAN(B,MASTER)
	CALL ADDS_EXP("레즈경험", A, B)
	CALL ADDS_EXP("레즈경험", A, MASTER)
ELSEIF IS_GAY(B,MASTER)
	CALL ADDS_EXP("ＢＬ경험", A, B)
	CALL ADDS_EXP("ＢＬ경험", A, MASTER)
ENDIF

CALL ADDS_EXP("사정경험", A/2, MASTER)

IF HAVE_PENIS(MASTER)
	CALL ADDS_EXP("정액경험", A/2, B)
ENDIF

CALL ADDS_EXP("가학쾌락경험", A/2, B)
CALL ADDS_EXP("고통쾌락경험", A/2, MASTER)
GOTJUEL:B:복종 += A*30
GOTJUEL:B:습득 += A*80
TFLAG:13 = 28
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:MASTER%---
CALL SHOW_ADD_EXP(MASTER, "단순")
CALL SHOW_JUEL_CHECK, MASTER
DRAWLINE

RETURN 0

;お寝小
@SELF_MORNING_30
DRAWLINE

;Ｃ감각
IF ABL:B:Ｃ감각 <= 2
	A = 2
ELSEIF ABL:B:Ｃ감각 <= 4
	A = 3
ELSEIF ABL:B:Ｃ감각 <= 7
	A = 4
ELSEIF ABL:B:Ｃ감각 <= 10
	A = 5
ELSE
	A = 5 + (ABL:B:Ｃ감각 - 10) / 3
ENDIF

;노출증
IF ABL:B:노출증 <= 2
	A += 2
ELSEIF ABL:B:노출증 <= 4
	A += 3
ELSEIF ABL:B:노출증 <= 7
	A += 4
ELSEIF ABL:B:노출증 <= 10
	A += 5
ELSE
	A += 5 + (ABL:B:노출증 - 10) / 3
ENDIF

;자위광
SIF TALENT:B:자위광
	A += 2
;Ｃ민감
SIF TALENT:B:Ｃ민감
	A += 1
;유아／유아퇴행または유치
SIF TALENT:B:유아／유아퇴행 || TALENT:B:유치
	A += 2
;아이は驚異的な早さで成長するので、TALENT:아이はとりあえず대상外

SIF A == 0
	A = 1

CALL ADDS_EXP("방뇨경험", A/4, B)
GOTJUEL:B:쾌Ｃ += A*60
GOTJUEL:B:굴복 += A*50
GOTJUEL:B:치정 += A*40
GOTJUEL:B:부정 += A*20
TFLAG:13 = 30
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:MASTER%---
CALL SHOW_ADD_EXP(MASTER, "단순")
CALL SHOW_JUEL_CHECK, MASTER
DRAWLINE

RETURN 0


;朝の搾りたてミルク
@SELF_MORNING_29
DRAWLINE

;봉사정신
IF ABL:B:봉사정신 <= 6
	A = 2
ELSEIF ABL:B:봉사정신 <= 8
	A = 3
ELSEIF ABL:B:봉사정신 <= 10
	A = 4
ELSE
	A = 4 + (ABL:7 - 10) / 3
ENDIF

;분유중독
IF ABL:B:분유중독 <= 1
	A += 1
ELSEIF ABL:B:분유중독 <= 3
	A += 2
ELSEIF ABL:B:분유중독 <= 6
	A += 3
ELSEIF ABL:B:분유중독 <= 10
	A += 4
ELSE
	A += 4 + (ABL:B:분유중독 - 10) / 2
ENDIF

;헌신적
SIF TALENT:B:헌신적
	A += 1
;음유
SIF TALENT:B:음유
	A += 2
;Ｂ민감
SIF TALENT:B:Ｂ민감
	A += 1

SIF A == 0
	A = 1

CALL ADDS_EXP("분유경험", A/2, B)
GOTJUEL:B:쾌Ｂ += A*40
GOTJUEL:B:복종 += A*60
GOTJUEL:B:치정 += A*40
TFLAG:13 = 29
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:MASTER%---
CALL SHOW_ADD_EXP(MASTER, "단순")
CALL SHOW_JUEL_CHECK, MASTER
DRAWLINE

;朝Vレイプ(対象C 相手V)
@SELF_MORNING_68
DRAWLINE

;욕망
IF ABL:B:욕망 <= 2
	A = 1
ELSEIF ABL:B:욕망 <= 4
	A = 2
ELSEIF ABL:B:욕망 <= 7
	A = 3
ELSEIF ABL:B:욕망 <= 10
RETURN 0

	A = 4
ELSE
	A = 4 + (ABL:B:욕망 - 10) / 4
ENDIF

;Ｖ감각
IF ABL:MASTER:Ｖ감각 <= 2
	A += 1
ELSEIF ABL:MASTER:Ｖ감각 <= 4
	A += 2
ELSEIF ABL:MASTER:Ｖ감각 <= 7
	A += 3
ELSEIF ABL:MASTER:Ｖ감각 <= 10
	A += 4
ELSE
	A += 4 + (ABL:MASTER:Ｖ감각 - 10) / 3
ENDIF

;Ｃ감각（対象）
IF ABL:B:Ｃ감각 <= 2
	A += 1
ELSEIF ABL:B:Ｃ감각 <= 4
	A += 2
ELSEIF ABL:B:Ｃ감각 <= 7
	A += 3
ELSEIF ABL:B:Ｃ감각 <= 10
	A += 4
ELSE
	A += 4 + (ABL:B:Ｃ감각 - 10) / 3
ENDIF

;정액중독
IF ABL:MASTER:정액중독 <= 1
	A += 1
ELSEIF ABL:MASTER:정액중독 <= 2
	A += 2
ELSEIF ABL:MASTER:정액중독 <= 5
	A += 3
ELSEIF ABL:MASTER:정액중독 <= 7
	A += 4
ELSEIF ABL:MASTER:정액중독 <= 10
	A += 5
ELSE
	A += 5 + (ABL:MASTER:정액중독 - 10) / 4
ENDIF

;섹스중독
IF ABL:B:섹스중독 <= 1
	A += 1
ELSEIF ABL:B:섹스중독 <= 2
	A += 2
ELSEIF ABL:B:섹스중독 <= 4
	A += 3
ELSEIF ABL:B:섹스중독 <= 6
	A += 4
ELSEIF ABL:B:섹스중독 <= 8
	A += 5
ELSEIF ABL:B:섹스중독 <= 10
	A += 6
ELSE
	A += 6 + (ABL:B:섹스중독 - 10) / 3
ENDIF

;娼婦
SIF TALENT:B:창부
	A += 1
;セックス狂
SIF TALENT:B:섹스광
	A += 2
SIF TALENT:MASTER:섹스광
	A += 2
;Ｖ敏感
SIF TALENT:MASTER:Ｖ민감
	A += 1
;献身的
SIF TALENT:B:헌신적
	A += 1
;獰猛もしくは狡猾
SIF TALENT:B:영맹 || TALENT:B:교활
	A += 1

SIF A == 0
	A = 1

IF IS_LESBIAN(B,MASTER)
	CALL ADDS_EXP("레즈경험", A, B)
	CALL ADDS_EXP("레즈경험", A, MASTER)
ELSEIF IS_GAY(B,MASTER)
	CALL ADDS_EXP("ＢＬ경험", A, B)
	CALL ADDS_EXP("ＢＬ경험", A, MASTER)
ENDIF

IF HAVE_PENIS(B)
	CALL ADDS_EXP("사정경험", A/2, B)
	IF CFLAG:MASTER:노예의질내사정에의한임신판정 > 1 && CFLAG:MASTER:자궁내피임결계 == 0
		CALL ADDS_EXP("질사경험", A/2, MASTER)
		CFLAG:MASTER:노예의질내사정에의한임신판정 += A/2
	ENDIF
ENDIF


CALL ADDS_EXP("사정경험", A/2, B)
CALL ADDS_EXP("Ｖ경험", A/2, MASTER)
CALL ADDS_EXP("절정경험", A/4, B)
CALL ADDS_EXP("절정경험", A/4, MASTER)
;CALL ADDS_EXP("성교경험", A/2, B)
CALL ADDS_EXP("성교경험", A/2, MASTER)
CALL ADDS_EXP("정액경험", A/2, MASTER)
GOTJUEL:B:쾌Ｃ += A*100
GOTJUEL:B:복종 += A*60
GOTJUEL:B:굴복 += A*40
GOTJUEL:B:습득 += A*40
TFLAG:13 = 68
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:B%---
CALL SHOW_ADD_EXP(B, "단순")
CALL SHOW_JUEL_CHECK, B
PRINTFORML ---%CALLNAME:MASTER%---
CALL SHOW_ADD_EXP(MASTER, "단순")
;CALL SHOW_JUEL_CHECK, MASTER


DRAWLINE

RETURN 0

;-------------------------------------------------
;조교後に起こる이벤트
;-------------------------------------------------
@SELF_CHECK
;強精神剤の反動
IF TEQUIP:강정신약 > 0 && (TFLAG:44>0 || TFLAG:45>0 || TFLAG:46>0 || TFLAG:47>0)
	CALL SELF_CHECK3
;조교後레즈およびＢＬプレイ、조교後섹스どちらか一つ（強정신剤の反動が起こる時は무효）
ELSE
	IF ASSI >= 0
		A = NO:ASSI
		IF (TALENT:음란 || TALENT:창부) && GET_RELATION(TARGET, ASSI) > 100 && BASE:0 >= 500 && TEQUIP:강정신약 <= 2 && (IS_LESBIAN(ASSI,TARGET) || IS_GAY(ASSI,TARGET))
			CALL SELF_CHECK1
		ELSEIF ((TALENT:연모 || TALENT:친애) || ((TALENT:음란 || TALENT:복종 || TALENT:창부 || TALENT:예속) && ABL:Ｖ감각 >= 3)) && TALENT:처녀 == 0 && TALENT:재생처녀 == 0 && BASE:체력 >= 500 && TEQUIP:강정신약 <= 2 && CFLAG:MASTER:사정남은수보존 && HAVE_PENIS(MASTER) && !IS_MALE(TARGET)
			CALL SELF_CHECK2
		ENDIF
	ELSEIF ((TALENT:연모 || TALENT:친애) || ((TALENT:음란 || TALENT:복종 || TALENT:창부 || TALENT:예속) && ABL:Ｖ감각 >= 3)) && TALENT:처녀 == 0 && TALENT:재생처녀 == 0 && BASE:체력 >= 500 && TEQUIP:강정신약 <= 2 && CFLAG:MASTER:사정남은수보존 && HAVE_PENIS(MASTER) && !IS_MALE(TARGET)
		CALL SELF_CHECK2
	ELSEIF ((TALENT:연모 || TALENT:친애) || ((TALENT:음란 || TALENT:복종 || TALENT:창부 || TALENT:예속) && ABL:Ｃ감각 >= 3)) && TALENT:MASTER:처녀 == 0 && TALENT:MASTER:재생처녀 == 0 && BASE:체력 >= 500 && TEQUIP:강정신약 <= 2 && CFLAG:사정남은수보존 && HAVE_PENIS(TARGET) && !IS_MALE(MASTER)
		CALL SELF_CHECK6
	ENDIF

	;조교後착유、조교後자위。どれか一つ
	IF ABL:Ｃ감각 >= 4 && (ABL:분유중독 > ABL:자위중독) && TALENT:모유체질 && !IS_MALE(TARGET)
		CALL SELF_CHECK4
	ELSEIF ABL:자위중독
		CALL SELF_CHECK5
	ENDIF
ENDIF


;레즈およびＢＬプレイ
@SELF_CHECK1
;이벤트구상호출
DRAWLINE

;레즈중독또는ＢＬ중독
N = 1
IF IS_LESBIAN(TARGET,ASSI)
	IF ABL:레즈중독 == 1
		N += 1
	ELSEIF ABL:레즈중독 == 2
		N += 2
	ELSEIF ABL:레즈중독 == 3
		N += 3
	ELSEIF ABL:레즈중독 == 4
		N += 5
	ELSEIF ABL:레즈중독 >= 5
		N += 7
	ENDIF
	IF ABL:ASSI:레즈중독 == 1
		N += 1
	ELSEIF ABL:ASSI:레즈중독 == 2
		N += 2
	ELSEIF ABL:ASSI:레즈중독 == 3
		N += 5
	ELSEIF ABL:ASSI:레즈중독 == 4
		N += 8
	ELSEIF ABL:ASSI:레즈중독 >= 5
		N += 13
	ENDIF
ELSEIF IS_GAY(TARGET,ASSI)
	IF ABL:ＢＬ중독 == 1
		N += 1
	ELSEIF ABL:ＢＬ중독 == 2
		N += 2
	ELSEIF ABL:ＢＬ중독 == 3
		N += 3
	ELSEIF ABL:ＢＬ중독 == 4
		N += 5
	ELSEIF ABL:ＢＬ중독 >= 5
		N += 7
	ENDIF
	IF ABL:ASSI:ＢＬ중독 == 1
		N += 1
	ELSEIF ABL:ASSI:ＢＬ중독 == 2
		N += 2
	ELSEIF ABL:ASSI:ＢＬ중독 == 3
		N += 5
	ELSEIF ABL:ASSI:ＢＬ중독 == 4
		N += 8
	ELSEIF ABL:ASSI:ＢＬ중독 >= 5
		N += 13
	ENDIF
ENDIF

;愛称処理
;A = NO:ASSI
N *= GET_RELATION(TARGET, ASSI)
N /= 100

;바이
SIF TALENT:바이
	M += 3


IF IS_LESBIAN(TARGET,ASSI)
	CALL ADDS_EXP("레즈경험", N*20, TARGET)
	CALL ADDS_EXP("레즈경험", N*20, ASSI)
ELSEIF IS_GAY(TARGET,ASSI)
	CALL ADDS_EXP("ＢＬ경험", N*20, TARGET)
	CALL ADDS_EXP("ＢＬ경험", N*20, ASSI)
ENDIF
CALL ADDS_EXP("절정경험", N*100*ABL:순종/500, TARGET)
GOTJUEL:쾌Ｃ += N*100*ABL:순종
GOTJUEL:욕정 += N*200

IF HAVE_PENIS(TARGET) && HAVE_PENIS(ASSI)
	CALL ADDS_EXP("사정경험", N, TARGET)
	CALL ADDS_EXP("정액경험", N, TARGET)
	CALL ADDS_EXP("봉사쾌락경험", N, TARGET)
	CALL ADDS_EXP("펠라경험", N, TARGET)
	CALL ADDS_EXP("사정경험", N, ASSI)
	CALL ADDS_EXP("정액경험", N, ASSI)
	CALL ADDS_EXP("봉사쾌락경험", N, ASSI)
	CALL ADDS_EXP("펠라경험", N, ASSI)
	GOTJUEL:욕정 += N*100
	GOTJUEL:굴복 += N*100
	GOTJUEL:치정 += N*100
ELSEIF HAVE_PENIS(ASSI)
	CALL ADDS_EXP("정액경험", N, TARGET)
	CALL ADDS_EXP("사정경험", N, ASSI)
	GOTJUEL:굴복 += N*100*(ABL:기교+ABL:봉사정신)
	GOTJUEL:습득 += N*100*(ABL:기교+ABL:봉사정신)
ELSEIF HAVE_PENIS(TARGET)
	CALL ADDS_EXP("정액경험", N, ASSI)
	CALL ADDS_EXP("사정경험", N, TARGET)
	GOTJUEL:치정 += N*100
ELSE
	GOTJUEL:굴복 += N*50*(ABL:기교+ABL:봉사정신)
	GOTJUEL:습득 += N*50*(ABL:기교+ABL:봉사정신)
ENDIF

IF TALENT:ASSI:새드
	IF N*100*ABL:노출증 > 0
		GOTJUEL:고통 += N*100*(1 + ABL:마조끼)
	ENDIF
	CALL ADDS_EXP("고통쾌락경험", N, TARGET)
	CALL ADDS_EXP("가학쾌락경험", N, ASSI)
ENDIF
TFLAG:13 = 4
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:TARGET%---
CALL SHOW_ADD_EXP(TARGET, "단순")
CALL SHOW_JUEL_CHECK, TARGET
PRINTFORML ---%CALLNAME:ASSI%---
CALL SHOW_ADD_EXP(ASSI, "단순")
;CALL SHOW_JUEL_CHECK, ASSI

WAIT
DRAWLINE

;조교後섹스
@SELF_CHECK2
;이벤트구상호출
DRAWLINE

S = 1
;V감각
IF ABL:Ｖ감각 == 1
	S += 1
ELSEIF ABL:Ｖ감각 == 2
	S += 2
ELSEIF ABL:Ｖ감각 == 3
	S += 3
ELSEIF ABL:Ｖ감각 == 4
	S += 4
ELSEIF ABL:Ｖ감각 >= 5
	S += 5
ENDIF

;욕망と봉사정신によるボーナス
IF ABL:욕망 >= 5 && ABL:봉사정신 >= 5 && PALAM:5 >= PALAMLV:5
	S += 3
ELSEIF ABL:욕망 >= 4 && ABL:봉사정신 >= 4 && PALAM:5 >= PALAMLV:4
	S += 2
ELSEIF ABL:욕망 >= 3 && ABL:봉사정신 >= 3 && PALAM:5 >= PALAMLV:3
	S += 1
ENDIF

;섹스광
SIF TALENT:섹스광
	S += 3

;主人の사정제한
SIF S > CFLAG:MASTER:사정남은수보존
	S = CFLAG:MASTER:사정남은수보존

CALL ADDS_EXP("Ｖ경험", S, TARGET)
CALL ADDS_EXP("정액경험", S, TARGET)
CALL ADDS_EXP("성교경험", S, TARGET)
IF CFLAG:주인의질내사정에의한임신판정 > 0 && CFLAG:자궁내피임결계 == 0
	CALL ADDS_EXP("질사경험", S/2, TARGET)
	CFLAG:주인의질내사정에의한임신판정 += S/2
ENDIF
GOTJUEL:쾌Ｖ += S*400
GOTJUEL:복종 += S*200
GOTJUEL:욕정 += S*400
CFLAG:MASTER:사정남은수보존 -= S
TFLAG:13 = 5
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:TARGET%---
CALL SHOW_ADD_EXP(TARGET, "단순")
CALL SHOW_JUEL_CHECK, TARGET
;PRINTFORML ---%CALLNAME:MASTER%---
;CALL SHOW_ADD_EXP(MASTER, "단순")
;CALL SHOW_JUEL_CHECK, MASTER
WAIT


@SELF_CHECK3
;이벤트구상호출
DRAWLINE

;강정신약による절정체크
D = 0
;강정신약の効果が残ったまま조교を종료した場合の処理
;통상時の効果が再現できそうにないので同時多重절정したという処理に변경
;Dは多重절정の종류を示す(1の場合は○절정、2の場合は○＋△절정、4の場合は四重절정となっている)
SIF TFLAG:44
	D += 1
SIF TFLAG:45
	D += 1
SIF TFLAG:46
	D += 1
SIF TFLAG:47
	D += 1
C = D * TFLAG:44
V = D * TFLAG:45
A = D * TFLAG:46
B = D * TFLAG:47

CALL ADDS_EXP("절정경험", TFLAG:44 + TFLAG:45 + TFLAG:46 + TFLAG:47, TARGET)
GOTJUEL:쾌Ｃ += C*1000
GOTJUEL:쾌Ｖ += V*1000
GOTJUEL:쾌Ａ += A*1000
GOTJUEL:쾌Ｂ += B*1000

;리셋
TFLAG:44 = 0
TFLAG:45 = 0
TFLAG:46 = 0
TFLAG:47 = 0
TEQUIP:강정신약 = 0

;副作用で체력が500に
SIF BASE:체력 > 500
	BASE:체력 = 500
TFLAG:13 = 6
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:TARGET%---
CALL SHOW_ADD_EXP(TARGET, "단순")
CALL SHOW_JUEL_CHECK, TARGET
WAIT


@SELF_CHECK4
;이벤트구상호출
DRAWLINE


;분유중독による착유체크
;남자はだめ。모유체질、분유중독、一定능력、체력が필요
M = 1

IF ABL:분유중독 == 1
	M += 1
ELSEIF ABL:분유중독 == 2
	M += 2
ELSEIF ABL:분유중독 == 3
	M += 3
ELSEIF ABL:분유중독 == 4
	M += 5
ELSEIF ABL:분유중독 >= 5
	M += 7
ENDIF
;욕망と봉사정신によるボーナス
IF ABL:욕망 >= 5 && ABL:봉사정신 >= 5 && PALAM:5 >= PALAMLV:5
	M += 3
ELSEIF ABL:욕망 >= 4 && ABL:봉사정신 >= 4 && PALAM:5 >= PALAMLV:4
	M += 2
ELSEIF ABL:욕망 >= 3 && ABL:봉사정신 >= 3 && PALAM:5 >= PALAMLV:3
	M += 1
ENDIF
;자위하기쉬움
SIF TALENT:자위하기쉬움
	M += 2
;음유
SIF TALENT:음유
	M += 3


CALL ADDS_EXP("분유경험", M, TARGET)
GOTJUEL:쾌Ｂ += M*300
GOTJUEL:욕정 += M*50
GOTJUEL:습득 += M*20
IF ABL:순종+ABL:노출증+ABL:마조끼 >= 10
	GOTJUEL:치정 += M*150
ENDIF
TFLAG:13 = 7
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:TARGET%---
CALL SHOW_ADD_EXP(TARGET, "단순")
CALL SHOW_JUEL_CHECK, TARGET
;PRINTFORML ---%CALLNAME:MASTER%---
;CALL SHOW_ADD_EXP(MASTER, "단순")
;CALL SHOW_JUEL_CHECK, MASTER
WAIT


@SELF_CHECK5
;이벤트구상호출
DRAWLINE


;자위중독による자위체크
A = 1
;자위중독を見る
IF ABL:자위중독 == 1
	A += 1
ELSEIF ABL:자위중독 == 2
	A += 2
ELSEIF ABL:자위중독 == 3
	A += 3
ELSEIF ABL:자위중독 == 4
	A += 5
ELSEIF ABL:자위중독 >= 5
	A += 7
ENDIF

;욕망とＣ감각によるボーナス
IF ABL:욕망 >= 5 && ABL:Ｃ감각 >= 5 && PALAM:5 >= PALAMLV:5
	A += 3
ELSEIF ABL:욕망 >= 4 && ABL:Ｃ감각 >= 4 && PALAM:5 >= PALAMLV:4
	A += 2
ELSEIF ABL:욕망 >= 3 && ABL:Ｃ감각 >= 3 && PALAM:5 >= PALAMLV:3
	A += 1
ENDIF

;자위하기쉬움
SIF TALENT:자위하기쉬움
	A += 2
;자위광
SIF TALENT:자위광
	A += 3

;조수が고무
IF ASSI >= 0
	SIF TALENT:ASSI:고무
		A += 1
ENDIF

CALL ADDS_EXP("자위경험", A, TARGET)
GOTJUEL:쾌Ｃ += A*500
GOTJUEL:복종 += A*100
GOTJUEL:욕정 += A*250
IF ABL:순종+ABL:노출증+ABL:마조끼 >= 10 && TIME == 0
	GOTJUEL:치정 += A*200
ENDIF
TFLAG:13 = 8
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:TARGET%---
CALL SHOW_ADD_EXP(TARGET, "단순")
CALL SHOW_JUEL_CHECK, TARGET
WAIT

;調教後セックス(逆転)
@SELF_CHECK6
;イベント口上呼び出し
DRAWLINE

S = 1
;V感覚
IF ABL:Ｃ감각 == 1
	S += 1
ELSEIF ABL:Ｃ감각 == 2
	S += 2
ELSEIF ABL:Ｃ감각 == 3
	S += 3
ELSEIF ABL:Ｃ감각 == 4
	S += 4
ELSEIF ABL:Ｃ감각 >= 5
	S += 5
ENDIF

;욕망と봉사정신によるボーナス
IF ABL:욕망 >= 5 && ABL:봉사정신 >= 5 && PALAM:5 >= PALAMLV:5
	S += 3
ELSEIF ABL:욕망 >= 4 && ABL:봉사정신 >= 4 && PALAM:5 >= PALAMLV:4
	S += 2
ELSEIF ABL:욕망 >= 3 && ABL:봉사정신 >= 3 && PALAM:5 >= PALAMLV:3
	S += 1
ENDIF

;自慰狂い
SIF TALENT:자위광
	S += 3

;主人の射精制限
SIF S > CFLAG:MASTER:사정남은수보존
	S = CFLAG:MASTER:사정남은수보존

;CALL ADDS_EXP("Ｃ経験", S, TARGET)
CALL ADDS_EXP("사정경험", S, TARGET)
;CALL ADDS_EXP("성교경험", S, MASTER)
IF CFLAG:MASTER:노예의질내사정에의한임신판정 > 0 && CFLAG:자궁내피임결계 == 0
	;CALL ADDS_EXP("질사경험", S/2, MASTER)
	CFLAG:MASTER:노예의질내사정에의한임신판정 += S/2
ENDIF
GOTJUEL:쾌Ｃ += S*400
GOTJUEL:복종 += S*200
GOTJUEL:욕정 += S*400
CFLAG:MASTER:사정남은수보존 -= S
TFLAG:13 = 99
CALL KOJO_MESSAGE_EVENT
PRINTFORML ---%CALLNAME:TARGET%---
CALL SHOW_ADD_EXP(TARGET, "단순")
CALL SHOW_JUEL_CHECK, TARGET
;PRINTFORML ---%CALLNAME:MASTER%---
;CALL SHOW_ADD_EXP(MASTER, "단순")
;CALL SHOW_JUEL_CHECK, MASTER
WAIT

