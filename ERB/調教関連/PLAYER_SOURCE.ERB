
;_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/#
;
;	Module		:INFO.ERB
;
;	Licence		:ライセンスフリー。
;
;	Modification Data:
;
;	Edit	Date			Author					Reason
;	001		20XX/XX/XX		----					新規作成
;	002		2011/03/03		迷走中の人				쾌ＣＶＡＢのソースを해방
;	003		2019/03/28		TR(SAYA)				샤세트마	が3日持続する様に
;_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/#

;@SOURCE_CHECK_PLAYER
;;-------------------------------------------------
;;쾌Ｃのソース
;;-------------------------------------------------
;;Ｃ민감とＣ둔감はここで処理
;SIF TALENT:PLAYER:101
;	TIMES SOURCE:PLAYER:0 , 0.50
;SIF TALENT:PLAYER:102
;	TIMES SOURCE:PLAYER:0 , 2.00
;
;;C감각
;SIF ABL:PLAYER:3 == 0
;	TIMES SOURCE:PLAYER:0 , 0.50
;SIF ABL:PLAYER:3 == 1
;	TIMES SOURCE:PLAYER:0 , 1.80
;SIF ABL:PLAYER:3 == 2
;	TIMES SOURCE:PLAYER:0 , 3.00
;SIF ABL:PLAYER:3 == 3
;	TIMES SOURCE:PLAYER:0 , 5.00
;SIF ABL:PLAYER:3 == 4
;	TIMES SOURCE:PLAYER:0 , 7.00
;SIF ABL:PLAYER:3 == 5
;	TIMES SOURCE:PLAYER:0 , 9.00
;SIF ABL:PLAYER:3 == 6
;	TIMES SOURCE:PLAYER:0 , 11.00
;SIF ABL:PLAYER:3 == 7
;	TIMES SOURCE:PLAYER:0 , 13.00
;SIF ABL:PLAYER:3 == 8
;	TIMES SOURCE:PLAYER:0 , 15.00
;SIF ABL:PLAYER:3 == 9
;	TIMES SOURCE:PLAYER:0 , 17.00
;SIF ABL:PLAYER:3 >= 10
;	TIMES SOURCE:PLAYER:0 , 20.00
;
;
;UP:0 += SOURCE:PLAYER:0
;
;;-------------------------------------------------
;;쾌Ｖのソース
;;-------------------------------------------------
;;Ｖ민감とＶ둔감はここで処理
;SIF TALENT:PLAYER:103
;	TIMES SOURCE:PLAYER:1 , 0.50
;SIF TALENT:PLAYER:104
;	TIMES SOURCE:PLAYER:1 , 2.00
;
;;V감각
;SIF ABL:PLAYER:4 == 0
;	TIMES SOURCE:PLAYER:1 , 0.50
;SIF ABL:PLAYER:4 == 1
;	TIMES SOURCE:PLAYER:1 , 1.80
;SIF ABL:PLAYER:4 == 2
;	TIMES SOURCE:PLAYER:1 , 3.00
;SIF ABL:PLAYER:4 == 3
;	TIMES SOURCE:PLAYER:1 , 5.00
;SIF ABL:PLAYER:4 == 4
;	TIMES SOURCE:PLAYER:1 , 7.00
;SIF ABL:PLAYER:4 == 5
;	TIMES SOURCE:PLAYER:1 , 9.00
;SIF ABL:PLAYER:4 == 6
;	TIMES SOURCE:PLAYER:1 , 11.00
;SIF ABL:PLAYER:4 == 7
;	TIMES SOURCE:PLAYER:1 , 13.00
;SIF ABL:PLAYER:4 == 8
;	TIMES SOURCE:PLAYER:1 , 15.00
;SIF ABL:PLAYER:4 == 9
;	TIMES SOURCE:PLAYER:1 , 17.00
;SIF ABL:PLAYER:4 >= 10
;	TIMES SOURCE:PLAYER:1 , 20.00
;
;;EXP:Ｖ경험をみる
;IF EXP:0 < EXPLV:1
;	TIMES SOURCE:PLAYER:1 , 0.20
;ELSEIF EXP:0 < EXPLV:2
;	TIMES SOURCE:PLAYER:1 , 0.60
;ELSEIF EXP:0 < EXPLV:3
;	TIMES SOURCE:PLAYER:1 , 1.00
;ELSEIF EXP:0 < EXPLV:4
;	TIMES SOURCE:PLAYER:1 , 1.20
;ELSEIF EXP:0 < EXPLV:5
;	TIMES SOURCE:PLAYER:1 , 1.40
;ELSEIF EXP:0 >= EXPLV:5
;	TIMES SOURCE:PLAYER:1 , 1.60
;ENDIF
;
;
;
;;소인체형
;IF TALENT:PLAYER:149
;	TIMES SOURCE:PLAYER:1 , 1.20
;ENDIF
;
;UP:1 += SOURCE:PLAYER:1
;
;;-------------------------------------------------
;;쾌Ａのソース
;;-------------------------------------------------
;;Ａ민감とＡ둔감はここで処理
;SIF TALENT:PLAYER:105
;	TIMES SOURCE:PLAYER:2 , 0.50
;SIF TALENT:PLAYER:106
;	TIMES SOURCE:PLAYER:2 , 2.00
;
;;오토코노코
;SIF TALENT:PLAYER:오토코노코
;	TIMES SOURCE:PLAYER:2 , 1.50
;
;;A감각
;SIF ABL:PLAYER:5 == 0
;	TIMES SOURCE:PLAYER:2 , 0.50
;SIF ABL:PLAYER:5 == 1
;	TIMES SOURCE:PLAYER:2 , 1.80
;SIF ABL:PLAYER:5 == 2
;	TIMES SOURCE:PLAYER:2 , 3.00
;SIF ABL:PLAYER:5 == 3
;	TIMES SOURCE:PLAYER:2 , 5.00
;SIF ABL:PLAYER:5 == 4
;	TIMES SOURCE:PLAYER:2 , 7.00
;SIF ABL:PLAYER:5 == 5
;	TIMES SOURCE:PLAYER:2 , 9.00
;SIF ABL:PLAYER:5 == 6
;	TIMES SOURCE:PLAYER:2 , 11.00
;SIF ABL:PLAYER:5 == 7
;	TIMES SOURCE:PLAYER:2 , 13.00
;SIF ABL:PLAYER:5 == 8
;	TIMES SOURCE:PLAYER:2 , 15.00
;SIF ABL:PLAYER:5 == 9
;	TIMES SOURCE:PLAYER:2 , 17.00
;SIF ABL:PLAYER:5 >= 10
;	TIMES SOURCE:PLAYER:2 , 20.00
;
;;PALAM:욕정をみる
;;쾌ＡはあまりPALAM:욕정では差が出ない
;IF PALAM:6 < PALAMLV:1
;	TIMES A , 0.80
;ELSEIF PALAM:6 < PALAMLV:2
;	TIMES A , 1.00
;ELSEIF PALAM:6 < PALAMLV:3
;	TIMES A , 1.20
;ELSEIF PALAM:6 < PALAMLV:4
;	TIMES A , 1.40
;ELSEIF PALAM:6 >= PALAMLV:4
;	TIMES A , 1.60
;ENDIF
;
;
;;EXP:Ａ경험をみる
;IF EXP:1 < EXPLV:1
;	TIMES SOURCE:PLAYER:2 , 0.10
;ELSEIF EXP:1 < EXPLV:2
;	TIMES SOURCE:PLAYER:2 , 0.30
;ELSEIF EXP:1 < EXPLV:3
;	TIMES SOURCE:PLAYER:2 , 0.50
;ELSEIF EXP:1 < EXPLV:4
;	TIMES SOURCE:PLAYER:2 , 1.00
;ELSEIF EXP:1 < EXPLV:5
;	TIMES SOURCE:PLAYER:2 , 1.40
;ELSEIF EXP:1 >= EXPLV:5
;	TIMES SOURCE:PLAYER:2 , 1.60
;ENDIF
;
;
;;소인체형
;IF TALENT:PLAYER:149
;	TIMES SOURCE:PLAYER:2 , 1.50
;ENDIF
;
;
;UP:2 += SOURCE:PLAYER:2
;
;;-------------------------------------------------
;;쾌Ｂのソース
;;-------------------------------------------------
;;Ｂ민감とＢ둔감はここで処理
;SIF TALENT:PLAYER:107
;	TIMES SOURCE:PLAYER:3 , 0.50
;SIF TALENT:PLAYER:108
;	TIMES SOURCE:PLAYER:3 , 2.00
;
;;오토코노코
;SIF TALENT:PLAYER:오토코노코
;	TIMES SOURCE:PLAYER:3 , 1.50
;
;;B감각
;SIF ABL:PLAYER:6 == 0
;	TIMES SOURCE:PLAYER:3 , 0.50
;SIF ABL:PLAYER:6 == 1
;	TIMES SOURCE:PLAYER:3 , 1.80
;SIF ABL:PLAYER:6 == 2
;	TIMES SOURCE:PLAYER:3 , 3.00
;SIF ABL:PLAYER:6 == 3
;	TIMES SOURCE:PLAYER:3 , 5.00
;SIF ABL:PLAYER:6 == 4
;	TIMES SOURCE:PLAYER:3 , 7.00
;SIF ABL:PLAYER:6 == 5
;	TIMES SOURCE:PLAYER:3 , 9.00
;SIF ABL:PLAYER:6 == 6
;	TIMES SOURCE:PLAYER:3 , 11.00
;SIF ABL:PLAYER:6 == 7
;	TIMES SOURCE:PLAYER:3 , 13.00
;SIF ABL:PLAYER:6 == 8
;	TIMES SOURCE:PLAYER:3 , 15.00
;SIF ABL:PLAYER:6 == 9
;	TIMES SOURCE:PLAYER:3 , 17.00
;SIF ABL:PLAYER:6 >= 10
;	TIMES SOURCE:PLAYER:3 , 20.00
;
;UP:3 += SOURCE:PLAYER:3
;
;;-------------------------------------------------
;;소질などによる上下の処理（쾌락系）
;;-------------------------------------------------
;;미약
;IF TEQUIP:PLAYER:26
;	TIMES UP:0 , 2.00
;	TIMES UP:1 , 2.00
;	TIMES UP:2 , 2.00
;	TIMES UP:3 , 2.00
;ENDIF
;
;;-------------------------------------------------
;;함락소질
;;-------------------------------------------------
;;음란
;IF TALENT:PLAYER:4
;	TIMES UP:0 , 1.20
;	TIMES UP:1 , 1.20
;	TIMES UP:2 , 1.20
;	TIMES UP:3 , 1.20
;ENDIF
;
;;창부
;IF TALENT:PLAYER:7
;	TIMES UP:0 , 1.50
;	TIMES UP:1 , 1.50
;	TIMES UP:2 , 1.50
;	TIMES UP:3 , 1.50
;ENDIF
;
;;-------------------------------------------------
;;소질
;;-------------------------------------------------
;;자제심
;IF TALENT:PLAYER:20
;	TIMES UP:0 , 0.70
;	TIMES UP:1 , 0.90
;	TIMES UP:2 , 1.00
;	TIMES UP:3 , 0.70
;ENDIF
;
;;즉각함락
;IF TALENT:PLAYER:73
;	TIMES UP:0 , 2.00
;	TIMES UP:1 , 2.00
;	TIMES UP:2 , 2.00
;	TIMES UP:3 , 2.00
;ENDIF
;;자위광
;SIF TALENT:PLAYER:74
;	TIMES UP:0 , 1.20
;;섹스광
;SIF TALENT:PLAYER:75
;	TIMES UP:1 , 1.20
;;애널광
;SIF TALENT:PLAYER:76
;	TIMES UP:2 , 1.20
;;음유
;SIF TALENT:PLAYER:77
;	TIMES UP:3 , 1.20
;
;;남자
;IF IS_MALE(PLAYER)
;	TIMES UP:2 , 1.30
;ENDIF
;
;;-------------------------------------------------
;;난이도による上下の処理（쾌락系）
;;-------------------------------------------------
;;EASY
;IF FLAG:4 == 1
;	TIMES UP:0 , 1.60
;	TIMES UP:1 , 1.60
;	TIMES UP:2 , 1.60
;	TIMES UP:3 , 1.60
;;NORMAL
;ELSEIF FLAG:4 == 2
;	TIMES UP:0 , 1.20
;	TIMES UP:1 , 1.20
;	TIMES UP:2 , 1.20
;	TIMES UP:3 , 1.20
;;HARD
;ELSEIF FLAG:4 == 3
;	TIMES UP:0 , 0.80
;	TIMES UP:1 , 0.80
;	TIMES UP:2 , 0.80
;	TIMES UP:3 , 0.80
;ENDIF
;
;CALL ORGASM_ADD_PLAYER
;CALL UPCHECK_PLAYER
;CALL PLAYER_MILK_CHECK

;;-------------------------------------------------
;;조교대상の분유체크
;;-------------------------------------------------
;@PLAYER_MILK_CHECK
;SIF TALENT:PLAYER:149 == 0
;	RETURN 0
;
;A = UP:0 / 5 + UP:1 / 5 + UP:2 / 5 + UP:3 * 3
;
;;자제심
;SIF TALENT:PLAYER:20
;	A /= 2
;
;;쾌감에솔직
;SIF TALENT:PLAYER:70
;	TIMES A , 1.20
;
;;쾌감을부정（음란、창부で무효）
;SIF TALENT:PLAYER:71 && (TALENT:PLAYER:4 == 0 && TALENT:PLAYER:7 == 0)
;	TIMES A , 0.80
;
;;B민감
;SIF TALENT:PLAYER:107
;	TIMES A , 1.20
;
;;미약
;SIF TEQUIP:PLAYER:26
;	A *= 2
;
;;이뇨제
;SIF TEQUIP:PLAYER:27
;	A /= 2
;
;;조교자が유아퇴행
;SIF TALENT:TARGET:150
;	TIMES A , 1.20
;
;;조교자が유치
;SIF TALENT:TARGET:151
;	TIMES A , 1.20
;
;;빈유
;SIF TALENT:PLAYER:109
;	TIMES A , 0.50
;
;;분유중독の레벨を見る
;IF ABL:PLAYER:19 == 0
;	TIMES A , 1.00
;ELSEIF ABL:PLAYER:19 == 1
;	TIMES A , 1.05
;ELSEIF ABL:PLAYER:19 == 2
;	TIMES A , 1.10
;ELSEIF ABL:PLAYER:19 == 3
;	TIMES A , 1.20
;ELSEIF ABL:PLAYER:19 == 4
;	TIMES A , 1.30
;ELSE
;	TIMES A , 1.50
;ENDIF
;
;A = 500 + A / 2
;BASE:PLAYER:3 += A
;
;S = BASE:PLAYER:3
;EJAC = MAXBASE:PLAYER:3
;
;IF  S > EJAC * 2
;	E = 2
;ELSEIF S > EJAC
;	E = 1
;ELSE
;	E = 0
;ENDIF
;
;;大量분유
;IF E == 2
;
;	PRINTFORML %NAME:PLAYER%は유두から大量の모유を噴出した
;	PRINTL 분유경험＋２
;	IF EXP:PLAYER:54 == 0
;		EXP:PLAYER:50 += 1
;		PRINTL 이상경험＋1
;	ENDIF
;	EXP:PLAYER:54 += 2
;	;Ｂに모유불결
;	STAIN:PLAYER:5 |= 16
;
;	BASE:PLAYER:3 -= EJAC*2
;	SIF BASE:PLAYER:3 >= EJAC
;		BASE:PLAYER:3 = EJAC-1
;
;	IF ASSIPLAY
;		;조교대상이분유フラグ
;		TFLAG:조수가분유 += 2
;		;착유기で모유が集められているか체크
;		SIF TEQUIP:PLAYER:17
;			TFLAG:조수가착유중 += 2
;	ELSE
;		;조교대상이분유フラグ
;		TFLAG:주인이분유 += 2
;		;착유기で모유が集められているか체크
;		SIF TEQUIP:PLAYER:17
;			TFLAG:주인이착유중 += 2
;	ENDIF
;
;	NOWEX:PLAYER:4 += 1
;	EX:PLAYER:4 += 1
;;통상の분유
;ELSEIF E == 1
;
;	PRINTFORML %NAME:PLAYER%は유두から모유を垂れ流した
;	PRINTL 분유경험＋１
;	IF EXP:PLAYER:54 == 0
;		EXP:PLAYER:50 += 1
;		PRINTL 이상경험＋1
;	ENDIF
;	EXP:PLAYER:54 += 1
;	;Ｂに모유불결
;	STAIN:PLAYER:5 |= 16
;
;	BASE:PLAYER:3 -= EJAC
;	SIF BASE:PLAYER:3 >= EJAC
;		BASE:PLAYER:3 = EJAC-1
;
;	IF ASSIPLAY
;		;조교대상이분유フラグ
;		TFLAG:조수가분유 += 1
;		;착유기で모유が集められているか체크
;		SIF TEQUIP:PLAYER:17
;			TFLAG:조수가착유중 += 1
;	ELSE
;		;조교대상이분유フラグ
;		TFLAG:주인이분유 += 1
;		;착유기で모유が集められているか체크
;		SIF TEQUIP:PLAYER:17
;			TFLAG:주인이착유중 += 1
;	ENDIF
;
;	NOWEX:PLAYER:4 += 1
;	EX:PLAYER:4 += 1
;ENDIF
;
;IF CFLAG:PLAYER:ＭＡＧ비피흡수 == 0 && E > 0
;	LOCAL = 2 * BASE:TARGET:LV * E * 20 * (5+MAX(ABL:TARGET:순종,ABL:TARGET:욕망,ABL:TARGET:기교))/5
;	CALL DRAIN_MAG,PLAYER,LOCAL,TARGET
;ENDIF
;
;;-------------------------------------------------
;;조교자の절정処理
;;-------------------------------------------------
;@ORGASM_ADD_PLAYER
;LOCAL:0 = 0
;LOCAL:1 = 0
;LOCAL:2 = 0
;LOCAL:3 = 0
;
;;절정Ｃ
;IF CUP:PLAYER:0 + PALAM:PLAYER:0 >= PALAMLV:4 * 2
;	LOCAL:0 = 2
;	DOWN:0 = (PALAMLV:4 * 2 - 1000)
;	PRINTL 強절정Ｃ(조교자)
;ELSEIF UP:0 + PALAM:PLAYER:0 >= PALAMLV:4
;	LOCAL:0 = 1
;	DOWN:0 = (PALAMLV:4 - 1000)
;	PRINTL 절정Ｃ(조교자)
;ENDIF
;;DOWN:0で下げても절정이상なら
;;その値-1になるように調整（10000で절정なら9999）
;SIF UP:0 + PALAM:PLAYER:0 - DOWN:0 >= PALAMLV:4
;	DOWN:0 = UP:0 + PALAM:PLAYER:0 - PALAMLV:4 + 1
;
;;절정Ｖ
;IF UP:1 + PALAM:PLAYER:1 >= PALAMLV:4 * 2
;	LOCAL:1 = 2
;	DOWN:1 = (PALAMLV:4 * 2 - 1000)
;	PRINTL 強절정Ｖ(조교자)
;ELSEIF UP:1 + PALAM:PLAYER:1 >= PALAMLV:4
;	LOCAL:1 = 1
;	DOWN:1 = (PALAMLV:4 - 1000)
;	PRINTL 절정Ｖ(조교자)
;ENDIF
;;DOWN:1で下げても절정이상なら
;;その値-1になるように調整（10000で절정なら9999）
;SIF UP:1 + PALAM:PLAYER:1 - DOWN:1 >= PALAMLV:4
;	DOWN:1 = UP:1 + PALAM:PLAYER:1 - PALAMLV:4 + 1
;
;
;;절정Ａ
;IF UP:2 + PALAM:PLAYER:2 >= PALAMLV:4 * 2
;	LOCAL:2 = 2
;	DOWN:2 = (PALAMLV:4 * 2 - 1000)
;	PRINTL 強절정Ａ(조교자)
;ELSEIF UP:2 + PALAM:PLAYER:2 >= PALAMLV:4
;	LOCAL:2 = 1
;	DOWN:2 = (PALAMLV:4 - 1000)
;	PRINTL 절정Ａ(조교자)
;ENDIF
;;DOWN:2で下げても절정이상なら
;;その値-1になるように調整（10000で절정なら9999）
;SIF UP:2 + PALAM:PLAYER:2 - DOWN:2 >= PALAMLV:4
;	DOWN:2 = UP:2 + PALAM:PLAYER:2 - PALAMLV:4 + 1
;
;;절정Ｂ
;IF UP:3 + PALAM:PLAYER:3 >= PALAMLV:4 * 2
;	LOCAL:3 = 2
;	DOWN:3 = (PALAMLV:4 * 2 - 1000)
;	PRINTL 強절정Ｂ(조교자)
;ELSEIF UP:3 + PALAM:PLAYER:3 >= PALAMLV:4
;	LOCAL:3 = 1
;	DOWN:3 = (PALAMLV:4 - 1000)
;	PRINTL 절정Ｂ(조교자)
;ENDIF
;;DOWN:3で下げても절정이상なら
;;その値-1になるように調整（10000で절정なら9999）
;SIF UP:3 + PALAM:PLAYER:3 - DOWN:3 >= PALAMLV:4
;	DOWN:3 = UP:3 + PALAM:PLAYER:3 - PALAMLV:4 + 1
;
;;-------------------------------------------------
;;절정時の추가処理
;;-------------------------------------------------
;TFLAG:조교자절정강도 = LOCAL + LOCAL:1 + LOCAL:2 + LOCAL:3
;
;LOCAL:5 = 0
;
;IF LOCAL && LOCAL:1 && LOCAL:2 && LOCAL:3
;	PRINTL 四 重 絶 頂(조교자)
;	LOCAL *= 8
;	LOCAL:1 *= 8
;	LOCAL:2 *= 8
;	LOCAL:3 *= 8
;ELSEIF LOCAL && LOCAL:1 && LOCAL:2
;	PRINTL Ｃ＆Ｖ＆Ａ절정(조교자)
;	LOCAL *= 4
;	LOCAL:1 *= 4
;	LOCAL:2 *= 4
;ELSEIF LOCAL:3 && LOCAL:1 && LOCAL:2
;	PRINTL Ｂ＆Ｖ＆Ａ절정(조교자)
;	LOCAL:3 *= 4
;	LOCAL:1 *= 4
;	LOCAL:2 *= 4
;ELSEIF LOCAL && LOCAL:3 && LOCAL:2
;	PRINTL Ｃ＆Ｂ＆Ａ절정(조교자)
;	LOCAL *= 4
;	LOCAL:3 *= 4
;	LOCAL:2 *= 4
;ELSEIF LOCAL && LOCAL:1 && LOCAL:3
;	PRINTL Ｃ＆Ｖ＆Ｂ절정(조교자)
;	LOCAL *= 4
;	LOCAL:1 *= 4
;	LOCAL:3 *= 4
;ELSEIF LOCAL && LOCAL:1
;	PRINTL Ｃ＆Ｖ절정(조교자)
;	LOCAL *= 2
;	LOCAL:1 *= 2
;ELSEIF LOCAL && LOCAL:2
;	PRINTL Ｃ＆Ａ절정(조교자)
;	LOCAL *= 2
;	LOCAL:2 *= 2
;ELSEIF LOCAL:1 && LOCAL:2
;	PRINTL Ｖ＆Ａ절정(조교자)
;	LOCAL:1 *= 2
;	LOCAL:2 *= 2
;ELSEIF LOCAL && LOCAL:3
;	PRINTL Ｃ＆Ｂ절정(조교자)
;	LOCAL *= 2
;	LOCAL:3 *= 2
;ELSEIF LOCAL:1 && LOCAL:3
;	PRINTL Ｖ＆Ｂ절정(조교자)
;	LOCAL:1 *= 2
;	LOCAL:3 *= 2
;ELSEIF LOCAL:2 && LOCAL:3
;	PRINTL Ａ＆Ｂ절정(조교자)
;	LOCAL:2 *= 2
;	LOCAL:3 *= 2
;ENDIF
;LOCAL:5 = TFLAG:조교자절정강도
;
;SIF LOCAL
;	LOCAL:5 += 2
;
;IF LOCAL:5 > 0 && CFLAG:PLAYER:ＭＡＧ비피흡수 == 0
;	
;	LOCAL:5 *= MAXBASE:TARGET:LV * 20 * (5+MAX(ABL:TARGET:순종,ABL:TARGET:욕망,ABL:TARGET:기교))/5
;	CALL DRAIN_MAG,PLAYER,LOCAL:5,TARGET
;ENDIF
;
;IF LOCAL
;	SOURCE:PLAYER:13 += 500 * LOCAL
;	SOURCE:PLAYER:14 += 200 * LOCAL
;	SOURCE:PLAYER:18 += 150 * LOCAL
;ENDIF
;IF LOCAL:1
;	SOURCE:PLAYER:11 += 800 * LOCAL:1
;	SOURCE:PLAYER:12 += 500 * LOCAL:1
;	SOURCE:PLAYER:13 += 700 * LOCAL:1
;	SOURCE:PLAYER:14 += 400 * LOCAL:1
;	SOURCE:PLAYER:18 += 300 * LOCAL:1
;ENDIF
;IF LOCAL:2
;	SOURCE:PLAYER:11 += 500 * LOCAL:2
;	SOURCE:PLAYER:12 += 700 * LOCAL:2
;	SOURCE:PLAYER:13 += 900 * LOCAL:2
;	SOURCE:PLAYER:14 += 500 * LOCAL:2
;	SOURCE:PLAYER:18 += 400 * LOCAL:2
;ENDIF
;IF LOCAL:3
;	SOURCE:PLAYER:13 += 500 * LOCAL:3
;	SOURCE:PLAYER:14 += 200 * LOCAL:3
;	SOURCE:PLAYER:18 += 150 * LOCAL:3
;ENDIF
;
;;NOWEXに데이터を入れる（절정時구상に使う）
;NOWEX:PLAYER:0 = LOCAL
;NOWEX:PLAYER:1 = LOCAL:1
;NOWEX:PLAYER:2 = LOCAL:2
;NOWEX:PLAYER:3 = LOCAL:3
;
;;절정횟수を増やす
;EX:PLAYER:0 += LOCAL
;EX:PLAYER:1 += LOCAL:1
;EX:PLAYER:2 += LOCAL:2
;EX:PLAYER:3 += LOCAL:3
;
;;절정경험を増やす
;EXP:PLAYER:2 += LOCAL+LOCAL:1+LOCAL:2+LOCAL:3
;
;RETURN 1

;---------------------------------------------------------
;절정するかの체크
;---------------------------------------------------------
@EX_CHECK
;汎用的な関数なので、将来的にはすべての조교コマンドの사정체크をここでやることも가능
S = BASE:PLAYER:99
EJAC = MAXBASE:PLAYER:99

;사정限界が来ている場合は、사정ゲージは強制的に0にする
IF CFLAG:PLAYER:11 == 0
	S = 0
	BASE:PLAYER:99 = 0
ENDIF

IF  S > EJAC * 99
	E = 2
ELSEIF S > EJAC
	E = 1
ELSE
	E = 0
ENDIF

@EX_CHECK_M
;조교자と대상が異なる場合（主人）
S = BASE:MASTER:99
EJAC = MAXBASE:MASTER:99

;사정限界が来ている場合は、사정ゲージは強制的に0にする
IF CFLAG:MASTER:11 == 0
	S = 0
	BASE:MASTER:2 = 0
ENDIF

;사정フラグはここで초기化

IF  S > EJAC * 2
	E = 2
ELSEIF S > EJAC
	E = 1
ELSE
	E = 0
ENDIF

@EX_CHECK_A
;조교자と대상が異なる場合（조수）
S = BASE:ASSI:99
EJAC = MAXBASE:ASSI:99

;사정限界が来ている場合は、사정ゲージは強制的に0にする
IF CFLAG:ASSI:11 == 0
	S = 0
	BASE:ASSI:2 = 0
ENDIF

IF  S > EJAC * 2
	E = 2
ELSEIF S > EJAC
	E = 1
ELSE
	E = 0
ENDIF

@EX_PLAYER,ARG,ARG:1
;ARGイった人
;ARG:1イかせた人

IF E == 2
	EXP:ARG:절정경험 += 2

	SIF TFLAG:998 & 1
	PRINTL Ｃ강절정(조교자)
	SIF TFLAG:998 & 2
	PRINTL Ｖ강절정(조교자)
	SIF TFLAG:998 & 4
	PRINTL Ａ강절정(조교자)
	SIF TFLAG:998 & 8
	PRINTL Ｂ강절정(조교자)
	SIF TALENT:ARG:149 && TFLAG:998 & 8
	PRINTL 대량 분유(조교자)
	BASE:ARG:99 -= EJAC*2
	SIF BASE:ARG:99 >= EJAC
		BASE:ARG:99 = EJAC-1
	SIF TFLAG:998 & 1
		EX:ARG:0 += 2
	SIF TFLAG:998 & 2
		EX:ARG:1 += 2
	SIF TFLAG:998 & 4
		EX:ARG:2 += 2
	SIF TFLAG:998 & 8
		EX:ARG:3 += 2
	SIF TALENT:ARG:149 && TFLAG:998 & 8
		EXP:ARG:54 += 2
	
	
	IF CFLAG:ARG:ＭＡＧ비피흡수 == 0
		LOCAL = 2 * MAXBASE:(ARG:1):LV * 20 *  (5+MAX(ABL:(ARG:1):순종,ABL:(ARG:1):욕망,ABL:(ARG:1):기교))/5
		CALL DRAIN_MAG,ARG,LOCAL,ARG:1
	ENDIF

;통상の사정
ELSEIF E == 1
	EXP:ARG:절정경험 += 1

	SIF TFLAG:998 & 1
	PRINTL Ｃ절정(조교자)
	SIF TFLAG:998 & 2
	PRINTL Ｖ절정(조교자)
	SIF TFLAG:998 & 4
	PRINTL Ａ절정(조교자)
	SIF TFLAG:998 & 8
	PRINTL Ｂ절정(조교자)
	SIF TALENT:ARG:149 && TFLAG:998 & 8
	PRINTL 분유(조교자)
	BASE:ARG:99 -= EJAC
	SIF BASE:ARG:99 >= EJAC
		BASE:ARG:99 = EJAC-1
	
	SIF TFLAG:998 & 1
		EX:ARG:0 += 1
	SIF TFLAG:998 & 2
		EX:ARG:1 += 1
	SIF TFLAG:998 & 4
		EX:ARG:2 += 1
	SIF TFLAG:998 & 8
		EX:ARG:3 += 1
	SIF TALENT:ARG:149 && TFLAG:998 & 8
		EXP:ARG:54 += 1
	IF CFLAG:ARG:ＭＡＧ비피흡수 == 0
		LOCAL = 2 * MAXBASE:(ARG:1):LV * 20 * (5+MAX(ABL:(ARG:1):순종,ABL:(ARG:1):욕망,ABL:(ARG:1):기교))/5
		CALL DRAIN_MAG,ARG,LOCAL,ARG:1
	ENDIF
ENDIF

;사정後は再装填の時間を設ける
IF SELECTCOM == 124 || SELECTCOM == 125
	SIF E == 1
		CFLAG:MASTER:9 = 3
	SIF E == 2
		CFLAG:MASTER:9 = 5
	CFLAG:MASTER:11 -= 1
ELSE
	SIF E == 1
		CFLAG:PLAYER:9 = 3
	SIF E == 2
		CFLAG:PLAYER:9 = 5
	CFLAG:PLAYER:11 -= 1
ENDIF

;無限사정薬が有効なら再装填時間を0に
SIF CFLAG:MASTER:무한사정약플래그 > 0
	CFLAG:MASTER:9 = 0
SIF CFLAG:PLAYER:무한사정약플래그 > 0
	CFLAG:PLAYER:9 = 0

