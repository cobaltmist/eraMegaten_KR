;==============================
;콘서트 캐릭목록 표시 함수
;==============================
@SHOW_CONCERT_CHARA_LIST
#DIM LCOUNT
LOCAL:3 = 0
FOR LCOUNT, 0, リスト표시数()
	文字色변경 = 0
	LOCAL = Q:(LCOUNT + P * リスト표시数())
	SIF LOCAL < 0 || CFLAG:LOCAL:この場に居ないフラグ == 1
		CONTINUE
	IF FLAG:SHOP커맨드 == 1201
		CALL STRFLAG_NUM_CPD(LOCAL,"DIFF")
	ENDIF
	
	CALL ARRANGE_SETCOLOR, LOCAL
	CALL ARRANGE_TARGETSIGN, LOCAL
	
	SELECTCASE FLAG:SHOP커맨드
	CASE 107
		CALL ARRANGE_NAMECALLS, LOCAL
		CONTINUE
	CASE 40032
		CALL LISTVIEW_LVUP_AUTOIF2 , LOCAL
		CONTINUE
	ENDSELECT

	CALL ARRANGE_CHARALIST, LOCAL
	
	IF FLAG:커스텀게임화면
		PRINTFORM 체력({BASE:LOCAL:0, 5}/{MAXBASE:LOCAL:0, 5}) 
	ELSE
		PRINTFORM 체력({BASE:LOCAL:0, 4}/{MAXBASE:LOCAL:0, 4})  
	ENDIF
	PRINT 기타：
	SETCOLOR 0x00ff40
	PRINTFORM {CFLAG:LOCAL:기타숙련도,4} 
	RESETCOLOR
	PRINT 베이스：
	SETCOLOR 0x00ff40
	PRINTFORM {CFLAG:LOCAL:베이스숙련도,4} 
	RESETCOLOR
	PRINT 드럼：
	SETCOLOR 0x00ff40
	PRINTFORM {CFLAG:LOCAL:드럼숙련도,4} 
	RESETCOLOR
	IF ABL:LOCAL:가창기능 > 9
		PRINT 가창：Lv
		SETCOLOR 0x00ff40
		PRINTFORM {ABL:LOCAL:가창기능,1} 
		RESETCOLOR
	ELSE
		PRINT 가창：Lv 
		SETCOLOR 0x00ff40
		PRINTFORM {ABL:LOCAL:가창기능,1} 
		RESETCOLOR
	ENDIF
	PRINT 그림：
	SETCOLOR 0x00ff40
	PRINTFORM {CFLAG:LOCAL:그림그리기숙련도,4} 
	RESETCOLOR
	;야시오 루이일 경우 바이올린이다
	IF NO:LOCAL == 7929
		PRINT 바이올린：
	ELSE
		PRINT 키보드：
	ENDIF
	SETCOLOR 0x00ff40
	PRINTFORM {CFLAG:LOCAL:키보드숙련도,4} 
	RESETCOLOR
	PRINT 연주동조율：
	SETCOLOR 0x00ff40
	PRINTFORM {CFLAG:LOCAL:연주동조율,4} 
	RESETCOLOR
	
	CALL ARRANGE_FALLTALENT, LOCAL
	CALL ARRANGE_SEX, LOCAL
	PRINTL
NEXT
RESETCOLOR


;==============================
;콘서트 캐릭목록 표시 내부기능 함수
;==============================
@INPUT_CONCERT_CHARA_LIST(ARGS, ARGS:1 = "", ARGS:2 = "", ARGS:3 = "", ARGS:4 = "", ARGS:5 = "돌아간다")
#DIM LINE, 2
#DIM LLOCK
#DIM LREDRAW
#DIM LCOUNT
#LOCALSSIZE 1

IF !LLOCK
	LREDRAW = CURRENTREDRAW()
	REDRAW 2
	LLOCK = 1
ENDIF

LINE = LINECOUNT
;표시させるキャラを抽出（Q:*に표시するキャラの登録番号、Aに人数)
VARSET Q, -1
SIF LOCALS != ARGS:1
	P = 0
LOCALS = %ARGS:1%
A = 0
FOR LCOUNT, 0, CHARANUM
	TRYCCALLFORM %ARGS:1%(LCOUNT)
	CATCH
		RESULT = 1
	ENDCATCH
	SIF RESULT == 0
		CONTINUE
	Q:A = LCOUNT
	A   += 1
NEXT
P = LIMIT(P, 0, (A - 1) / リスト표시数())
IF (FLAG:표시情報ページ保存 % 10)
	;最後に見ていた표시情報を保存していた
	O = (FLAG:표시情報ページ保存) / 100 -1
ELSE
	O = 0
ENDIF

$PRINT_LIST
CLEARLINE LINECOUNT - LINE
DRAWLINE
TRYCCALLFORM %ARGS:2%
CATCH
	PRINTFORM %ARGS%　
	SIF A > リスト표시数()
		PRINTFORM ＜page.{P + 1}/{A / リスト표시数() + 1}＞
	PRINTL
ENDCATCH
DRAWLINE
LINE:1 = LINECOUNT - LINE:0
CALL SHOW_CONCERT_CHARA_LIST
PRINTFORM \@ P && P == (A - 1) / リスト표시数() ? %"\n" * (リスト표시数() + LINE:1 + LINE:0 - LINECOUNT)% # \@
DRAWLINE
PRINTFORMLC \@ A > リスト표시数() ?[1007]이전 페이지# [----] \@
PRINTFORMLC \@ ARGS:5 != "キャンセル不可" ? [1000]%ARGS:5% # [----] \@
PRINTFORMLC \@ A > リスト표시数() ?[1008]다음 페이지# [----] \@
;PRINTLC [1009]표시 정보 전환
TRYCALLFORM %ARGS:4%(-1)

TRYCALLFORM %ARGS:3%

$INPUT_LOOP_1
INPUT
TRYCCALLFORM %ARGS:4%(RESULT)
	IF !RESULT:1
		LLOCK = 0
		REDRAW LREDRAW
		RETURN RESULT
	ENDIF
	SIF RESULT:1 == -1
		RESTART
CATCH
ENDCATCH
SELECTCASE RESULT
	CASE 1000
		IF ARGS:5 != "キャンセル不可"
			LLOCK = 0
			REDRAW LREDRAW
			RETURN RESULT
		ENDIF
		CLEARLINE 1
		GOTO INPUT_LOOP_1
	CASE 1007
		P = P <= 0 ? (A - 1) / リスト표시数() # P - 1
	CASE 1008
		P = P >= (A - 1) / リスト표시数() ? 0 # P + 1
	;CASE 1009
	;	O += 1
	;	SIF (FLAG:표시情報ページ保存 % 10)
	;		FLAG:표시情報ページ保存 = ((O + 1) * 100 + 1)
	;合体用ソフトクイック설정の為
	CASE 1500 TO 1600
		LLOCK = 0
		REDRAW LREDRAW
		RETURN RESULT
	CASEELSE
		SIF RESULT < 0 || RESULT >= CHARANUM || MATCH(Q,RESULT,0) == 0
			GOTO INPUT_LOOP_1
		LLOCK = 0
		REDRAW LREDRAW
		RETURN RESULT
ENDSELECT
GOTO PRINT_LIST
