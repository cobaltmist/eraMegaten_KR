;_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/#
;
;	Module		:COMF160-169_触手系.ERB
;
;	Modification Data:
;
;	Edit	Date			Author					Reason
;	001		XXXX/XX/XX		------					新規作成
;	002		2020/09/06		MkjX					触手系コマンドを修正
;	003		2020/10/19		JK好き					掲示板に書いてあった通りに修正
;	004		2021/09/07		JK好き					TFLAG:48の重複に対処　BASEの参照が間違って射精ではなく뇨의を見ていた問題を修正
;	005		2022/06/27		JK好き					촉수가사정しなくなっていた問題を修正
;													触手で妊娠しなくなっていた問題を修正
;													TEQUIP:縄を見るべきところをTEQUIP:アイマスクを見ていた問題を修正
;_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/#
;-------------------------------------------------
;触手召喚および派生コマンド
;触手系コマンド
;-------------------------------------------------

;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME160
IF TEQUIP:触手
	RESULTS = 触手送還
ELSE
	RESULTS = 触手召喚
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----
@ACT_COM160
;---- EDIT 002 触手系コマンドを修正 MOD START ----
IF TEQUIP:触手
	PRINTL 触手送還
ELSE
	PRINTL 触手召喚
ENDIF
;---- EDIT 002 触手系コマンドを修正 MOD END   ----
TSTR:0 = 触手召喚
;CALL KOJO_MESSAGE_COM

;着脱の処理
IF TEQUIP:触手 == 0
	TEQUIP:触手 = 1
	;触手系コマンドに影響する装備は外す（道具が触手扱いになるため）
	TEQUIP:クリキャップ = 0
	TEQUIP:オナホール = 0
	TEQUIP:바이브 = 0
	TEQUIP:アナル바이브 = 0
	TEQUIP:ニプルキャップ = 0
	TEQUIP:搾乳機 = 0
	TEQUIP:縄 = 0
	TEQUIP:浣腸器＋プラグ = 0
	TEQUIP:緊縛種類 = 0
	TEQUIP:PLAYER:クリキャップ = 0
	TEQUIP:PLAYER:オナホール = 0
	TEQUIP:PLAYER:바이브 = 0
	TEQUIP:PLAYER:アナル바이브 = 0
	TEQUIP:PLAYER:ニプルキャップ = 0
	TEQUIP:PLAYER:搾乳機 = 0
;---- EDIT 002 触手系コマンドを修正 MOD START ----
	TEQUIP:触手危険度 = 0
;	SIF FLAG:47
;		TEQUIP:触手危険度 = LIMIT((FLAG:触手レベル - BASE:PLAYER:LV) * 10, 10, 80)
;---- EDIT 002 触手系コマンドを修正 MOD END   ----
;触手解除時はソース、経験の加算は行わず終了する
ELSE
;---- EDIT 002 触手系コマンドを修正 MOD START ----
	;TEQUIP:触手 = 0
	;触手系コマンドの装備も解除する
	TEQUIP:クリキャップ = 0
	TEQUIP:オナホール = 0
	TEQUIP:바이브 = 0
	TEQUIP:アナル바이브 = 0
	TEQUIP:ニプルキャップ = 0
	TEQUIP:搾乳機 = 0
	TEQUIP:縄 = 0
	;触手浣腸中ならまき散らす
	IF TEQUIP:浣腸器＋プラグ == 1
		;触手浣腸
		CALL COM146
	ENDIF
;	TEQUIP:浣腸器＋プラグ = 0
	TEQUIP:拡張バルーン = 0
	TEQUIP:触手口辱 = 0
	TEQUIP:PLAYER:クリキャップ = 0
	TEQUIP:PLAYER:オナホール = 0
	TEQUIP:PLAYER:바이브 = 0
	TEQUIP:PLAYER:アナル바이브 = 0
	TEQUIP:PLAYER:ニプルキャップ = 0
	TEQUIP:PLAYER:搾乳機 = 0
	;最後に触手解除
	TEQUIP:触手 = 0
	TSTR:0 = 触手送還
;---- EDIT 002 触手系コマンドを修正 MOD END   ----

	RETURN 1
ENDIF


;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
;消費体力、気力
DOWNBASE:TARGET:体力 += MAX(100, 200 - FLAG:触手レベル)
DOWNBASE:TARGET:気力 += MAX(150, 300 - FLAG:触手レベル)

SOURCE:TARGET:恐れ = MIN(3000, 2500 + FLAG:触手レベル)
SOURCE:TARGET:逸脱 = MIN(3000, 2500 + FLAG:触手レベル)
SOURCE:TARGET:反感 = MAX(2000, 2500 - FLAG:触手レベル)


;-------------------------------------------------
;特殊ソース処理
;-------------------------------------------------
;촉수경험は先に見ておく
IF EXP:촉수경험 < EXPLV:1
	TIMES DOWNBASE:TARGET:体力 , 1.20
	TIMES DOWNBASE:TARGET:気力 , 1.20
	TIMES SOURCE:TARGET:恐れ , 1.20
	TIMES SOURCE:TARGET:逸脱 , 1.20
	TIMES SOURCE:TARGET:反感 , 1.20
ELSEIF EXP:촉수경험 < EXPLV:2
	TIMES DOWNBASE:TARGET:体力 , 0.90
	TIMES DOWNBASE:TARGET:気力 , 0.90
	TIMES SOURCE:TARGET:恐れ , 0.90
	TIMES SOURCE:TARGET:逸脱 , 0.90
	TIMES SOURCE:TARGET:反感 , 0.90
ELSEIF EXP:촉수경험 < EXPLV:3
	TIMES DOWNBASE:TARGET:体力 , 0.80
	TIMES DOWNBASE:TARGET:気力 , 0.80
	TIMES SOURCE:TARGET:恐れ , 0.80
	TIMES SOURCE:TARGET:逸脱 , 0.80
	TIMES SOURCE:TARGET:反感 , 0.80
ELSEIF EXP:촉수경험 < EXPLV:4
	TIMES DOWNBASE:TARGET:体力 , 0.70
	TIMES DOWNBASE:TARGET:気力 , 0.70
	TIMES SOURCE:TARGET:恐れ , 0.70
	TIMES SOURCE:TARGET:逸脱 , 0.70
	TIMES SOURCE:TARGET:反感 , 0.70
ELSEIF EXP:촉수경험 < EXPLV:5
	TIMES DOWNBASE:TARGET:体力 , 0.60
	TIMES DOWNBASE:TARGET:気力 , 0.60
	TIMES SOURCE:TARGET:恐れ , 0.60
	TIMES SOURCE:TARGET:逸脱 , 0.60
	TIMES SOURCE:TARGET:反感 , 0.60
ELSE
	TIMES DOWNBASE:TARGET:体力 , 0.50
	TIMES DOWNBASE:TARGET:気力 , 0.50
	TIMES SOURCE:TARGET:恐れ , 0.50
	TIMES SOURCE:TARGET:逸脱 , 0.50
	TIMES SOURCE:TARGET:反感 , 0.50
ENDIF


;-------------------------------------------------
;経験の処理
;-------------------------------------------------
IF EXP:촉수경험 == 0
	CALL ADDS_ABNORMAL_EXP("触手初体験", TARGET)
ENDIF
CALL ADDS_EXP("촉수경험", 1, TARGET)

RETURN 1

;-------------------------------------------------
;装着継続の処理
;-------------------------------------------------
@EQUIP_COM160
;触手召喚中
PRINTL ＜触手召喚中＞

;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
;消費体力、気力
DOWNBASE:TARGET:体力 += MAX(50, 150 - FLAG:触手レベル)
DOWNBASE:TARGET:気力 += MAX(100, 200 - FLAG:触手レベル)

SOURCE:TARGET:恐れ += MIN(1500, 1000 + FLAG:触手レベル)
SOURCE:TARGET:逸脱 += MIN(1500, 1000 + FLAG:触手レベル)
SOURCE:TARGET:反感 += MAX(500, 1000 - FLAG:触手レベル)

;-------------------------------------------------
;射精チェック
;-------------------------------------------------
IF MAXBASE:MASTER:뇨의 != 0
	B = 1000
	;ABL:技巧をみる
	IF ABL:技巧 == 0
		TIMES B , 1.00
	ELSEIF ABL:技巧 == 1
		TIMES B , 1.10
	ELSEIF ABL:技巧 == 2
		TIMES B , 1.20
	ELSEIF ABL:技巧 == 3
		TIMES B , 1.30
	ELSEIF ABL:技巧 == 4
		TIMES B , 1.40
	ELSE
		TIMES B , 1.50
	ENDIF

	;ABL:従順をみる
	IF ABL:従順 == 0
		TIMES B , 0.80
	ELSEIF ABL:従順 == 1
		TIMES B , 0.90
	ELSEIF ABL:従順 == 2
		TIMES B , 1.00
	ELSEIF ABL:従順 == 3
		TIMES B , 1.10
	ELSEIF ABL:従順 == 4
		TIMES B , 1.20
	ELSE
		TIMES B , 1.30
	ENDIF

	;PALAM:欲情をみる
	IF PALAM:5 < PALAMLV:1
		TIMES B , 1.00
	ELSEIF PALAM:5 < PALAMLV:2
		TIMES B , 1.10
	ELSEIF PALAM:5 < PALAMLV:3
		TIMES B , 1.20
	ELSEIF PALAM:5 < PALAMLV:4
		TIMES B , 1.30
	ELSEIF PALAM:5 < PALAMLV:5
		TIMES B , 1.40
	ELSE
		TIMES B , 1.50
	ENDIF

	;触手挿入
	SIF TEQUIP:바이브
		TIMES B , 1.50
	;アナル触手
	SIF TEQUIP:アナル바이브
		TIMES B , 1.50
	;触手クリ責め
	SIF TEQUIP:クリキャップ
		TIMES B , 1.20
	;触手乳首責め
	SIF TEQUIP:ニプルキャップ
		TIMES B , 1.20
	;触手搾乳
	SIF TEQUIP:搾乳機
		TIMES B , 1.30
	;触手ペニス責め
	SIF TEQUIP:オナホール
		TIMES B , 1.10
	;触手緊縛
	SIF TEQUIP:縄
		TIMES B , 1.20
	;触手浣腸
	SIF TEQUIP:浣腸器＋プラグ
		TIMES B , 1.30
	;触手口辱
	SIF TEQUIP:触手口辱
		TIMES B , 1.50
;---- EDIT 002 触手系コマンドを修正 ADD START ----
	;アナル極太触手
	SIF TEQUIP:拡張バルーン
		TIMES B , 1.50
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

	BASE:MASTER:뇨의 += B
ENDIF
;-------------------------------------------------
;特殊ソース処理
;-------------------------------------------------
;촉수경험は先に見ておく
IF EXP:촉수경험 < EXPLV:1
	TIMES DOWNBASE:TARGET:体力 , 1.20
	TIMES DOWNBASE:TARGET:気力 , 1.20
;	TIMES SOURCE:TARGET:恐れ , 1.20
;	TIMES SOURCE:TARGET:逸脱 , 1.20
;	TIMES SOURCE:TARGET:反感 , 1.20
ELSEIF EXP:촉수경험 < EXPLV:2
	TIMES DOWNBASE:TARGET:体力 , 0.90
	TIMES DOWNBASE:TARGET:気力 , 0.90
;	TIMES SOURCE:TARGET:恐れ , 0.90
;	TIMES SOURCE:TARGET:逸脱 , 0.90
;	TIMES SOURCE:TARGET:反感 , 0.90
ELSEIF EXP:촉수경험 < EXPLV:3
	TIMES DOWNBASE:TARGET:体力 , 0.80
	TIMES DOWNBASE:TARGET:気力 , 0.80
;	TIMES SOURCE:TARGET:恐れ , 0.80
;	TIMES SOURCE:TARGET:逸脱 , 0.80
;	TIMES SOURCE:TARGET:反感 , 0.80
ELSEIF EXP:촉수경험 < EXPLV:4
	TIMES DOWNBASE:TARGET:体力 , 0.70
	TIMES DOWNBASE:TARGET:気力 , 0.70
;	TIMES SOURCE:TARGET:恐れ , 0.70
;	TIMES SOURCE:TARGET:逸脱 , 0.70
;	TIMES SOURCE:TARGET:反感 , 0.70
ELSEIF EXP:촉수경험 < EXPLV:5
	TIMES DOWNBASE:TARGET:体力 , 0.60
	TIMES DOWNBASE:TARGET:気力 , 0.60
;	TIMES SOURCE:TARGET:恐れ , 0.60
;	TIMES SOURCE:TARGET:逸脱 , 0.60
;	TIMES SOURCE:TARGET:反感 , 0.60
ELSE
	TIMES DOWNBASE:TARGET:体力 , 0.50
	TIMES DOWNBASE:TARGET:気力 , 0.50
;	TIMES SOURCE:TARGET:恐れ , 0.50
;	TIMES SOURCE:TARGET:逸脱 , 0.50
;	TIMES SOURCE:TARGET:反感 , 0.50
ENDIF


;-------------------------------------------------
;射精チェック
;-------------------------------------------------
EJAC = MAXBASE:MASTER:뇨의

IF  BASE:MASTER:뇨의 > EJAC * 2
	E = 2
ELSEIF BASE:MASTER:뇨의 > EJAC
	E = 1
ELSE
	E = 0
ENDIF

;射精時に中毒充足のソースを追加、なお触手は射精の再装填は無し
;通常射精時
IF E == 1
	A = 200
;大量射精時
ELSEIF E == 2
	A = 500
ENDIF

IF E > 0
	;정액중독を見る
	IF ABL:정액중독 == 1
		TIMES A , 0.00
	ELSEIF ABL:정액중독 == 2
		TIMES A , 0.30
	ELSEIF ABL:정액중독 == 3
		TIMES A , 0.60
	ELSEIF ABL:정액중독 == 4
		TIMES A , 0.90
	ELSEIF ABL:정액중독 == 5
		TIMES A , 1.20
	ELSEIF ABL:정액중독 == 6
		TIMES A , 1.50
	ELSEIF ABL:정액중독 == 7
		TIMES A , 1.80
	ELSEIF ABL:정액중독 == 8
		TIMES A , 2.30
	ELSEIF ABL:정액중독 == 9
		TIMES A , 3.00
	ELSEIF ABL:정액중독 >= 10
		TIMES A , 5.00
	ENDIF
ENDIF

SOURCE:TARGET:中毒充足 += A

;射精時の処理
;大量射精
IF E == 2
	PRINTL 촉수대량사정
	IF TEQUIP:바이브
		IF CFLAG:자궁내피임결계
			PRINTL <피임결계>
		ELSE
			PRINTL 촉수질내대량사정
			;究極射精と同じ量
			CALL ADDS_EXP("질사경험", 5, TARGET)
			CFLAG:촉수의질내사정에의한임신판정 += 10
			CFLAG:TARGET:자궁현재용량 += 20 + RAND:25
			TFLAG:촉수가사정 = 2
			IF FLAG:쌍둥이플래그 == 0
				CALL 자궁최대용량초기설정, TARGET
				;満タンにされた場合、拡張する
				IF CFLAG:TARGET:자궁현재용량 > CFLAG:TARGET:자궁최대용량
					IF CFLAG:TARGET:자궁최대용량 <= 5000
						CFLAG:TARGET:자궁최대용량 += CFLAG:TARGET:자궁현재용량 / 20 + 1
					ELSEIF CFLAG:TARGET:자궁최대용량 >= 20000
						CFLAG:TARGET:자궁최대용량 = 20000
					ELSE
						CFLAG:TARGET:자궁최대용량 += RAND:25
					ENDIF
				ENDIF
			ELSE
				CALL 자궁최대용량초기설정, TARGET
				;満タンにされた場合、拡張する
				IF CFLAG:TARGET:자궁현재용량 > CFLAG:TARGET:자궁최대용량
					;究極射精と同じ量
					LOCAL:2 = MIN(100, (LOCAL:2 / 4 * (TALENT:TARGET:임신하기쉬움 * 5 / 10 +1) * (EXP:TARGET:출산경험 / 10 + 1)))
					;おまじない
					SIF LOCAL:2 < 1
						LOCAL:2 = 1
					;5000mlまではいいペースで増える
					IF CFLAG:TARGET:자궁최대용량 <= 5000
						CFLAG:TARGET:자궁최대용량 += LOCAL:2 + 1
					;10000mlまでは速度半減
					ELSEIF CFLAG:TARGET:자궁최대용량 <= 10000
						CFLAG:TARGET:자궁최대용량 += LOCAL:2 / 2 + 1
					;20000までは速度3割
					ELSEIF CFLAG:TARGET:자궁최대용량 <= 20000
						CFLAG:TARGET:자궁최대용량 += LOCAL:2 / 3 + 1
					;それ以上は25%
					ELSE
						CFLAG:TARGET:자궁최대용량 += LOCAL:2 / 4 + 1
					ENDIF
					SIF CFLAG:TARGET:자궁최대용량 >= 50000
						CFLAG:TARGET:자궁최대용량 = 50000
				ENDIF
			ENDIF
			;子宮容量増加後でも抱えきれなければ現在容量は最大容量まで下がる。
			CFLAG:TARGET:자궁현재용량 = CFLAG:TARGET:자궁최대용량
		ENDIF
		CALL ADDS_EXP("정액경험", 5, TARGET)
	ENDIF
	IF TEQUIP:PLAYER:바이브
		IF CFLAG:PLAYER:자궁내피임결계
			IF PLAYER == MASTER
				PRINTL <피임결계>(주인)
			ELSEIF PLAYER == ASSI
				PRINTL <피임결계>(조수)
			ENDIF
		ELSE
			IF PLAYER == MASTER
				PRINTL 촉수질내대량사정(주인)
			ELSEIF PLAYER == ASSI
				PRINTL 촉수질내대량사정(조수)
			ENDIF
			;究極射精と同じ量
			CALL ADDS_EXP("질사경험", 5, PLAYER)
			CFLAG:PLAYER:촉수의질내사정에의한임신판정 += 10
			CFLAG:PLAYER:자궁현재용량 += 20 + RAND:25
			IF FLAG:쌍둥이플래그 == 0
				CALL 자궁최대용량초기설정, PLAYER
				;満タンにされた場合、拡張する
				IF CFLAG:PLAYER:자궁현재용량 > CFLAG:PLAYER:자궁최대용량
					IF CFLAG:PLAYER:자궁최대용량 <= 5000
						CFLAG:PLAYER:자궁최대용량 += CFLAG:PLAYER:자궁현재용량 / 20 + 1
					ELSEIF CFLAG:PLAYER:자궁최대용량 >= 20000
						CFLAG:PLAYER:자궁최대용량 = 20000
					ELSE
						CFLAG:PLAYER:자궁최대용량 += RAND:25
					ENDIF
				ENDIF
				;子宮容量増加後でも抱えきれなければ現在容量は最大容量まで下がる。
				CFLAG:PLAYER:자궁현재용량 = CFLAG:PLAYER:자궁최대용량
			ELSE
				CALL 자궁최대용량초기설정, PLAYER
				;満タンにされた場合、拡張する
				IF CFLAG:PLAYER:자궁현재용량 > CFLAG:PLAYER:자궁최대용량
					;究極射精と同じ量
					LOCAL:2 = MIN(100, (LOCAL:2 / 4 * (TALENT:PLAYER:임신하기쉬움 * 5 / 10 +1) * (EXP:PLAYER:출산경험 / 10 + 1)))
					;おまじない
					SIF LOCAL:2 < 1
						LOCAL:2 = 1
					;5000mlまではいいペースで増える
					IF CFLAG:PLAYER:자궁최대용량 <= 5000
						CFLAG:PLAYER:자궁최대용량 += LOCAL:2 + 1
					;10000mlまでは速度半減
					ELSEIF CFLAG:PLAYER:자궁최대용량 <= 10000
						CFLAG:PLAYER:자궁최대용량 += LOCAL:2 / 2 + 1
					;20000までは速度3割
					ELSEIF CFLAG:PLAYER:자궁최대용량 <= 20000
						CFLAG:PLAYER:자궁최대용량 += LOCAL:2 / 3 + 1
					;それ以上は25%
					ELSE
						CFLAG:PLAYER:자궁최대용량 += LOCAL:2 / 4 + 1
					ENDIF

					SIF CFLAG:PLAYER:자궁최대용량 >= 50000
						CFLAG:PLAYER:자궁최대용량 = 50000
				ENDIF
			ENDIF
		ENDIF
		CALL ADDS_EXP("정액경험", 5, PLAYER)
	ENDIF
	BASE:MASTER:뇨의 -= EJAC*2
	SIF BASE:MASTER:뇨의 >= EJAC
		BASE:MASTER:뇨의 = EJAC-1
;通常の射精
ELSEIF E == 1
	PRINTL 触手射精
	IF TEQUIP:바이브
		IF CFLAG:자궁내피임결계
			PRINTL <피임결계>
		ELSE
			PRINTL 触手膣内射精
			;超大量射精と同じ量
			CALL ADDS_EXP("질사경험", 3, TARGET)
			CFLAG:촉수의질내사정에의한임신판정 += 5
			CFLAG:TARGET:자궁현재용량 += 10 + RAND:15
			TFLAG:촉수가사정 = 1
			IF FLAG:쌍둥이플래그 == 0
				CALL 자궁최대용량초기설정, TARGET
				IF CFLAG:TARGET:자궁현재용량 > CFLAG:TARGET:자궁최대용량
					IF CFLAG:TARGET:자궁최대용량 <= 5000
						CFLAG:TARGET:자궁최대용량 += CFLAG:TARGET:자궁현재용량 / 20 + 1
					ELSEIF CFLAG:TARGET:자궁최대용량 >= 20000
						CFLAG:TARGET:자궁최대용량 = 20000
					ELSE
						CFLAG:TARGET:자궁최대용량 += RAND:15
					ENDIF
				ENDIF
			ELSE
				CALL 자궁최대용량초기설정, TARGET
				;満タンにされた場合、拡張する
				IF CFLAG:TARGET:자궁현재용량 > CFLAG:TARGET:자궁최대용량
					;超大量射精と同じ量
					LOCAL:2 = MIN(100, (LOCAL:2 / 4 * (TALENT:TARGET:임신하기쉬움 * 5 / 10 +1) * (EXP:TARGET:출산경험 / 10 + 1)))
					;おまじない
					SIF LOCAL:2 < 1
						LOCAL:2 = 1
					;5000mlまではいいペースで増える
					IF CFLAG:TARGET:자궁최대용량 <= 5000
						CFLAG:TARGET:자궁최대용량 += LOCAL:2 + 1
					;10000mlまでは速度半減
					ELSEIF CFLAG:TARGET:자궁최대용량 <= 10000
						CFLAG:TARGET:자궁최대용량 += LOCAL:2 / 2 + 1
					;20000までは速度3割
					ELSEIF CFLAG:TARGET:자궁최대용량 <= 20000
						CFLAG:TARGET:자궁최대용량 += LOCAL:2 / 3 + 1
					;それ以上は25%
					ELSE
						CFLAG:TARGET:자궁최대용량 += LOCAL:2 / 4 + 1
					ENDIF

					SIF CFLAG:TARGET:자궁최대용량 >= 50000
						CFLAG:TARGET:자궁최대용량 = 50000
				ENDIF
			ENDIF
			;子宮容量増加後でも抱えきれなければ現在容量は最大容量まで下がる。
			CFLAG:TARGET:자궁현재용량 = CFLAG:TARGET:자궁최대용량
		ENDIF
		CALL ADDS_EXP("정액경험", 3, TARGET)
	ENDIF
	IF TEQUIP:PLAYER:바이브
		IF CFLAG:PLAYER:자궁내피임결계
			IF PLAYER == MASTER
				PRINTL <피임결계>(주인)
			ELSEIF PLAYER == ASSI
				PRINTL <피임결계>(조수)
			ENDIF
		ELSE
			IF PLAYER == MASTER
				PRINTL 触手膣内射精(주인)
			ELSEIF PLAYER == ASSI
				PRINTL 触手膣内射精(조수)
			ENDIF
			;超大量射精と同じ量
			CALL ADDS_EXP("질사경험", 3, PLAYER)
			CFLAG:PLAYER:촉수의질내사정에의한임신판정 += 5
			CFLAG:PLAYER:자궁현재용량 += 10 + RAND:15
			IF FLAG:쌍둥이플래그 == 0
				CALL 자궁최대용량초기설정, PLAYER
				IF CFLAG:PLAYER:자궁현재용량 > CFLAG:PLAYER:자궁최대용량
					IF CFLAG:PLAYER:자궁최대용량 <= 5000
						CFLAG:PLAYER:자궁최대용량 += CFLAG:PLAYER:자궁현재용량 / 20 + 1
					ELSEIF CFLAG:PLAYER:자궁최대용량 >= 20000
						CFLAG:PLAYER:자궁최대용량 = 20000
					ELSE
						CFLAG:PLAYER:자궁최대용량 += RAND:15
					ENDIF
				ENDIF
				;子宮容量増加後でも抱えきれなければ現在容量は最大容量まで下がる。
				CFLAG:PLAYER:자궁현재용량 = CFLAG:PLAYER:자궁최대용량
			ELSE
				CALL 자궁최대용량초기설정, PLAYER
				;満タンにされた場合、拡張する
				IF CFLAG:PLAYER:자궁현재용량 > CFLAG:PLAYER:자궁최대용량
					;超大量射精と同じ量
					LOCAL:2 = MIN(100, (LOCAL:2 / 4 * (TALENT:PLAYER:임신하기쉬움 * 5 / 10 +1) * (EXP:PLAYER:출산경험 / 10 + 1)))
					;おまじない
					SIF LOCAL:2 < 1
						LOCAL:2 = 1
					;5000mlまではいいペースで増える
					IF CFLAG:PLAYER:자궁최대용량 <= 5000
						CFLAG:PLAYER:자궁최대용량 += LOCAL:2 + 1
					;10000mlまでは速度半減
					ELSEIF CFLAG:PLAYER:자궁최대용량 <= 10000
						CFLAG:PLAYER:자궁최대용량 += LOCAL:2 / 2 + 1
					;20000までは速度3割
					ELSEIF CFLAG:PLAYER:자궁최대용량 <= 20000
						CFLAG:PLAYER:자궁최대용량 += LOCAL:2 / 3 + 1
					;それ以上は25%
					ELSE
						CFLAG:PLAYER:자궁최대용량 += LOCAL:2 / 4 + 1
					ENDIF
					SIF CFLAG:PLAYER:자궁최대용량 >= 50000
						CFLAG:PLAYER:자궁최대용량 = 50000
				ENDIF
			ENDIF
		ENDIF
		CALL ADDS_EXP("정액경험", 3, PLAYER)
	ENDIF
	BASE:MASTER:뇨의 -= EJAC
	SIF BASE:MASTER:뇨의 >= EJAC
		BASE:MASTER:뇨의 = EJAC-1
ENDIF
	SIF TEQUIP:TARGET:바이브
		CALL ADDS_EXP("촉수경험", 1, TARGET)
	SIF TEQUIP:PLAYER:바이브
		CALL ADDS_EXP("촉수경험", 1, PLAYER)

;-------------------------------------------------
;汚れの処理
;-------------------------------------------------
;촉수가사정した場合の精液汚れ
IF E > 0
	;触手挿入
	SIF TEQUIP:바이브
		CALL SET_STAIN("膣内", "精液", TARGET)
	;アナル触手
	SIF TEQUIP:アナル바이브
		CALL SET_STAIN("アナル", "精液", TARGET)
	;触手クリ責め
	SIF TEQUIP:クリキャップ
		CALL SET_STAIN("ヴァギナ", "精液", TARGET)
	;触手乳首責め
	SIF TEQUIP:ニプルキャップ
		CALL SET_STAIN("胸", "精液", TARGET)
	;触手搾乳
	SIF TEQUIP:搾乳機
		CALL SET_STAIN("胸", "精液", TARGET)
	;触手ペニス責め
	SIF TEQUIP:オナホール
		CALL SET_STAIN("ペニス", "精液", TARGET)
	;触手緊縛（全身にぶっかけるイメージ）
	IF TEQUIP:縄
		CALL SET_STAIN("口", "精液", TARGET)
		CALL SET_STAIN("手", "精液", TARGET)
		;ペニスがあればペニス、なければヴァギナへ
		IF HAVE_PENIS(PLAYER)
			CALL SET_STAIN("ペニス", "精液", TARGET)
		ELSE
			CALL SET_STAIN("ヴァギナ", "精液", TARGET)
		ENDIF
		CALL SET_STAIN("胸", "精液", TARGET)
	ENDIF
	;触手浣腸
	SIF TEQUIP:浣腸器＋プラグ
		CALL SET_STAIN("アナル", "精液", TARGET)
	;触手口辱
	SIF TEQUIP:触手口辱
		CALL SET_STAIN("口", "精液", TARGET)
;---- EDIT 002 触手系コマンドを修正 ADD START ----
	;アナル極太触手
	SIF TEQUIP:拡張バルーン
		CALL SET_STAIN("アナル", "精液", TARGET)
;---- EDIT 002 触手系コマンドを修正 ADD END   ----
ENDIF


;-------------------------------------------------
;経験の処理
;-------------------------------------------------
;各触手派生コマンドから集めた촉수경험を一括処理
;ADD_EXPなら個別に取らせても問題ないのでTで集める措置を無くす
CALL ADDS_EXP("촉수경험", 1, TARGET)

;触手装着中は依存度ベクトル強制変更
;依存度ベクトル
TFLAG:33 = 5

;依存度補正値(服従で1、隷属で2　強制変更なので、これまでの数値をリセット）
IF TALENT:服従 && ASSIPLAY == 0
	TFLAG:依存度補正 = 2
ELSEIF TALENT:隷属 && ASSIPLAY == 0
	TFLAG:依存度補正 = 4
ENDIF

;---- EDIT 002 触手系コマンドを修正 MOD START ----
;コマンド名退避
;ARGS:0 = %TSTR:0%
LOCALS:0 = %TSTR:0%

;触手召喚以外なら暴走判定
IF SELECTCOM != 160
	IF FLAG:触手レベル <= TEQUIP:触手危険度 || TFLAG:触手暴走フラグ
;IF RAND:100 + 1 < TEQUIP:触手危険度 && FLAG:47 && SELECTCOM != 160 && FLAG:触手レベル > 0
	

		PRINTL 　
		PRINTW ･
		PRINTW ･
		PRINTW ･
		PRINTW !
		PRINT 触手は、与えられた命令に従わず、
		PRINT まるで自分の思考があるように
		PRINTL 勝手に動き出した…
		PRINTL 
		PRINTW ･
		PRINTW ･
		PRINTW ･

		;オトコかふたなり
		IF HAVE_PENIS(TARGET)
		;IF !USE_CLI(TARGET)
			;未実行確認
			IF TEQUIP:오나홀 == 0
				;触手ペニス責め
				CALL COM169
			ENDIF
		ELSE
			;未実行確認
			IF TEQUIP:클리캡 == 0
				;触手クリ責め
				CALL COM42
			ENDIF
		ENDIF
		
		IF TALENT:남자 == 0
			;未実行確認
			IF TEQUIP:바이브 == 0
				;触手挿入
				CALL COM44
			ENDIF
		ENDIF
		
		;同じ個所が複数つくと解除できなくなる
		;尻が空いてるか
		IF !(TEQUIP:アナル바이브 || TEQUIP:浣腸器＋プラグ || TEQUIP:拡張バルーン)
			;アナル触手
			CALL COM45
		ENDIF
		
		;胸が空いてるか
		IF !(TEQUIP:ニプルキャップ || TEQUIP:搾乳機)
			IF TALENT:母乳体質
				;触手搾乳
				CALL COM49
			ELSE
				;触手乳首責め
				CALL COM47
			ENDIF
		ENDIF
		
		;未実行確認
		IF TEQUIP:縄 == 0
			;触手緊縛
			CALL COM106
		ENDIF
		
		;未実行確認
		IF TEQUIP:触手口辱 == 0
			;触手口辱
			CALL COM168
		ENDIF
		
		;触手暴走フラグ初期化
		TFLAG:触手暴走フラグ = 0
	ENDIF

	IF (FLAG:触手レベル + RAND:100) <= TEQUIP:触手危険度 || TFLAG:触手暴走させるフラグ
	
		PRINTL 　
		PRINTW ･
		PRINTW ･
		PRINTW ･
		PRINTW !
		PRINTFORM 触手は、%CALLNAME:TARGET%を襲うだけでは飽き足らず
		PRINTL 
		PRINTFORM %CALLNAME:PLAYER%に襲い掛かった
		PRINTL 
		PRINTW ･
		PRINTW ･
		PRINTW ･
		
		IF HAVE_PENIS(PLAYER)
		;IF !USE_CLI(PLAYER)
			;未実行確認
			IF TEQUIP:PLAYER:オナホール == 0
				;触手ペニス責めさせる
				CALL COM51
			ENDIF
		ELSE
			;未実行確認
			IF TEQUIP:PLAYER:クリキャップ == 0
				;触手クリ責めさせる
				CALL COM50
			ENDIF
		ENDIF
		
		IF TALENT:PLAYER:オトコ == 0
			;未実行確認
			IF TEQUIP:PLAYER:바이브 == 0
				;触手挿入させる
				CALL COM52
			ENDIF
		ENDIF
		
		;同じ個所が複数つくと解除できなくなる
		;尻が空いてるか
		IF !(TEQUIP:PLAYER:アナル바이브 || TEQUIP:PLAYER:浣腸器＋プラグ || TEQUIP:PLAYER:拡張バルーン)
			;アナル触手させる
			CALL COM53
		ENDIF
		
		;胸が空いてるか
		IF !(TEQUIP:PLAYER:ニプルキャップ || TEQUIP:PLAYER:搾乳機)
			IF TALENT:PLAYER:母乳体質
				;触手搾乳させる
				CALL COM56
			ELSE
				;触手乳首責めさせる
				CALL COM55
			ENDIF
		ENDIF
		
		
		;触手暴走させるフラグ初期化
		TFLAG:触手暴走させるフラグ = 0
		;TEQUIP:触手危険度 = LIMIT((FLAG:触手レベル - BASE:LV) * 10, 10, 80)
	ENDIF
	
	;他コマンドを呼び出したため退避した前回調教コマンドを付け直す
	;TSTR:0 = %ARGS:0%
	TSTR:0 = %LOCALS:0%

ENDIF


TEQUIP:触手危険度 += 1
;SIF FLAG:47
;	TEQUIP:触手危険度 += RAND:3
;---- EDIT 002 触手系コマンドを修正 MOD END   ----

RETURN 1


;-------------------------------------------------
;派生コマンドの処理
;-------------------------------------------------
;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME161
IF TEQUIP:바이브 == 1
	RESULTS = 触手挿入解除
ELSE
	RESULTS = 触手挿入
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM161
;触手挿入
JUMP COM44
RETURN 1

;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME162
IF TEQUIP:アナル바이브 == 1
	RESULTS = アナル触手解除
ELSE
	RESULTS = アナル触手
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM162
;アナル触手
JUMP COM45
RETURN 1

;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME163
IF TEQUIP:クリキャップ == 1
	RESULTS = 触手クリ責め解除
ELSE
	RESULTS = 触手クリ責め
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM163
;触手クリ責め
JUMP COM42
RETURN 1

;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME164
IF TEQUIP:ニプルキャップ == 1
	RESULTS = 触手乳首責め解除
ELSE
	RESULTS = 触手乳首責め
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM164
;触手乳首責め
JUMP COM47
RETURN 1

;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME165
IF TEQUIP:搾乳機 == 1
	RESULTS = 触手搾乳解除
ELSE
	RESULTS = 触手搾乳
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM165
;触手搾乳
JUMP COM49
RETURN 1

;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME166
IF TEQUIP:縄 == 1
	RESULTS = 触手緊縛解除
ELSE
	RESULTS = 触手緊縛
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM166
;触手緊縛
JUMP COM106
RETURN 1

;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME167
IF TEQUIP:浣腸器＋プラグ == 1
	RESULTS = 触手浣腸解除
ELSE
	RESULTS = 触手浣腸
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM167
;触手浣腸
JUMP COM146
RETURN 1


;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME168
IF TEQUIP:触手口辱 == 1
	RESULTS = 触手口辱解除
ELSE
	RESULTS = 触手口辱
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM168
;触手口辱
PRINTL 触手口辱
TSTR:0 = 触手口辱
SELECTCOM = 168
;CALL KOJO_MESSAGE_COM

;着脱の処理
IF TEQUIP:触手口辱 == 0
	TEQUIP:触手口辱 = 1
	;汚れの付加
	CALL SET_STAIN("口", "粘液", TARGET)
ELSE
	TEQUIP:触手口辱 = 0
ENDIF


;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
DOWNBASE:TARGET:体力 += 80
DOWNBASE:TARGET:気力 += 100

SOURCE:TARGET:性行動 = 200
SOURCE:TARGET:屈従 = 1000
SOURCE:TARGET:逸脱 = 1000


;-------------------------------------------------
;汚れの処理
;-------------------------------------------------
IF TEQUIP:触手口辱 == 1
	CALL SET_STAIN("口", "ペニス", TARGET)
	CALL SET_STAIN("口", "粘液", TARGET)
ENDIF


;-------------------------------------------------
;経験の処理
;-------------------------------------------------
;촉수경험のリセット
;T = 0

;フェラ経験
CALL ADDS_EXP("フェラ経験",1,TARGET)
;PRINTL フェラ経験＋１
RETURN 1

;-------------------------------------------------
;装着継続の処理
;-------------------------------------------------
@EQUIP_COM168
;触手口辱中
PRINTL ＜触手口辱中＞

DOWNBASE:TARGET:体力 += 50
DOWNBASE:TARGET:気力 += 80

SOURCE:TARGET:性行動 += 100
SOURCE:TARGET:屈従 += 700
SOURCE:TARGET:逸脱 += 700


;-------------------------------------------------
;経験の処理
;-------------------------------------------------
;フェラ経験
CALL ADDS_EXP("フェラ経験",1,TARGET)

;촉수경험加算
CALL ADDS_EXP("촉수경험", 1, TARGET)

RETURN 1


;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME169
IF TEQUIP:オナホール == 1
	RESULTS = 触手ペニス責め解除
ELSE
	RESULTS = 触手ペニス責め
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM169
;触手ペニス責め
JUMP COM43
RETURN 1

;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME170
IF TEQUIP:PLAYER:바이브 == 1
	RESULTS = 触手挿入させる解除
ELSE
	RESULTS = 触手挿入させる
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM170
;触手挿入させる
JUMP COM52
RETURN 1

;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME171
IF TEQUIP:PLAYER:アナル바이브 == 1
	RESULTS = アナル触手させる解除
ELSE
	RESULTS = アナル触手させる
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM171
;アナル触手させる
JUMP COM53
RETURN 1

;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME172
IF TEQUIP:PLAYER:クリキャップ == 1
	RESULTS = 触手クリ責めさせる解除
ELSE
	RESULTS = 触手クリ責めさせる
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM172
;触手クリ責めさせる
JUMP COM50
RETURN 1

;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME173
IF TEQUIP:PLAYER:ニプルキャップ == 1
	RESULTS = 触手乳首責めさせる解除
ELSE
	RESULTS = 触手乳首責めさせる
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM173
;触手乳首責めさせる
JUMP COM55
RETURN 1

;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME174
IF TEQUIP:PLAYER:搾乳機 == 1
	RESULTS = 触手搾乳させる解除
ELSE
	RESULTS = 触手搾乳させる
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM174
;触手搾乳させる
JUMP COM56
RETURN 1

;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME175
IF TEQUIP:PLAYER:オナホール == 1
	RESULTS = 触手ペニス責めさせる解除
ELSE
	RESULTS = 触手ペニス責めさせる
ENDIF
;---- EDIT 002 触手系コマンドを修正 ADD END   ----

@ACT_COM175
;触手ペニス責めさせる
JUMP COM51
RETURN 1

;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMNAME176
IF TEQUIP:拡張バルーン == 1
	RESULTS = アナル極太触手解除
ELSE
	RESULTS = アナル極太触手
ENDIF

@ACT_COM176
;アナル極太触手
JUMP COM148
RETURN 1

@COMNAME177
RESULTS = 触手暴走

@ACT_COM177
;触手暴走
PRINTL 触手暴走
TSTR:0 = 触手暴走
SELECTCOM = 177

TFLAG:触手暴走フラグ = 1
RETURN 1

@COMNAME178
RESULTS = 触手暴走させる

@ACT_COM178
;触手暴走させる
PRINTL 触手暴走させる
TSTR:0 = 触手暴走させる
SELECTCOM = 178

TFLAG:触手暴走させるフラグ = 1

RETURN 1

;---- EDIT 002 触手系コマンドを修正 ADD END   ----

;===================================================
;調教タイプ
;===================================================
@COMTYPE_160
RETURN COMTYPE("触手系")
@COMTYPE_161
RETURN COMTYPE("触手系")
@COMTYPE_162
RETURN COMTYPE("触手系")
@COMTYPE_163
RETURN COMTYPE("触手系")
@COMTYPE_164
RETURN COMTYPE("触手系")
@COMTYPE_165
RETURN COMTYPE("触手系")
@COMTYPE_166
RETURN COMTYPE("触手系")
@COMTYPE_167
RETURN COMTYPE("触手系")
@COMTYPE_168
RETURN COMTYPE("触手系")
@COMTYPE_169
RETURN COMTYPE("触手系")
@COMTYPE_170
RETURN COMTYPE("触手系")
@COMTYPE_171
RETURN COMTYPE("触手系")
@COMTYPE_172
RETURN COMTYPE("触手系")
@COMTYPE_173
RETURN COMTYPE("触手系")
@COMTYPE_174
RETURN COMTYPE("触手系")
@COMTYPE_175
RETURN COMTYPE("触手系")
;---- EDIT 002 触手系コマンドを修正 ADD START ----
@COMTYPE_176
RETURN COMTYPE("触手系")
@COMTYPE_177
RETURN COMTYPE("触手系")
@COMTYPE_178
RETURN COMTYPE("触手系")
;---- EDIT 002 触手系コマンドを修正 ADD END   ----




