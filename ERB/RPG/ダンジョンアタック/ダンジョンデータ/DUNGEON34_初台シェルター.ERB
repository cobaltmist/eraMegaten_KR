
;=======================================================================
;하츠다이쉘터
;
;偽典여신転生、主人公の生まれの地であり始まりの地。
;大破壊後の東京で生き残っている有数のシェルター『だった』が、
;마왕バール一味を머리とする무르무르に侵入され壊滅する。
;eraMegatenでは舞台背景が大破壊前である가능性も考慮し、
;大破壊前から、実用性があるかテストも兼ねて、すでに稼働していたことにする。
;던전플래그:34:1-6 = 1.宝箱
;던전플래그:34:7 = 1.中ボス扉警告
;던전플래그:34:8 = 1.ボス撃破＆クリアフラグ
;던전플래그:34:9 = 1.中ボス좀비の群れ
;던전플래그:34:10 = 1.라이도우参戦
;던전플래그:34:11 = 1.COMPチュートリアル
;던전플래그:34:12 = 1.전투チュートリアル
;던전플래그:34:13 = 1.チュートリアル途中で帰った
;던전플래그:34:14 = 1.中ボス머신
;던전플래그:34:15 = 1.宝
;던전플래그:34:16 = 1.특수탄チュートリアル
;던전플래그:34:17 = 1.스킬카드チュートリアル
;던전플래그:34:18 = 좀비戦中断用
;던전플래그:34:20 = 1.초기奴隷도리
;던전플래그:34:21 = 1.초기奴隷마리
;던전플래그:34:30 = 1,チュートリアルを受けた 2,메시지を見た(一度出ると2になってるため、라이도우加入をはじめとした이벤트がおこらなく)
;던전플래그:34:31 = 키쿠리히메撃破
;던전플래그:34:32 = チュートリアル中（단탈리온撃破or途中帰還で0に）
;던전ナンバー34
;=======================================================================




;=======================================================================
;攻略조건
;=======================================================================
@PREREQUISITE_DUNGEON_34
;特になし
RETURN 1



;=======================================================================
;던전名
;=======================================================================
@GET_DUNGEON_NAME_34
RESULTS = 하츠다이쉘터


;=======================================================================
;플로어名표시
;=======================================================================
@FLOORNAME_34
PRINT 하츠다이 쉘터
SELECTCASE FLAG:현M
	CASE 0
		PRINTL   １Ｆ
	CASE 1
		PRINTL   Ｂ１Ｆ
	CASE 2
		PRINTL   Ｂ２Ｆ
	CASE 3
		PRINTL   Ｂ３Ｆ
	CASE 4
		PRINTL   Ｂ４Ｆ
	CASE 5
		PRINTL   Ｂ５Ｆ
	CASE 6
		PRINTL   Ｂ６Ｆ
	CASE 7
		PRINTL   Ｂ７Ｆ
	CASE 8
		PRINTL   Ｂ８Ｆ
	CASE 9
		PRINTL   Ｂ９Ｆ
	CASE 10
		PRINTL   Ｂ１０Ｆ
	CASEELSE
		PRINTL
ENDSELECT


;=======================================================================
;特殊タイル표시
;=======================================================================
@TILE_MARK_34_9_8_6
RESULTS = Ｔ
@TILE_MARK_34_0_6_9
RESULTS = Ｅ

@TILE_MARK_34_5_3_3
RESULTS = Ｅ
@TILE_MARK_34_5_9_3
RESULTS = Ｅ

@TILE_MARK_34_6_5_1
RESULTS = Ｅ
@TILE_MARK_34_6_10_1
RESULTS = Ｅ

@TILE_MARK_34_7_13_1
RESULTS = Ｅ

@TILE_MARK_34_8_13_1
RESULTS = Ｅ
@TILE_MARK_34_8_5_9
RESULTS = □

@TILE_MARK_34_9_6_1
RESULTS = Ｅ

@TILE_MARK_34_10_9_1
RESULTS = Ｅ

;=======================================================================
;스타ト地点입력
;=======================================================================
@START_DUNGEON_34,ARG
FLAG:현M = 0
FLAG:현X = 4
FLAG:현Y = 1
;CALL AUTOMAP

;=======================================================================
;스타ト時이벤트
;=======================================================================
@EVENT_DUNGEON_START_34
#DIM LCOUNT
;チュートリアル
;IF FLAG:전투난이도 >= 3 || FLAG:주회횟수 >= 1 || 던전플래그:1:1 == 1 || 던전플래그:34:8 == 1 || BASE:MASTER:LV >= 11
IF 던전플래그:34:30 == 1
	던전플래그:34:30 = 2
;	FOR LCOUNT, 0, CHARANUM
;		SIF NO:LCOUNT == 4505
;			던전플래그:34:20 = 1
;	NEXT
;	FOR LCOUNT, 0, CHARANUM
;		SIF NO:LCOUNT == 4506
;			던전플래그:34:20 = 2
;	NEXT
;	PRINTFORMW チュートリアルを受けますか？
;	CALL INPUT_YN
;	IF RESULT == 0
	CALL MESSAGE_WINDOW_D, "", @"＞하츠다이 쉘터에 들어가려던 때、/＞%CALLNAME:MASTER%의 휴대전화가 울렸다"
	CALL MESSAGE_WINDOW_D, "목소리", "후후… 일하던 중이었으려나？"
	CALL MESSAGE_WINDOW_D, "", "＞전화기 너머에서 들려오는 것은 마요네의 목소리였다"
	IF GETCHARA([[キャラ:마리]]) == -1
		IF RAND:2 == 0
			CALL MESSAGE_WINDOW_D, "", "＞노예의 것인지/＞가끔、찰팍찰팍하고 음탕한 물소리가 섞여있다…"
		ELSE
			CALL MESSAGE_WINDOW_D, "", "＞노예의 것인지/＞욕정에 찬 여자의 달콤한 허덕임이 섞여있다…"
		ENDIF
	ENDIF
	CALL MESSAGE_WINDOW_D, "마요네", "쉘터의 가까운 곳에 우리들、/팬텀 소사이어티에 적대한는 세력/쿠즈노하의 사람이 보였다는 정보가 들어왔어요"
	CALL MESSAGE_WINDOW_D, "", "＞위험을 알리는 마요네의 음성은 즐거운 것 같다…"
	CALL MESSAGE_WINDOW_D, "마요네", "뭐…만약, 만나버렸다면/당신같은 햇병아리는 어떻게 해볼 상대가 아니에요/조심하도록 해"
	IF GETCHARA([[キャラ:도리]]) == -1
		CALL MESSAGE_WINDOW_D, "", @"＞충고하는 마요네의 목소리와 함께 전화의 너머에서/＞%\@RAND:2?철썩#파앗\@%하는 채찍소리가 들린다"
		CALL MESSAGE_WINDOW_D, "소녀인 듯한 목소리", @"%\@RAND:2?주인님, 용서를…#\힉, 살려…\@%"
		CALL MESSAGE_WINDOW_D, "", @"＞%\@RAND:2?비명#애원\@%과 함께 전화는 끊어졌다…"
	ELSE
		CALL MESSAGE_WINDOW_D, "", "＞충고를 남기고 전화는 끊어졌다"
	ENDIF
ELSE
	던전플래그:34:10 = 1
	던전플래그:34:11 = 1
	던전플래그:34:12 = 1
	던전플래그:34:13 = 2
	던전플래그:34:16 = 1
	던전플래그:34:17 = 1
	CALL MAKE_FLOOR, FLAG:현던전
ENDIF


;=======================================================================
;指定したマスに進入가능か
;=======================================================================
@CAN_ENTER_34,ARG,ARG:1
IF FLAG:현M == 5 && ARG ==1 && ARG:1 == 9 && 던전플래그:34:9 == 0
	CALL MESSAGE_WINDOW_D, "", "＞죽음의 냄새가 난다/＞문을 엽니까？"
	CALL INPUT_YN_D
	SIF RESULT
		RETURN 0
;ELSEIF FLAG:현M == 5 && ARG == 1 && ARG:1 == 9 && 던전플래그:34:7 == 0
;	CALL MESSAGE_WINDOW_D, "", "＞문 틈으로 피가 흘러들어온다/＞문을 엽니까？"
;	CALL INPUT_YN_D
;	SIF RESULT
;		RETURN 0
;	던전플래그:34:7 = 1
ELSEIF FLAG:현M == 9
	IF ARG == 7 && ARG:1 == 9 && !던전플래그:34:8
		CALL MESSAGE_WINDOW_D, "", "＞문의 건너편에서, 키보드를 두드리는 소리가 들린다/＞누군가 있는 듯 하다…/＞문을 열겠습니까？"
		CALL INPUT_YN_D
		SIF RESULT
			RETURN 0
	ENDIF
ENDIF
CALL CAN_ENTER,ARG,ARG:1
RETURN RESULT

;=======================================================================
;플로어데이터
;=======================================================================
@MAKE_FLOOR_34
SELECTCASE FLAG:현M
	CASE 0
	;１階
		FLAG:최대X = 9
		FLAG:최대Y = 12
							    ;012345678
		CALL MAKE_FLOOR_LINE, 0,"    8    "
		CALL MAKE_FLOOR_LINE, 1,"   111   "
		CALL MAKE_FLOOR_LINE, 2,"    2    "
		CALL MAKE_FLOOR_LINE, 3,"    1    "
		CALL MAKE_FLOOR_LINE, 4,"  11111  "
		CALL MAKE_FLOOR_LINE, 5,"  11111  "
		CALL MAKE_FLOOR_LINE, 6,"  2 1    "
		CALL MAKE_FLOOR_LINE, 7,"  1 7    "
		CALL MAKE_FLOOR_LINE, 8,"  1      "
		CALL MAKE_FLOOR_LINE, 9,"  11119  "
		CALL MAKE_FLOOR_LINE,10,"         "
							    ;012345678

		CALL SET_TILE,4,4,던전플래그:34:10,0,4
		CALL SET_TILE,4,4,던전플래그:34:13,1,4

		CALL SET_TILE,4,5,던전플래그:34:11,0,4
		CALL SET_TILE,4,6,던전플래그:34:12,0,4

		;CALL SET_TILE,6,9,던전플래그:34:14,0,4

	CASE 1
	;地下１階
		FLAG:최대X = 7
		FLAG:최대Y = 7
							   ;0123456
		CALL MAKE_FLOOR_LINE,0,"       "
		CALL MAKE_FLOOR_LINE,1," 11111 "
		CALL MAKE_FLOOR_LINE,2," 11111 "
		CALL MAKE_FLOOR_LINE,3," 11111 "
		CALL MAKE_FLOOR_LINE,4," 1   1 "
		CALL MAKE_FLOOR_LINE,5," 7   6 "
		CALL MAKE_FLOOR_LINE,6,"       "

	CASE 2
	;地下２階
		FLAG:최대X = 7
		FLAG:최대Y = 7
		CALL MAKE_FLOOR_LINE,0,"       "
		CALL MAKE_FLOOR_LINE,1," 11111 "
		CALL MAKE_FLOOR_LINE,2," 11111 "
		CALL MAKE_FLOOR_LINE,3," 11111 "
		CALL MAKE_FLOOR_LINE,4," 1   1 "
		CALL MAKE_FLOOR_LINE,5," 7   6 "
		CALL MAKE_FLOOR_LINE,6,"       "

	CASE 3
	;地下３階
		FLAG:최대X = 7
		FLAG:최대Y = 7
							   ;0123456
		CALL MAKE_FLOOR_LINE,0,"       "
		CALL MAKE_FLOOR_LINE,1," 11111 "
		CALL MAKE_FLOOR_LINE,2," 11111 "
		CALL MAKE_FLOOR_LINE,3," 11111 "
		CALL MAKE_FLOOR_LINE,4," 1   1 "
		CALL MAKE_FLOOR_LINE,5," 7   6 "
		CALL MAKE_FLOOR_LINE,6,"       "

		;CALL SET_TILE,5,3,던전플래그:34:17,0,4

	CASE 4
	;地下４階
		FLAG:최대X = 7
		FLAG:최대Y = 7
							   ;0123456
		CALL MAKE_FLOOR_LINE,0,"       "
		CALL MAKE_FLOOR_LINE,1," 11121 "
		CALL MAKE_FLOOR_LINE,2," 111 1 "
		CALL MAKE_FLOOR_LINE,3," 111 1 "
		CALL MAKE_FLOOR_LINE,4," 1   1 "
		CALL MAKE_FLOOR_LINE,5," 7   6 "
		CALL MAKE_FLOOR_LINE,6,"       "

		CALL SET_TILE,5,3,던전플래그:34:16,0,4

	CASE 5
	;地下５階
		FLAG:최대X = 11
		FLAG:최대Y = 13
							    ;01234567890123
		CALL MAKE_FLOOR_LINE, 0,"           "
		CALL MAKE_FLOOR_LINE, 1," 111112116 "
		CALL MAKE_FLOOR_LINE, 2," 1      1  "
		CALL MAKE_FLOOR_LINE, 3," 1 9    19 "
		CALL MAKE_FLOOR_LINE, 4," 1 2 11    "
		CALL MAKE_FLOOR_LINE, 5," 1 1211    "
		CALL MAKE_FLOOR_LINE, 6," 1 1       "
		CALL MAKE_FLOOR_LINE, 7," 1 1211    "
		CALL MAKE_FLOOR_LINE, 8," 1 1 11    "
		CALL MAKE_FLOOR_LINE, 9," 2 2       "
		CALL MAKE_FLOOR_LINE,10," 11111     "
		CALL MAKE_FLOOR_LINE,11," 1111127   "
		CALL MAKE_FLOOR_LINE,12,"           "
		
		;宝箱の設置
		CALL SET_TILE,6,4,던전플래그:34:1,0,3
		;中ボス　警告
		;CALL SET_TILE,1,8,던전플래그:34:7,0,4
		;中ボス　좀비の設置
		CALL SET_TILE,1,10,던전플래그:34:9,0,4

	CASE 6
	;地下６階
		FLAG:최대X = 14
		FLAG:최대Y = 10
							    ;01234567890123
		CALL MAKE_FLOOR_LINE, 0,"              "
		CALL MAKE_FLOOR_LINE, 1,"     9 11 9   "
		CALL MAKE_FLOOR_LINE, 2,"     2 11 2   "
		CALL MAKE_FLOOR_LINE, 3,"     1  2 121 "
		CALL MAKE_FLOOR_LINE, 4," 111 1 1111   "
		CALL MAKE_FLOOR_LINE, 5," 111212111121 "
		CALL MAKE_FLOOR_LINE, 6," 111 1 1111   "
		CALL MAKE_FLOOR_LINE, 7,"     1 2  1   "
		CALL MAKE_FLOOR_LINE, 8," 12111 1 617  "
		CALL MAKE_FLOOR_LINE, 9,"              "

		;宝箱の設置
		CALL SET_TILE,1,8,던전플래그:34:15,0,3
		CALL SET_TILE,12,3,던전플래그:34:2,0,3

	CASE 7
	;地下７階
		FLAG:최대X = 15
		FLAG:최대Y = 11
							    ;01234567890123
		CALL MAKE_FLOOR_LINE, 0,"               "
		CALL MAKE_FLOOR_LINE, 1,"  1 1 1 1 1  9 "
		CALL MAKE_FLOOR_LINE, 2,"  2 2 2 2 2  2 "
		CALL MAKE_FLOOR_LINE, 3,"  111111111411 "
		CALL MAKE_FLOOR_LINE, 4,"   1  1  2 1 1 "
		CALL MAKE_FLOOR_LINE, 5," 121111 11 1 1 "
		CALL MAKE_FLOOR_LINE, 6,"   11   11 6 7 "
		CALL MAKE_FLOOR_LINE, 7," 121  1 2      "
		CALL MAKE_FLOOR_LINE, 8,"   2 111111111 "
		CALL MAKE_FLOOR_LINE, 9,"   1 1 1 1 1 1 "
		CALL MAKE_FLOOR_LINE,10,"               "

		;宝箱の設置
		CALL SET_TILE,6,7,던전플래그:34:3,0,3
		;中ボス、키쿠리히메
		DA:11:3 = !던전플래그:34:30 || 던전플래그:34:31 ? 1 # 4

	CASE 8
	;地下８階
		FLAG:최대X = 15
		FLAG:최대Y = 13
							    ;01234567890123
		CALL MAKE_FLOOR_LINE, 0,"               "
		CALL MAKE_FLOOR_LINE, 1,"  1 1 1 1 1  9 "
		CALL MAKE_FLOOR_LINE, 2,"  2 2 2 2 2  2 "
		CALL MAKE_FLOOR_LINE, 3,"  111111111111 "
		CALL MAKE_FLOOR_LINE, 4,"   1  1  2 1 1 "
		CALL MAKE_FLOOR_LINE, 5," 121111 11 1 4 "
		CALL MAKE_FLOOR_LINE, 6,"   1    11 6 7 "
		CALL MAKE_FLOOR_LINE, 7," 121 1  2      "
		CALL MAKE_FLOOR_LINE, 8,"   1 2  1    1 "
		CALL MAKE_FLOOR_LINE, 9,"   1 1  1    2 "
		CALL MAKE_FLOOR_LINE,10,"   2 1 1111111 "
		CALL MAKE_FLOOR_LINE,11,"   111 1 1 1 1 "
		CALL MAKE_FLOOR_LINE,12,"               "

		;宝箱の設置
		CALL SET_TILE,5,7,던전플래그:34:5,0,3
		CALL SET_TILE,13,8,던전플래그:34:4,0,3
		;中ボスの設置
		DA:13:5 = 던전플래그:34:14 ? 1 # 4

	CASE 9
	;地下９階
		FLAG:최대X = 13
		FLAG:최대Y = 13
							    ;01234567890123
		CALL MAKE_FLOOR_LINE, 0,"             "
		CALL MAKE_FLOOR_LINE, 1,"      9      "
		CALL MAKE_FLOOR_LINE, 2,"      2      "
		CALL MAKE_FLOOR_LINE, 3,"   7111      "
		CALL MAKE_FLOOR_LINE, 4,"      121    "
		CALL MAKE_FLOOR_LINE, 5," 121111 2    "
		CALL MAKE_FLOOR_LINE, 6,"      1 9    "
		CALL MAKE_FLOOR_LINE, 7,"    611   11 "
		CALL MAKE_FLOOR_LINE, 8," 11   1  111 "
		CALL MAKE_FLOOR_LINE, 9," 11 12121111 "
		CALL MAKE_FLOOR_LINE,10,"  2   1  111 "
		CALL MAKE_FLOOR_LINE,11," 111111   11 "
		CALL MAKE_FLOOR_LINE,12,"             "

		;宝箱の設置
		CALL SET_TILE,1,8,던전플래그:34:6,0,3
		;ボスの設置
		CALL SET_TILE,8,9,던전플래그:34:8,0,4

	CASE 10
	;地下１０階、何も無い
		FLAG:최대X = 13
		FLAG:최대Y = 13
		
		;座標X7/Y5が7=降り階段指定になっていた
		;9階に対する昇り階段なので6が正しい
		
								;0123456789012
		CALL MAKE_FLOOR_LINE, 0,"             "
		CALL MAKE_FLOOR_LINE, 1," 111 11  9   "
		CALL MAKE_FLOOR_LINE, 2," 111 11  2   "
		CALL MAKE_FLOOR_LINE, 3,"  2  2   1   "
		CALL MAKE_FLOOR_LINE, 4," 11111   121 "
		CALL MAKE_FLOOR_LINE, 5,"   11126 1   "
		CALL MAKE_FLOOR_LINE, 6," 12111   121 "
		CALL MAKE_FLOOR_LINE, 7,"   1     1   "
		CALL MAKE_FLOOR_LINE, 8,"   111111121 "
		CALL MAKE_FLOOR_LINE, 9," 121  2  2   "
		CALL MAKE_FLOOR_LINE,10,"   1 11 11   "
		CALL MAKE_FLOOR_LINE,11," 121 11 1121 "
		CALL MAKE_FLOOR_LINE,12,"             "
	CASEELSE

ENDSELECT



;=======================================================================
;[5]조사　実行時の이벤트
;=======================================================================
@EVENT_CHECK_DUNGEON_34

;==========
;出口の処理
;==========
IF DA:(FLAG:현X):(FLAG:현Y) == 8
	CALL DUNGEON_EXIT
	RETURN 1
;========
;宝の処理
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 3
	CALL TRESURING_CALLING_34
	RETURN 1
;==========
;이벤트の処理
;==========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 4
	CALL EVENTING_CALLING_34
	RETURN 1
;=======
;階段
;=======
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 6
	SELECTCASE FLAG:현M
		CASE 0
		CASE 1
			CALL DUNGEON_UPSTAIRS,0,4,4
		CASE 2
			CALL DUNGEON_UPSTAIRS,1,1,4
		CASE 3
			CALL DUNGEON_UPSTAIRS,2,1,4
		CASE 4
			CALL DUNGEON_UPSTAIRS,3,1,4
		CASE 5
			CALL DUNGEON_UPSTAIRS,4,1,4
		CASE 6
			CALL DUNGEON_UPSTAIRS,5,7,11
		CASE 7
			CALL DUNGEON_UPSTAIRS,6,10,8
		CASE 8
			CALL DUNGEON_UPSTAIRS,7,13,5
		CASE 9
			CALL DUNGEON_UPSTAIRS,8,13,6
		CASE 10
			CALL DUNGEON_UPSTAIRS,9,4,3
		CASEELSE
	ENDSELECT
	
	RETURN 1

ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 7
	SELECTCASE FLAG:현M
		CASE 0
			CALL DUNGEON_DOWNSTAIRS,1,5,4
		CASE 1
			CALL DUNGEON_DOWNSTAIRS,2,5,4
		CASE 2
			CALL DUNGEON_DOWNSTAIRS,3,5,4
		CASE 3
			CALL DUNGEON_DOWNSTAIRS,4,5,4
		CASE 4
			CALL DUNGEON_DOWNSTAIRS,5,9,1
		CASE 5
			CALL DUNGEON_DOWNSTAIRS,6,10,8
		CASE 6
			CALL DUNGEON_DOWNSTAIRS,7,11,5
		CASE 7
			CALL DUNGEON_DOWNSTAIRS,8,11,5
		CASE 8
			CALL DUNGEON_DOWNSTAIRS,9,5,6
		CASE 9
			CALL DUNGEON_DOWNSTAIRS,10,6,5
		CASEELSE
	ENDSELECT
	RETURN 1


;==========
;ターミナル
;==========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 9
	SELECTCASE FLAG:현M
		CASE 0
			SIF FLAG:현X == 6 && FLAG:현Y == 9
				CALL SYODAI_E
		CASE 5
			SIF (FLAG:현X == 3 || FLAG:현X == 9) && FLAG:현Y == 3
				CALL SYODAI_E
		CASE 6
			SIF (FLAG:현X == 5 || FLAG:현X == 10) && FLAG:현Y == 1
				CALL SYODAI_E
		CASE 7
			SIF FLAG:현X == 12 && FLAG:현Y == 1
				CALL SYODAI_E
		CASE 8
			SIF FLAG:현X == 12 && FLAG:현Y == 1
				CALL SYODAI_E
		CASE 9
			SIF FLAG:현X == 6 && FLAG:현Y == 1 
				CALL SYODAI_E
			SIF FLAG:현X == 8 && FLAG:현Y == 6 
				CALL RAIDOU_TERMINAL
		CASE 10
			SIF FLAG:현X == 9 && FLAG:현Y == 1
				CALL SYODAI_E
		CASEELSE
	ENDSELECT
	RETURN 1
ELSE
	CALL MESSAGE_WINDOW_D, "", "＞아무 것도 일어나지 않았다" 
	RETURN 0
ENDIF

;=======================================================================
;タイル進入時の이벤트
;=======================================================================
@EVENT_ENTER_DUNGEON_34,ARG
;ARG = 進入時の向き　0の場合ワープなど
;==========
;出口の処理
;==========
IF DA:(FLAG:현X):(FLAG:현Y) == 8
	IF FLAG:현M == 0 && FLAG:현X ==4 && FLAG:현Y == 0
		;さらば라이도우
		LOCAL = GETCHARA([[キャラ:라이도우]])
		IF LOCAL >= 0 && !CFLAG:LOCAL:인계횟수
			CALL SHOW_PICTURE, "D"
			CALL MESSAGE_WINDOW_D, "고우토", "돌아갈 건가？/우리가 너희에게 가르쳐줄 수 있는 기회는/오늘 밖에 없다"
			CALL INPUT_YN_D
			IF RESULT == 0
				CALL MESSAGE_WINDOW_D, "고우토", "그럼、 작별이다/우리들은 이 땅에서 조사하기 않으면 안될 것이 있다"
				CALL MESSAGE_WINDOW_D, "", "＞고우토와 라이도우가 ＰＴ에서 이탈했다"
				던전플래그:34:13 = 1
				던전플래그:34:32 = 0
				CALL DEL_GUEST, LOCAL
				FLAG:탈출스킬금지 = 0
				CALL DUNGEON_EXIT
			ELSE
				CALL MESSAGE_WINDOW_D, "고우토", "그렇다면、탐색을 계속하자"
				CALL MESSAGE_WINDOW_D, "", "＞고우토가 재촉하듯이 던전의 앞을 가리켰다"
				FLAG:현Y = 1
			ENDIF
		ELSE
			CALL DUNGEON_EXIT
		ENDIF
	ENDIF
	RETURN 1
;========
;宝の処理
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 3
	CALL TRESURING_CALLING_34
	RETURN 1
;==========
;이벤트の処理
;==========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 4
	CALL EVENTING_CALLING_34
	RETURN 1
;=======
;階段
;=======
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 6
SELECTCASE FLAG:현M
	CASE 0
	CASE 1
		CALL DUNGEON_UPSTAIRS,0,4,7
	CASE 2
		CALL DUNGEON_UPSTAIRS,1,1,4
	CASE 3
		CALL DUNGEON_UPSTAIRS,2,1,4
	CASE 4
		CALL DUNGEON_UPSTAIRS,3,1,4
	CASE 5
		CALL DUNGEON_UPSTAIRS,4,1,4
	CASE 6
		CALL DUNGEON_UPSTAIRS,5,7,11
	CASE 7
		CALL DUNGEON_UPSTAIRS,6,10,8
	CASE 8
		CALL DUNGEON_UPSTAIRS,7,13,5
	CASE 9
		CALL DUNGEON_UPSTAIRS,8,13,6
	CASE 10
		CALL DUNGEON_UPSTAIRS,9,4,3
	CASEELSE
ENDSELECT

RETURN 1

ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 7
SELECTCASE FLAG:현M
	CASE 0
		CALL DUNGEON_DOWNSTAIRS,1,5,4
	CASE 1
		CALL DUNGEON_DOWNSTAIRS,2,5,4
	CASE 2
		CALL DUNGEON_DOWNSTAIRS,3,5,4
	CASE 3
		CALL DUNGEON_DOWNSTAIRS,4,5,4
	CASE 4
		CALL DUNGEON_DOWNSTAIRS,5,9,1
	CASE 5
		CALL DUNGEON_DOWNSTAIRS,6,10,8
	CASE 6
		CALL DUNGEON_DOWNSTAIRS,7,11,5
	CASE 7
		CALL DUNGEON_DOWNSTAIRS,8,11,5
	CASE 8
		CALL DUNGEON_DOWNSTAIRS,9,5,7
	CASE 9
		CALL DUNGEON_DOWNSTAIRS,10,6,5
	CASEELSE
ENDSELECT
RETURN 1
;==========
;扉の処理
;==========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 2
	CALL DUNGEON_DOOR,ARG
	RETURN 1
;==========
;ターミナル
;==========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 9
	SELECTCASE FLAG:현M
		CASE 0
			SIF FLAG:현X == 6 && FLAG:현Y == 9
				CALL SYODAI_E
		CASE 5
			SIF (FLAG:현X == 3 || FLAG:현X == 9) && FLAG:현Y == 3
				CALL SYODAI_E
		CASE 6
			SIF (FLAG:현X == 5 || FLAG:현X == 10) && FLAG:현Y == 1
				CALL SYODAI_E
		CASE 7
			SIF FLAG:현X == 12 && FLAG:현Y == 1
				CALL SYODAI_E
		CASE 8
			SIF FLAG:현X == 12 && FLAG:현Y == 1
				CALL SYODAI_E
		CASE 9
			SIF FLAG:현X == 6 && FLAG:현Y == 1 
				CALL SYODAI_E
			SIF FLAG:현X == 8 && FLAG:현Y == 6 
				CALL RAIDOU_TERMINAL
		CASE 10
			SIF FLAG:현X == 9 && FLAG:현Y == 1
				CALL SYODAI_E
		CASEELSE
	ENDSELECT
	RETURN 1
ENDIF
RETURN 0

;=======================================================================
;필요레벨눈安
;권장LV 雑魚최저LV 雑魚最高LV ボスLV 
;=======================================================================
@GET_DUNGEON_LV_34
RETURN 5, 3, 13, 15
;=======================================================================
;인카운트율
;=======================================================================
@ENCOUNT_RATE_34
IF FLAG:현M < 8
	FLAG:인카운트율 = FLAG:미조우걸음수 > 5 ? FLAG:미조우걸음수*5 # 0
ELSEIF FLAG:현M == 9
	FLAG:인카운트율 = FLAG:미조우걸음수 > 5 ? FLAG:미조우걸음수*5 + 10 # 0
ELSE
	FLAG:인카운트율 = FLAG:미조우걸음수 > 5 ? FLAG:미조우걸음수*5 + 20 # 0
ENDIF
;=======================================================================
;エンカウント処理
;=======================================================================
@CHECK_ENCOUNT_34
IF RAND:100 < FLAG:인카운트율
	IF 던전플래그:34:32
		FLAG:선제기습취소 = 1
		던전플래그:34:18 = 0
	ENDIF
	CALL ENEMY_TABLE
	RETURN 1
ELSE
	던전플래그:34:18 = 0
	FLAG:미조우걸음수 += 1
	RETURN 0
ENDIF
;=======================================================================
;적の종족の종류数
;=======================================================================
@CLASS_NUM_34
;チュートリアル
IF 던전플래그:34:30
	SELECTCASE RAND:100
		CASE IS < 50
			RETURN 1
		CASEELSE
			RETURN 2
	ENDSELECT
ELSE
	SELECTCASE RAND:100
		CASE IS < 40
			RETURN 1
		CASE IS < 95
			RETURN 2
		CASEELSE
			RETURN 3
	ENDSELECT
ENDIF
;=======================================================================
;적の総数
;=======================================================================
@ENEMY_NUM_34, ARG
;チュートリアル
IF 던전플래그:34:30
	SELECTCASE ARG
		CASE 1
			RETURN RAND(1, 4)
		CASE 2
			RETURN RAND(2, 5)
	ENDSELECT
;통상
ELSE
	SELECTCASE ARG
		CASE 1
			RETURN RAND(1, 3)
		CASE 2
			RETURN RAND(2, 5)
		CASE 3
			RETURN RAND(3, 6)
	ENDSELECT
ENDIF
;=======================================================================
;적の종류
;=======================================================================
@ENEMY_34, ARG
;チュートリアルを受けた場合は専用テーブルしか出てこない
;難度저하と見せかけて、実際のところ、획득できる동료마의종류がかなり減るし、레벨も上げにくくなるので
;楽になる反面、攻略上の旨みは減ると思います
IF 던전플래그:34:30
	SELECTCASE RAND:100
		CASE IS < 10
			;10%で라타토스크Lv5
			RETURN [[キャラ:라타토스크]], 5
		CASE IS < 25
			;15%で픽시Lv3
			RETURN [[キャラ:픽시]], 3
		CASE IS < 40
			;15%で아프사라스Lv5
			RETURN [[キャラ:아프사라스]], 5
		CASE IS < 60
			;20%で좀비쨩Lv4
			RETURN [[キャラ:좀비쨩]], 4
		CASE IS < 70
			;10%で좀비군Lv5
			RETURN [[キャラ:좀비군]], 5
		CASE IS < 80
			;10%で좀비독
			RETURN [[キャラ:좀비독]], 1
		CASE IS < 85
			;5%で코볼트Lv5
			RETURN [[キャラ:코볼트]], 5
		CASE IS < 95
			;5%で노커Lv4
			RETURN [[キャラ:노커]], 4
		CASE IS < 100
			;10%で아귀Lv4
			RETURN [[キャラ:아귀]], 4
	ENDSELECT
ELSE
	SELECTCASE FLAG:현M
		;五階まで
		CASE IS < 6
			SELECTCASE RAND:100
				CASE IS < 15
					;15%で픽시Lv3
					RETURN [[キャラ:픽시]], 3
				CASE IS < 30
					;15%で아프사라스Lv5
					RETURN [[キャラ:아프사라스]], 5
				CASE IS < 50
					;20%で좀비쨩Lv4
					RETURN [[キャラ:좀비쨩]], 4
				CASE IS < 60
					;15%で좀비군Lv7
					RETURN [[キャラ:좀비군]], 7
				CASE IS < 70
					;10%で좀비독
					RETURN [[キャラ:좀비독]], 3
				CASE IS < 80
					;15%で코볼트Lv5
					RETURN [[キャラ:코볼트]], 5
				CASE IS < 90
					;10%で노커Lv4
					RETURN [[キャラ:노커]], 4
				CASE IS < 100
					;10%で아귀Lv4
					RETURN [[キャラ:아귀]], 4
			ENDSELECT
		;六階-七階
	CASE IS < 8
		SELECTCASE RAND:100
			CASE IS < 15
				;15%で아프사라스
				RETURN [[キャラ:아프사라스]], 5
			CASE IS < 30
				;15%で라타토스크Lv5
				RETURN [[キャラ:라타토스크]], 5
			CASE IS < 45
				;15%で좀비쨩
				RETURN [[キャラ:좀비쨩]], 7
			CASE IS < 50
				;5%で좀비너스
				RETURN [[キャラ:좀비너스]], 8
			CASE IS < 55
				;5%で모코이Lv6
				RETURN [[キャラ:모코이]], 6
			CASE IS < 65
				;10%で고블린Lv7
				RETURN [[キャラ:고블린]], 7
			CASE IS < 75
				;10%で커시Lv6
				RETURN [[キャラ:커시]], 6
			CASE IS < 90
				;15%で아귀
				RETURN [[キャラ:아귀]], 7
			CASE IS < 100
				;10%で좀비군
				RETURN [[キャラ:좀비군]], 7
		ENDSELECT
	;七階-九階
	CASE IS < 10
		SELECTCASE RAND:100
			CASE IS < 5
				;5%で리림Lv9
				RETURN [[キャラ:리림]], 9
			CASE IS < 15
				;10%で실키LV7
				RETURN [[キャラ:실키]], 7
			CASE IS < 30
				;15%で라타토스크
				RETURN [[キャラ:라타토스크]], 8
			CASE IS < 45
				;15%で좀비쨩　랭크1
				RETURN [[キャラ:좀비쨩]], 7
			CASE IS < 50
				;5%で좀비너스
				RETURN [[キャラ:좀비너스]], 8
			CASE IS < 55
				;5%で모코이랭크1
				RETURN [[キャラ:모코이]], 9
			CASE IS < 65
				;10%で고블린
				RETURN [[キャラ:고블린]], 7
			CASE IS < 75
				;10%で커시
				RETURN [[キャラ:커시]], 9
			CASE IS < 85
				;10%で안드라스
				RETURN [[キャラ:안드라스]], 8
			CASE IS < 100
				;15%で좀비군
				RETURN [[キャラ:좀비군]], 7
		ENDSELECT
	CASEELSE
		SELECTCASE RAND:100
			CASE IS < 15
				;15%で리림　랭크1
				RETURN [[キャラ:리림]], 12
			CASE IS < 25
				;10%で실키　랭크1
				RETURN [[キャラ:실키]], 10
			CASE IS < 40
				;15%で좀비쨩　랭크2
				RETURN [[キャラ:좀비쨩]], 10
			CASE IS < 50
				;10%で좀비너스
				RETURN [[キャラ:좀비너스]], 11
			CASE IS < 60
				;10%で브라우니
				RETURN [[キャラ:브라우니]], 11
			CASE IS < 75
				;15%で이누가미
				RETURN [[キャラ:이누가미]], 13
			CASE IS < 90
				;15%で좀비군　랭크1
				RETURN [[キャラ:좀비군]], 10
			CASE IS < 100
				;10%で안드라스　랭크1
				RETURN [[キャラ:안드라스]], 11
		ENDSELECT
	ENDSELECT
ENDIF

;=======================================================================
;이벤트まとめ
;=======================================================================
@EVENTING_CALLING_34
SELECTCASE FLAG:현M
	CASE 0
		IF FLAG:현X == 4 && FLAG:현Y == 4 && 던전플래그:34:10 == 0
			CALL SHOW_PICTURE, "D"
			;하늘의박물관　마야姉システムから拝借
			CALL MESSAGE_WINDOW_D, "", "＞검은 고양이와 외투를 걸친 청년이 있다"
;			IF 던전플래그:34:10 == 0
				CALL MESSAGE_WINDOW_D, "검은 고양이", "너가 펜텀 소사이어티의 서머너인가"
				;アマラ宇宙に迷い込んだ라이도우と고우토　とある閣下の의뢰で色々特別なので고우토が喋ります
				CALL MESSAGE_WINDOW_D, "", "＞검은 고양이가 말했다…"
				CALL MESSAGE_WINDOW_D, "검은 고양이", "이 남자의 이름은 쿠즈노하 라이도우, 나는 고우토/우리들은 자네와는 적대하는 관계/하지만 이번은 어떤 인물로부터의 의뢰이기 때문에"
;				던전플래그:34:10 = 1
				던전플래그:34:32 = 1
;			ELSE
;				PRINTFORML 「기다리고 있었다」
;				PRINTFORMW 「함께 최심부로 가도록 하자」
;			ENDIF
			FOR LOCAL, 1, 7
				LOCALS = 포지션{LOCAL}
				SIF FLAG:LOCALS < 0
					BREAK
				SIF ABL:(FLAG:LOCALS):종족 > 0 && NO:(FLAG:LOCALS) != 4509
					CONTINUE
				SIF LOCAL == 6
					GOTO KUZUNOHA01
			NEXT
			;
			IF FLAG:전투난이도 < 3 || FLAG:DEBUG
				CALL MESSAGE_WINDOW_D, "고우토", "잘 부탁한다/함께 돌아가는 것은 불가능하기 때문에,/탈출스킬은 봉해두었다"
				CALL SET_GUEST_D34
				던전플래그:34:10 = 1
				던전플래그:34:13 = 0
				FLAG:탈출스킬금지 = 1
			ELSE
				$KUZUNOHA01
				CALL MESSAGE_WINDOW_D, "고우토", "흐음…/동료가 가득인 듯 하군"
			ENDIF
			CALL CLEAR_TILE
		ELSEIF FLAG:현X == 4 && FLAG:현Y == 5 && 던전플래그:34:11 == 0 && FLAG:주회횟수 < 1
			CALL SHOW_PICTURE, "D"
			CALL MESSAGE_WINDOW_D, "", "＞라이도우와 함께 있는 검은 고양이, 고우토가 말을 걸어왔다"
			CALL MESSAGE_WINDOW_D, "고우토", "데빌서머너는 TALK로 교섭하여,/동료마를 늘리는 것이 가능하다/ＣＯＭＰ, 컴퓨터라고 말하나?"
			CALL MESSAGE_WINDOW_D, "고우토", "그것이 꽉 차있으면 악마는 동료마로 하는 것은 불가능하다/항상 비어있는 용량에는 주의하라는 것이다"
			CALL MESSAGE_WINDOW_D, "고우토", "우선 이 층에서 확실히 동료마를 모아보면 좋겠지/소수정예라고 말해도, 그것으로는 듣기 좋겠지만…/그 만큼의 실력이 요구된다는 것이다/자네는 아직 신출내기, 솔직하게 무리를 짓는 것이 좋을 것이야"
			SIF GETCHARA([[キャラ:픽시]]) >= 0 && CPOS(GETCHARA([[キャラ:픽시]])) == 0
				CALL MESSAGE_WINDOW_D, "고우토", "그건 그렇고, 자네는 계약하고 있는 악마가 없는건가?/만약 있다면, 확실하게 소환해두는 편이 좋다/막상, 전투가 시작하면, ＣＯＭＰ에서 부르기에는 늦을 때도 많이 있을 테니까/소환은 셋업에서 가능하다"
			CALL MESSAGE_WINDOW_D, "고우토", "또한, 파티에 ＣＯＭＰ를 다룰 서머너가 아무도 없다면/악마와 교섭하는 것도 소환하는 것도 할 수 없다/수면이나 마비 등의 배드 스테이터스 같은 것에도 조심해라"
			던전플래그:34:11 = 1
			LOCAL = 0
			CALL CLEAR_TILE
		ELSEIF FLAG:현M == 0 && FLAG:현X == 4 && FLAG:현Y == 6 && 던전플래그:34:12 == 0 && FLAG:주회횟수 < 1
			CALL SHOW_PICTURE, "D"
			CALL MESSAGE_WINDOW_D, "", "＞눈 앞에 좀비의 무리가 길을 막고 있다"
			CALL MESSAGE_WINDOW_D, "고우토", "신입이여…/악마에는 약점이 있을 때가 있다는 것을 알고 있나?"
			CALL MESSAGE_WINDOW_D, "고우토", "예를 들자면 이 녀석들 시귀에는 총은 먹히지가 않는다/하지만, 검이나 불에는 터무니없이 약하지/하늘을 나는 악마의 대다수는 비구와 충격, 질풍이 잘 먹힌다"
			CALL MESSAGE_WINDOW_D, "고우토", "약점을 노리면 편안하게 싸울 수 있다/그 것을 명심하고 싸워라"
			FLAG:도주불가플래그 = 1
			FLAG:회화불능플래그 = 1
			FLAG:선제기습취소 = 1
			;전투後の경험치処理をスキップする
			FLAG:RESULT스킵 = 1
			CALL SET_ENEMY,7,[[キャラ:좀비군]],1,0,0
			CALL SET_ENEMY,8,[[キャラ:좀비쨩]],1,0,0
			CALL SET_ENEMY,9,[[キャラ:좀비군]],1,0,0
			CALL BATTLE_START
			FLAG:도주불가플래그 = 0
			FLAG:회화불능플래그 = 0
			FLAG:선제기습취소 = 0
			;전투後の경험치処理をスキップする
			FLAG:RESULT스킵 = 0
			던전플래그:34:12 = 1
			CALL CLEAR_TILE
			CALL SHOW_PICTURE, "D"
			CALL MESSAGE_WINDOW_D, "고우토", "지금 것들은 잡어, 특별히 곤란할 것도 없는데…/하지만, 방심은 금물이다./조금씩이라도, 상처가 생겨가면/결국, 되돌릴 수 없는 일으로 될 때도 있겠지"
			CALL MESSAGE_WINDOW_D, "고우토", "어이, 라이도우, 회복아이템을 건내줘라"
			CALL MESSAGE_WINDOW_D, "", @"＞라이도우는 %CALLNAME:MASTER%에게 아이템을 내밀었다"
			CALL GET_ITEMS, "외상약", 5
			CALL GET_ITEMS, "메디컬파우더", 3
			CALL GET_ITEMS, "도반옥", 1
			CALL GET_ITEMS, "디스포이즌", 3
			CALL GET_ITEMS, "우황단", 1
			CALL MESSAGE_WINDOW_D, "", "＞외상약을 받았다/＞메디컬파우더를 받았다/＞도반옥을 받았다"
			CALL MESSAGE_WINDOW_D, "", "＞디스포이즌을 받았다/＞우황단을 받았다"
			CALL MESSAGE_WINDOW_D, "고우토", "회복아이템을 사용하면, 상처를 치료하던가、/사망한 동료마를 살리던가, /독을 치료하는 것도 있다"
			CALL MESSAGE_WINDOW_D, "고우토", "돈이 필요한 것이나,/들고 다닐 수 있는 수에 각각 한계가 있는 것은 성가시지만/그래도, 효과는 대단하다"
			CALL MESSAGE_WINDOW_D, "고우토", "자네 자신을 지키기 위해 사용하는 것은 물론、/자네를 믿고 싸우는 동료마를 지키기 위해서도,/회복아이템의 준비를 소홀히해서는 안되겠지"
		ENDIF
	CASE 3
		;出口での이벤트とかぶるのと
		;탈출後の話は탈출後にだけまとめたほうがいいだろうということでカード입수自体も탈출時にまわす
		;IF FLAG:현X == 5 && FLAG:현Y == 3 && 던전플래그:34:17 == 0 && FLAG:주회횟수 < 1
		;	PRINTFORML ＞라이도우가 한 장의 카드를 내밀었다
		;	PRINTFORMW ＞고우토가 카드에 대해 설명해주었다
		;	PRINTFORML 「이 것은 스킬카드라고 불리는 것이다」
		;	PRINTFORMW 「마을에 돌아가서 ［122］동료마강화로 동료마에게 스킬카드에 각인된 스킬을 배우게 하는 것이 가능하다」
		;	PRINTFORML 「［120］사교의 관에서는 동료마를 함체시키는 것도 가능하지만」
		;	PRINTFORMW 「신뢰를 얻은 동료마로부터 스킬카드를 추출하는 것도 가능하다고 들었다」
		;	PRINTFORMW 「여러가지 시험해보는게 좋다」
		;	PRINTFORMW ＞스킬카드 【갈】을 얻었다
		;	ITEM:11701 += 1
		;	던전플래그:34:17 = 1
		;ENDIF
	CASE 4
		IF FLAG:현X == 5 && FLAG:현Y == 3 && 던전플래그:34:16 == 0 && FLAG:주회횟수 < 1
			CALL SHOW_PICTURE, "D"
			CALL MESSAGE_WINDOW_D, "", "＞고우토가 입을 열었다"
			CALL MESSAGE_WINDOW_D, "고우토", "신입이여, 자네에게는 건슬링거의 소질이 있는 듯 하군/특수탄은 알고 있나？/예를 들어 시귀, 좀비에게는 통상의 탄환은 효과가 없지만/화염속성이나 파마속성이 잘 듣는다"
			CALL MESSAGE_WINDOW_D, "고우토", "이러한 때……아니, 입으로 말하는 것보다 직접 해보는 것이 빠르지/라이도우, 이자식에게 몇개 정도 나눠줘"
			CALL MESSAGE_WINDOW_D, "", "＞성스러운탄환을 받았다/＞코로나샷을 받았다/＞프로스트탄을 받았다/＞랜턴탄을 받았다"
			CALL MESSAGE_WINDOW_D, "고우토", "장비하지 않으면 의미가 없으니까 신경쓰도록/ＥＱＵＩＰ에서 장비를 선택해, ［특수탄 변경］으로 장비하는 것이다/전투중에 ＧＵＮ의 아래에 있는 ＢＵＬＬＥＴ을 선택하면/특수탄으로 공격할 수 있다"
			CALL GET_ITEMS, "성스러운탄환", 10
			CALL GET_ITEMS, "코로나샷", 5
			CALL GET_ITEMS, "프로스트탄", 5
			CALL GET_ITEMS, "랜턴탄", 5
			CALL CLEAR_TILE
			던전플래그:34:16 = 1
		ENDIF
	CASE 5
		IF FLAG:현X == 1 && FLAG:현Y == 10 && 던전플래그:34:9 == 0
			CALL SHOW_PICTURE, "D"
			CALL MESSAGE_WINDOW_D, "", @"＞문을 열자, 돌연 %CALLNAME:MASTER%에 심하게 시체의 냄새가 덮쳐왔다！/＞아무래도, 문의 건너편에는 대량의 시귀가 모여있는 것 같다！"
			;라이도우が生きてる時のみ
			IF FINDCHARA_B(4542,0) == 2
				IF 던전플래그:34:19++ == 0
					CALL MESSAGE_WINDOW_D, "고우토", "흠, 문 앞에 뭔가가 있다고는 생각했지만,/라이도우, 그것을"
					CALL MESSAGE_WINDOW_D, "", @"＞라이도우는 %CALLNAME:MASTER%에게 아이템을 내밀었다/＞네이팜탄을 5개, 얻었다/＞라이어트밤을 5개, 얻었다/＞액화질소봄베를 5개, 얻었다"
					CALL GET_ITEMS,"네이팜탄", 5
					CALL GET_ITEMS,"라이어트밤", 5
					CALL GET_ITEMS,"액화질소봄베", 5
					CALL MESSAGE_WINDOW_D, "고우토", "이제, 적의 약점을 찌르는 것은/알고 있을 거라고 생각한다/이능의 힘을 사용할 수 없는 자네는 스스로 할 수 있는 것에 한계가 있다/그것을 보충하는 것이 아이템이다"
					CALL MESSAGE_WINDOW_D, "고우토", "지금, 라이도우가 자네에게 건내준 것 안에/이 상황을 해쳐나갈 것이 있다/전투가 시작되면 ＩＴＥＭ에서 이거라고 생각되는 물건을 사용해봐라/그럼, 간다！"
				ELSE
					CALL MESSAGE_WINDOW_D, "고우토", "이번에야 말로 괜찮은가？/아이템을 사용해, COOP을 노리는 거다"
					IF ITEM:네이팜탄 == 0
						CALL MESSAGE_WINDOW_D, "고우토", "이런、네이팜탄이 없지 않나…/어쩔 수 없군。라이도우"
						CALL GET_ITEMS,"네이팜탄", 1
						CALL MESSAGE_WINDOW_D, "", "＞라이도우는 %CALLNAME:MASTER%에게 아이템을 건네주었다/＞네이팜탄을 1개、손에 넣었다"
					ENDIF
					CALL MESSAGE_WINDOW_D, "고우토", "다음은 제대로 동료마를 모은다면 이길 것이다/그럼、가자！"
				ENDIF
				던전플래그:34:18 = 1
			ENDIF
			FLAG:도주불가플래그 = 1
			FLAG:회화불능플래그 = 1
			FLAG:선제기습취소 = 1
			IF FINDCHARA_B(4542,0) == 2
				FLAG:RESULT스킵 = 1
				FOR LOCAL, 7, 12
					CALL SET_ENEMY,LOCAL,[[キャラ:좀비군]],9,0,1
					CSTR:(CHARANUM-1):사고패턴 = チュートリアル좀비
					BASE:(CHARANUM-1):질풍 = 25
					BASE:(CHARANUM-1):화염 = 400
					MAXBASE:(CHARANUM-1):질풍 = 25
					MAXBASE:(CHARANUM-1):화염 = 400
					CFLAG:(CHARANUM-1):속도보정 = -100
					CFLAG:(CHARANUM-1):회피보정 = -100
					CALL SET_BATTLE_STATUS(CHARANUM-1, 80, "ＨＰ")
					CALL SYNC_STATUS, CHARANUM- 1
					CALL HEALTH_CHARA, CHARANUM-1
				NEXT
			ELSE
				CALL SET_ENEMY,7,[[キャラ:좀비군]],13,0,0
				CALL SET_ENEMY,8,[[キャラ:좀비쨩]],10,0,0
				CALL SET_ENEMY,9,[[キャラ:좀비군]],13,0,0
				CALL SET_ENEMY,10,[[キャラ:좀비너스]],14,0,0
				CALL SET_ENEMY,11,[[キャラ:좀비쨩]],10,0,0
			ENDIF
			CALL BATTLE_START
			FLAG:도주불가플래그 = 0
			FLAG:회화불능플래그 = 0
			FLAG:선제기습취소 = 0
			FLAG:RESULT스킵 = 0
			IF 던전플래그:34:18 == 2
				FLAG:현Y -= 2
				CALL SHOW_PICTURE, "D"
				CALL MESSAGE_WINDOW_D, "고우토", "신참이여, 괜찮은가?/저만한 수다./정신차려라"
				CALL MESSAGE_WINDOW_D, "고우토", "또, 만약에/위력이 부족했다면, 동료마를 모으는 것이 좋다/COOP은 발생시킨 자와 생각이 가까운 자가 많으면 많을수록/데미지가 늘어나니까"
				던전플래그:34:18 = 0
				RETURN 0
			ENDIF
			던전플래그:34:18 = 0
			던전플래그:34:9 = 1
			CALL CLEAR_TILE
			;라이도우
			IF (FINDCHARA_B(4542,1) == 2 || FINDCHARA_B(4542,0) == 2) && FLAG:주회횟수 < 1
				CALL SHOW_PICTURE, "D"
				CALL MESSAGE_WINDOW_D, "고우토", "신참이여, 상처는 없는가？"
				CALL INPUT_YN_D
				IF RESULT == 0
					CALL MESSAGE_WINDOW_D, "고우토", "별 일 없다면 좋다"
				ELSE
					CALL MESSAGE_WINDOW_D, "고우토", "대답을 할 수 있을 정도라면 아직 괜찮을 듯 하군/하지만, 위험하다고 느끼면 되돌아가는 것도 좋다"
				ENDIF
				CALL MESSAGE_WINDOW_D, "고우토", "특히 문의 안에는/강적이 기다리고 있는 일이 많다/만전을 갖추고 열어라"
			ENDIF
		ENDIF
	CASE 7
		CALL SHOW_PICTURE, "D"
		IF 던전플래그:34:31 == 0
			CALL MESSAGE_WINDOW_D, "고우토", "저것은, 키쿠리히메인가…/어째서 이런 곳에…?/신참이여, 저 녀석은 주살 스킬【무도】를 가지고 있다"
			CALL MESSAGE_WINDOW_D, "고우토", "주살에 성공하면, 아무리 체력이 많아도 일격으로 죽어버린다/그 무서움, 이야기를 듣는 것만으로도 잘 알겠지？/그러나, 대항책이 없다는 것은 아니다"
		ENDIF
		CALL MESSAGE_WINDOW_D, "고우토", "자네는 GUARD하고 있어라/GUARD하고 있는 한, 자네가 주살당하는 일은 없다/그 동안 라이도우가 녀석을 쓰려뜨려줄 것이다"
		CALL SET_ENEMY, 9,[[キャラ:키쿠리히메]],9,0,1
		CSTR:(CHARANUM-1):사고패턴 = チュートリアル키쿠리히메
		CFLAG:(CHARANUM-1):속도보정 = 100
		CFLAG:(CHARANUM-1):ＭＰ보정 = 1000
		CALL SYNC_STATUS, CHARANUM-1
		CALL HEALTH_CHARA, CHARANUM-1
		FLAG:도주불가플래그 = 1
		FLAG:회화불능플래그 = 1
		FLAG:선제기습취소 = 1
		FLAG:RESULT스킵 = 1
		던전플래그:34:18 = 3
		CALL BATTLE_START
		FLAG:도주불가플래그 = 0
		FLAG:회화불능플래그 = 0
		FLAG:선제기습취소 = 0
		FLAG:RESULT스킵 = 0
		IF 던전플래그:34:18 == 2
			FLAG:현Y += 2
			CALL SHOW_PICTURE, "D"
			CALL MESSAGE_WINDOW_D, "고우토", "주살의 무서움/제대로 이해하지 못했나?/이번은 라이도우가 있어줘서 좋았지만、/본래라면 이걸로 죽어있어도 이상하지 않다"
			CALL MESSAGE_WINDOW_D, "고우토", "라고 해도 아무리 강력한 공격에도 반드시 약점은 있다/키쿠리히메는 그것을 주로 가르쳐 줄 것이다/자, 정신 차리고 가자"
			던전플래그:34:31 = -1
		ELSE
			CALL SHOW_PICTURE, "D"
			CALL MESSAGE_WINDOW_D, "고우토", "무사히, 빠져나갔나/GUARD는 단순히 데미지를 줄이는 것이 아니라、/이러한 사용법도 있다"
			CALL MESSAGE_WINDOW_D, "고우토", "또, GUARD는 주살뿐아니라,/독이나 매료등 배드 스테이터스도 막는다/그리고, 심지어 GUARD하고 있는 동안은,/약점을 찔려도 １ＭＯＲＥ가 발생하지 않는다"
			CALL MESSAGE_WINDOW_D, "고우토", "이 의미는 알겠지？/그래, 약점을 극복할 수 있다는 것이다/자네에게 따르는 약마들은 각각 약점을 안고 있다"
			CALL MESSAGE_WINDOW_D, "고우토", "물론, 약점을 가진 동료마를 전투에 내지 않는 것은 기본이지만/자네가 GUARD를 지시해서 하는 것도,/동료마를 지키는 것이 가능하다/동료를 위해 정확한 지시를 내리도록 명심해라"
			CALL CLEAR_TILE
			던전플래그:34:31 = 1
		ENDIF
		던전플래그:34:18 = 0
	CASE 8
		IF FLAG:현X == 13 && FLAG:현Y == 5 && 던전플래그:34:14 <= 0
			CALL SHOW_PICTURE, "D"
			FLAG:도주불가플래그 = 1
			FLAG:회화불능플래그 = 1
			FLAG:선제기습취소 = 1
			;라이도우
			IF (FINDCHARA_B(4542,1) == 2 || FINDCHARA_B(4542,0) == 2) && GETCHARA([[キャラ:모・쇼보]]) == -1
				CALL MESSAGE_WINDOW_D, "", "＞통로에 대량의 머신이 있다！"
				FLAG:RESULT스킵 = 1
				IF 던전플래그:34:14 == 0
					CALL MESSAGE_WINDOW_D, "고우토", "카라쿠리인가……/카라쿠리는 전격에 약하다./전격을 사용한다면 쉽사리 쓰러뜨리겠지만"
					CALL MESSAGE_WINDOW_D, "고우토", "과연 이 정도 숫자는 위험하다…/라이도우、지금은 신입과 링케이지를 사용하자/총을 건내줘라"
					CALL MESSAGE_WINDOW_D, "", @"＞고우토가 눈짓을 하자、라이도우는 끄덕이고、/＞%CALLNAME:MASTER%에게 철파이프형 산탄총을 건내、/＞%조사처리(CALLNAME:MASTER,"가")% 장비할 수 있게 했다"
					EQUIP:MASTER:특수탄1 = GETNUM(ITEM, "코로나샷")
					EQUIP:MASTER:특수탄2 = 0
					EQUIP:MASTER:특수탄3 = 0
					CALL GET_ITEMS,"코로나샷",5
					CALL GET_ITEMS,"쇠파이프형산탄총",1
					CALL 장비변경, MASTER, GET_EQUIPNUM("총"), GETNUM(ITEM, "쇠파이프형산탄총")
					DA:34:18 = 1
					CALL MESSAGE_WINDOW_D, "고우토", "그것은 샷건이다./일렬의 적을 한번에 공격하는 것이 가능하다"
					CALL MESSAGE_WINDOW_D, "고우토", "거기에 코로나샷을 넣으면,/일렬의 적에게 코로나샷을 쏜다/하지만, 이 경우는 그거로는 부족하다。라이도우！"
				ENDIF
				CALL MESSAGE_WINDOW_D, "", "＞라이도우는 흉조 모・쇼보를 소환했다/＞모・쇼보가 일시적으로 파티에 가입했다"
				CALL ADD_GUEST_COMPANION, [[キャラ:모・쇼보]], 200, 1
				ABL:GETCHARA([[キャラ:모・쇼보]]):스킬2 = [[스킬:마하・갈]]
				SIF ITEM:코로나샷 == 0
					CALL GET_ITEMS,"코로나샷",3
				CALL MESSAGE_WINDOW_D, "고우토", "코로나샷과 갈이나 마하 갈을/조합하는 것으로 뇌령마법탄이라는 기술을 사용한다/두 사람이 함께 공격하는 것으로, /보통으로 공격하는 것보다 강하다는 것이다"
				CALL MESSAGE_WINDOW_D, "고우토", "핸드건으로 공격하면 일렬공격,/그리고 샷건으로 공격하면, 전체공격이 된다/전투가 시작하면, 링케이지를 선택하는 거다"
				CALL MESSAGE_WINDOW_D, "", "＞비트볼이 10체 나타났다！"
				FOR LOCAL, 7 ,17
					CALL SET_ENEMY,LOCAL,[[キャラ:비트볼]],9,0,1
					CSTR:(CHARANUM-1):사고패턴 = チュートリアル비트볼
					BASE:(CHARANUM-1):질풍 = 25
					BASE:(CHARANUM-1):전격 = 300
					MAXBASE:(CHARANUM-1):질풍 = 25
					MAXBASE:(CHARANUM-1):전격 = 400
					CFLAG:(CHARANUM-1):마법피데미지보정 = -50
					CFLAG:(CHARANUM-1):COOP피데미지보정 = 250
					CFLAG:(CHARANUM-1):속도보정 = -100
					던전플래그:34:18 = 1
					CALL SET_BATTLE_STATUS(CHARANUM-1, 120, "ＨＰ")
					CALL SYNC_STATUS, CHARANUM- 1
					CALL HEALTH_CHARA, CHARANUM-1
				NEXT
			ELSE
				던전플래그:34:18 = 0
				CALL MESSAGE_WINDOW_D, "", "＞통로를 막는 듯이 머신이 있다"
				CALL MESSAGE_WINDOW_D, "머신", "침 입 자 발 견.　배 제 합 니 다"
				CALL MESSAGE_WINDOW_D, "", "＞비트볼이 3체 나타났다！"
				CALL SET_ENEMY,8,[[キャラ:비트볼]],13,0,0
				CALL SET_ENEMY,9,[[キャラ:비트볼]],13,0,0
				CALL SET_ENEMY,10,[[キャラ:비트볼]],13,0,0
			ENDIF
			CALL BATTLE_START
			FLAG:도주불가플래그 = 0
			FLAG:회화불능플래그 = 0
			FLAG:선제기습취소 = 0
			FLAG:RESULT스킵 = 0
			IF 던전플래그:34:32
				CALL 캐릭터삭제(GETCHARA([[キャラ:모・쇼보]]))
				IF 던전플래그:34:18 == 2
					FLAG:현Y -= 2
					CALL SHOW_PICTURE, "D"
					CALL MESSAGE_WINDOW_D, "고우토", "후, 과연 식은 땀이 났다고/신입이여, 과연 여기서 미스하는 것은 농담도 되지 않는다/계속、모・쇼보를 불러둘테니까 다음은 잘 부탁한다"
					던전플래그:34:18 = 0
					던전플래그:34:14 = -1
					RETURN 0
				ENDIF
				던전플래그:34:18 = 0
				CALL SHOW_PICTURE, "D"
				CALL MESSAGE_WINDOW_D, "흉조 모・쇼보", "힘들어~/저기~, 이제 걍 가도 좋아?"
				CALL MESSAGE_WINDOW_D, "", "＞라이도우가 고개를 끄덕이며 모・쇼보를 귀환시켰다/＞모・쇼보가 파티에서 나갔다"
				CALL MESSAGE_WINDOW_D, "고우토", "어떤가?/링케이지의 강력함. 알아차렸나?/자네와 동료마뿐만 아니라, 동료마와 동료마라도 링케이지는 가능하다"
				CALL MESSAGE_WINDOW_D, "고우토", "이렇게 힘을 모을 수 있도록/동료마를 모아가는 것도 한 방법이다/하긴 이것을 위해서는 스킬의 조합법을 알지 않으면 안되겠지만…"
				CALL MESSAGE_WINDOW_D, "고우토", "일단、이 ＣＯＭＰ에도/어느정도 레시피가 등록되어있지?/전투중에 링케이지를 선택해、/거기에서 애널라이즈해서 확인하는 것이다"
				CALL MESSAGE_WINDOW_D, "고우토", "또、지금부터 새롭게 발견한 레시피도/등록되어、확인할 수 있게된다/어찌되었던、/이것저것 시험해보면、언젠가는 알게될 것이다"
			ENDIF
			던전플래그:34:14 = 1
			CALL CLEAR_TILE
		ENDIF
	CASE 9
		IF FLAG:현X == 8 && FLAG:현Y == 9 && 던전플래그:34:8 == 0
			;部屋をアナライズし표시更新
			CALL SET_FLOOR_ANALYZE(2, FLAG:현던전, FLAG:현M, 8, 11)
			FOR LOCAL:1, 6, 13
				FOR LOCAL, 9, 13
					CALL SET_FLOOR_ANALYZE(2, FLAG:현던전, FLAG:현M, LOCAL, LOCAL:1)
				NEXT
			NEXT
			CALL MESSAGE_WINDOW_D, "", "＞수 많은 모니터와 컴퓨터가 늘어진 방의 방의 안에,/한마리의 악마가 모니터를 쳐다보고 있다"
			CALL MESSAGE_WINDOW_D, "타천사 단탈리온", "네 녀석, 뭐하는 놈이냐!/……아니, 뭐하는 놈인지는 관계없어/마침 ＭＡＧ에 굶주리고 있을 무렵이었으니/네 녀석에게서 뽑아내마!"
			CALL MESSAGE_WINDOW_D, "", "＞타천사 단탈리온이 １체 나타났다！"
			FLAG:도주불가플래그 = 1
			FLAG:회화불능플래그 = 1
			FLAG:선제기습취소 = 1
			;チュートリアルだとLVが減る
			IF 던전플래그:34:30
				CALL SET_ENEMY,9, [[キャラ:단탈리온]],8,0,1
			ELSE
				CALL SET_ENEMY,9, [[キャラ:단탈리온]],15,0,1
			ENDIF
			CFLAG:(CHARANUM-1):행동횟수 = 2
			CFLAG:(CHARANUM-1):ＨＰ보정 += 400
			ABL:(CHARANUM-1):아이템3 = 278
			ABL:(CHARANUM-1):입수확률3 = 100
			CALL SYNC_STATUS,(CHARANUM-1)
			CALL HEALTH_CHARA,(CHARANUM-1)
			CALL BATTLE_START
			FLAG:도주불가플래그 = 0
			FLAG:회화불능플래그 = 0
			FLAG:선제기습취소 = 0
			CALL MESSAGE_WINDOW_D, "", "＞타천사 단탈리온은 힘이 다했다…"
			CALL MESSAGE_WINDOW_D, "", @"%CALLNAME:MASTER%은 단탈리온이 조작하고 있던 컴퓨터의 화면을 들여다봤다…/화면에는 스크립트가 춤추고 있다…/자세한 내용은 모르겠지만,/아무래도 인스톨 소프트인 것 같다"
			CALL MESSAGE_WINDOW_D, "", "＞적당히 조작을 해서, 소프트의 설명서를 발견했다/＞『새로운 의식에 적응하여, 새로운 솔로몬의 열쇠를 작성……』/＞『천사를 추방해, 우리들의 길을 열기 위한 프로그램……』"
			CALL MESSAGE_WINDOW_D, "", @"＞아무래도, 이것은 컨버터인 것 같다/＞게다가, 벌써 완성이 끝난 상태인 것 같다……/＞%조사처리(CALLNAME:MASTER,"는")% 소프트를 다운로드하기로 했다…/＞인스톨 소프트【고에티아】를 손에 넣었다…"
			;라이도우
			LOCAL = GETCHARA([[キャラ:라이도우]])
			IF LOCAL >= 0 && !CFLAG:LOCAL:인계횟수
				CALL MESSAGE_WINDOW_D, "고우토", "아무래도 여기는 우리들이 찾고 있는 장소가 아닌 듯 하군/펜텀의 서머너여/함께하는 것은 여기까지다"
				CALL MESSAGE_WINDOW_D, "고우토", "오늘 가르쳐준 것을 잊지 않고/당신 스스로 수련하여, 강해지는 것이다"
				CALL MESSAGE_WINDOW_D, "고우토", "그렇지……/돌아가면, 우선은[120] 사교의관에 가면 좋을 것이다/거기서 동료마끼리를 합체시켜, 보다 강력한 동료마를 얻을 수 있다"
				CALL MESSAGE_WINDOW_D, "고우토", "서머너에게 있어 강해진다고 하는 것은/요컨데 보다 강력한 동료마를 만드는 것이다/TALK로 동료마를 권하는 것도 중요하지만, 합체도 소홀히는 할 수는 없다"
				CALL MESSAGE_WINDOW_D, "고우토", "라고 해도, 네 자신도 또 강해지지 않으면/강력한 동료마를 따르게 할 수 없지만……/네가 강해지면, 그 만큼 강한 동료마를 얻을 수 있는 것을/제대로 기억해두는 것이 좋다"
				CALL MESSAGE_WINDOW_D, "고우토", "나머지는 그렇지/[122] 동료마강화도 시험해 보아야 한다/지금 있는 너의 동료마를 더욱 강화할 수가 있다"
				CALL MESSAGE_WINDOW_D, "고우토", "MAG만 있으면, 힘이나 마력이라고 하는 스테이터스를 늘리는 것 외에도/궁합이나 공격 범위등 여러가지 능력을 변경할 수 있다/아무튼, 그 MAG를 준비하는 것이 어렵지만…"
				CALL MESSAGE_WINDOW_D, "", "＞라이도우는 고우토에게 귓속말을 하고는/＞1장의 카드를 내밀어 왔다/＞스킬카드【갈】을 손에 넣었다"
				CALL GET_ITEMS,"스킬카드【갈】", 1
				CALL MESSAGE_WINDOW_D, "고우토", "미안하군/중요한 일을 말하는 것을 잊고 있었다/그 카드는 스킬 카드라고 해서,/마법이나 특기의 힘을 내포하고 있다"
				CALL MESSAGE_WINDOW_D, "고우토", "[122] 동료마강화에서는 그 카드와 MAG를 사용해,/동료마에 스킬을 기억하게 할 수가 있다/그 카드라면 당연히 갈이다"
				CALL MESSAGE_WINDOW_D, "고우토", "조금 전에는 모·쇼보와 함께 링케이지를 했지만/그 카드를 사용하면 너의 동료마와 링케이지 할 수도 있다/어때?　편리하겠지? "
				CALL MESSAGE_WINDOW_D, "고우토", "그리고 카드는 줍거나 받기도 할 수 있지만……/그 외에 사교의 관에서 동료마의 힘을/카드화 하는 것으로 모을 수도 있을 것이다"
				CALL MESSAGE_WINDOW_D, "고우토", "아무튼……그렇게 하기 위해서는 동료마에게 신뢰 받지 않으면 안 되고/카드화해 버리면 그 동료마로부터 스킬은 없어지지만……/이 부분에 에 대해서는 잘 생각해야 할 것이다"
				CALL MESSAGE_WINDOW_D, "고우토", "아차, [115] 정크숍이나 [114] 마카교환도 잊지 마라/돈이나 마카를 사용하는 것으로 여러가지 장비나 아이템, 거기에 인스톨 소프트 등도 살 수 있다"
				CALL MESSAGE_WINDOW_D, "고우토", "아이템의 유용성은 오늘의 싸움으로 잘 알았다고 생각하지만/장비의 중요함도 잊어서는 안된다/당연한 일이지만 인간은 악마에 비해 힘이 약하다"
				CALL MESSAGE_WINDOW_D, "고우토", "방어구가 없으면 악마의 공격에는 견딜 수 없고/무기가 없으면 데미지를 주는 일도 어렵다/아니, 그 뿐만 아니라 무기가 나쁘면 공격도 맞출 수 없게 된다"
				CALL MESSAGE_WINDOW_D, "고우토", "마법을 사용하는 인간이라도 무기에 깃들은 마력이나/방어구에 깃든 마법 효과를 이용하지 않으면/마법을 유효하게 사용하는 일도 할 수 없다"
				CALL MESSAGE_WINDOW_D, "고우토", "요컨데 인간이 악마와 서로 싸우려면 돈이 필요하다 라는 것이다/장비에, 아이템에,/인스톨 소프트에, 무엇이 필요하게 될지 모른다"
				CALL MESSAGE_WINDOW_D, "고우토", "이전에 아무렇지도 않게 사 둔 것이/의외로 도움이 된다고 하는 일도 있다/낭비를 하라고 말하는 것은 아니지만,/그렇게 까지 째째하게 굴만한 일도 아니다"
				CALL MESSAGE_WINDOW_D, "고우토", "아무튼, 어쨌든, 강해지기 위한 노력을 아끼지 않는 것이다/그렇지 않으면, 살아 남을 수 없는 세계다/그러면, 인연이 있으면 또 만나는 일도 있을 것이다"
				CALL MESSAGE_WINDOW_D, "", "＞고우토와 라이도우가 PT를 떠났다"
				CALL DEL_GUEST, LOCAL
			ENDIF
			CALL MESSAGE_WINDOW_D, "", "＞하츠다이쉘터를 제압했다"
			IF 던전플래그:34:30
				CALL MESSAGE_WINDOW_D, "", "＞보수로 ￥10000이 지불되었다"
				MONEY += 10000
			ELSE
				CALL MESSAGE_WINDOW_D, "", "＞보수로 ￥35000이 지불되었다"
				MONEY += 35000
			ENDIF
			ITEM:고에티아 += 1
			ITEM:라비스질 += 1
			던전플래그:34:8 = 1
			던전플래그:34:10 = 1
			던전플래그:34:13 = 2
			던전플래그:34:32 = 0
			CALL CLEAR_TILE
			FLAG:탈출스킬금지 = 0
			FLAG:탈출 = 1
			RETURN 1
		ENDIF
	CASEELSE
	ENDSELECT
	RETURN 1
RETURN 0
;=======================================================================
;宝箱まとめ
;=======================================================================
@TRESURING_CALLING_34
SELECTCASE FLAG:현M
	CASE 5
		CALL GET_TREASURE,1017,2,34,1
	CASE 6
		IF FLAG:현X == 1 && FLAG:현Y == 8
			CALL GET_TREASURE,1001,3,34,15
		ELSEIF FLAG:현X == 12 && FLAG:현Y == 3
			CALL GET_TREASURE,1002,2,34,2
		ENDIF
	CASE 7
		CALL GET_TREASURE,1005,1,34,3
	CASE 8
		IF FLAG:현X == 13 && FLAG:현Y == 8
			CALL GET_TREASURE,2005,1,34,4
		ELSEIF FLAG:현X == 5 && FLAG:현Y == 7
			;チュートリアルを受けた場合は디스포이즌
			IF 던전플래그:34:30
				CALL GET_TREASURE,GETNUM(ITEM, "디스포이즌"),3,34,5
			ELSE
				CALL GET_TREASURE,GETNUM(ITEM, "쇠파이프형산탄총"),1,34,5
			ENDIF
		ENDIF
	CASE 9
		CALL GET_TREASURE,1034,2,34,6
ENDSELECT
RETURN 0


@SYODAI_E
CALL MESSAGE_WINDOW_D, "", "＞엘리베이터와 같……지만, 악마에 부숴져 있다"

@SET_GUEST_D34
#LOCALSIZE 1
CALL ADD_GUEST_COMPANION(4542, 0, 1)
CALL MESSAGE_WINDOW_D, "", @"＞쿠즈노하 라이도우가 %CALLNAME:MASTER%의 파티에 참가했다 %\@RESULT:1 >= 0 ? /＞%CALLNAME:(RESULT:1)%를 COMP에 되돌렸으므로 주의해 주세요#\@%"
LOCAL = GETCHARA(4542)
BASE:LOCAL:LV += 10
BASE:LOCAL:ＭＡＧ = 0
BASE:LOCAL:힘 += 6
BASE:LOCAL:지혜 += 5
BASE:LOCAL:마력 += 5
BASE:LOCAL:인내력 += 5
BASE:LOCAL:속도 += 6
BASE:LOCAL:운 += 5
ABL:(CHARANUM-1):스킬2 = 308
ABL:(CHARANUM-1):스킬3 = 813
ABL:(CHARANUM-1):스킬4 = 914
ABL:(CHARANUM-1):스킬5 = 1710
ABL:(CHARANUM-1):스킬7 = 515
ABL:(CHARANUM-1):스킬8 = 2430
CALL SYNC_STATUS, LOCAL
CALL HEALTH_CHARA, LOCAL


;=====================================================================
;ターミナル
;=====================================================================
@RAIDOU_TERMINAL
CALL SHOW_PICTURE, "D"
CALL MESSAGE_WINDOW_D, "", "＞터미널이 있다"
CALL MESSAGE_WINDOW_D, "터미널", "이쪽은 하츠다이 쉘터 터미널입니다/용무를 부탁합니다"
$START
CALL INPUT_SELECT_D, "[1] 세이브/[2] 인스톨 소프트 변경/[3] 자신의 방으로 돌아간다/[0] 아무것도안한다"
IF RESULT == 0
	RETURN 1
ELSEIF RESULT == 1
	CALL TITLE_SAVEGAME
ELSEIF RESULT == 2
	CALL SETUP_SOFT
ELSEIF RESULT == 3
	LOCAL = GETCHARA([[キャラ:라이도우]])
	IF LOCAL >= 0 && !CFLAG:LOCAL:인계횟수
		CALL MESSAGE_WINDOW_D, "고우토", "돌아갈 건가？/우리가 너희에게 가르쳐줄 수 있는 기회는/오늘 밖에 없다"
		CALL INPUT_YN_D
		IF RESULT == 0
			CALL MESSAGE_WINDOW_D, "고우토", "그럼、 작별이다/우리들은 이 땅에서 조사하기 않으면 안될 것이 있다"
			CALL MESSAGE_WINDOW_D, "", "＞고우토와 라이도우가 ＰＴ에서 이탈했다"
			던전플래그:34:13 = 1
			던전플래그:34:32 = 0
			CALL DEL_GUEST, LOCAL
			FLAG:탈출스킬금지 = 0
			CALL MESSAGE_WINDOW_D, "터미널", "전송을 시작합니다"
			CALL MESSAGE_WINDOW_D, "", @"＞%CALLNAME:MASTER% 일행은 자신의 방으로 귀환하였다"
			FLAG:탈출 = 1
		ELSE
			CALL MESSAGE_WINDOW_D, "고우토", "그렇다면、탐색을 계속하자"
			CALL MESSAGE_WINDOW_D, "", "＞고우토가 재촉하듯이 던전의 앞을 가리켰다" 
			FLAG:탈출 = 0
		ENDIF
	ELSE
		FLAG:탈출 = 1
		FLAG:탈출스킬금지 = 0
	ENDIF
	RETURN 1
ENDIF
GOTO START

@EVENT_BATTLE_ACTEND_DUNGEON34
SIF 던전플래그:34:32 == 0
	RETURN 0
CALL SYNC_STATUS, MASTER
SIF BASE:MASTER:ＨＰ > 0
	RETURN 0
CALL MESSAGE_B(2, "큭、이건 위험해！", "라이도우！　여긴 일단 후퇴한다！")
PRINTL 
PRINTFORMW ＞라이도우는 %CALLNAME:MASTER%의 팔을 잡고 빠져나갔다
PRINTL 
BASE:MASTER:ＨＰ = 1
CFLAG:MASTER:상태이상 = GET_STATE_NUM("GOOD")
FLAG:승리플래그 = 1
FLAG:패배플래그 = 0
던전플래그:34:18 = 2
RETURN -1
@EVENT_BATTLE_TURNEND_DUNGEON34
SIF 던전플래그:34:18 != 1
	RETURN 0
CALL MESSAGE_B(2, "큭、실패했는가", "라이도우！　여긴 일단 후퇴한다！")
FLAG:승리플래그 = 1
던전플래그:34:18 = 2
PRINTL 
PRINTFORMW ＞라이도우는 %CALLNAME:MASTER%의 팔을 잡고 빠져나갔다
PRINTL 
RETURN -1
@SET_ACTION_チュートリアル좀비, ARG
IF CPOS(MASTER) > 3
	CFLAG:ARG:입력행동 = -1
ELSE
	CFLAG:ARG:입력행동 = [[스킬:할퀴기]]
	CFLAG:ARG:타겟 = CPOS(MASTER)
ENDIF
@SET_ACTION_チュートリアル비트볼, ARG
CFLAG:ARG:입력행동 = [[스킬:전격]]
CFLAG:ARG:타겟 = CPOS(MASTER)


@SET_ACTION_チュートリアル키쿠리히메, ARG
CFLAG:ARG:입력행동 = [[스킬:무드]]
MAXBASE:MASTER:주살 = 3000
CFLAG:ARG:타겟 = CPOS(MASTER)


;=======================================================================
;윤간참가악마
;=======================================================================
@DUNGEON_RAPE_DEVIL_34
;랜덤にどの악마が出るか決定
;RETURN CSV번호 , 人数 , 레벨
SELECTCASE RAND:4
	CASE 0
		RETURN [[キャラ:노커]] , 6 + RAND:15 , CSVBASE([[キャラ:노커]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 1
		RETURN [[キャラ:코볼트]] , 3 + RAND:10 , CSVBASE([[キャラ:코볼트]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 2
		RETURN [[キャラ:아귀]] , 3 + RAND:10 , CSVBASE([[キャラ:아귀]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 3
		RETURN [[キャラ:좀비군]] , 3 + RAND:10 , CSVBASE([[キャラ:좀비군]] , GETNUM(BASE , "LV") , 0) + RAND:3
ENDSELECT


