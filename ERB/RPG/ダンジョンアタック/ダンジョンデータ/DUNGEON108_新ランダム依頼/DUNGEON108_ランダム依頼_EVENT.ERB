;========================================

;戦闘開始時の処理

;========================================
@EVENT_BATTLE_START_DUNGEON108
TRYCALLFORM EVENT_BATTLE_START_DUNGEON108_{의뢰플래그:108:1}




;========================================
;行動終了時の処理
;========================================
@EVENT_BATTLE_ACTEND_DUNGEON108
SELECTCASE 의뢰플래그:108:1
	;強奪部隊追撃
	CASE 7
		
		LOCAL = FLAG:행동순1
		SIF CFLAG:LOCAL:PT플래그 == 0
			RETURN 0
		SIF LOCAL < 0
			RETURN 0
		SIF CFLAG:LOCAL:상태이상 == GET_STATE_NUM("DYING")
			RETURN 0
		IF MAXBASE:LOCAL:화염 == 999
			LOCAL:1 = 0
		ELSE
			LOCAL:1 = RAND:20 + 50
			IF CFLAG:LOCAL:화염무효화횟수 > 0
				LOCAL:1 = 0
				CFLAG:LOCAL:화염무효화횟수 -= 1
			ELSE
				LOCAL:1 = LOCAL:1 * MAXBASE:LOCAL:화염 / 100
			ENDIF
		ENDIF
		
		IF LOCAL:1 < 0
			LOCALS:1 = {-LOCAL:1}회복
		ELSEIF LOCAL:1 == 0
			LOCALS:1 = BLOCK
		ELSE
			LOCALS:1 = {LOCAL:1}데미지
		ENDIF
		
		SELECTCASE 의뢰플래그:108:1
			CASE 7
				LOCALS = トラップの爆発が%CALLNAME:LOCAL%を襲う！
		ENDSELECT
		
		SETCOLORBYNAME Red
		CALL MESSAGE_B(1, LOCALS)
		PRINTFORMW TARGET:[{LOCAL,2}] %CALLNAME:LOCAL,20,LEFT%　>>>>>>　%LOCALS:1%
		RESETCOLOR
		CALL VAR_HP, LOCAL, -(LOCAL:1), 0
		
	;ドリアードを間引いてくれ
	CASE 57
		LOCAL = FLAG:행동순1
		SIF CFLAG:LOCAL:PT플래그 == 0
			RETURN 0
		SIF LOCAL < 0
			RETURN 0
		SIF CFLAG:LOCAL:상태이상 == GET_STATE_NUM("DYING")
			RETURN 0
		IF MAXBASE:LOCAL:신경 == 999
			LOCAL:1 = 0
		ELSE
			LOCAL:1 = RAND:20 + 50
			IF CFLAG:LOCAL:신경무효화횟수 > 0
				LOCAL:1 = 0
				CFLAG:LOCAL:신경무효화횟수 -= 1
			ELSE
				LOCAL:1 = LOCAL:1 * MAXBASE:LOCAL:신경 / 100
			ENDIF
		ENDIF
		IF LOCAL:1 < 0
			LOCALS:1 = {-LOCAL:1}회복
		ELSEIF LOCAL:1 == 0
			LOCALS:1 = BLOCK
		ELSE
			LOCALS:1 = {LOCAL:1}ダメージ
		ENDIF
		SELECTCASE 의뢰플래그:108:1
			CASE 57
				LOCALS = ＭＡＧで有毒に変異した花粉が%CALLNAME:LOCAL%を襲う！
		ENDSELECT
		SETCOLORBYNAME Red
		CALL MESSAGE_B(1, LOCALS)
		PRINTFORMW TARGET:[{LOCAL,2}] %CALLNAME:LOCAL,20,LEFT%　>>>>>>　%LOCALS:1%
		RESETCOLOR
		CALL VAR_HP, LOCAL, -(LOCAL:1), 0
ENDSELECT