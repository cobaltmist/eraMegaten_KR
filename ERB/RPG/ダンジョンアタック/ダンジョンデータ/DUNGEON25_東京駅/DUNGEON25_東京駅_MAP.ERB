;FLAG:現M == 12 の時に左下の３列のホーム左端をランランダンジョンで歩くとエラー落ちする問題を応急処置

;=======================================================================
;フロア名表示
;=======================================================================
@FLOORNAME_TOKYO_STATION
PRINT 이계화한 도쿄 역
SELECTCASE FLAG:현M
	CASE 10
		PRINTL 　B１Ｆ
	CASE 11
		PRINTL 　１Ｆ
	CASE 12
		PRINTL 　홈
	CASE 13
		PRINTL 　구 도쿄 역사３Ｆ
	CASE 14
		PRINTL 　팔각 돔
ENDSELECT

;=======================================================================
;フロアデータ
;=======================================================================

;0：壁　1：床もしくは通路　2：扉　3：宝箱　4：イベント　5：罠　6：上り階段 7：下り階段　8：出口　9：その他特殊処理等
;これらの内、3～9が代入されているマスに、個別の番号を与える処理を実行します。
;この処理を行った後、これらのマスには 「マップ番号*1000 + そのマスがそのマップで左上から数えて何個目のARGタイプのマスか*10 + ARG」が代入されます
;例えば 2003 であった場合、「2番のマップ＝３Ｆで、左上から数えて0個目の3＝宝箱である」という事を意味しています
;尚、0～2はどのマップにも大量に設置されるので、ここでは基本的に個別の番号を与えません。


@MAKE_FLOOR_TOKYO_STATION
SELECTCASE FLAG:현M
	CASE 10
	;B１階
		FLAG:최대X = 40
		FLAG:최대Y = 30
		;								   1		 2		   3		 4
		;						 01234567890123456789012345678901234567890
		CALL MAKE_FLOOR_LINE, 0," 8                                      "
		CALL MAKE_FLOOR_LINE, 1," 1                                      "
		CALL MAKE_FLOOR_LINE, 2," 11                                     "
		CALL MAKE_FLOOR_LINE, 3,"  1                   111111111         "
		CALL MAKE_FLOOR_LINE, 4,"  1                   111111111         "
		CALL MAKE_FLOOR_LINE, 5,"  111111111111111111   11     1         "
		CALL MAKE_FLOOR_LINE, 6,"  11        11 11111   11    11         "
		CALL MAKE_FLOOR_LINE, 7," 111      111111111111111     1         "
		CALL MAKE_FLOOR_LINE, 8," 111      111111111    11     1         "
		CALL MAKE_FLOOR_LINE, 9," 111      11111111     111111 1         "
		CALL MAKE_FLOOR_LINE,10," 111      11111   1111111111111         "
		CALL MAKE_FLOOR_LINE,11," 111      11111 111111111  111111       "
		CALL MAKE_FLOOR_LINE,12," 111      1111  111111111    11 1111    "
		CALL MAKE_FLOOR_LINE,13," 111           61      1111111     11118"
		CALL MAKE_FLOOR_LINE,14," 111                   1111111          "
		CALL MAKE_FLOOR_LINE,15," 111                   1111111          "
		CALL MAKE_FLOOR_LINE,16,"  11                1111111111          "
		CALL MAKE_FLOOR_LINE,17,"  11                   11    1          "
		CALL MAKE_FLOOR_LINE,18,"  1111                 11    1          "
		CALL MAKE_FLOOR_LINE,19,"     1                 11    1          "
		CALL MAKE_FLOOR_LINE,20,"    11                 11    1          "
		CALL MAKE_FLOOR_LINE,21,"    111111111     111111111111          "
		CALL MAKE_FLOOR_LINE,22,"     11111111     111111111111          "
		CALL MAKE_FLOOR_LINE,23,"         11111111 1111111111111111111118"
		CALL MAKE_FLOOR_LINE,24,"           1111111111111111111          "
		CALL MAKE_FLOOR_LINE,25,"                 1111111111111          "
		CALL MAKE_FLOOR_LINE,26,"                       1111111          "
		CALL MAKE_FLOOR_LINE,27,"                          1111          "
		CALL MAKE_FLOOR_LINE,28,"                             1          "
		CALL MAKE_FLOOR_LINE,29,"                                        "
		;						 01234567890123456789012345678901234567890
		;								   1		 2		   3		 4
		;던전플래그:25:12 == 0なら、X == 2,Y == 5にイベント(4)を設置
		CALL SET_TILE, 2 , 5 , 던전플래그:25:12 , 0 , 4
			
	;1F
	CASE 11
		IF 던전플래그:25:11 == 0;強行突破してない
			FLAG:최대X = 40
			FLAG:최대Y = 30
			;								   1		 2		   3		 4
			;						 01234567890123456789012345678901234567890
			CALL MAKE_FLOOR_LINE, 0,"                    888                 "
			CALL MAKE_FLOOR_LINE, 1,"     11111111       111            11   "
			CALL MAKE_FLOOR_LINE, 2,"     1111111111A1111111111111111111111  "
			CALL MAKE_FLOOR_LINE, 3,"  11111111111       111          111611 "
			CALL MAKE_FLOOR_LINE, 4," 71      1111       111          111111 "
			CALL MAKE_FLOOR_LINE, 5,"          111       111           1111  "
			CALL MAKE_FLOOR_LINE, 6,"          111       111            11   "
			CALL MAKE_FLOOR_LINE, 7,"          111       111            11   "
			CALL MAKE_FLOOR_LINE, 8,"          111      61116           11   "
			CALL MAKE_FLOOR_LINE, 9,"          111       AAA            11   "
			CALL MAKE_FLOOR_LINE,10,"          111       111            11   "
			CALL MAKE_FLOOR_LINE,11,"          111      61116           11   "
			CALL MAKE_FLOOR_LINE,12,"          111       AAA            11   "
			CALL MAKE_FLOOR_LINE,13,"          111       111            11   "
			CALL MAKE_FLOOR_LINE,14,"          111      61116           11   "
			CALL MAKE_FLOOR_LINE,15,"          111       AAA                 "
			CALL MAKE_FLOOR_LINE,16,"           1111111111111111111111111111 "
			CALL MAKE_FLOOR_LINE,17,"           1111111111111111111111111111 "
			CALL MAKE_FLOOR_LINE,18,"         1111111    111111111   11   11 "
			CALL MAKE_FLOOR_LINE,19,"         1111 AA    111111111   AA   11 "
			CALL MAKE_FLOOR_LINE,20,"        111  6116   111111111  6116  11 "
			CALL MAKE_FLOOR_LINE,21,"      11111   11    111111111   11   11 "
			CALL MAKE_FLOOR_LINE,22,"81111111111   11    111111111   11   118"
			CALL MAKE_FLOOR_LINE,23,"81111111111   11    111   111   11      "
			CALL MAKE_FLOOR_LINE,24,"      11 1111111    111   11111111      "
			CALL MAKE_FLOOR_LINE,25,"      11 1111111    111   11111111      "
			CALL MAKE_FLOOR_LINE,26,"      11  11  1     111      11         "
			CALL MAKE_FLOOR_LINE,27,"      11  11  1     111      11         "
			CALL MAKE_FLOOR_LINE,28,"      11  11  1     111      11         "
			CALL MAKE_FLOOR_LINE,29,"      88  88  8     888      88         "
			;						 01234567890123456789012345678901234567890
			;								   1		 2		   3		 4
			;キョウジ戦前
			;X == 8,Y == 2にイベントを設置
			CALL SET_TILE, 8 ,  2 , 던전플래그:25:10 , 0 , 4
			;X == 13,Y == 2に壁を設置
			CALL SET_TILE, 13 , 2 , 던전플래그:25:10 , 0 , 0
			;X == 10,Y == 5に壁を設置
			CALL SET_TILE, 10 , 5 , 던전플래그:25:10 , 0 , 0
			;X == 11,Y == 5に壁を設置
			CALL SET_TILE, 11 , 5 , 던전플래그:25:10 , 0 , 0
			;X == 12,Y == 5に壁を設置
			CALL SET_TILE, 12 , 5 , 던전플래그:25:10 , 0 , 0
				
		ELSEIF 던전플래그:25:11 == 1;強行突破済み
			FLAG:최대X = 40
			FLAG:최대Y = 30
			;								   1		 2		   3		 4
			;						 01234567890123456789012345678901234567890
			CALL MAKE_FLOOR_LINE, 0,"                    888                 "
			CALL MAKE_FLOOR_LINE, 1,"     11111111       111            11   "
			CALL MAKE_FLOOR_LINE, 2,"     111111111111111111111111111111111  "
			CALL MAKE_FLOOR_LINE, 3,"  11111111111       111          111611 "
			CALL MAKE_FLOOR_LINE, 4," 71      1111       111          111111 "
			CALL MAKE_FLOOR_LINE, 5,"          111       111           1111  "
			CALL MAKE_FLOOR_LINE, 6,"          111       111            11   "
			CALL MAKE_FLOOR_LINE, 7,"          111       111            11   "
			CALL MAKE_FLOOR_LINE, 8,"          111      61116           11   "
			CALL MAKE_FLOOR_LINE, 9,"          111       111            11   "
			CALL MAKE_FLOOR_LINE,10,"          111       111            11   "
			CALL MAKE_FLOOR_LINE,11,"          111      61116           11   "
			CALL MAKE_FLOOR_LINE,12,"          111       111            11   "
			CALL MAKE_FLOOR_LINE,13,"          111       111            11   "
			CALL MAKE_FLOOR_LINE,14,"          111      61116           11   "
			CALL MAKE_FLOOR_LINE,15,"          111       111                 "
			CALL MAKE_FLOOR_LINE,16,"           1111111111111111111111111111 "
			CALL MAKE_FLOOR_LINE,17,"           1111111111111111111111111111 "
			CALL MAKE_FLOOR_LINE,18,"         1111111    111111111   11   11 "
			CALL MAKE_FLOOR_LINE,19,"         1111 11    111111111   11   11 "
			CALL MAKE_FLOOR_LINE,20,"        111  6116   111111111  6116  11 "
			CALL MAKE_FLOOR_LINE,21,"      11111   11    111111111   11   11 "
			CALL MAKE_FLOOR_LINE,22,"81111111111   11    111111111   11   118"
			CALL MAKE_FLOOR_LINE,23,"81111111111   11    111   111   11      "
			CALL MAKE_FLOOR_LINE,24,"      11 1111111    111   11111111      "
			CALL MAKE_FLOOR_LINE,25,"      11 1111111    111   11111111      "
			CALL MAKE_FLOOR_LINE,26,"      11  11  1     111      11         "
			CALL MAKE_FLOOR_LINE,27,"      11  11  1     111      11         "
			CALL MAKE_FLOOR_LINE,28,"      11  11  1     111      11         "
			CALL MAKE_FLOOR_LINE,29,"      88  88  8     888      88         "
			;						 01234567890123456789012345678901234567890
			;								   1		 2		   3		 4
		ENDIF
	;ホーム(2F)
	CASE 12
		IF 던전플래그:25:11 == 0;強行突破してない
			FLAG:최대X = 40
			FLAG:최대Y = 30
			;								   1		 2		   3		 4
			;						 01234567890123456789012345678901234567890
			CALL MAKE_FLOOR_LINE, 0,"                                        "
			CALL MAKE_FLOOR_LINE, 1,"                                   11   "
			CALL MAKE_FLOOR_LINE, 2,"                                  1111  "
			CALL MAKE_FLOOR_LINE, 3,"                                 116711 "
			CALL MAKE_FLOOR_LINE, 4,"                                 111111 "
			CALL MAKE_FLOOR_LINE, 5,"                                  1111  "
			CALL MAKE_FLOOR_LINE, 6,"                                   11   "
			CALL MAKE_FLOOR_LINE, 7,"                                        "
			CALL MAKE_FLOOR_LINE, 8,"111111111111111111171A171111111111111111"
			CALL MAKE_FLOOR_LINE, 9,"111111111111111111111A111111111141111111"
			CALL MAKE_FLOOR_LINE,10,"                                        "
			CALL MAKE_FLOOR_LINE,11,"111111111111111111171A171111111141111111"
			CALL MAKE_FLOOR_LINE,12,"111111111411111111111A111111111111111111"
			CALL MAKE_FLOOR_LINE,13,"                                        "
			CALL MAKE_FLOOR_LINE,14,"111111111411111111171A171111111111111111"
			CALL MAKE_FLOOR_LINE,15,"111111111111111111111A111111111141111111"
			CALL MAKE_FLOOR_LINE,16,"                                        "
			CALL MAKE_FLOOR_LINE,17,"                                        "
			CALL MAKE_FLOOR_LINE,18,"                                        "
			CALL MAKE_FLOOR_LINE,19," 11111111111111111111A111111111141111111"
			CALL MAKE_FLOOR_LINE,20," 11111111111171171111A111111111711711111"
			CALL MAKE_FLOOR_LINE,21," 11111111111111111111A111111111111111111"
			CALL MAKE_FLOOR_LINE,22,"                                        "
			CALL MAKE_FLOOR_LINE,23,"                                        "
			CALL MAKE_FLOOR_LINE,24,"                                        "
			CALL MAKE_FLOOR_LINE,25,"                                        "
			CALL MAKE_FLOOR_LINE,26,"                                        "
			CALL MAKE_FLOOR_LINE,27,"                                        "
			CALL MAKE_FLOOR_LINE,28,"                                        "
			CALL MAKE_FLOOR_LINE,29,"                                        "
			;						 01234567890123456789012345678901234567890
			;								   1		 2		   3		 4
		ELSEIF 던전플래그:25:11 == 1;強行突破した
			FLAG:최대X = 40
			FLAG:최대Y = 30
			;								   1		 2		   3		 4
			;						 01234567890123456789012345678901234567890
			CALL MAKE_FLOOR_LINE, 0,"                                        "
			CALL MAKE_FLOOR_LINE, 1,"                                   11   "
			CALL MAKE_FLOOR_LINE, 2,"                                  1111  "
			CALL MAKE_FLOOR_LINE, 3,"                                 116711 "
			CALL MAKE_FLOOR_LINE, 4,"                                 111111 "
			CALL MAKE_FLOOR_LINE, 5,"                                  1111  "
			CALL MAKE_FLOOR_LINE, 6,"                                   11   "
			CALL MAKE_FLOOR_LINE, 7,"                                        "
			CALL MAKE_FLOOR_LINE, 8,"1111111111111111111711171111111111111111"
			CALL MAKE_FLOOR_LINE, 9,"1111111111111111111111111111111141111111"
			CALL MAKE_FLOOR_LINE,10,"                                        "
			CALL MAKE_FLOOR_LINE,11,"1111111111111111111711171111111141111111"
			CALL MAKE_FLOOR_LINE,12,"1111111114111111111111111111111111111111"
			CALL MAKE_FLOOR_LINE,13,"                                        "
			CALL MAKE_FLOOR_LINE,14,"1111111114111111111711171111111111111111"
			CALL MAKE_FLOOR_LINE,15,"1111111111111111111111111111111141111111"
			CALL MAKE_FLOOR_LINE,16,"                                        "
			CALL MAKE_FLOOR_LINE,17,"                                        "
			CALL MAKE_FLOOR_LINE,18,"                                        "
			CALL MAKE_FLOOR_LINE,19," 111111111111111111111111111111141111111"
			CALL MAKE_FLOOR_LINE,20," 111111111111711711111111111111711711111"
			CALL MAKE_FLOOR_LINE,21," 111111111111111111111111111111111111111"
			CALL MAKE_FLOOR_LINE,22,"                                        "
			CALL MAKE_FLOOR_LINE,23,"                                        "
			CALL MAKE_FLOOR_LINE,24,"                                        "
			CALL MAKE_FLOOR_LINE,25,"                                        "
			CALL MAKE_FLOOR_LINE,26,"                                        "
			CALL MAKE_FLOOR_LINE,27,"                                        "
			CALL MAKE_FLOOR_LINE,28,"                                        "
			CALL MAKE_FLOOR_LINE,29,"                                        "
			;						 01234567890123456789012345678901234567890
			;								   1		 2		   3		 4
		ENDIF

	CASE 13
		;旧東京駅(3F)
		FLAG:최대X = 40
		FLAG:최대Y = 30
		;								   1		 2		   3		 4
		;						 01234567890123456789012345678901234567890
		CALL MAKE_FLOOR_LINE, 0,"                                        "
		CALL MAKE_FLOOR_LINE, 1,"   11                              11   "
		CALL MAKE_FLOOR_LINE, 2,"  1111                            1111  "
		CALL MAKE_FLOOR_LINE, 3," 11611111111111111111111111111111117111 "
		CALL MAKE_FLOOR_LINE, 4," 11111111111111111111111111111111111111 "
		CALL MAKE_FLOOR_LINE, 5,"  1111                            1111  "
		CALL MAKE_FLOOR_LINE, 6,"   11                              11   "
		CALL MAKE_FLOOR_LINE, 7,"                                        "
		;						 01234567890123456789012345678901234567890
		;								   1		 2		   3		 4
	CASE 14
		;屋上(4F)
		FLAG:최대X = 40
		FLAG:최대Y = 30
		;								   1		 2		   3		 4
		;						 01234567890123456789012345678901234567890
		CALL MAKE_FLOOR_LINE, 0,"                                        "
		CALL MAKE_FLOOR_LINE, 1,"                                    1   "
		CALL MAKE_FLOOR_LINE, 2,"  1111                             111  "
		CALL MAKE_FLOOR_LINE, 3,"  1711111111111111111111111111111111411 "
		CALL MAKE_FLOOR_LINE, 4,"  1111                             111  "
		CALL MAKE_FLOOR_LINE, 5,"                                    1   "
		CALL MAKE_FLOOR_LINE, 6,"                                        "
		CALL MAKE_FLOOR_LINE, 7,"                                        "
		;						 01234567890123456789012345678901234567890
		;								   1		 2		   3		 4
ENDSELECT

;===========================================================================
;階段
;===========================================================================
@UPSTAIRS_TOKYO_STATION
SELECTCASE FLAG:현M
	CASE 10
		CALL DUNGEON_UPSTAIRS,11,2,4
	CASEELSE
		CALL DUNGEON_UPSTAIRS,FLAG:현M + 1,FLAG:현X,FLAG:현Y
ENDSELECT
RETURN 1

@DOWNSTAIRS_TOKYO_STATION
SELECTCASE FLAG:현M
	CASE 11
		CALL DUNGEON_DOWNSTAIRS,10,16,13
	CASEELSE
		CALL DUNGEON_DOWNSTAIRS,FLAG:현M - 1,FLAG:현X,FLAG:현Y
ENDSELECT
RETURN 1


