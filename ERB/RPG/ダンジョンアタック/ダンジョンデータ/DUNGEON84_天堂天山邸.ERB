;=======================================================================
;22/05/12	???		コドクノマレビトMOD部分の漂白
;22/06/01	NEO		……というパッチを他の方が出してくれたのを同梱。ありがとうございます
;=======================================================================
;


;던전플래그:84:0 = 1.クリアフラグ
;던전플래그:84:1 = 1.初回
;던전플래그:84:2 = 1.中ボス撃破
;던전플래그:84:10- = 1.宝箱

;=======================================================================
;攻略条件
;=======================================================================
@PREREQUISITE_DUNGEON_84
IF 던전플래그:83:0 == 1 && !던전플래그:84:0
	RETURN 1
ENDIF

;=======================================================================
;ダンジョン名
;=======================================================================
@GET_DUNGEON_NAME_84
RESULTS = 텐도우텐잔저택
;=======================================================================
;플로어名표시
;=======================================================================
@FLOORNAME_84
PRINT 수령저택
SELECTCASE FLAG:현M
	CASE 0
		PRINTL 1F
	CASE 1
		PRINTL 2F
	CASE 2
		PRINTL 3F
	CASE 3
		PRINTL 4F
	CASE 4
		PRINTL 5F
	CASE 5
		PRINTL 6F
	CASE 6
		PRINTL 7F
	CASE 7
		PRINTL 8F
	CASE 8
		PRINTL 9F
	CASEELSE
		PRINTL
ENDSELECT
;=======================================================================
;スタート地点入力
;=======================================================================
@START_DUNGEON_84,ARG
FLAG:현M = 0
FLAG:현X = 6
FLAG:현Y = 21

;=======================================================================
;スタート時イベント
;=======================================================================
@EVENT_DUNGEON_START_84
IF 던전플래그:84:1 == 0
	CALL SHOW_PICTURE, "NONFLOORD"
	CALL MESSAGE_WINDOW_D, "", @"＞텐도우파(天童組)와 경찰서장이 뒤로 연결되어 있다는/＞정보를 얻은 %조사처리(CALLNAME:MASTER,"는")% 저택을 조사하러 방문했다/＞이계화되어있는 저택으로 볼 때、관계가 있는 것은 틀림없을 것이다/＞뭔가 정보를 얻을 수 있을지도 모른다"
	던전플래그:84:1 = 1
ENDIF

;=======================================================================
;フロアデータ
;=======================================================================
@MAKE_FLOOR_84
SELECTCASE FLAG:현M
	CASE 0
		FLAG:최대X = 13 
		FLAG:최대Y = 24 
		;                        0123456789012
		CALL MAKE_FLOOR_LINE, 0,"             "
		CALL MAKE_FLOOR_LINE, 1," 13   3   31 "
		CALL MAKE_FLOOR_LINE, 2," 11211111211 "
 		CALL MAKE_FLOOR_LINE, 3," 1  11111  1 "
		CALL MAKE_FLOOR_LINE, 4," 1         1 "
		CALL MAKE_FLOOR_LINE, 5," 111111 13 1 "
		CALL MAKE_FLOOR_LINE, 6," 1   11213 1 "
		CALL MAKE_FLOOR_LINE, 7," 1         1 "
		CALL MAKE_FLOOR_LINE, 8," 11111411111 "
		CALL MAKE_FLOOR_LINE, 9," 1    1    1 "
		CALL MAKE_FLOOR_LINE,10," 1  1 2 41 1 "
		CALL MAKE_FLOOR_LINE,11," 1111 6 11 1 "
		CALL MAKE_FLOOR_LINE,12," 1  2    2 1 "
		CALL MAKE_FLOOR_LINE,13," 1 11   11 1 "
		CALL MAKE_FLOOR_LINE,14," 1 11 6 11 1 "
		CALL MAKE_FLOOR_LINE,15," 1 2  2 2  1 "
		CALL MAKE_FLOOR_LINE,16," 1 11 1 1111 "
		CALL MAKE_FLOOR_LINE,17," 1 41 1 3  1 "
		CALL MAKE_FLOOR_LINE,18," 1    1    1 "
		CALL MAKE_FLOOR_LINE,19," 11111111111 "
		CALL MAKE_FLOOR_LINE,20,"      1      "
		CALL MAKE_FLOOR_LINE,21,"      1      "
		CALL MAKE_FLOOR_LINE,22,"      8      "
		CALL MAKE_FLOOR_LINE,23,"             "
		;                        0123456789012
		
		
	CASE 1
		FLAG:최대X = 26
		FLAG:최대Y = 14
		;                        01234567890123456789012345
		CALL MAKE_FLOOR_LINE, 0,"                          "
		CALL MAKE_FLOOR_LINE, 1," 11 14211 1114 4 11211 11 "
		CALL MAKE_FLOOR_LINE, 2," 11 11 11 15   1 11 14211 "
 		CALL MAKE_FLOOR_LINE, 3,"  2 2          1  2 2   2 "
		CALL MAKE_FLOOR_LINE, 4," 14 1121 126 7 1 14 44214 "
		CALL MAKE_FLOOR_LINE, 5," 1421  1 1   2 4 14211 11 "
		CALL MAKE_FLOOR_LINE, 6,"       1 11111       2  2 "
		CALL MAKE_FLOOR_LINE, 7,"       1        414214 11 "
		CALL MAKE_FLOOR_LINE, 8," 11211 1111 617   1 14211 "
		CALL MAKE_FLOOR_LINE, 9," 11 11 1  1  2    1    1  "
		CALL MAKE_FLOOR_LINE,10,"  2  2 1  1  1  41114  1  "
		CALL MAKE_FLOOR_LINE,11," 11 11 11 1  1         1  "
		CALL MAKE_FLOOR_LINE,12," 11211211 4  111111111111 "
		CALL MAKE_FLOOR_LINE,13,"                          "
		;                        01234567890123456789012345
		
		CASE 2
		FLAG:최대X = 13
		FLAG:최대Y = 12
		;                        0123456789012
		CALL MAKE_FLOOR_LINE, 0,"             "
		CALL MAKE_FLOOR_LINE, 1," 6 41 311111 "
		CALL MAKE_FLOOR_LINE, 2," 2 11214   1 "
 		CALL MAKE_FLOOR_LINE, 3," 1 1       1 "
		CALL MAKE_FLOOR_LINE, 4," 111 7211111 "
		CALL MAKE_FLOOR_LINE, 5,"             "
		CALL MAKE_FLOOR_LINE, 6,"  DDDDDD DDD "
		CALL MAKE_FLOOR_LINE, 7,"  D      DDD "
		CALL MAKE_FLOOR_LINE, 8," DDD 7D6 DDD "
		CALL MAKE_FLOOR_LINE, 9," D5D  2   D  "
		CALL MAKE_FLOOR_LINE,10," DDD  DDDDD  "
		CALL MAKE_FLOOR_LINE,11,"             "
		;                        0123456789012
		
		
		CASE 3
		FLAG:최대X = 17 
		FLAG:최대Y = 14 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 7 6 1211111 311 "
		CALL MAKE_FLOOR_LINE, 2," 2 2 1     1   1 "
 		CALL MAKE_FLOOR_LINE, 3," 11111 111 1   1 "
		CALL MAKE_FLOOR_LINE, 4,"       111 1   1 "
		CALL MAKE_FLOOR_LINE, 5," 111111111 11111 "
		CALL MAKE_FLOOR_LINE, 6," 1         1   1 "
		CALL MAKE_FLOOR_LINE, 7," 1   1111115   1 "
		CALL MAKE_FLOOR_LINE, 8," 1   1     1   1 "
		CALL MAKE_FLOOR_LINE, 9," 11111  7  11111 "
		CALL MAKE_FLOOR_LINE,10," 1   1  2  1   1 "
		CALL MAKE_FLOOR_LINE,11," 11     1     11 "
		CALL MAKE_FLOOR_LINE,12," 111111111111111 "
		CALL MAKE_FLOOR_LINE,13,"                 "
		;                        01234567890123456
		
		CASE 4
		FLAG:최대X = 15 
		FLAG:최대Y = 15 
		;                        012345678901234
		CALL MAKE_FLOOR_LINE, 0,"               "
		CALL MAKE_FLOOR_LINE, 1," 7 62111111111 "
		CALL MAKE_FLOOR_LINE, 2," 2           1 "
 		CALL MAKE_FLOOR_LINE, 3," 1 5 DDDDDDD 1 "
		CALL MAKE_FLOOR_LINE, 4," 1 D2D5   DD 1 "
		CALL MAKE_FLOOR_LINE, 5," 1 D D     D 1 "
		CALL MAKE_FLOOR_LINE, 6," 1 D D  E  D 1 "
		CALL MAKE_FLOOR_LINE, 7," 1 D 2  2  2 1 "
		CALL MAKE_FLOOR_LINE, 8," 1 D DD D DD 1 "
		CALL MAKE_FLOOR_LINE, 9," 1 D DD D DD 1 "
		CALL MAKE_FLOOR_LINE,10," 1 D    D    1 "
		CALL MAKE_FLOOR_LINE,11," 1 DDDDDDDDD 1 "
		CALL MAKE_FLOOR_LINE,12," 1           1 "
		CALL MAKE_FLOOR_LINE,13," 1111111111111 "
		CALL MAKE_FLOOR_LINE,14,"               "
		;                        012345678901234
		
		CASE 5
		FLAG:최대X = 16 
		FLAG:최대Y = 16 
		;                        0123456789012345
		CALL MAKE_FLOOR_LINE, 0,"                "
		CALL MAKE_FLOOR_LINE, 1," 6 72111111     "
		CALL MAKE_FLOOR_LINE, 2," 2   1    1     "
 		CALL MAKE_FLOOR_LINE, 3," 11111    11111 "
		CALL MAKE_FLOOR_LINE, 4," 1            1 "
		CALL MAKE_FLOOR_LINE, 5," 1 1111111111 1 "
		CALL MAKE_FLOOR_LINE, 6," 1 111      1 1 "
		CALL MAKE_FLOOR_LINE, 7," 1 11121 E  1 1 "
		CALL MAKE_FLOOR_LINE, 8," 1 2   1 2  1 1 "
		CALL MAKE_FLOOR_LINE, 9," 1 111 111  1 1 "
		CALL MAKE_FLOOR_LINE,10," 1 111      1 1 "
		CALL MAKE_FLOOR_LINE,11," 1 11121125 1 1 "
		CALL MAKE_FLOOR_LINE,12," 1     11   2 1 "
		CALL MAKE_FLOOR_LINE,13," 11111     11 3 "
		CALL MAKE_FLOOR_LINE,14,"     11111211   "
		CALL MAKE_FLOOR_LINE,15,"                "
		;                        0123456789012345
		
		CASE 6
		FLAG:최대X = 16 
		FLAG:최대Y = 15 
		;                        0123456789012345
		CALL MAKE_FLOOR_LINE, 0,"                "
		CALL MAKE_FLOOR_LINE, 1,"   7211111115   "
		CALL MAKE_FLOOR_LINE, 2,"     1     1121 "
 		CALL MAKE_FLOOR_LINE, 3," 11111        1 "
		CALL MAKE_FLOOR_LINE, 4," 1     111    1 "
		CALL MAKE_FLOOR_LINE, 5," 1 126 111111 1 "
		CALL MAKE_FLOOR_LINE, 6," 1 1   1    1 1 "
		CALL MAKE_FLOOR_LINE, 7," 1 11111 E  1 1 "
		CALL MAKE_FLOOR_LINE, 8," 1 1   1 2  1 1 "
		CALL MAKE_FLOOR_LINE, 9," 1 11511 1  1 1 "
		CALL MAKE_FLOOR_LINE,10," 1     1 1111 1 "
		CALL MAKE_FLOOR_LINE,11," 1     1 5    1 "
		CALL MAKE_FLOOR_LINE,12," 11115      111 "
		CALL MAKE_FLOOR_LINE,13,"    1111111115  "
		CALL MAKE_FLOOR_LINE,14,"                "
		;                        0123456789012345
		
		CASE 7
		FLAG:최대X = 13 
		FLAG:최대Y = 13 
		;                        0123456789012
		CALL MAKE_FLOOR_LINE, 0,"             "
		CALL MAKE_FLOOR_LINE, 1," 126 7211111 "
		CALL MAKE_FLOOR_LINE, 2," 1     115 1 "
 		CALL MAKE_FLOOR_LINE, 3," 1         1 "
		CALL MAKE_FLOOR_LINE, 4," 1 1111151 1 "
		CALL MAKE_FLOOR_LINE, 5," 11315111111 "
		CALL MAKE_FLOOR_LINE, 6,"             "
		;                        0123456789012
		
		CASE 8
		FLAG:최대X = 12 
		FLAG:최대Y = 10 
		;                        012345678901
		CALL MAKE_FLOOR_LINE, 0,"            "
		CALL MAKE_FLOOR_LINE, 1,"    1111111 "
		CALL MAKE_FLOOR_LINE, 2," 7211     1 "
		CALL MAKE_FLOOR_LINE, 3,"          1 "
		CALL MAKE_FLOOR_LINE, 4," 11111    1 "
 		CALL MAKE_FLOOR_LINE, 5,"  1  1    1 "
		CALL MAKE_FLOOR_LINE, 6,"  1  1    1 "
		CALL MAKE_FLOOR_LINE, 7,"  2  1    1 "
		CALL MAKE_FLOOR_LINE, 8,"  4  111111 "
		CALL MAKE_FLOOR_LINE, 9,"            "
		;                        012345678901
		

	CASEELSE
ENDSELECT


;=======================================================================
;タイル調整
;=======================================================================
@MAKE_FLOOR_LINE_COMMON_84, ARG, ARG:1, ARG:2
#LOCALSIZE 20
SIF ARG:1 == 0 && ARG:2 == 0
	VARSET LOCAL
SELECTCASE ARG
	CASE 3
		IF GETBIT(던전플래그:(FLAG:현던전):(FLAG:현M+10), LOCAL:3)
			DA:(ARG:1):(ARG:2) = 1
			ELSE
			DA:(ARG:1):(ARG:2) = FLAG:현M *1000 + LOCAL:3 * 10 + 3
		ENDIF
		LOCAL:3++
	CASE 4 TO 9
		DA:(ARG:1):(ARG:2) = FLAG:현M *1000 + LOCAL:ARG * 10 + ARG
		LOCAL:ARG++
	
ENDSELECT

;=======================================================================
;指定したマスに進入可能か
;=======================================================================
@CAN_ENTER_84,ARG,ARG:1
IF FLAG:현M == 1 && ARG == 6 && ARG:1 == 4
		IF FLAG:현X < ARG
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
	ENDIF
ENDIF

IF FLAG:현M == 3 && ARG == 6 && ARG:1 == 1
		IF FLAG:현X > ARG
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
	ENDIF
ENDIF

IF FLAG:현M == 5 && ARG == 10 && ARG:1 == 14
		IF FLAG:현X < ARG
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
	ENDIF
ENDIF

IF FLAG:현M == 5 && ARG == 6 && ARG:1 == 7
		IF FLAG:현X < ARG
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
	ENDIF
ENDIF

IF FLAG:현M == 6 && ARG == 13 && ARG:1 == 2
		IF FLAG:현X < ARG
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
	ENDIF
ENDIF

IF FLAG:현M == 8 && ARG == 2 && ARG:1 == 7 
	CALL MESSAGE_WINDOW_D, "", "＞문 너머에서 강한 사기(邪気)가 느껴진다/＞문을 엽니까？"
	CALL INPUT_YN_D
	SIF RESULT
		RETURN 0
ENDIF


CALL CAN_ENTER,ARG,ARG:1
RETURN RESULT
;=======================================================================
;タイル定義
;=======================================================================
@TILE_MARK_COMMON_84_4, ARG , ARG:1 , ARG:2
SELECTCASE ARG / 10
	CASE 1,2,200,201
		SETCOLOR 0x00ff00
		RESULTS = ｍ
	CASE 800 
		RESULTS = ！
	CASEELSE
		IF FLAG:현M == 0
			RESULTS = □
		ELSE
			RESULTS = Ｗ
		ENDIF
	ENDSELECT

@TILE_MARK_COMMON_84_5, ARG, ARG:1, ARG:2
IF FLAG:라이트마 || (EQUIP:MASTER:다크스캐너 && NUM_SUMMONER())
		RESULTS = \@GET_FLOOR_ANALYZE_T(ARG:1, ARG:2) == 2 ?덫#□\@
ELSE
SELECTCASE ARG / 10
		CASE 200, 400, 401,
		SETCOLOR 0x404040
			RESULTS = □
		CASEELSE
			RESULTS = \@GET_FLOOR_ANALYZE_T(ARG:1, ARG:2) == 2 ?덫#□\@
	ENDSELECT
ENDIF

@TILE_MARK_COMMON_84_D, ARG, ARG:1, ARG:2
IF FLAG:라이트마 || (EQUIP:MASTER:다크스캐너 && NUM_SUMMONER())
	SELECTCASE ARG/10
		CASEELSE
			RESULTS = □
	ENDSELECT
ELSE
	SETCOLOR 0x404040
	SELECTCASE ARG/10
		CASEELSE
			RESULTS = □
	ENDSELECT
ENDIF

;=======================================================================
;[5]調べる　実行時のイベント
;=======================================================================
@EVENT_CHECK_DUNGEON_84

;==========
;出口の処理
;==========
IF DA:(FLAG:현X):(FLAG:현Y) % 10 == 8
		CALL DUNGEON_EXIT
	RETURN 1
;========
;宝の処理
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 3
	CALL TRESURING_CALLING_84
	RETURN RESULT

;=======
;階段
;=======
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 6
	CALL UPSTAIRS_84
	RETURN RESULT

ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 7
	CALL DOWNSTAIRS_84
	RETURN RESULT

;==========
;イベントの処理
;==========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 4
	SELECTCASE FLAG:현M
		CASE 0
			IF FLAG:현X == 3 && FLAG:현Y == 17
				CALL MESSAGE_WINDOW_D, "チンピラ", "あーん、/どこに目えつけてんじゃ、アホんだら！/しばいたろかボケェ！！ "
			ELSEIF  FLAG:현X == 8 && FLAG:현Y == 10
				CALL MESSAGE_WINDOW_D, "チンピラ", "なんじゃい、われ！/どたま、かち割ったろか！/このガキャーーーー！！ "
			ENDIF
			
		CASE 2
			IF FLAG:현X == 3 && FLAG:현Y == 1
				CALL MESSAGE_WINDOW_D, "야쿠자", "두목이 원했던 것은、젊음이었다。/불로불사라는 놈이지。/그 광기가 두목을 바꿔버렸다。"
				CALL MESSAGE_WINDOW_D, "야쿠자", "돈과 여자는 충분해、/그것만으로는 부족했었나………/나로선 두목의 본심을、아직 모르겠어。"
			ELSEIF  FLAG:현X == 7 && FLAG:현Y == 2
				CALL MESSAGE_WINDOW_D, "야쿠자", "두목은 변해버렸어。/옛날엔 저런、사람이 아니었어……… "
			ENDIF
	ENDSELECT
	RETURN 1
ELSE
	CALL MESSAGE_WINDOW_D, "", "＞아무것도 없는 것 같다"
	RETURN 0
ENDIF

;=======================================================================
;タイル進入時の이벤트
;=======================================================================
@EVENT_ENTER_DUNGEON_84,ARG
;ARG = 進入時の向き　0の場合ワープなど
;==========
;出口の処理
;==========
IF DA:(FLAG:현X):(FLAG:현Y) % 10 == 8
	CALL DUNGEON_EXIT
	RETURN 1

;========
;宝の処理
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 3
	CALL TRESURING_CALLING_84
	RETURN RESULT
	
;========
;罠の処理
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 ==  5 
	CALL TRAP_84
	RETURN RESULT
	
;==========
;扉の処理
;==========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 2
	CALL DUNGEON_DOOR,ARG
	RETURN 1

;=======
;階段
;=======
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 6
	CALL UPSTAIRS_84
	RETURN RESULT

ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 7
	CALL DOWNSTAIRS_84
	RETURN RESULT

		
;==========
;イベントの処理
;==========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 4
	SELECTCASE FLAG:현M
	CASE 0
		IF FLAG:현X == 6 && FLAG:현Y == 8
			 IF ARG == 4
				CALL SHOW_FORCEMOVE, "L", "D", , ,  "갑자기 바닥이 움직이기 시작했다！"
			 ELSEIF ARG == 6
				CALL SHOW_FORCEMOVE, "R", "D", , ,  "갑자기 바닥이 움직이기 시작했다！"
			 ENDIF
		ENDIF
	CASE 1
		IF FLAG:현X == 21 && FLAG:현Y == 4
			IF ARG == 4
				CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
				FLAG:현X = 5
				FLAG:현Y = 1
			ENDIF
		ELSEIF FLAG:현X == 5 && FLAG:현Y == 1
			IF ARG == 4
				CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
				FLAG:현X = 21
				FLAG:현Y = 4
			ENDIF
		ELSEIF FLAG:현X == 15 && FLAG:현Y == 1
			CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
			FLAG:현X = 13
			FLAG:현Y = 10
		ELSEIF FLAG:현X == 13 && FLAG:현Y == 1
			CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
			FLAG:현X = 13
			FLAG:현Y = 10
		ELSEIF FLAG:현X == 18 && FLAG:현Y == 5
			IF ARG == 4
				CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
				FLAG:현X = 21
				FLAG:현Y = 2
			ENDIF
		ELSEIF FLAG:현X == 21 && FLAG:현Y == 2
			IF ARG == 4
				CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
				FLAG:현X = 18
				FLAG:현Y = 5
			ENDIF
		ELSEIF FLAG:현X == 24 && FLAG:현Y == 4
			IF ARG == 2
				CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
				FLAG:현X = 2
				FLAG:현Y = 4
			ENDIF
		ELSEIF FLAG:현X == 2 && FLAG:현Y == 4
			IF ARG == 2
				CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
				FLAG:현X = 24
				FLAG:현Y = 4
			ENDIF
		ELSEIF FLAG:현X == 21 && FLAG:현Y == 8
			IF ARG == 4
				CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
				FLAG:현X = 2
				FLAG:현Y = 5
			ENDIF
		ELSEIF FLAG:현X == 2 && FLAG:현Y == 5
			IF ARG == 4
				CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
				FLAG:현X = 21
				FLAG:현Y = 8
			ENDIF
		ELSEIF FLAG:현X == 21 && FLAG:현Y == 7
			IF ARG == 2
				CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
				FLAG:현X = 18
				FLAG:현Y = 4
			ENDIF
		ELSEIF FLAG:현X == 18 && FLAG:현Y == 4
			IF ARG == 2
				CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
				FLAG:현X = 21
				FLAG:현Y = 7
			ENDIF
		ELSEIF FLAG:현X == 20 && FLAG:현Y == 4
			IF ARG == 2
				CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
				FLAG:현X = 16
				FLAG:현Y = 7
			ENDIF
		ELSEIF FLAG:현X == 16 && FLAG:현Y == 7
			CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
			FLAG:현X = 20
			FLAG:현Y = 4
		ELSEIF FLAG:현X == 15 && FLAG:현Y == 5
			CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
			FLAG:현X = 7
			FLAG:현Y = 8
		ELSEIF FLAG:현X == 18 && FLAG:현Y == 7
			IF ARG == 4
				CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
				FLAG:현X = 18
				FLAG:현Y = 1
			ENDIF
		ELSEIF FLAG:현X == 16 && FLAG:현Y == 10
			CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
			FLAG:현X = 15
			FLAG:현Y = 3
		ELSEIF FLAG:현X == 20 && FLAG:현Y == 10
			CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
			FLAG:현X = 13
			FLAG:현Y = 10
		ELSEIF FLAG:현X == 10 && FLAG:현Y == 12
			CALL MESSAGE_WINDOW_D, "", "＞워프존이다！"
			FLAG:현X = 13
			FLAG:현Y = 1
		ENDIF
	CASE 8
		IF FLAG:현X == 2 && FLAG:현Y == 8
			CALL MESSAGE_WINDOW_D, "", "＞호화로운 장식으로 꾸며진 방 안에/＞인간이라고는 생각할 수 없는 분위기가 감도는、/＞늙은 남성이 앉아있었다"
			CALL MESSAGE_WINDOW_D, "텐도우", "너어、어디의 수하인가？/내가 텐도우파 회장、텐도우 텐잔(天堂天山)이라는 걸 알고 있느냐。"
			CALL MESSAGE_WINDOW_D, "텐도우", "여기까지 오다니이、훌륭하지만、/내 적수는 아니지。/냉큼、죽여주마。 "
			CALL MESSAGE_WINDOW_D, "", "＞텐도우의 육체가 생기를 되찾아、/＞그 모습을 불길한 악마로 변이시켜 간다/"
			CALL MESSAGE_WINDOW_D, "", "＞유귀 텐도우가 １체 나왔다！"
			
			FLAG:도주불가플래그 = 1
			FLAG:회화불능플래그 = 1
			FLAG:선제기습취소 = 1
			
			;텐도우
			CALL SET_ENEMY,9,[[キャラ:텐도우]],64,0,1
			CFLAG:(CHARANUM-1):ＨＰ보정 = 4200
			CFLAG:(CHARANUM-1):ＭＰ보정 = 8000
			CFLAG:(CHARANUM-1):행동횟수 = 2
			CFLAG:(CHARANUM-1):속도보정 = 15
			BASE:(CHARANUM-1):힘 += 6
			BASE:(CHARANUM-1):지혜 += 6
			BASE:(CHARANUM-1):마력 += 6
			BASE:(CHARANUM-1):속도 += 8
			CALL SYNC_STATUS,(CHARANUM-1)
			CALL HEALTH_CHARA,(CHARANUM-1)
			CSTR:(CHARANUM-1):사고패턴 = D84_텐도우
			
			CALL BATTLE_START
			FLAG:도주불가플래그 = 0
			FLAG:회화불능플래그 = 0
			FLAG:선제기습취소 = 0
			
			CALL MESSAGE_WINDOW_D, "텐도우", "크윽、회춘의 힘이 끊어졌는가……/더 피를、부하들에게 모으게 한 피를/담은 황금상을…………。"
			CALL MESSAGE_WINDOW_D, "텐도우", "……아직 싸울 수 있다……/피를、황금상을…………。" 
			CALL MESSAGE_WINDOW_D, "시드", "거기까지 입니DA。텐도우씨。/당신의 역할은、끝났습니DA。/당신에게、이 이상 에너지를 사용하게 하는 것은 낭비입니DA。"
			CALL MESSAGE_WINDOW_D, "", "＞갑작스럽게 시드가 모습을 드러냈다"
			CALL MESSAGE_WINDOW_D, "시드","당신은、부하를 써서 땅을 사들이고、/건설회사에、봉인의 사당과 신사를 훼손하게 하거나、/흡혈귀가 되어、피를 모아주었습니DA。"
			CALL MESSAGE_WINDOW_D, "시드","당신의 일은、이것으로 끝입니DA。/다시 한번、데빌 서머너와 싸워도、/이길 수 없겠지YO。"
			CALL MESSAGE_WINDOW_D, "시드","이용가치가 없어지고、싸움에도 진、/당신은、원래의 비참한 노인으로 돌아가서、/죽는 것입니DA。"
			CALL MESSAGE_WINDOW_D, "시드","그럼、안녕히。 "
			CALL MESSAGE_WINDOW_D, "", "＞시드는 모습을 감추고 떠났다"
			CALL MESSAGE_WINDOW_D, "텐도우", "……이제 죽는겐가……/제길、나는 놈들에게 놀아난 끝에/죽는겐가…………。"
			CALL MESSAGE_WINDOW_D, "", "＞유귀 텐도우는 힘이 다했다…"
			CALL MESSAGE_WINDOW_D, "", "＞組織の不穏分子を排除したことにより、/＞報酬として입座に￥50000が支払われ、名声300得た"
			MONEY += 50000
			던전플래그:84:0 = 1
			FLAG:명성 += 300
			FLAG:탈출 = 1
		ENDIF
	ENDSELECT
ENDIF

;テンドウ戦闘行動
@SET_ACTION_D84_텐도우,ARG
;入力行動を-1とターゲットを-1にしておく
CFLAG:ARG:입력행동 = -1
CFLAG:ARG:타겟 = -1

IF CFLAG:ARG:１more플래그 == 2
	IF RAND:2 == 0
		CFLAG:ARG:입력행동 = 2039
	ELSE
		CFLAG:ARG:입력행동 = 1411
	ENDIF
	
ELSEIF CFLAG:ARG:행동한횟수 == 0
	SELECTCASE RAND:100
		CASE 0 TO 40
			CFLAG:ARG:입력행동 = 1010
		CASE 41 TO 80
			CFLAG:ARG:입력행동 = 2062
		CASEELSE
			CFLAG:ARG:입력행동 = 2039
		ENDSELECT
ELSE
	SELECTCASE RAND:100
		CASE 0 TO 25
			CFLAG:ARG:입력행동 = 1010
		CASE 25 TO 55
			CFLAG:ARG:입력행동 = 2062
		CASE 56 TO 75
			CFLAG:ARG:입력행동 = [[스킬:ＡＴＴＡＣＫ]]
		CASEELSE
			CFLAG:ARG:입력행동 = 2039
		ENDSELECT
	ENDIF

FOR LOCAL:1, 0, 5
	FOR LOCAL, 1, 7
		IF POS(LOCAL) > 0 && CFLAG:POS(LOCAL):AUTO_SPLIT("명중강화/회피강화/마법위력강화/공격강화/방어강화", "/", LOCAL:1) > 4
			CFLAG:ARG:입력행동 = [[스킬:데・카쟈]]
			CFLAG:ARG:타겟 = -1
		ENDIF
	NEXT
NEXT
;アクション実行不能
CALL CHECK_ACTIONABLE, ARG, CFLAG:ARG:입력행동
SIF RESULT == 0
	CFLAG:ARG:입력행동 = 0
;ここまでターゲットが決まってなかったら、ランダムターゲットをよんで決定
SIF CFLAG:ARG:타겟 == -1
	CALL RANDOM_TARGET, ARG, CFLAG:ARG:입력행동
RETURN 1

;=======================================================================
;脱出時のイベント
;=======================================================================
@EVENT_DUNGEON_END_84

;========
;階段移動
;========
@UPSTAIRS_84
SELECTCASE FLAG:현M
	CASE 0
		SIF FLAG:현X == 6 && FLAG:현Y == 14
			CALL DUNGEON_UPSTAIRS,1,14,8
		SIF FLAG:현X == 6 && FLAG:현Y == 11
			CALL DUNGEON_UPSTAIRS,1,13,4
	CASE 1
		SIF FLAG:현X == 11 && FLAG:현Y == 4
			CALL DUNGEON_UPSTAIRS,2,5,4
		SIF FLAG:현X == 12 && FLAG:현Y == 8
			CALL DUNGEON_UPSTAIRS,2,5,8
	CASE 2
		SIF FLAG:현X == 7 && FLAG:현Y == 8
			CALL DUNGEON_UPSTAIRS,3,8,9
		SIF FLAG:현X == 1 && FLAG:현Y == 1
			CALL DUNGEON_UPSTAIRS,3,1,1
	CASE 3
		SIF FLAG:현X == 3 && FLAG:현Y == 1
			CALL DUNGEON_UPSTAIRS,4,1,1
	CASE 4
		SIF FLAG:현X == 3 && FLAG:현Y == 1
			CALL DUNGEON_UPSTAIRS,5,3,1
	CASE 5
		SIF FLAG:현X == 1 && FLAG:현Y == 1
			CALL DUNGEON_UPSTAIRS,6,3,1
	CASE 6
		SIF FLAG:현X == 5 && FLAG:현Y == 5
			CALL DUNGEON_UPSTAIRS,7,5,1
	CASE 7
		SIF FLAG:현X == 3 && FLAG:현Y == 1
			CALL DUNGEON_UPSTAIRS,8,1,2
	CASEELSE
ENDSELECT
RETURN 1

@DOWNSTAIRS_84
SELECTCASE FLAG:현M
	CASE 1
		SIF FLAG:현X == 14 && FLAG:현Y == 8
			CALL DUNGEON_DOWNSTAIRS,0,6,14
		SIF FLAG:현X == 13 && FLAG:현Y == 4
			CALL DUNGEON_DOWNSTAIRS,0,6,11
	CASE 2
		SIF FLAG:현X == 5 && FLAG:현Y == 4
			CALL DUNGEON_DOWNSTAIRS,1,11,4
		SIF FLAG:현X == 5 && FLAG:현Y == 8
			CALL DUNGEON_DOWNSTAIRS,1,12,8
	CASE 3
		SIF FLAG:현X == 8 && FLAG:현Y == 9
			CALL DUNGEON_DOWNSTAIRS,2,7,8
		SIF FLAG:현X == 1 && FLAG:현Y == 1
			CALL DUNGEON_DOWNSTAIRS,2,1,1
	CASE 4
		SIF FLAG:현X == 1 && FLAG:현Y == 1
			CALL DUNGEON_DOWNSTAIRS,3,3,1
	CASE 5
		SIF FLAG:현X == 3 && FLAG:현Y == 1
			CALL DUNGEON_DOWNSTAIRS,4,3,1
	CASE 6
		SIF FLAG:현X == 3 && FLAG:현Y == 1
			CALL DUNGEON_DOWNSTAIRS,5,1,1
	CASE 7
		SIF FLAG:현X == 5 && FLAG:현Y == 1
			CALL DUNGEON_DOWNSTAIRS,6,5,5
	CASE 8
		SIF FLAG:현X == 1 && FLAG:현Y == 2
			CALL DUNGEON_DOWNSTAIRS,7,3,1
	CASEELSE
ENDSELECT
RETURN 1
;=======================================================================
;エレベーター
;=======================================================================
@DUNGEON_ELEVATOR_84, ARG
RESULT:1 = 4
RESULT:2 = 5
RESULT:3 = 6
RESULTS:1 = ５Ｆ
RESULTS:2 = ６Ｆ
RESULTS:3 = ７Ｆ
RETURN -1

;=======================================================================
;宝箱の中身
;=======================================================================
@TRESURING_CALLING_84
#LOCALSIZE 3
LOCAL = FLAG:현M + 10

LOCAL:1 = (DA:(FLAG:현X):(FLAG:현Y) / 10) % 100
SELECTCASE DA:(FLAG:현X):(FLAG:현Y) / 10
		CASE 0
			CALL GET_TREASURE, [[아이템:메기도스톤]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 1
			CALL GET_TREASURE, [[아이템:비전의단도]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 2
			CALL GET_TREASURE_MAG, , 4000 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 3
			CALL GET_TREASURE, [[아이템:Ｍ16라이플]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 4
			CALL GET_TREASURE, [[아이템:호와카빈]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 5
			CALL GET_TREASURE, [[아이템:외상약]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 200
			CALL GET_TREASURE_MONEY, 0 , 50000 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 300
			CALL GET_TREASURE, [[아이템:인내력의향]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 500
			CALL GET_TREASURE, [[아이템:메기도라스톤]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 700
			CALL GET_TREASURE, [[아이템:뇌아의도끼]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
	ENDSELECT
RETURN 1


;========
;罠置き場
;========
@TRAP_84
SELECTCASE FLAG:현M
	CASE 1
		CALL MESSAGE_WINDOW_D, "", "＞함정이다！"
				SIF FLAG:현X == 11 && FLAG:현Y == 2
				CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X-5,  FLAG:현Y+7
	CASE 2
		CALL MESSAGE_WINDOW_D, "", "＞함정이다！"
				SIF FLAG:현X == 2 && FLAG:현Y == 9
				CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X+6,  FLAG:현Y+2
	CASE 3
		CALL MESSAGE_WINDOW_D, "", "＞함정이다！"
				SIF FLAG:현X == 11 && FLAG:현Y == 7
				CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X-4,  FLAG:현Y-1
	CASE 4
		CALL MESSAGE_WINDOW_D, "", "＞함정이다！"
				SIF FLAG:현X == 6 && FLAG:현Y == 4
				CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X+3,  FLAG:현Y+1
				SIF FLAG:현X == 3 && FLAG:현Y == 3
				CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X,  FLAG:현Y
	CASE 5
		CALL MESSAGE_WINDOW_D, "", "＞함정이다！"
				SIF FLAG:현X == 10 && FLAG:현Y == 11
				CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X,  FLAG:현Y-2
	CASE 6
		CALL MESSAGE_WINDOW_D, "", "＞함정이다！"
				SIF FLAG:현X == 12 && FLAG:현Y == 1
				CALL DUNGEON_WORP, FLAG:현M-2, FLAG:현X,  FLAG:현Y
				SIF FLAG:현X == 5 && FLAG:현Y == 12
				CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X,  FLAG:현Y+1
				SIF FLAG:현X == 13 && FLAG:현Y == 13
				CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X-1,  FLAG:현Y+1
				SIF FLAG:현X == 9 && FLAG:현Y == 11
				CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X-1,  FLAG:현Y+1
				SIF FLAG:현X == 5 && FLAG:현Y == 9
				CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X-1,  FLAG:현Y+1
	CASE 7
		CALL MESSAGE_WINDOW_D, "", "＞함정이다！"
				SIF FLAG:현X == 9 && FLAG:현Y == 2
				CALL DUNGEON_WORP, FLAG:현M-5, FLAG:현X,  FLAG:현Y+4
				SIF FLAG:현X == 5 && FLAG:현Y == 5
				CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X+2,  FLAG:현Y+4
				SIF FLAG:현X == 8 && FLAG:현Y == 4
				CALL DUNGEON_WORP, FLAG:현M-3, FLAG:현X+2,  FLAG:현Y+4
	ENDSELECT
;=======================================================================
;エンカウント率
;=======================================================================
@ENCOUNT_RATE_84

SELECTCASE FLAG:현M
	CASE 0,1
		FLAG:인카운트율 = FLAG:미조우걸음수*5
	CASE 2,3,4,5,6
		FLAG:인카운트율 = 5 + FLAG:미조우걸음수*5
	CASEELSE
		FLAG:인카운트율 = 10 + FLAG:미조우걸음수*5
ENDSELECT
SIF FLAG:미조우걸음수 < 5
	FLAG:인카운트율 = 0
;=======================================================================
;必要レベル目安
;推奨LV 雑魚最低LV 雑魚最高LV ボスLV 
;=======================================================================
@GET_DUNGEON_LV_84
;コドクノマレビトmod
IF 이벤트플래그:41:2 == 1
	RETURN 40, 15, 30, 50
;通常
ELSE
	RETURN 50, 25, 54, 64 
ENDIF
;=======================================================================
;エンカウント処理
;=======================================================================
@CHECK_ENCOUNT_84
IF RAND:100 < FLAG:인카운트율
	CALL ENEMY_TABLE
	RETURN 1
ELSE
	FLAG:미조우걸음수 += 1
	RETURN 0
ENDIF

;=======================================================================
;敵の種族の種類数
;=======================================================================
@CLASS_NUM_84
SELECTCASE FLAG:현M
	CASE 0,1,2,3,4,5,6
		RETURN CLASS_NUM_COMMON("上級")
	CASE 7,8
		RETURN CLASS_NUM_COMMON("最上級")
ENDSELECT
;=======================================================================
;敵の総数
;ARGは出現する敵の種類です
;=======================================================================
@ENEMY_NUM_84, ARG
SELECTCASE FLAG:현M
	CASE 0,1,2,3,4,5,6
		RETURN ENEMY_NUM_COMMON("上級", ARG)
	CASE 7,8
		RETURN ENEMY_NUM_COMMON("最上級", ARG)
ENDSELECT
;=======================================================================
;敵の種類
;=======================================================================
@ENEMY_84, ARG
SELECTCASE FLAG:현M
	CASE 0,1
		SELECTCASE RAND:100
			CASE IS < 15
				RETURN [[キャラ:야쿠자]], 25
			CASE IS < 30
				RETURN [[キャラ:킬러초퍼]], 35
			CASE IS < 55
				RETURN [[キャラ:인큐버스]], 39
			CASE IS < 70
				RETURN [[キャラ:정키]], 35
			CASE IS < 85
				RETURN [[キャラ:한냐]], 36
			CASE IS < 100
				RETURN [[キャラ:타라스크]], 38
		ENDSELECT
	CASE 2,3,4
		SELECTCASE RAND:100
			CASE IS < 30
				RETURN [[キャラ:버쳐]], 46
			CASE IS < 55
				RETURN [[キャラ:서큐버스]], 47
			CASE IS < 70
				RETURN [[キャラ:바르바토스]], 48
			CASE IS < 85
				RETURN [[キャラ:쿠드락]], 48
			CASE IS < 100
				RETURN [[キャラ:달기]], 47
		ENDSELECT
	CASE 5,6
		SELECTCASE RAND:100
			CASE IS < 30
				RETURN [[キャラ:티타니아]], 51
			CASE IS < 55
				RETURN [[キャラ:섀도우]], 49
			CASE IS < 70
				RETURN [[キャラ:바르바토스]], 49
			CASE IS < 85
				RETURN [[キャラ:쿠드락]], 50
			CASE IS < 100
				RETURN [[キャラ:서큐버스]], 49
		ENDSELECT
	CASE 7,8
		SELECTCASE RAND:100
			CASE IS < 15
				RETURN [[キャラ:타투맨]], 53
			CASE IS < 30
				RETURN [[キャラ:티타니아]], 53
			CASE IS < 40
				RETURN [[キャラ:베탈라]], 53
			CASE IS < 55
				RETURN [[キャラ:서큐버스]], 53
			CASE IS < 70
				RETURN [[キャラ:쿠드락]], 54 
			CASE IS < 85
				RETURN [[キャラ:바르바토스]], 50
			CASE IS < 100
				RETURN [[キャラ:기리메칼라]], 54
		ENDSELECT	
ENDSELECT

;=======================================================================
;輪姦参加悪魔
;=======================================================================
@DUNGEON_RAPE_DEVIL_84
;ランダムにどの悪魔が出るか決定
;RETURN CSV番号 , 人数 , レベル
SELECTCASE RAND:3
	CASE 0
		RETURN [[キャラ:인큐버스]] , 3 + RAND:10 , CSVBASE([[キャラ:인큐버스]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 1
		RETURN [[キャラ:야쿠자]] , 3 + RAND:10 , CSVBASE([[キャラ:야쿠자]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 2
		RETURN [[キャラ:정키]] , 3 + RAND:10 , CSVBASE([[キャラ:정키]] , GETNUM(BASE , "LV") , 0) + RAND:3
ENDSELECT