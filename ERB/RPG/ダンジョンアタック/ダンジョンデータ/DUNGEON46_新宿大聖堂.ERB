
;=======================================================================
;신주쿠대성당
;ボス・파주주
;던전ナンバー46　ＭＡＰ0~6
;=======================================================================




;=======================================================================
;攻略조건
;=======================================================================
@PREREQUISITE_DUNGEON_46
SIF (던전플래그:18:22 == 1 && 던전플래그:42:0 >= 1) || FLAG:DEBUG 
	RETURN 1
RETURN 0
	
;=======================================================================
;던전名
;=======================================================================
@GET_DUNGEON_NAME_46
RESULTS = 신주쿠대성당


;=======================================================================
;플로어名표시
;=======================================================================
@FLOORNAME_46
;PRINT 롯폰기
SELECTCASE FLAG:현M
	CASE 0
		PRINTL 신주쿠대성당 １Ｆ북
	CASE 1
		PRINTL 신주쿠대성당 １Ｆ남
	CASE 2
		PRINTL 신주쿠대성당 ２Ｆ북
	CASE 3
		PRINTL 신주쿠대성당 ２Ｆ남
	CASE 4
		PRINTL 신주쿠대성당 ３Ｆ북
	CASE 5
		PRINTL 신주쿠대성당 ３Ｆ남
	CASE 6
		PRINTL 신주쿠대성당 Ｂ１Ｆ
	CASEELSE
ENDSELECT


;=======================================================================
;特殊タイル표시
;=======================================================================
@TILE_MARK_46_0_1_10
RESULTS = ↓
@TILE_MARK_46_0_18_10
RESULTS = ↓

@TILE_MARK_46_1_1_0
RESULTS = ↑
@TILE_MARK_46_1_18_0
RESULTS = ↑

@TILE_MARK_46_1_3_6
RESULTS = Ｅ

@TILE_MARK_46_2_1_10
RESULTS = ↓
@TILE_MARK_46_2_18_10
RESULTS = ↓

@TILE_MARK_46_3_1_0
RESULTS = ↑
@TILE_MARK_46_3_18_0
RESULTS = ↑
@TILE_MARK_46_3_3_5
RESULTS = Ｅ

@TILE_MARK_46_4_1_10
RESULTS = ↓
@TILE_MARK_46_4_18_10
RESULTS = ↓
@TILE_MARK_46_4_5_10
RESULTS = ↓

@TILE_MARK_46_5_1_0
RESULTS = ↑
@TILE_MARK_46_5_18_0
RESULTS = ↑
@TILE_MARK_46_5_5_0
RESULTS = ↑
@TILE_MARK_46_5_3_5
RESULTS = Ｅ

@TILE_MARK_46_6_3_1
RESULTS = Ｅ
;=======================================================================
;スタート地点입력
;=======================================================================
@START_DUNGEON_46,ARG
;フラグ
FLAG:현M = 1
FLAG:현X = 10
FLAG:현Y = 8
;CALL AUTOMAP

;=======================================================================
;スタート時이벤트
;=======================================================================
@EVENT_DUNGEON_START_46
IF 던전플래그:46:3 == 0 
	PRINTFORML 우에노를 개방한 파주주에게 이끌려 %마스터는% 신주쿠 대성당을 방문했다
	PRINTFORMW 메시아교의 일대거점、신주쿠와 시나가와
	PRINTFORML 
	PRINTFORML 엄숙한 분위기의 교회 주변은 예배를 드리기 위해 찾아온 사람으로 혼잡했다
	PRINTFORML 악마를 경계하고 있는 템플나이트의 모습도 보였다
	PRINTFORMW 
	IF FINDCHARA_B(4501,1)== 2 && (TALENT:(RESULT:1):연모 || TALENT:(RESULT:1):친애)
		PRINTL 
		PRINTFORMW 신주쿠 대성당에 온 베스는 생각하는게 있는지
		PRINTFORMW 침울해졌다
		PRINTFORML 「%마스터는% 팬텀 소사이어티 사람」
		PRINTFORMW 「만약... 정체를 들키게 된다면……」
		PRINTFORML 「게다가……여기는……」
		PRINTFORML 「그다지 좋은 기억같은 건 없으니까」
		PRINTFORMW 베스는 침울한 표정으로 %마스터를% 바라본다
		PRINTFORML 「파주주의 말이 신경쓰여…」
		PRINTFORMW 「함정일지도 몰라요… 방심하지 마세요」
	ENDIF
	던전플래그:46:3 = 1
ENDIF

IF 던전플래그:46:0 == 0 && 던전플래그:46:2 == 1
	던전플래그:46:4 = 1
ENDIF
;=======================================================================
;指定したマスに進入가능か
;=======================================================================
@CAN_ENTER_46,ARG,ARG:1

IF FLAG:현M == 0 && ARG == 10 && ARG:1 == 4
	IF 던전플래그:46:0 == 1 || 던전플래그:46:2 == 1
		RETURN 1
	ELSEIF (던전플래그:46:50 == 1 || 던전플래그:46:90 == 1 || FLAG:DEBUG) && 던전플래그:46:0 == 0
		PRINTFORMW 문 너머에서 거대한 기운이 느껴진다 
		PRINTFORMW 문을 열겠습니까？
		PRINTL 
		PRINTL [0] 네
		PRINTL [1] 아니요
		$INPUT_LOOP_A1
		INPUT
		IF RESULT == 0
			RETURN 1
		ELSEIF RESULT == 1
			RETURN 0
		ELSE
			GOTO INPUT_LOOP_A1
		ENDIF
	ELSE
		PRINTW 문이 닫혀있다
		RETURN 0
	ENDIF
ENDIF

IF FLAG:현M == 0 && ARG == 17 && ARG:1 == 3
	IF 던전플래그:46:1 >= 3 || FLAG:DEBUG
		RETURN 1
	ELSE
		PRINTW 문이 닫혀있다
		RETURN 0
	ENDIF
ENDIF

IF FLAG:현M == 2 && ARG == 12 && ARG:1 == 8
	IF 던전플래그:46:1 >= 3 || FLAG:DEBUG
		RETURN 1
	ELSE
		PRINTW 문이 닫혀있다
		RETURN 0
	ENDIF
ENDIF

IF FLAG:현M == 4 && ARG == 11 && ARG:1 == 3
	IF 던전플래그:46:1 >= 3 || FLAG:DEBUG
		RETURN 1
	ELSE
		PRINTW 문이 닫혀있다
		RETURN 0
	ENDIF
ENDIF

IF FLAG:현M == 5 && ARG == 10 && ARG:1 == 2
	IF 던전플래그:46:1 >= 3 || FLAG:DEBUG
		RETURN 1
	ELSE
		PRINTW 문이 닫혀있다
		RETURN 0
	ENDIF
ENDIF


IF FLAG:현M == 6 && ARG == 3 && ARG:1 == 2
	IF 던전플래그:46:1 == 4 || FLAG:DEBUG
		RETURN 1
	ELSE
		PRINTW 문이 닫혀있다
		RETURN 0
	ENDIF
ENDIF

CALL CAN_ENTER,ARG,ARG:1
RETURN RESULT
;=======================================================================
;플로어데이터
;=======================================================================
@MAKE_FLOOR_46
SELECTCASE FLAG:현M

	CASE 0
	;신주쿠대성당１Ｆ北
		FLAG:최대X = 20 
		FLAG:최대Y = 11 
								;01234567890123456789
		CALL MAKE_FLOOR_LINE, 0,"                    "
		CALL MAKE_FLOOR_LINE, 1," 111111111111111111 "
		CALL MAKE_FLOOR_LINE, 2," 1     11111      1 "
		CALL MAKE_FLOOR_LINE, 3," 1   1 11111 1 7121 "
		CALL MAKE_FLOOR_LINE, 4," 121 1    2  1    1 "
		CALL MAKE_FLOOR_LINE, 5," 1   1 6  1  111111 "
		CALL MAKE_FLOOR_LINE, 6," 11111 2     1    1 "
		CALL MAKE_FLOOR_LINE, 7," 1   1 1     1 1121 "
		CALL MAKE_FLOOR_LINE, 8," 1 111 1211111 11 1 "
		CALL MAKE_FLOOR_LINE, 9," 1                1 "
		CALL MAKE_FLOOR_LINE,10," 9                9 "
								;01234667890123466789

		CALL SET_TILE,10,5,던전플래그:46:0,0,4
		CALL SET_TILE,3,8,던전플래그:46:30,0,4
		CALL SET_TILE,5,3,던전플래그:46:31,0,4
		CALL SET_TILE,15,8,던전플래그:46:32,0,4
	
	CASE 1
	;신주쿠대성당１Ｆ南
		FLAG:최대X = 20 
		FLAG:최대Y = 12 
								;01234567890123466789
		CALL MAKE_FLOOR_LINE, 0," 9                9 "
		CALL MAKE_FLOOR_LINE, 1," 1    1111111     1 "
		CALL MAKE_FLOOR_LINE, 2," 1 11111111111    1 "
		CALL MAKE_FLOOR_LINE, 3," 111111111111111211 "
		CALL MAKE_FLOOR_LINE, 4," 1 11111111111    1 "
		CALL MAKE_FLOOR_LINE, 5," 1  111111111     1 "
		CALL MAKE_FLOOR_LINE, 6," 1 9 1111111   1121 "
		CALL MAKE_FLOOR_LINE, 7,"   2    222   11    "
		CALL MAKE_FLOOR_LINE, 8," 11111  111  11111  "
		CALL MAKE_FLOOR_LINE, 9," 2 2 2  2 2  2 1 2  "
		CALL MAKE_FLOOR_LINE,10," 1 1 1  8 8  1 1 1  "
		CALL MAKE_FLOOR_LINE,11,"                    "
								;01234567890123466789
	
		CALL SET_TILE,8,1,던전플래그:46:33,0,4
		CALL SET_TILE,9,6,던전플래그:46:34,0,4
		CALL SET_TILE,17,10,던전플래그:46:35,0,4

		CALL SET_TILE,1,10,던전플래그:46:40,0,4
		CALL SET_TILE,3,10,던전플래그:46:41,0,4
		CALL SET_TILE,5,10,던전플래그:46:42,0,4

	CASE 2
	;신주쿠대성당２Ｆ北
		FLAG:최대X = 20
		FLAG:최대Y = 11
								;01234567890123456789
		CALL MAKE_FLOOR_LINE, 0,"                    "
		CALL MAKE_FLOOR_LINE, 1," 111111121 11111111 "
		CALL MAKE_FLOOR_LINE, 2," 1       1 1      1 "
		CALL MAKE_FLOOR_LINE, 3," 1     111 1    6 1 "
		CALL MAKE_FLOOR_LINE, 4," 1 121 2 1 1    2 2 "
		CALL MAKE_FLOOR_LINE, 5," 1   1 7 1 111111 1 "
		CALL MAKE_FLOOR_LINE, 6," 11111   1        1 "
		CALL MAKE_FLOOR_LINE, 7," 1   1   1   1111 1 "
		CALL MAKE_FLOOR_LINE, 8," 1 121 1211121111 1 "
		CALL MAKE_FLOOR_LINE, 9," 1                1 "
		CALL MAKE_FLOOR_LINE,10," 9                9 "
								;01234667890123466789

		CALL SET_TILE,3,4,던전플래그:46:1,1,4


		;宝箱の設置
		;마카736
		CALL SET_TILE,16,7,던전플래그:46:20,0,3
		;한마
		CALL SET_TILE,16,8,던전플래그:46:21,0,3
	
	CASE 3
	;신주쿠대성당２Ｆ南
		FLAG:최대X = 20 
		FLAG:최대Y = 11 
								;01234567890123466789
		CALL MAKE_FLOOR_LINE, 0," 9                9 "
		CALL MAKE_FLOOR_LINE, 1," 1           1  1 1 "
		CALL MAKE_FLOOR_LINE, 2," 111121      2  2 1 "
		CALL MAKE_FLOOR_LINE, 3," 1  1    11111111 1 "
		CALL MAKE_FLOOR_LINE, 4," 1  111121   1111 1 "
		CALL MAKE_FLOOR_LINE, 5," 1 9   1 1 1 1111 1 "
		CALL MAKE_FLOOR_LINE, 6,"   2   1   2 2  2 2 "
		CALL MAKE_FLOOR_LINE, 7," 11111 1 111 1  1 1 "
		CALL MAKE_FLOOR_LINE, 8," 2 2 2 1   1      1 "
		CALL MAKE_FLOOR_LINE, 9," 1 1 1 111211111111 "
		CALL MAKE_FLOOR_LINE,10,"                    "
								;01234667890123466789

		CALL SET_TILE,14,3,던전플래그:46:37,0,4

		CALL SET_TILE,1,9,던전플래그:46:43,0,4
		CALL SET_TILE,3,9,던전플래그:46:44,0,4
		CALL SET_TILE,5,9,던전플래그:46:45,0,4


	CASE 4
	;신주쿠대성당３Ｆ北
		FLAG:최대X = 20 
		FLAG:최대Y = 11 
								;01234567890123456789
		CALL MAKE_FLOOR_LINE, 0,"                    "
		CALL MAKE_FLOOR_LINE, 1," 112111121111211111 "
		CALL MAKE_FLOOR_LINE, 2," 1            1 2 1 "
		CALL MAKE_FLOOR_LINE, 3," 121 11111121 1 7 1 "
		CALL MAKE_FLOOR_LINE, 4," 1   1        1   1 "
		CALL MAKE_FLOOR_LINE, 5," 1111121111   11111 "
		CALL MAKE_FLOOR_LINE, 6," 1   1            2 "
		CALL MAKE_FLOOR_LINE, 7," 1   2 1111  121111 "
		CALL MAKE_FLOOR_LINE, 8," 121 111  1    1111 "
		CALL MAKE_FLOOR_LINE, 9," 1   1    1  121111 "
		CALL MAKE_FLOOR_LINE,10," 9   9            9 "
								;01234667890123466789

		CALL SET_TILE,10,9,던전플래그:46:38,0,4
		CALL SET_TILE,13,9,던전플래그:46:25,0,3


		;宝箱の設置
		;마력의향
		CALL SET_TILE,12,3,던전플래그:46:22,0,3
	
	CASE 5
	;신주쿠대성당３Ｆ南
		FLAG:최대X = 20 
		FLAG:최대Y = 11 
								;01234567890123466789
		CALL MAKE_FLOOR_LINE, 0," 9   9            9 "
		CALL MAKE_FLOOR_LINE, 1," 1   1    1       1 "
		CALL MAKE_FLOOR_LINE, 2," 1   1    2 1 1 1 1 "
		CALL MAKE_FLOOR_LINE, 3," 1  111   1 2 2 2 2 "
		CALL MAKE_FLOOR_LINE, 4," 2   1    111111111 "
		CALL MAKE_FLOOR_LINE, 5," 1 9              1 "
		CALL MAKE_FLOOR_LINE, 6,"   2              1 "
		CALL MAKE_FLOOR_LINE, 7," 11111            1 "
		CALL MAKE_FLOOR_LINE, 8," 2 2 2            1 "
		CALL MAKE_FLOOR_LINE, 9," 1 1 1 121111112111 "
		CALL MAKE_FLOOR_LINE,10,"                    "
								;012345678890123466789


		CALL SET_TILE,5,3,던전플래그:46:51,0,4
		CALL SET_TILE,12,2,던전플래그:46:1,2,4
		;MAG1040
		CALL SET_TILE,10,1,던전플래그:46:23,0,3
		;지혜의향
		CALL SET_TILE,7,9,던전플래그:46:24,0,3

		CALL SET_TILE,1,9,던전플래그:46:46,0,4
		CALL SET_TILE,3,9,던전플래그:46:47,0,4
		CALL SET_TILE,5,9,던전플래그:46:48,0,4


	CASE 6
		FLAG:최대X = 9 
		FLAG:최대Y = 12 
								;01234567890123466789
		CALL MAKE_FLOOR_LINE, 0,"         "
		CALL MAKE_FLOOR_LINE, 1,"   9   6 "
		CALL MAKE_FLOOR_LINE, 2,"   2   1 "
		CALL MAKE_FLOOR_LINE, 3," 1111111 "
		CALL MAKE_FLOOR_LINE, 4," 2 2 2 1 "
		CALL MAKE_FLOOR_LINE, 5," 1 1 1 1 "
		CALL MAKE_FLOOR_LINE, 6,"       1 "
		CALL MAKE_FLOOR_LINE, 7,"     111 "
		CALL MAKE_FLOOR_LINE, 8," 111   2 "
		CALL MAKE_FLOOR_LINE, 9," 2 11111 "
		CALL MAKE_FLOOR_LINE,10," 8       "
		CALL MAKE_FLOOR_LINE,11,"         "
								;01234667890123466789

		CALL SET_TILE,7,2,던전플래그:46:1,3,4

	CASEELSE


ENDSELECT


;=======================================================================
;[5]調べる　実行時の이벤트
;=======================================================================
@EVENT_CHECK_DUNGEON_46

;==========
;出口の処理
;==========
IF DA:(FLAG:현X):(FLAG:현Y) == 8
	CALL DUNGEON_EXIT
	RETURN 1
;========
;宝の処理
;========

ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 3
	SELECTCASE FLAG:현M
		CASE 2
			;마카736
			IF FLAG:현X == 16 && FLAG:현Y == 7
				CALL GET_TREASURE_MONEY,1,736,FLAG:현던전,20
			;한마
			ELSEIF FLAG:현X == 16 && FLAG:현Y == 8
				CALL GET_TREASURE,11302,1,FLAG:현던전,21
			ENDIF
		CASE 4
			;마력의향
			SIF FLAG:현X == 12 && FLAG:현Y == 3
				CALL GET_TREASURE,1012,1,FLAG:현던전,22
			;화제신부
			SIF FLAG:현X == 13 && FLAG:현Y == 9
				CALL GET_TREASURE,1031,2,FLAG:현던전,25
		CASE 5
			;지혜의향
			IF FLAG:현X == 7 && FLAG:현Y == 9
				CALL GET_TREASURE,1011,1,FLAG:현던전,24
			;MAG
			ELSEIF FLAG:현X == 10 && FLAG:현Y == 1
				CALL GET_TREASURE_MAG,0,30000,FLAG:현던전,23
			ENDIF
	ENDSELECT
	RETURN 1

;=======
;階段
;=======
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 6
	SELECTCASE FLAG:현M
		;一階昇り階段
		CASE 0
			SIF FLAG:현X == 7 && FLAG:현Y == 5
				CALL DUNGEON_UPSTAIRS,2,7,5
		;二階昇り階段
		CASE 2
			;ニ階　MAP6の座標を指定
			SIF FLAG:현X == 16 && FLAG:현Y == 3
				CALL DUNGEON_UPSTAIRS,4,16,3
		;地下一階昇り階段
		CASE 6
			SIF FLAG:현X == 7 && FLAG:현Y == 1
				CALL DUNGEON_UPSTAIRS,0,15,3

	ENDSELECT
	RETURN 1
	
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 7
	SELECTCASE FLAG:현M
		CASE 0
			SIF FLAG:현X == 15 && FLAG:현Y == 3
				CALL DUNGEON_DOWNSTAIRS,6,7,1
	
		CASE 2
			SIF FLAG:현X == 7 && FLAG:현Y == 5
				CALL DUNGEON_DOWNSTAIRS,0,7,5
		CASE 4
			SIF FLAG:현X == 16 && FLAG:현Y == 3
				CALL DUNGEON_DOWNSTAIRS,2,16,3
	ENDSELECT
	RETURN 1

;=======
;ワープ
;=======

ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 9
	SELECTCASE FLAG:현M
		
		CASE 0
			SIF FLAG:현X == 1 && FLAG:현Y == 10
				CALL DUNGEON_WORP,1,1,1
			SIF FLAG:현X == 18 && FLAG:현Y == 10
				CALL DUNGEON_WORP,1,18,1
				
		CASE 1
			SIF FLAG:현X == 1 && FLAG:현Y == 0
				CALL DUNGEON_WORP,0,1,9
			SIF FLAG:현X == 18 && FLAG:현Y == 0
				CALL DUNGEON_WORP,0,18,9
			;エレベーター　一階
			SIF FLAG:현X == 3 && FLAG:현Y == 6
				CALL E_PAZUSU

		CASE 2
			SIF FLAG:현X == 1 && FLAG:현Y == 10
				CALL DUNGEON_WORP,3,1,1
			SIF FLAG:현X == 18 && FLAG:현Y == 10
				CALL DUNGEON_WORP,3,18,1

		CASE 3
			SIF FLAG:현X == 1 && FLAG:현Y == 0
				CALL DUNGEON_WORP,2,1,9
			SIF FLAG:현X == 18 && FLAG:현Y == 0
				CALL DUNGEON_WORP,2,18,9
			;エレベーター　二階
			SIF FLAG:현X == 3 && FLAG:현Y == 5
				CALL E_PAZUSU

		CASE 4
			SIF FLAG:현X == 1 && FLAG:현Y == 10
				CALL DUNGEON_WORP,5,1,1
			SIF FLAG:현X == 18 && FLAG:현Y == 10
				CALL DUNGEON_WORP,5,18,1
			SIF FLAG:현X == 5 && FLAG:현Y == 10
				CALL DUNGEON_WORP,5,5,1

		CASE 5
			SIF FLAG:현X == 1 && FLAG:현Y == 0
				CALL DUNGEON_WORP,4,1,9
			SIF FLAG:현X == 18 && FLAG:현Y == 0
				CALL DUNGEON_WORP,4,18,9
			SIF FLAG:현X == 5 && FLAG:현Y == 0
				CALL DUNGEON_WORP,4,5,9

			;エレベーター　三階
			SIF FLAG:현X == 3 && FLAG:현Y == 5
				CALL E_PAZUSU
		CASE 6
			;エレベーター　地下
			SIF FLAG:현X == 3 && FLAG:현Y == 1
				CALL E_PAZUSU
		CASEELSE
	ENDSELECT
	RETURN 1
ELSE
	PRINTW 아무것도 없는 것 같다
	RETURN 0
ENDIF

;=======================================================================
;タイル進入時の이벤트
;=======================================================================
@EVENT_ENTER_DUNGEON_46,ARG
;ARG = 進入時の向き　0の場合ワープなど
;==========
;出口の処理
;==========
IF DA:(FLAG:현X):(FLAG:현Y) == 8
	CALL DUNGEON_EXIT
	RETURN 1
;========
;宝の処理
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 3
	SELECTCASE FLAG:현M
		CASE 2
			;마카736
			IF FLAG:현X == 16 && FLAG:현Y == 7
				CALL GET_TREASURE_MONEY,1,736,FLAG:현던전,20
			;한마
			ELSEIF FLAG:현X == 16 && FLAG:현Y == 8
				CALL GET_TREASURE,11302,1,FLAG:현던전,21
			ENDIF
		CASE 4
			;마력의향
			SIF FLAG:현X == 12 && FLAG:현Y == 3
				CALL GET_TREASURE,1012,1,FLAG:현던전,22
			;화제신부
			SIF FLAG:현X == 13 && FLAG:현Y == 9
				CALL GET_TREASURE,1031,2,FLAG:현던전,25
		CASE 5
			;지혜의향
			IF FLAG:현X == 7 && FLAG:현Y == 9
				CALL GET_TREASURE,1011,1,FLAG:현던전,24
			;MAG
			ELSEIF FLAG:현X == 10 && FLAG:현Y == 1
				CALL GET_TREASURE_MAG,0,30000,FLAG:현던전,23
			ENDIF
	ENDSELECT
	RETURN 1

;=======
;階段
;=======
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 6
	SELECTCASE FLAG:현M
		;一階昇り階段
		CASE 0
			SIF FLAG:현X == 7 && FLAG:현Y == 5
				CALL DUNGEON_UPSTAIRS,2,7,5
		;二階昇り階段
		CASE 2
			;ニ階　MAP6の座標を指定
			SIF FLAG:현X == 16 && FLAG:현Y == 3
				CALL DUNGEON_UPSTAIRS,4,16,3
		;地下一階昇り階段
		CASE 6
			SIF FLAG:현X == 7 && FLAG:현Y == 1
				CALL DUNGEON_UPSTAIRS,0,15,3

	ENDSELECT
	RETURN 1
	
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 7
	SELECTCASE FLAG:현M
		CASE 0
			SIF FLAG:현X == 15 && FLAG:현Y == 3
				CALL DUNGEON_DOWNSTAIRS,6,7,1
	
		CASE 2
			SIF FLAG:현X == 7 && FLAG:현Y == 5
				CALL DUNGEON_DOWNSTAIRS,0,7,5
		CASE 4
			SIF FLAG:현X == 16 && FLAG:현Y == 3
				CALL DUNGEON_DOWNSTAIRS,2,16,3
	ENDSELECT
	RETURN 1


;=======
;ワープ
;=======

ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 9
	SELECTCASE FLAG:현M
		
		CASE 0
			SIF FLAG:현X == 1 && FLAG:현Y == 10
				CALL DUNGEON_WORP,1,1,1
			SIF FLAG:현X == 18 && FLAG:현Y == 10
				CALL DUNGEON_WORP,1,18,1
				
		CASE 1
			SIF FLAG:현X == 1 && FLAG:현Y == 0
				CALL DUNGEON_WORP,0,1,9
			SIF FLAG:현X == 18 && FLAG:현Y == 0
				CALL DUNGEON_WORP,0,18,9
			;エレベーター　一階
			SIF FLAG:현X == 3 && FLAG:현Y == 6
				CALL E_PAZUSU

		CASE 2
			SIF FLAG:현X == 1 && FLAG:현Y == 10
				CALL DUNGEON_WORP,3,1,1
			SIF FLAG:현X == 18 && FLAG:현Y == 10
				CALL DUNGEON_WORP,3,18,1

		CASE 3
			SIF FLAG:현X == 1 && FLAG:현Y == 0
				CALL DUNGEON_WORP,2,1,9
			SIF FLAG:현X == 18 && FLAG:현Y == 0
				CALL DUNGEON_WORP,2,18,9
			;エレベーター　二階
			SIF FLAG:현X == 3 && FLAG:현Y == 5
				CALL E_PAZUSU

		CASE 4
			SIF FLAG:현X == 1 && FLAG:현Y == 10
				CALL DUNGEON_WORP,5,1,1
			SIF FLAG:현X == 18 && FLAG:현Y == 10
				CALL DUNGEON_WORP,5,18,1
			SIF FLAG:현X == 5 && FLAG:현Y == 10
				CALL DUNGEON_WORP,5,5,1

		CASE 5
			SIF FLAG:현X == 1 && FLAG:현Y == 0
				CALL DUNGEON_WORP,4,1,9
			SIF FLAG:현X == 18 && FLAG:현Y == 0
				CALL DUNGEON_WORP,4,18,9
			SIF FLAG:현X == 5 && FLAG:현Y == 0
				CALL DUNGEON_WORP,4,5,9
			;エレベーター　三階
			SIF FLAG:현X == 3 && FLAG:현Y == 5
				CALL E_PAZUSU
		CASE 6
			;エレベーター　地下
			SIF FLAG:현X == 3 && FLAG:현Y == 1
				CALL E_PAZUSU

		CASEELSE
	ENDSELECT
	RETURN 1


;========
;罠の処理
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 5
	CALL TRAP_46
	RETURN RESULT

;==========
;扉の処理
;==========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 2
	CALL DUNGEON_DOOR,ARG
	RETURN 1

;========================
;이벤트
;========================
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 4
	IF FLAG:현M == 0 && FLAG:현X == 10 && FLAG:현Y == 5 && 던전플래그:46:0 == 0 
		CUSTOMDRAWLINE =
		PRINTFORML ＞거기에는 우에노에서 해방된 파주주가 있었다
		PRINTFORMW 「잘 찾아왔습니다、구세주님」
		IF 던전플래그:46:50 == 1
			PRINTFORML 「메시아 프로젝트에 참여하시겠습니까？」
			PRINTFORMW 「구세주 님께서 원하기만 한다면 순종적이고 헌신적인 유능한 노예들을 얼마든지 준비해 드리지요」
		ELSEIF 던전플래그:46:90 == 1
			PRINTFORML 「아무래도… 좋지 않은 일을 하려는 자들이 불필요한 바람을 불어 넣었나 보군요」
			PRINTFORMW 「구세주 님、잘 생각하세요」
			PRINTFORMW 「이 세상에는 지배하는 유능한 사람과 지배 당하는 무능한 사람 밖에 없답니다」
			PRINTFORMW 「구세주 님은 지배하는 쪽、무능한 인간의 말에 귀를 기울여선 안 됩니다」
			PRINTFORMW 「당신이 저에게 협력하겠다고 약속하신다면 순종적이고 헌신적인 유능한 노예들을 얼마든지 준비해 드릴 수 있습니다」
		ENDIF
		IF FINDCHARA_B(4501,1)== 2 && (TALENT:(RESULT:1):연모 || TALENT:(RESULT:1):친애)
			PRINTFORML 『……당신 무슨 말이지！？』
			PRINTFORML 「네 놈을 대신할 건 얼마든지 있다는 이야기란다、아가씨」
			PRINTFORMW 『이 악마에게 귀 기울이지 마십시오、구세주 님』
			PRINTFORMW 「실패작은 역시 실패작이라는건가」
			PRINTFORMW 「가짜 구세주와 함께 죽으세요！！」
			PRINTW 사신邪神 파주주가 １체 나타났다！
			CUSTOMDRAWLINE =
			WAIT
			FLAG:도주불가플래그 = 1
			FLAG:회화불능플래그 = 1
			FLAG:선제기습취소 = 1
			CALL SET_ENEMY,9,[[キャラ:파주주]],55,0,1
			CSTR:(CHARANUM-1):사고패턴 = 255
			CFLAG:(CHARANUM-1):ＨＰ보정 = 3000
			CFLAG:(CHARANUM-1):ＭＰ보정 = 9000
			CFLAG:(CHARANUM-1):행동횟수 = 2
			CFLAG:(CHARANUM-1):속도보정 = 15
			ABL:(CHARANUM-1):스킬1 = 706
			ABL:(CHARANUM-1):스킬2 = 1008
			ABL:(CHARANUM-1):스킬3 = 1009
			ABL:(CHARANUM-1):스킬4 = 1402
			ABL:(CHARANUM-1):스킬5 = 1706
			ABL:(CHARANUM-1):스킬6 = 1903
			ABL:(CHARANUM-1):스킬7 = 0
			ABL:(CHARANUM-1):스킬8 = 0
			MAXBASE:(CHARANUM-1):검격 = 80
			MAXBASE:(CHARANUM-1):비구 = 125
			MAXBASE:(CHARANUM-1):타격 = 80
			MAXBASE:(CHARANUM-1):전술 = 80
			MAXBASE:(CHARANUM-1):화염 = 0
			MAXBASE:(CHARANUM-1):빙결 = 125
			MAXBASE:(CHARANUM-1):전격 = 125
			MAXBASE:(CHARANUM-1):충격 = -100
			MAXBASE:(CHARANUM-1):신경 = 50
			MAXBASE:(CHARANUM-1):정신 = 50
			MAXBASE:(CHARANUM-1):파마 = 125
			MAXBASE:(CHARANUM-1):주살 = 999
			MAXBASE:(CHARANUM-1):지변 = 0
			MAXBASE:(CHARANUM-1):수격 = 125
			MAXBASE:(CHARANUM-1):질풍 = -100
			MAXBASE:(CHARANUM-1):중력 = 125
			MAXBASE:(CHARANUM-1):핵열 = 0
			MAXBASE:(CHARANUM-1):만능 = 100
			MAXBASE:(CHARANUM-1):사이코 = 100
			CALL SYNC_STATUS,(CHARANUM-1)
			CALL HEALTH_CHARA,(CHARANUM-1)
			CALL BATTLE_START
			FLAG:도주불가플래그 = 0
			FLAG:회화불능플래그 = 0
			FLAG:선제기습취소 = 0
		ELSE
			PRINTFORMW 「우리에게 협력하겠습니까？」
			PRINTL 
			PRINTL [0] 네
			PRINTL [1] 아니요
			$INPUT_LOOP_PAZUSU
			INPUT
			IF RESULT == 0
				;Dark/Low
				;속성を固定
				FLAG:속성고정LD = 3
				FLAG:속성고정LC = 1
				던전플래그:46:2 = 1
			ELSEIF RESULT == 1
				PRINTFORML 「이해해 주시겠습니까」
				PRINTFORML 「결국은 구세주 후보」
				PRINTFORML 「쓸모없는 인형에겐 볼 일 없습니다」
				PRINTFORMW 「죽여드리지요！！」
				PRINTW 광인 베스가 2체 나타났다！
				PRINTW 사신邪神 파주주가 １체 나타났다！
				CUSTOMDRAWLINE =
				WAIT
				FLAG:도주불가플래그 = 1
				FLAG:회화불능플래그 = 1
				FLAG:선제기습취소 = 1
				CALL SET_ENEMY,9,[[キャラ:파주주]],49,0,1
				CSTR:(CHARANUM-1):사고패턴 = 255
				CFLAG:(CHARANUM-1):ＨＰ보정 = 1500
				CFLAG:(CHARANUM-1):ＭＰ보정 = 9000
				CFLAG:(CHARANUM-1):행동횟수 = 2
				CFLAG:(CHARANUM-1):속도보정 = 10
				ABL:(CHARANUM-1):스킬1 = 706
				ABL:(CHARANUM-1):스킬2 = 1008
				ABL:(CHARANUM-1):스킬3 = 1009
				ABL:(CHARANUM-1):스킬4 = 1402
				ABL:(CHARANUM-1):스킬5 = 1706
				ABL:(CHARANUM-1):스킬6 = 1903
				ABL:(CHARANUM-1):스킬7 = 0
				ABL:(CHARANUM-1):스킬8 = 0
				MAXBASE:(CHARANUM-1):검격 = 80
				MAXBASE:(CHARANUM-1):비구 = 125
				MAXBASE:(CHARANUM-1):타격 = 80
				MAXBASE:(CHARANUM-1):전술 = 80
				MAXBASE:(CHARANUM-1):화염 = 0
				MAXBASE:(CHARANUM-1):빙결 = 125
				MAXBASE:(CHARANUM-1):전격 = 125
				MAXBASE:(CHARANUM-1):충격 = -100
				MAXBASE:(CHARANUM-1):신경 = 50
				MAXBASE:(CHARANUM-1):정신 = 50
				MAXBASE:(CHARANUM-1):파마 = 125
				MAXBASE:(CHARANUM-1):주살 = 999
				MAXBASE:(CHARANUM-1):지변 = 0
				MAXBASE:(CHARANUM-1):수격 = 125
				MAXBASE:(CHARANUM-1):질풍 = -100
				MAXBASE:(CHARANUM-1):중력 = 125
				MAXBASE:(CHARANUM-1):핵열 = 0
				MAXBASE:(CHARANUM-1):만능 = 100
				MAXBASE:(CHARANUM-1):사이코 = 100
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)

				CALL SET_ENEMY,8,[[キャラ:베스]],35,0,1
				CFLAG:(CHARANUM-1):ＨＰ보정 = 500
				CFLAG:(CHARANUM-1):ＭＰ보정 = 1000
				CFLAG:(CHARANUM-1):속도보정 = 10
				ABL:(CHARANUM-1):스킬1 = 402
				ABL:(CHARANUM-1):스킬2 = 418
				ABL:(CHARANUM-1):스킬3 = 903
				ABL:(CHARANUM-1):스킬4 = 905
				ABL:(CHARANUM-1):스킬5 = 1214
				ABL:(CHARANUM-1):스킬6 = 2005
				ABL:(CHARANUM-1):스킬7 = 0
				ABL:(CHARANUM-1):스킬8 = 0
				EQUIP:(CHARANUM-1):검 = [[아이템:아세이미나이프]]
				EQUIP:(CHARANUM-1):총 = [[아이템:IMI데저트이글]]
				EQUIP:(CHARANUM-1):머리 = [[아이템:팬저헬름]]
				EQUIP:(CHARANUM-1):몸통 = [[아이템:팬저수트]]
				EQUIP:(CHARANUM-1):팔 = [[아이템:팬저피스트]]
				EQUIP:(CHARANUM-1):발 = [[아이템:팬저레그]]
				EQUIP:(CHARANUM-1):악세서리 = [[아이템:매직링]]
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)

				CALL SET_ENEMY,10,[[キャラ:베스]],35,0,1
				CFLAG:(CHARANUM-1):ＨＰ보정 = 500
				CFLAG:(CHARANUM-1):ＭＰ보정 = 1000
				CFLAG:(CHARANUM-1):속도보정 = 10
				ABL:(CHARANUM-1):스킬1 = 402
				ABL:(CHARANUM-1):스킬2 = 418
				ABL:(CHARANUM-1):스킬3 = 903
				ABL:(CHARANUM-1):스킬4 = 905
				ABL:(CHARANUM-1):스킬5 = 1214
				ABL:(CHARANUM-1):스킬6 = 2005
				ABL:(CHARANUM-1):스킬7 = 0
				ABL:(CHARANUM-1):스킬8 = 0
				EQUIP:(CHARANUM-1):검 = [[아이템:아세이미나이프]]
				EQUIP:(CHARANUM-1):총 = [[아이템:IMI데저트이글]]
				EQUIP:(CHARANUM-1):머리 = [[아이템:팬저헬름]]
				EQUIP:(CHARANUM-1):몸통 = [[아이템:팬저수트]]
				EQUIP:(CHARANUM-1):팔 = [[아이템:팬저피스트]]
				EQUIP:(CHARANUM-1):발 = [[아이템:팬저레그]]
				EQUIP:(CHARANUM-1):악세서리 = [[아이템:매직링]]
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
				CALL BATTLE_START
				FLAG:도주불가플래그 = 0
				FLAG:회화불능플래그 = 0
				FLAG:선제기습취소 = 0
			ELSE
				GOTO INPUT_LOOP_PAZUSU
			ENDIF
		ENDIF
		IF 던전플래그:46:2 == 1
			PRINTFORML 「그 대답을 기다리고 있었습니다」
			PRINTFORMW 「드디어 가이아교와 전쟁이 시작됩니다」
			PRINTFORML 「구세주 님、시나가와에 와 주십시요」
			PRINTFORMW 「저도 당분간은 이 땅을 비워야 합니다만 용서해 주십시요」
			PRINTFORML 「때가 되면 저도 구세주 님의 하인으로서 힘을 빌려드리지요」
			PRINTFORMW 「그날을 즐겁게 기다리지요、큭큭큭」
			CALL LIFTING_A_BAN([[キャラ:파주주]])
			;FLAG:11617 = 1
			CUSTOMDRAWLINE =
		ELSEIF FINDCHARA_B(4501,1)== 2 && (TALENT:(RESULT:1):연모 || TALENT:(RESULT:1):친애)
			PRINTFORML 「…네 녀석은……진짜 구세주…！？」
			PRINTFORML 「설마、이런 곳에서 당할 줄이야…」
			PRINTFORML 「뭐、괜찮겠지요… 나이트메어 시스템이 완성되면 인간 따위……」
			PRINTFORMW 「먼저 지옥에서 기다리지요」
			PRINTFORMW 「진실을 알고 절망해라、구세주！！」
			IF 던전플래그:46:2 == 0
				PRINTL 
				PRINTL 파주주의 시체에서 필러가 나타났다。
				PRINTW 화성의 필러를 손에 넣었다！
;				PRINTFORMW 화성의 힘이 %CALLNAME:MASTER%에게 힘을 준다…。
				PRINTL 
;				PRINTFORMW %CALLNAME:MASTER%의 모든 능력이 상승했다！
;				BASE:MASTER:힘 += 1
;				BASE:MASTER:지혜 += 1
;				BASE:MASTER:마력 += 1
;				BASE:MASTER:인내력 += 1
;				BASE:MASTER:속도 += 1
;				BASE:MASTER:운 += 1
			ENDIF
			PRINTFORML 
			PRINTFORMW 사신邪神 파주주를 쓰러뜨린 일에 대해 가이아교에서 현상금을 지불하였다。
			PRINTFORMW %CALLNAME:MASTER%의 계좌에도 ￥50000이 들어왔다。
			MONEY += 50000
		ELSE
			PRINTFORML 「큭… 어리석은 인간놈」
			PRINTFORML 「열심히 잘난척 해라」
			PRINTFORML 「나이트메어 시스템이 완성될 새벽에는…」
			PRINTFORMW 「인류따위… 마그네타이트나 생산할 가축이 될 테니까…」
			IF 던전플래그:46:2 == 0
				PRINTL 
				PRINTL 파주주의 시체에서 필러가 나타났다。
				PRINTW 화성의 필러를 손에 넣었다！
;				PRINTFORMW 화성의 힘이 %CALLNAME:MASTER%에게 힘을 준다…。
				PRINTL 
;				PRINTFORMW %CALLNAME:MASTER%의 모든 능력이 상승했다！
;				BASE:MASTER:힘 += 1
;				BASE:MASTER:지혜 += 1
;				BASE:MASTER:마력 += 1
;				BASE:MASTER:인내력 += 1
;				BASE:MASTER:속도 += 1
;				BASE:MASTER:운 += 1
			ENDIF
			PRINTFORML 
			PRINTFORMW 사신邪神 파주주를 쓰러뜨린 일에 대해 가이아교에서 현상금을 지불하였다。
			PRINTFORMW %CALLNAME:MASTER%의 계좌에도 ￥50000이 들어왔다。
			MONEY += 50000
		ENDIF
		던전플래그:46:0 = 1

	ELSEIF FLAG:현M == 0 && FLAG:현X == 5 && FLAG:현Y == 3
		PRINTFORML ＞메시아교도가 있다
		PRINTFORML 「구세주 님이 나타날 때가 가깝도다」
		PRINTFORMW 「당신도 함께 신에게 기도를 드립시다」
		던전플래그:46:30 = 1
	ELSEIF FLAG:현M == 0 && FLAG:현X == 3 && FLAG:현Y == 8
		PRINTFORML ＞메시아교도가 있다
		PRINTFORML 「이 대성당은 많은 템플나이트들이 지키고 있어요」
		PRINTFORMW 「악마가 와도 안심이군요」
		던전플래그:46:31 = 1
	ELSEIF FLAG:현M == 0 && FLAG:현X == 15 && FLAG:현Y == 8
		PRINTFORML ＞노인이 있다
		PRINTFORML 「이 대성당은 신의 가호가 지켜주신다」
		PRINTFORMW 「여기에 있으면 악마를 무서워할 필요도 없지」
		던전플래그:46:32 = 1
	ELSEIF FLAG:현M == 1 && FLAG:현X == 8 && FLAG:현Y == 1
		PRINTFORML ＞메시아교도가 있다
		PRINTFORML 「당신도 메시아교에 들어오기 위해 왔습니까？」
		PRINTFORMW 「함께 신에게 기도합시다」
		던전플래그:46:33 = 1
	ELSEIF FLAG:현M == 1 && FLAG:현X == 9 && FLAG:현Y == 6
		PRINTFORML ＞템플나이트가 있다
		PRINTFORML 「이 신주쿠 대성당은 메시아교에게 중요한 곳」
		PRINTFORMW 「시나가와의 대성당 만큼은 아니지만 훌륭한 곳입니다」
		던전플래그:46:34 = 1
	ELSEIF FLAG:현M == 1 && FLAG:현X == 17 && FLAG:현Y == 10 && 던전플래그:46:35 == 0 
		;신주쿠クリア
		IF 던전플래그:42:0 >= 1 || FLAG:DEBUG
			PRINTFORML ＞신주쿠에서 만난 소년탐정이 있다
			PRINTFORML 「오랜만입니다」
			PRINTFORML 「메시아 프로젝트、나이트메어 시스템이라는 말을 들은 적 없습니까？」
			PRINTFORML 「신주쿠에 벌어진 일련의 악마변신사건도 그 메시아 프로젝트와 연관이 있는 것 같습니다」
			PRINTFORML 「만약、뭔가 정보를 얻게 된다면 알려주면 좋겠습니다」
			PRINTFORMW 「그럼…」
			던전플래그:46:1 = 1
		ELSE
			PRINTFORML ＞모자를 쓴 소년이 있다
			PRINTFORML 「당신은 메시아교도가 아닌 것 같네요」
			PRINTFORMW 「볼 일이 없다면 빨리 떠나는 것을 권합니다」
		ENDIF
		던전플래그:46:35 = 1
	ELSEIF FLAG:현M == 2 && FLAG:현X == 3 && FLAG:현Y == 4 && 던전플래그:46:36 == 0
		PRINTFORML ＞신주쿠에서 만난 소년탐정이 있다
		PRINTFORML 「역시、이곳의 지하에서 어떤 실험을 하고 있는 것 같습니다」
		PRINTFORML 「더 상세한 조사를 하려고는 합니다만…」
		PRINTFORMW 「당신도 조심하시길」
		던전플래그:46:36 = 1
		던전플래그:46:1 = 2

	ELSEIF FLAG:현M == 3 && FLAG:현X == 14 && FLAG:현Y == 3
		PRINTFORML ＞템플나이트가 있다
		PRINTFORML 「교단에서는 법과 질서를 무시무시한 힘을 지닌 악마로부터 지켜야 하기 때문에 어떤 힘이든 손에 넣어도 상관없다고 말하고 있지만」
		PRINTFORMW 「우리들은 과연 정말로 정의로운걸까…」
		던전플래그:46:37 = 1

	ELSEIF FLAG:현M == 4 && FLAG:현X == 10 && FLAG:현Y == 9 && 던전플래그:46:38 == 0
		;さらに改変する案を思いついた、ここをＢＢＡにすれば統合性が出る
		PRINTFORML ＞메이아교의 법의로 몸을 감싼 여자가 있다
		IF FINDCHARA_B(4501,1)== 2 && (TALENT:(RESULT:1):연모 || TALENT:(RESULT:1):친애)
			PRINTFORML 『히로코 님、이 땅은 어떻게 된 겁니까！？』
			PRINTFORML 「어서오세요、베스」
			PRINTFORMW 「당신에게 옛날 이야기를 하지 않으면 안되겠네요」
		ENDIF
		PRINTFORML 「일찌기 이 땅에는 네 명의 대천사님이 계셨습니다」
		PRINTFORML 「삼인의 대천사님은 구세주가 나타나지 않자 고심 끝에、인간의 아이는 신이 준 시련을 자력으로 넘을 수 없다고 여겼습니다」
		PRINTFORML 「그리고 그 중의 오직 한 분」
		PRINTFORML 「그러한 행동은 신의 뜻에 반한다고 반대하신 대천사님은 마음을 다치시고 자취를 감췄습니다」
		PRINTFORML 「그리고、지금… 이 땅을 다스리고 있는 것은 고대 바빌로니아의 사신邪神파주주」
		IF FINDCHARA_B(4501,1)== 2 && (TALENT:(RESULT:1):연모 || TALENT:(RESULT:1):친애)
			PRINTFORML 「이 세계는 본래의 모습을 잊어버리고 있습니다」
			PRINTFORML 「수많은 운명이 서로 얽혀 당신과 베스에게도 몇 개의 길이 있답니다る」
			PRINTFORML 「나는 당신이 구세주가 되는 길을 선택해줬으면 바라지만、강요하지는 않아요」
			PRINTFORMW 「메시아교의 진실을 알고 싶다면 파주주를 쓰러뜨리고 베스와 함께 시나가와로 오세요」
			PRINTFORMW ＞그렇게 말하고 법의의 모양새를 다듬으며 히로코는 떠나갔다
			던전플래그:46:90 = 1
		ELSE
			PRINTFORML 「그들은 신의 지상 대행자를 자처하며、세상의 미래를 걱정하는 것 같지만」
			PRINTFORML 「그 앞에 닥칠 미래는 모든 선택의 여지를 빼앗기고 가축처럼 관리되는 세계」
			PRINTFORMW 「약자는 강자를 따라야 할 뿐、스스로 생각할 수 조차 없게 됩니다」
			PRINTFORML 「이것이 올바른 법과 질서의 본래 모습인가？」
			PRINTFORML 「인간은 약해서 잘못을 저지르지요」
			PRINTFORML 「하지만 다른 사람과의 접촉을 통해 자신의 잘못을 깨닫고 실수를 바로 잡을 수 있습니다」
			PRINTFORML 「사람은 혼자 살 수 없답니다.」
			PRINTFORMW 「당신도 당신을 연모하는 노예를 소중히 해 주세요」
			PRINTFORMW ＞이렇게 말한 다음 법의을 고쳐 입으며 여자는 떠나갔다
		ENDIF
		던전플래그:46:38 = 1

	ELSEIF FLAG:현M == 5 && FLAG:현X == 12 && FLAG:현Y == 2 && 던전플래그:46:39 == 0
		PRINTFORML ＞신주쿠에서 만난 소년 탐정이 앉아있다
		PRINTFORML 「지하 시설의 열쇠를 손에 넣긴 했습니다만…」
		PRINTFORML 거칠게 숨을 내쉬는 소년의 안색이 새파랗게 질려갔다
		PRINTFORMW 「메시아교단은… 생체MAG를 강제로 추출하는…」
		PRINTFORMW 「…나이트메어 시스템이라는 무서운 기계를 만들고 있습니다」
		PRINTFORMW 「어쩌면 이미 완성했을지도… 나 대신 조사해 주실 순 없겠습니까？」
		IF FINDCHARA_B(4501,1)== 2 && (TALENT:(RESULT:1):연모 || TALENT:(RESULT:1):친애)
			PRINTFORML 『좋아요、맡겠습니다』
			PRINTFORMW %마스터가% 결정하는 것보다 빠르게 베스가 즉각 대답했다
			PRINTFORMW 『교단에 도대체 무슨 일이 벌어지고 있는지 나는 알고 싶어、힘을 빌려줘』
			던전플래그:46:1 = 3
		ELSE
			PRINTL 
			PRINTL 어떻게 할까？
			PRINTL 
			PRINTL [0] 네
			PRINTL [1] 아니요
			PRINTL [2] 데리고 돌아가 노예로 만든다
			$INPUT_LOOP_C1
			INPUT
			IF RESULT == 0
				CALL INCREASE_LD,5
				PRINTFORML 「감사합니다」
				PRINTFORML 「이것이… 교회 문의 열쇠입니다」
				PRINTFORMW ＞소년으로부터 %마스터는% 열쇠 꾸러미를 받았다
				던전플래그:46:1 = 3
			ELSEIF RESULT == 1
				CALL INCREASE_LD,-5
				PRINTFORMW ＞%마스터는% 소년의 제안을 거절했다
			ELSEIF RESULT == 2
				PRINTFORML 「큭… 무슨！？」
				PRINTFORMW %마스터는% 저항하는 소년을 붙잡아 데리고 돌아갔다
				CALL INCREASE_LD,-10
				CALL INCREASE_LC,-10
				CALL ADD_NEW_COMPANION,4541,300
				FLAG:탈출 = 1
				던전플래그:46:1 = 3
			ELSE
				GOTO INPUT_LOOP_C1
			ENDIF
			던전플래그:46:39 = 1
		ENDIF
	ELSEIF FLAG:현M == 5 && FLAG:현X == 5 && FLAG:현Y == 3
		PRINTFORML ＞백합 꽃밭이다
		PRINTFORML ＞천정에서 빛이 비추어지고 있어
		PRINTFORMW ＞환상적인 분위기가 느껴진다
		던전플래그:46:51 = 1

	ELSEIF FLAG:현M == 6 && FLAG:현X == 7 && FLAG:현Y == 2 && 던전플래그:46:50 == 0 && 던전플래그:46:1 == 3
		CUSTOMDRAWLINE =
		PRINTFORML ＞템플나이트가 있다
		PRINTFORML 「거수자놈、얌전히 투항하라！！」
		PRINTW 템플나이트가 3체 나타났다
		CUSTOMDRAWLINE =
		WAIT
		FLAG:도주불가플래그 = 1
		FLAG:회화불능플래그 = 1
		FLAG:선제기습취소 = 1
		;전투後の경험値処理をスキップする
		FLAG:RESULT스킵 = 1

		CALL SET_ENEMY,8,[[キャラ:템플나이트]],46,1,1
		;번개찌르기
		ABL:(CHARANUM-1):스킬1 = 9
		;데스바운드
		ABL:(CHARANUM-1):스킬2 = 10
		;한마
		ABL:(CHARANUM-1):스킬3 = 1302
		CALL SYNC_STATUS,(CHARANUM-1)
		CALL HEALTH_CHARA,(CHARANUM-1)

		CALL SET_ENEMY,9,[[キャラ:템플나이트]],46,1,1
		;타루카쟈
		ABL:(CHARANUM-1):스킬1 = 501
		;찰나장대비쏘기
		ABL:(CHARANUM-1):스킬2 = 108
		;한마
		ABL:(CHARANUM-1):스킬3 = 1302
		CALL SYNC_STATUS,(CHARANUM-1)
		CALL HEALTH_CHARA,(CHARANUM-1)

		CALL SET_ENEMY,10,[[キャラ:템플나이트]],46,1,1
		;메・디아라마
		ABL:(CHARANUM-1):스킬1 = 405
		;サム리캄
		ABL:(CHARANUM-1):스킬2 = 418
		;한마
		ABL:(CHARANUM-1):스킬3 = 1302
		CALL SYNC_STATUS,(CHARANUM-1)
		CALL HEALTH_CHARA,(CHARANUM-1)

		CALL BATTLE_START
		FLAG:도주불가플래그 = 0
		FLAG:회화불능플래그 = 0
		FLAG:선제기습취소 = 0
		;전투後の경험値処理をスキップする
		FLAG:RESULT스킵 = 0
		
		PRINTFORML 「큭… 파주주님에게 연락해라」
		PRINTFORMW 「거수자가 연구 블록에 침입했다」
		던전플래그:46:50 = 1
		던전플래그:46:1 = 4
	ENDIF



	IF FLAG:현M == 1 && FLAG:현X == 1 && FLAG:현Y == 10 && 던전플래그:46:40 == 0
		PRINTFORML ＞배양플랜트가 있다
		PRINTFORMW ＞유리케이스 안은 비어있다 
		던전플래그:46:40 = 1
	ELSEIF FLAG:현M == 1 && FLAG:현X == 3 && FLAG:현Y == 10 && 던전플래그:46:41 == 0
		PRINTFORML ＞배양플랜트가 있다
		PRINTFORML ＞유리케이스에는 쳐다보기 힘들 정도로 무서운 모습의 고기 덩어리가 
		PRINTFORMW ＞떠다니고 있었다
		던전플래그:46:41 = 1
	ELSEIF FLAG:현M == 1 && FLAG:현X == 5 && FLAG:현Y == 10 && 던전플래그:46:42 == 0
		PRINTFORML ＞연구실인 것 같다
		PRINTFORML ＞책상 위에는 실험대상의 연구기록이 남아있다
		IF FINDCHARA_B(4501,1)== 2 && (TALENT:(RESULT:1):연모 || TALENT:(RESULT:1):친애)
			PRINTFORML 연구기록 읽는 것을 베스가 완강하게 거절한다
			PRINTFORMW %마스터는% 연구기록을 그 자리에 놔두고 떠났다
		ELSE
			PRINTL 
			PRINTL 어떻게 할까？
			PRINTL 
			PRINTL [0] 읽는다
			PRINTL [1] 무시한다
			$INPUT_LOOP_BES1
			INPUT
			IF RESULT == 0
				CALL INCREASE_LD,-5
				PRINTFORML 전문용어를 많이 사용해서 연구기록을 모두 파악할 순 없었지만 
				PRINTFORML 이 연구시설이 인체를 베이스로 한 인공적인 이능자 창조
				PRINTFORMW 악마 합체가 연구되고 있었다는 것을 알았다
			ELSEIF RESULT == 1
				PRINTFORMW %마스터는% 연구기록을 무시하고 그 자리를 떠났다
			ELSE
				GOTO INPUT_LOOP_BES1
			ENDIF
		ENDIF
		던전플래그:46:42 = 1

	ELSEIF FLAG:현M == 3 && FLAG:현X == 1 && FLAG:현Y == 9 && 던전플래그:46:43 == 0
		PRINTFORML ＞배양플랜트가 있다
		PRINTFORMW ＞유리케이스 안에는 일찍이 인간이었을 물체가 떠다니고 있다… 
		던전플래그:46:43 = 1
	ELSEIF FLAG:현M == 3 && FLAG:현X == 3 && FLAG:현Y == 9 && 던전플래그:46:44 == 0
		PRINTFORML ＞배양플랜트가 있다
		PRINTFORMW ＞유리케이스 안은 비어있다
		던전플래그:46:44 = 1
	ELSEIF FLAG:현M == 3 && FLAG:현X == 5 && FLAG:현Y == 9 && 던전플래그:46:45 == 0
		PRINTFORML ＞연구실인 것 같다
		PRINTFORML ＞책상 위에는 연구기록이 남아 있다
		IF FINDCHARA_B(4501,1)== 2 && (TALENT:(RESULT:1):연모 || TALENT:(RESULT:1):친애)
			PRINTFORML 연구기록 읽는 것을 베스가 완강하게 거절한다
			PRINTFORMW %마스터는% 연구기록을 그 자리에 놔두고 떠났다
		ELSE
			PRINTL 
			PRINTL 어떻게 할까？
			PRINTL 
			PRINTL [0] 읽는다
			PRINTL [1] 무시한다
			$INPUT_LOOP_BES2
			INPUT
			IF RESULT == 0
				CALL INCREASE_LD,-5
				PRINTFORML 메시아 프로젝트
				PRINTFORML 유전자 배합에 의한 인위적인 이능자의 창조
				PRINTFORMW 이 연구소에서는 구세주나 성모의 소질을 가진 인간을 인공적으로 배양하는 연구가 이루어졌던 것 같다
			ELSEIF RESULT == 1
				PRINTFORMW %마스터는% 연구기록을 무시하고 그 자리를 떠났다
			ELSE
				GOTO INPUT_LOOP_BES2
			ENDIF
		ENDIF
		던전플래그:46:45 = 1
	ELSEIF FLAG:현M == 5 && FLAG:현X == 1 && FLAG:현Y == 9 && 던전플래그:46:46 == 0
		PRINTFORML ＞연구실인 것 같다
		PRINTFORML ＞책상 위에는 실험대상의 연구기록이 남아있다
		IF FINDCHARA_B(4501,1)== 2 && (TALENT:(RESULT:1):연모 || TALENT:(RESULT:1):친애)
			PRINTFORML 연구기록 읽는 것을 베스가 완강하게 거절한다
			PRINTFORMW %마스터는% 연구기록을 그 자리에 놔두고 떠났다
		ELSE
			PRINTL 
			PRINTL 어떻게 할까？
			PRINTL 
			PRINTL [0] 읽는다
			PRINTL [1] 무시한다
			$INPUT_LOOP_BES3
			INPUT
			IF RESULT == 0
				CALL INCREASE_LD,-5
				PRINTFORML 실험대상 No5261에 관한 경과보고
				PRINTFORML 최종교육과정 종료
				PRINTFORML 교단에 인도를 완료
				PRINTFORML 실험대상 No5261의 템플나이트 배속이 결정
				PRINTFORML 이후 실험대상 No5261의 호칭을 베스로 바꾼다
				PRINTFORMW 그 외 몇 가지 투약 기록이 써 있지만 %마스터는% 잘 이해할 수 없었다
			ELSEIF RESULT == 1
				PRINTFORMW %마스터는% 연구기록을 무시하고 그 자리를 떠났다
			ELSE
				GOTO INPUT_LOOP_BES3
			ENDIF
		ENDIF
		던전플래그:46:46 = 1
	ELSEIF FLAG:현M == 5 && FLAG:현X == 3 && FLAG:현Y == 9 && 던전플래그:46:47 == 0
		PRINTFORML ＞방 안에 넓은 공간이 펼쳐져 있다
		PRINTFORMW ＞바닥에는 무언가 무거운 물체를 옮긴 흔적이 남아있다
		SIF FINDCHARA_B(4501,1)== 2 && (TALENT:(RESULT:1):연모 || TALENT:(RESULT:1):친애)
			PRINTFORMW 「여기에 연구시설이 있었을 텐데…」
		던전플래그:46:47 = 1

	ELSEIF FLAG:현M == 5 && FLAG:현X == 5 && FLAG:현Y == 9&& 던전플래그:46:48 == 0
		PRINTFORML ＞연구실인 것 같다
		PRINTFORML ＞책상 위에는 실험대상의 연구기록이 남아있다
		IF FINDCHARA_B(4501,1)== 2 && (TALENT:(RESULT:1):연모 || TALENT:(RESULT:1):친애)
			PRINTFORML 연구기록 읽는 것을 베스가 완강하게 거절한다
			PRINTFORMW %마스터는% 연구기록을 그 자리에 놔두고 떠났다
		ELSE
			PRINTL 
			PRINTL 어떻게 할까？
			PRINTL 
			PRINTL [0] 읽는다
			PRINTL [1] 무시한다
			$INPUT_LOOP_BES4
			INPUT
			IF RESULT == 0
				CALL INCREASE_LD,-5
				PRINTFORML 사고보고서
				PRINTFORML 연구자 하나다에 의하면 No5200번 대에 장치된 폭탄의 제거는 능하다고 단정
				PRINTFORMW 폐기처분한다
			ELSEIF RESULT == 1
				PRINTFORMW %마스터는% 연구기록을 무시하고 그 자리를 떠났다
			ELSE
				GOTO INPUT_LOOP_BES4
			ENDIF
		ENDIF
		던전플래그:46:48 = 1
	ENDIF
ENDIF
RETURN 0

;=======================================================================
;인카운트율
;=======================================================================
@ENCOUNT_RATE_46
SELECTCASE FLAG:현M
	CASEELSE
		IF 던전플래그:46:1 >= 2
			FLAG:인카운트율 = FLAG:미조우걸음수*5 + 5
		ELSEIF 던전플래그:46:1 == 1
			FLAG:인카운트율 = FLAG:미조우걸음수*5
		ELSE
			FLAG:인카운트율 = 0
		ENDIF
ENDSELECT
SIF FLAG:미조우걸음수 < 5
	FLAG:인카운트율 = 0
;=======================================================================
;필요레벨눈安
;권장LV 雑魚최저LV 雑魚最高LV ボスLV 
;=======================================================================
@GET_DUNGEON_LV_46
RETURN 37, 34, 43, 55
;=======================================================================
;エンカウント処理
;=======================================================================
@CHECK_ENCOUNT_46
IF RAND:100 < FLAG:인카운트율
	CALL ENEMY_TABLE
	RETURN 1
ELSE
	FLAG:미조우걸음수 += 1
	RETURN 0
ENDIF
;=======================================================================
;적の종족の종류数
;=======================================================================
@CLASS_NUM_46
RETURN CLASS_NUM_COMMON("上級")
;=======================================================================
;적の総数
;ARGは出現する적の종류です
;=======================================================================
@ENEMY_NUM_46, ARG
RETURN ENEMY_NUM_COMMON("上級", ARG)
;=======================================================================
;적の종류
;=======================================================================
@ENEMY_46, ARG
;上野Lv33-37　
;신주쿠대성당Lv33-40？
;一階
IF FLAG:현M < 2
	SELECTCASE RAND:100
		CASE IS < 10
			;10%で머신라비　Lv35
			RETURN [[キャラ:라비]], 35
		CASE IS < 30
			;20%で광인템플나이트　Lv22（34）
			RETURN [[キャラ:템플나이트]], 34
		CASE IS < 45
			;15%で천사파워　Lv34
			RETURN [[キャラ:파워]], 34
		CASE IS < 55
			;10%で잠바반　Lv35
			RETURN [[キャラ:잠바반]], 35
		CASE IS < 65
			;10%で마수누에　Lv31（34）
			RETURN [[キャラ:누에]], 34
		CASE IS < 80
			;15%で천사아무르타트　Lv32（35）
			RETURN [[キャラ:아무르타트]], 35
		CASE IS < 90
			;10%で나쟈　Lv36
			RETURN [[キャラ:나쟈]], 36
		CASE IS < 100
			;10%で요마디스　Lv36
			RETURN [[キャラ:디스]], 36
	ENDSELECT
;二階
ELSEIF FLAG:현M >= 2 && FLAG:현M < 4
	SELECTCASE RAND:100
		CASE IS < 10
			;10%で머신라비　Lv35（38）
			RETURN [[キャラ:라비]], 38
		CASE IS < 30
			;20%で광인템플나이트　Lv22（37）
			RETURN [[キャラ:템플나이트]], 37
		CASE IS < 45
			;15%で천사파워　Lv34（37）
			RETURN [[キャラ:파워]], 37
		CASE IS < 55
			;10%で환마잠바반　Lv35（38）
			RETURN [[キャラ:잠바반]], 38
		CASE IS < 65
			;10%で요조스튐팔리데스　Lv35（38）
			RETURN [[キャラ:스튐팔리데스]], 38
		CASE IS < 75
			;10%で천사아무르타트　Lv32（35）
			RETURN [[キャラ:아무르타트]], 35
		CASE IS < 90
			;15%で천사라이라　Lv39
			RETURN [[キャラ:라이라]], 39
		CASE IS < 100
			;10%で요마디스　Lv36
			RETURN [[キャラ:디스]], 36
	ENDSELECT
;三階
ELSEIF FLAG:현M >= 4 && FLAG:현M < 6
	SELECTCASE RAND:100
		CASE IS < 10
			;10%で머신라비　Lv35（38）
			RETURN [[キャラ:라비]], 38
		CASE IS < 30
			;20%で광인템플나이트　Lv22（40）
			RETURN [[キャラ:템플나이트]], 40
		CASE IS < 45
			;15%で천사파워　Lv34（40）
			RETURN [[キャラ:파워]], 40
		CASE IS < 55
			;10%で환마잠바반　Lv35（38）
			RETURN [[キャラ:잠바반]], 38
		CASE IS < 65
			;10%で요조스튐팔리데스　Lv35（41）
			RETURN [[キャラ:스튐팔리데스]], 41
		CASE IS < 80
			;15%で천사라이라　Lv39（42）
			RETURN [[キャラ:라이라]], 42
		CASE IS < 90
			;10%で천사버쳐　Lv43
			RETURN [[キャラ:버쳐]], 43
		CASE IS < 100
			;10%で요마디스　Lv36（39）
			RETURN [[キャラ:디스]], 39
	ENDSELECT
;地下
ELSEIF FLAG:현M == 6
	SELECTCASE RAND:100
		CASE IS < 10
			;10%で머신라비　Lv35（38）
			RETURN [[キャラ:라비]], 38
		CASE IS < 25
			;15%で광인템플나이트　Lv22（40）
			RETURN [[キャラ:템플나이트]], 40
		CASE IS < 45
			;20%で광인뮤턴트　Lv29（41）
			RETURN [[キャラ:뮤턴트]], 41
		CASE IS < 55
			;10%で천사파워　Lv34（40）
			RETURN [[キャラ:파워]], 40
		CASE IS < 70
			;15%で천사라이라　Lv39（42）
			RETURN [[キャラ:라이라]], 42
		CASE IS < 80
			;10%で천사버쳐　Lv43
			RETURN [[キャラ:버쳐]], 43
		CASE IS < 85
			;5%で요마알라우네　Lv31（40）
			RETURN [[キャラ:알라우네]], 40
		CASE IS < 100
			;15%で섀도우　Lv39（42）
			RETURN [[キャラ:섀도우]], 42
	ENDSELECT
ENDIF
;=======================================================================
;特殊調整
;=======================================================================
@SET_ENEMY_STATUS_46, ARG
SELECTCASE NO:ARG
	CASE [[キャラ:라이라]]
		ABL:(CHARANUM-1):스킬4 = 0
	CASE [[キャラ:파워]]
		ABL:(CHARANUM-1):스킬5 = 705
	CASE [[キャラ:뮤턴트]]
		ABL:(CHARANUM-1):스킬3 = 302
		ABL:(CHARANUM-1):스킬4 = 323
	CASE [[キャラ:템플나이트]]
		ABL:(CHARANUM-1):스킬1 = 1002
		ABL:(CHARANUM-1):스킬5 = 3005
		ABL:(CHARANUM-1):스킬6 = 1302
	CASE [[キャラ:잠바반]]
		ABL:(CHARANUM-1):스킬5 = 0
		ABL:(CHARANUM-1):스킬6 = 511
ENDSELECT
;========
;罠置き場
;========
@TRAP_46
SELECTCASE FLAG:현M
	CASEELSE
ENDSELECT
RETURN 0

@E_PAZUSU
PRINTL 여기는 엘리베이터。
PRINTW -가고 싶은 층의 버튼을 눌러 주세요-
PRINTL [0]Ｂ１Ｆ
PRINTL [1]１Ｆ
PRINTL [2]２Ｆ
PRINTL [3]３Ｆ
$INPUT_LOOP_PAZUSU
INPUT
IF RESULT == 0
	IF FLAG:현M == 6
		RETURN 1
	ELSE
		FLAG:현M = 6
		FLAG:현X = 3
		FLAG:현Y = 3
	ENDIF
ELSEIF RESULT == 1
	IF FLAG:현M == 1
		RETURN 1
	ELSE
		FLAG:현M = 1
		FLAG:현X = 3
		FLAG:현Y = 8
	ENDIF
ELSEIF RESULT == 2
	IF FLAG:현M == 3
		RETURN 1
	ELSE
		FLAG:현M = 3
		FLAG:현X = 3
		FLAG:현Y = 7
	ENDIF
ELSEIF RESULT == 3
	IF FLAG:현M == 5
		RETURN 1
	ELSE
		FLAG:현M = 5
		FLAG:현X = 3
		FLAG:현Y = 7
	ENDIF
ELSE
	GOTO INPUT_LOOP_PAZUSU
ENDIF
CALL MAKE_FLOOR, FLAG:현던전
CALL AUTOMAP

@SET_ACTION_4501,ARG
;ＨＰ50％以下
IF 현HP비율(ARG) < 50
	CALL CHECK_ACTIONABLE,ARG,2005
	SIF RESULT == 0
		GOTO DECIDE_ACTION
	CFLAG:ARG:입력행동 = 2005
	CALL RANDOM_TARGET,ARG,2005
	RETURN 1
ELSE
	$DECIDE_ACTION
	CALL SEARCH_ACT,ARG
	IF RESULT == 0
		CFLAG:ARG:입력행동 = -1
		CFLAG:ARG:방어플래그 = 1
		RETURN 0
	ENDIF
;	PRINTFORML [{CFLAG:ARG:5}]の스킬数 {RESULT}
	LOCAL = RAND:RESULT
	;스킬番号決定
	LOCAL:1 = S:(10+LOCAL)
;	PRINTFORML [{CFLAG:ARG:5}]の스킬 {LOCAL:1}
	$TARGET_LOOP
	
	CALL RANDOM_TARGET,ARG,LOCAL:1
	CALLFORM SKILL_TARGET_{LOCAL:1}
	;ここで스킬番号を行動内容に代入
	SIF CFLAG:ARG:타겟 == -1
		GOTO DECIDE_ACTION
	CFLAG:ARG:입력행동 = LOCAL:1
ENDIF

;파주주の사고패턴
@SET_ACTION_255,ARG
;1more
IF CFLAG:ARG:１more플래그 > 0
	IF RAND:2 == 0
		;프레이다인
		CALL CHECK_ACTIONABLE,ARG,1903
		SIF RESULT == 0
			GOTO DECIDE_ACTION
		CFLAG:ARG:입력행동 = 1903
		CALL RANDOM_TARGET,ARG,1903
		RETURN 1
	ELSE
		;마하갈다인
		CALL CHECK_ACTIONABLE,ARG,1706
		SIF RESULT == 0
			GOTO DECIDE_ACTION
		CFLAG:ARG:입력행동 = 1706
		CALL RANDOM_TARGET,ARG,1706
		RETURN 1
	ENDIF
;ＨＰ50％以下
ELSEIF 현HP비율(ARG) < 50
	IF CFLAG:ARG:행동한횟수 == 0
		IF RAND:2 == 0
			CALL CHECK_ACTIONABLE,ARG,1402
			SIF RESULT == 0
				GOTO DECIDE_ACTION
			CFLAG:ARG:입력행동 = 1402
			CALL RANDOM_TARGET,ARG,1402
			RETURN 1
		ELSE
			CALL CHECK_ACTIONABLE,ARG,1009
			SIF RESULT == 0
				GOTO DECIDE_ACTION
			CFLAG:ARG:입력행동 = 1009
			CALL RANDOM_TARGET,ARG,1009
			RETURN 1
		ENDIF

	ELSEIF CFLAG:ARG:행동한횟수 == 1
		SELECTCASE RAND:100
			;40％で프레이다인
			CASE IS < 40
				CALL CHECK_ACTIONABLE,ARG,1903
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:입력행동 = 1903
				CALL RANDOM_TARGET,ARG,1903
				RETURN 1
			;30％で회오리
			CASE IS < 70
				CALL CHECK_ACTIONABLE,ARG,1008
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:입력행동 = 1008
				CALL RANDOM_TARGET,ARG,1008
				RETURN 1
			;20％で마하갈다인
			CASE IS < 90
				CALL CHECK_ACTIONABLE,ARG,1706
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:입력행동 = 1706
				CALL RANDOM_TARGET,ARG,1706
				RETURN 1
			;10％で이계의바람
			CASE IS < 100
				CALL CHECK_ACTIONABLE,ARG,1009
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:입력행동 = 1009
				CALL RANDOM_TARGET,ARG,1009
				RETURN 1
		ENDSELECT
	ENDIF

ELSEIF 현HP비율(ARG) >= 50 
	IF CFLAG:ARG:행동한횟수 == 0
		IF RAND:2 == 0
			CALL CHECK_ACTIONABLE,ARG,1402
			SIF RESULT == 0
				GOTO DECIDE_ACTION
			CFLAG:ARG:입력행동 = 1402
			CALL RANDOM_TARGET,ARG,1402
			RETURN 1
		ELSE
			CALL CHECK_ACTIONABLE,ARG,1903
			SIF RESULT == 0
				GOTO DECIDE_ACTION
			CFLAG:ARG:입력행동 = 1903
			CALL RANDOM_TARGET,ARG,1903
			RETURN 1
		ENDIF
	ELSEIF CFLAG:ARG:행동한횟수 == 1
		SELECTCASE RAND:100
			;40％で마하라기다인
			CASE IS < 40
				CALL CHECK_ACTIONABLE,ARG,706
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:입력행동 = 706
				CALL RANDOM_TARGET,ARG,706
				RETURN 1
			;35％で마하갈다인
			CASE IS < 75
				CALL CHECK_ACTIONABLE,ARG,1706
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:입력행동 = 1706
				CALL RANDOM_TARGET,ARG,1706
				RETURN 1
			;10％で회오리
			CASE IS < 85
				CALL CHECK_ACTIONABLE,ARG,1008
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:입력행동 = 1008
				CALL RANDOM_TARGET,ARG,1008
				RETURN 1
			;15％で通常공격
			CASE IS < 100
				CALL CHECK_ACTIONABLE,ARG,0
				SIF RESULT == 0
					GOTO DECIDE_ACTION
				CFLAG:ARG:입력행동 = 0
				CALL RANDOM_TARGET,ARG,0
				RETURN 1
		ENDSELECT
	ENDIF
ELSE
	$DECIDE_ACTION
	CALL SEARCH_ACT,ARG
	IF RESULT == 0
		CFLAG:ARG:입력행동 = -1
		CFLAG:ARG:방어플래그 = 1
		RETURN 0
	ENDIF
;	PRINTFORML [{CFLAG:ARG:5}]の스킬数 {RESULT}
	LOCAL = RAND:RESULT
	;스킬番号決定
	LOCAL:1 = S:(10+LOCAL)
;	PRINTFORML [{CFLAG:ARG:5}]の스킬 {LOCAL:1}
	$TARGET_LOOP
	
	CALL RANDOM_TARGET,ARG,LOCAL:1
	CALLFORM SKILL_TARGET_{LOCAL:1}
	;ここで스킬番号を行動内容に代入
	SIF CFLAG:ARG:타겟 == -1
		GOTO DECIDE_ACTION
	CFLAG:ARG:입력행동 = LOCAL:1
ENDIF


;=======================================================================
;윤간참가악마
;=======================================================================
@DUNGEON_RAPE_DEVIL_46
;랜덤にどの악마が出るか決定
;RETURN CSV番号 , 人数 , 레벨
SELECTCASE RAND:4
	CASE 0
		RETURN [[キャラ:뮤턴트]] , 3 + RAND:10 , CSVBASE([[キャラ:뮤턴트]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 1
		RETURN [[キャラ:템플나이트]] , 3 + RAND:10 , CSVBASE([[キャラ:템플나이트]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 2
		RETURN [[キャラ:파워]] , 3 + RAND:10 , CSVBASE([[キャラ:파워]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 3
		RETURN [[キャラ:버쳐]] , 3 + RAND:10 , CSVBASE([[キャラ:버쳐]] , GETNUM(BASE , "LV") , 0) + RAND:3
ENDSELECT

