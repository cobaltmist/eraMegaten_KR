;=======================================================================
;[5]調べる　実行時の이벤트
;=======================================================================
@EVENT_CHECK_DUNGEON_5
SELECTCASE DA:(FLAG:현X):(FLAG:현Y)% 10
	;이벤트タイル
	CASE 1
		CALL TILE_5
		RETURN RESULT
	;========
	;宝の処理
	;========
	CASE 3
		CALL TREASURE_5
		RETURN 1
	;========================
	;이벤트
	;========================
	CASE 4
		CALL EVENT_5
		RETURN 0
	;=======
	;罠
	;=======
	CASE 5
		CALL TRAP_5
		RETURN 1
	CASE 6,7
		CALL WORP_5
		RETURN 1
	;=======
	;メッセンジャー
	;=======
	CASE 8
		CALL MESSAGE_5, 0
		RETURN 1
	;=======
	;特殊タイル
	;=======
	CASE 9
		CALL SPECIAL_5
		RETURN 1
	;=======
	;ダークゾーン
	;=======
	CASE -1
		IF DA:(FLAG:현X):(FLAG:현Y) < -10
			CALL DARK_5
			RETURN RESULT
		ENDIF
	CASEELSE
	CALL MESSAGE_WINDOW_D, "", "＞아무것도 없는 것 같다"
	RETURN 0
ENDSELECT

;=======================================================================
;タイル進入時の이벤트
;=======================================================================
@EVENT_ENTER_DUNGEON_5,ARG
;ARG = 進入時の向き　0の場合ワープなど
SELECTCASE DA:(FLAG:현X):(FLAG:현Y) % 10
	;이벤트タイル
	CASE 1
		CALL TILE_5, 1
	;==========
	;문の処理
	;==========
	CASE 2
		SIF GROUPMATCH(DA:(FLAG:현X):(FLAG:현Y),902,922,942,962)
			DA:(FLAG:현X):(FLAG:현Y) += 10
		CALL DUNGEON_DOOR,ARG
		RETURN 1
;========
;宝の処理
;========
	CASE 3
		CALL TREASURE_5
		RETURN 1
;========================
;이벤트
;========================
	CASE 4
		CALL EVENT_5, 1
		RETURN 1
;=======
;罠
;=======
CASE 5
	CALL TRAP_5
	RETURN 1
;=======
;ワープゾーン
;=======
	CASE 6,7
		CALL WORP_5
		RETURN 1
;=======
;メッセンジャー
;=======
	CASE 8
		CALL MESSAGE_5, 1
		RETURN 1
;=======
;特殊タイル
;=======
	CASE 9
		CALL SPECIAL_5
		RETURN 1
;=======
;ダークゾーン
;=======
	CASE -1
		CALL DARK_5, 1
		RETURN RESULT
ENDSELECT
;=======================================
;床
;=======================================
@TILE_5, ARG
#LOCALSIZE 1
SELECTCASE DA:(FLAG:현X):(FLAG:현Y) / 10
	CASE 1600
		IF !STRFLAG_D("히노카구츠치입구발견")
			;侵入＋小瓶あり
			IF ARG == 1 && ITEM:루스의작은병
				CALL MESSAGE_WINDOW_D, "루스", "여기다！/여기다！/여기가 수상하다！"
				CALL MESSAGE_WINDOW_D, "", "＞작은 병 안의 루스가 떠들기 시작했다！"
				RETURN 1
			;調べた時
			ELSEIF ARG == 0
				CALL MESSAGE_WINDOW_D, "", "＞벽을 유심히 조사해 보았다……"
				CALL MESSAGE_WINDOW_D, "", "＞놀랍게도 문이 나타났다！"
				CALLF STRFLAG_D("히노카구츠치입구발견", 1)
				RETURN 1
			ENDIF
		ENDIF
	CASE 3800
		IF !STRFLAG_D("세트입구발견")
			;侵入＋小瓶あり
			IF ARG == 1 && ITEM:루스의작은병
				CALL MESSAGE_WINDOW_D, "루스", "여기다！/여기다！/여기가 수상하다！"
				CALL MESSAGE_WINDOW_D, "", "＞작은 병 안의 루스가 떠들기 시작했다！"
				RETURN 1
			;調べた時
			ELSEIF ARG == 0
				CALL MESSAGE_WINDOW_D, "", "＞벽을 유심히 조사해 보았다……"
				CALL MESSAGE_WINDOW_D, "", "＞놀랍게도 문이 나타났다！"
				CALLF STRFLAG_D("세트입구발견", 1)
				RETURN 1
			ENDIF
		ENDIF
	CASE 3900
		CALL MESSAGE_WINDOW_D, "", "＞워프 존이다！"
		CALL SHOW_PICTURE, "EMPTY"
		CALL DUNGEON_WORP_ID, FLAG:현M, DA:(FLAG:현X):(FLAG:현Y) + 10
		RETURN 1
ENDSELECT
SIF RANGE(FLAG:현M, 32, 39)
	CALL FIRE_TILE_5
SIF !ARG
	CALL MESSAGE_WINDOW_D, "", "＞아무것도 없는 것 같다"
RETURN 0
;=======================================
;문
;=======================================
@TILE_MARK_COMMON_5_2, ARG, ARG:1, ARG:2
SELECTCASE ARG / 10
	CASE 900, 904, 905, 1300, 1301, 1302, 2500, 4400
		RESULTS = 門
	CASE 1601
		RESULTS = %\@STRFLAG_D("히노카구츠치입구발견") ? 문 # ■ \@%
	CASE 3801
		RESULTS = %\@STRFLAG_D("세트입구발견") ? 문 # ■ \@%
	;一方通行
	CASE 90, 92, 94, 96
		RESULTS = 문
	CASE 91, 93, 95, 97, 1601
		RESULTS = ■
	CASE 3001
		RESULTS = \@ITEM:은릴리프 == -1 ? 문 # ■\@
	CASEELSE
		RESULTS = 문
ENDSELECT
@DOOR_5, ARG
SELECTCASE ARG
	CASE 700
		IF !STRFLAG_D("미노타우로스격파")
			CALL MESSAGE_WINDOW_D, "", "＞강대한 악마의 기색을 느낀다…/＞진행합니까？"
			CALL INPUT_YN_D
			RETURN !RESULT
		ENDIF
	CASE 900, 1300
		IF STRFLAG_NUM_D("비엔위치") != 0
			IF FLAG:현M == 9
				CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
			ELSE
				CALL MESSAGE_WINDOW_D, "갈", "이 문을 이용할 수 있는 것은 비엔이【발할라의 회랑】에 있을 때 뿐입니다/중앙문을 이용해주세요"
			ENDIF
		ELSEIF ITEM:갈의방패
		;ELSEIF STRFLAG_D("盾ゲット")
			;IF STRFLAG_D("갈クリア")
			IF ITEM:갈의방패 == -1
				IF STRFLAG_D("메두사격파")
					IF !ITEM:롤의부적
						CALL MESSAGE_WINDOW_D, "갈", "방패 말고도、거리까지 구할 줄이야！/…당신이라면 이 부적을 맡길 수 있습니다/이것은、나의 친구 롤이 임종 시에 나에게 맡긴 것으로/마왕 로키의 힘을 봉인하기 위해 만든 것입니다"
						CALL MESSAGE_WINDOW_D, "갈", "안타깝게도、롤은 끝끝내 완성할 수 없었지만…/그러나、로키와 친한 악마의 도움이 있으면 완성할 수 있다고 롤이 말했습니다/당신이라면 이 부적을 완성할 것입니다"
						ITEM:롤의부적 = 1
						CALL MESSAGE_WINDOW_D, "", "＞【롤의 부적】을 손에 넣었다"
					ELSE
						CALL MESSAGE_WINDOW_D, "갈", "이거야 이거、여러분、/어서…들어오시오！"
					ENDIF
				ELSE
					CALL MESSAGE_WINDOW_D, "갈", "이거야 이거、여러분、/어서…들어오시오！/단、방패에 대해서는 남에게 말하지 마시오"
				ENDIF
			ELSE
				CALL MESSAGE_WINDOW_D, "갈", "오오！젊은이여！/나의 방패가 아닌가！/고마워"
				CALL MESSAGE_WINDOW_D, "갈", "답례로 비엔으로의 통로를 열어 주겠소/돌 쪽이 안 된다면 언제라도 이쪽으로 오시오"
				ITEM:갈의방패 = -1
				;CALLF STRFLAG_D("갈クリア", 1)
			ENDIF
			IF FLAG:현M == 9
				CALL DUNGEON_WORP_ID, 13, 13001, 1
			ELSE
				CALL DUNGEON_WORP_ID, 9, 9001, 1
			ENDIF
		ELSEIF STRFLAG_D("갈의뢰")
			CALL MESSAGE_WINDOW_D, "갈", "방패를 훔친 네코마타를 다이타로스에서 본 사람이 있는 것 같아/그럼、부탁한다！"
		ELSE
			CALL MESSAGE_WINDOW_D, "", "＞문 앞에 문지기가 서 있다"
			CALL MESSAGE_WINDOW_D, "문지기", "나는 부문의 병사 갈. 정문의 병사 돌의 동생이다！/돌은、 문을 들어가게 하지 않을 것이다/녀석은 완고하니까"
			CALL MESSAGE_WINDOW_D, "갈", "나라면 들어가게 해줄 수 없는 것도 아니지/단 나의 조건을 받아들일 때의 이야기지만…"
			CALL INPUT_YN_D
			IF RESULT == 1
				CALL MESSAGE_WINDOW_D, "갈", "그런가、나도 억지로 말하지 않는다/다른 입구를 영원히 찾아 헤매는 게 좋아"
			ELSE
				CALL MESSAGE_WINDOW_D, "갈", "그렇다면 말하지、실은…/장난꾸러기 네코마타가 나의 방패를 훔쳐 갔다！/이대로는、아무래도 볼 품 없어"
				CALL MESSAGE_WINDOW_D, "갈", "어떻게 나의 방패를 찾아 오길 바란다…/다이타로스에서 녀석을 본 자가 있는 것 같지만…/이것이 조건이다！부탁한다！"
				CALLF STRFLAG_D("갈의뢰", 1)
			ENDIF
		ENDIF
		RETURN 0
	CASE 901
		IF !STRFLAG_D("로키격파")
			CALL MESSAGE_WINDOW_D, "", "＞강대한 악마의 기색을 느낀다…/＞진행합니까？"
			CALL INPUT_YN_D
			RETURN !RESULT
		ENDIF
	CASE 902, 903
		;로키の宝物庫
		IF !STRFLAG_D("로키격파")
			CALL MESSAGE_WINDOW_D, "", "＞문은 열쇠로 잠겨 있다"
			RETURN 0
		ENDIF
	CASE 904
		IF STRFLAG_NUM_D("비엔위치") != 0 || !STRFLAG_D("메두사격파")
			CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		ELSE
			IF FLAG:현M == 9
				CALL DUNGEON_WORP_ID, 13, 13011, 1
			ELSE
				CALL DUNGEON_WORP_ID, 9, 9011, 1
			ENDIF
		ENDIF
		RETURN 0
	CASE 905, 1302
		IF STRFLAG_NUM_D("비엔위치") != 0
			IF FLAG:현M == 9
				CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
			ELSE
				CALL MESSAGE_WINDOW_D, "돌", "지금、이 앞에는 아무것도 없다/중앙문으로부터 떨어져"
			ENDIF
		ELSEIF STRFLAG_D("메두사격파")
			CALL MESSAGE_WINDOW_D, "돌", "당신들은…강하군…/나도 젊었다면 따라가겠지만"
			IF FLAG:현M == 9
				CALL DUNGEON_WORP_ID, 13, 13021, 1
			ELSE
				CALL DUNGEON_WORP_ID, 9, 9021, 1
			ENDIF
		ELSE
			CALL MESSAGE_WINDOW_D, "", "＞문 앞에 문지기가 서 있다"
			CALL MESSAGE_WINDOW_D, "문지기", "…………"
			CALL MESSAGE_WINDOW_D, "", @"＞문지기는%CALLNAME:MASTER%에게 눈길도 주지 않는다/＞이 문은 통과할 수 없는 것 같다"
		ENDIF
		RETURN 0
	CASE 901
		IF !STRFLAG_D("메두사격파") || STRFLAG_NUM_D("비엔위치") != 0
			CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		ELSE
			CALL DUNGEON_WORP_ID, 8, 8001, 1
		ENDIF
		RETURN 0
	;門
	CASE 1301
		IF !STRFLAG_D("메두사격파")
			CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
			RETURN 0
		ELSE
			SELECTCASE STRFLAG_NUM_D("비엔위치")
				CASE 0
					CALL DUNGEON_WORP_ID, 9, 9011, 1
				CASE 1
					CALL DUNGEON_WORP_ID, 25, 25001, 1
				CASE 2
					CALL DUNGEON_WORP_ID, 44, 44001, 1
			ENDSELECT
			RETURN 0
		ENDIF
	CASE 1400
		;小さなカギ
		IF !ITEM:작은열쇠
			CALL MESSAGE_WINDOW_D, "", "＞문은 열쇠로 잠겨 있다"
			RETURN 0
		ENDIF
	CASE 1401,1402,1403
		;황소의키
		IF !ITEM:황소의키
			CALL MESSAGE_WINDOW_D, "", "＞문은 열쇠로 잠겨 있다"
			RETURN 0
		ENDIF
	CASE 1600
		IF !STRFLAG_D("메두사격파",,[[던전:대마궁]])
			CALL MESSAGE_WINDOW_D, "", "＞문 너머에서、사악한 기척이 느껴진다…/＞문을 엽니까？"
			CALL INPUT_YN_D
			SIF RESULT == 1
				RETURN 0
		ENDIF
	CASE 1601
		RETURN STRFLAG_D("히노카구츠치입구발견")
	CASE 2500
		IF STRFLAG_NUM_D("비엔위치") != 1
			CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
			RETURN 0
		ELSE
			CALL DUNGEON_WORP_ID, 13, 13011, 1
		ENDIF
	CASE 3000
		IF !STRFLAG_D("헤카테격파")
			CALL MESSAGE_WINDOW_D, "", "＞문은 열리지 않는다/＞무언가 마력이 움직이고 있는 것 같다"
			RETURN 0
		ENDIF
	CASE 3001
		RETURN ITEM:은릴리프 == -1
	;이자나미（세트）前
	CASE 3600
		IF STRFLAG_D("봉인해제실패")
			CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀 있다…"
			RETURN 0
		ENDIF
	CASE 3800
		IF STRFLAG_D("세트격파")
				RETURN 1
		ELSEIF STRFLAG_D("세트봉인해제")
			CALL MESSAGE_WINDOW_D, "", "＞문 안쪽에서 강대한 힘을 느낀다……/＞문을 엽니까？"
			CALL INPUT_YN_D
			IF RESULT == 0
				RETURN 1
			ELSE
				RETURN 0
			ENDIF
		ELSE
			CALL MESSAGE_WINDOW_D, "", "＞문은 열리지 않는다/＞무언가의 힘으로 봉인되어 있는 것 같다……"
			RETURN 0
		ENDIF
	CASE 3801
		RETURN STRFLAG_D("세트입구발견")
	CASE 4400
		IF STRFLAG_NUM_D("비엔위치") != 2
			CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
			RETURN 0
		ELSE
			CALL DUNGEON_WORP_ID, 13, 13011, 1
		ENDIF
ENDSELECT
RETURN 1

;=======================================
;特殊タイル
;=======================================
@TILE_MARK_COMMON_5_9, ARG, ARG:1, ARG:2
SELECTCASE ARG / 10
	CASE 90
		RESULTS = 酒
	CASE 97
		RESULTS = Ｃ
	CASE 98
		RESULTS = 店
	CASE 99
		RESULTS = 出
ENDSELECT
@SPECIAL_5
#LOCALSIZE 7
#LOCALSSIZE 1
SELECTCASE DA:(FLAG:현X):(FLAG:현Y) / 10
	CASE 90
		CALL SHOW_PICTURE, "NONFLOORD", "POIZON BAR"
		CALL MESSAGE_WINDOW_D, "바텐더", "어서 오십시오 부디 느긋하게 계십시오"
		$START
		CALL MESSAGE_WINDOW_D, "바텐더", "어떻게 합니까？"
		CALL INPUT_SELECT_D, "[0] 마실 것을 주문한다/[1] 대머리 남자 손님에게 말을 건다/[2] 젊은 여자 손님에게 말을 건다/[3] 여자 손님에게 말을 건다/[9] 가게에서 나간다", , , 2
		IF RESULT == 0
			CALL MESSAGE_WINDOW_D, "바텐더", "20마카입니다/좋습니까？"
			CALL INPUT_YN_D
			IF RESULT == 0
				IF MONEY:1 < 20
					CALL MESSAGE_WINDOW_D, "바텐더", "이런、돈이 부족한 것 같네요？"
				ELSE
					CALL MESSAGE_WINDOW_D, "바텐더", "그럼、어느 분이 드십니까？"
					LOCALS = 
					FOR LOCAL, 1, 7
						SIF POS(LOCAL) >= 0 && CFLAG:POS(LOCAL):상태이상 == 0
							LOCALS += @"[{LOCAL}] %CALLNAME:POS(LOCAL)%/"
					NEXT
					LOCALS +=  "[9] やめておく"
					CALL INPUT_SELECT_D, LOCALS, , , 2
					IF RESULT < 7
						LOCAL = POS(RESULT)
						MONEY:1 -= 20
						CALL MESSAGE_WINDOW_D, "", @"＞%조사처리(CALLNAME:LOCAL,"는")% 주문한 술을 마셨다"
						SELECTCASE RAND:100
							CASE IS < 10
								CALL MESSAGE_WINDOW_D, "", @"＞저리는 맛이었다/＞%조사처리(CALLNAME:LOCAL,"는")% PALYZE 상태가 되었다"
								PRINTW 
								CFLAG:LOCAL:상태이상 = GET_STATE_NUM("PALYZE")
								PRINTFORMW 
							CASE IS < 20
								CALL MESSAGE_WINDOW_D, "", @"＞위험한 맛이었다/＞%조사처리(CALLNAME:LOCAL,"는")% POISON 상태가 되었다"
								CFLAG:LOCAL:상태이상 = GET_STATE_NUM("POISON")
							CASE IS < 30
								CALL MESSAGE_WINDOW_D, "", @"＞마、맛없어！/＞%조사처리(CALLNAME:LOCAL,"는")% 데미지를 받았다"
								BASE:LOCAL:ＨＰ = BASE:LOCAL:ＨＰ/2+1
							CASE IS < 60
								CALL MESSAGE_WINDOW_D, "", @"＞마마、맛있어！/＞%조사처리(CALLNAME:LOCAL,"는")% 완전히 회복했다"
								BASE:LOCAL:ＨＰ = MAXBASE:LOCAL:ＨＰ
							CASEELSE
								CALL MESSAGE_WINDOW_D, "", @"＞그럭저럭이다/＞%조사처리(CALLNAME:LOCAL,"는")% 회복했다"
								CALL VAR_HP, LOCAL, MAXBASE:LOCAL:ＨＰ/2
								BASE:LOCAL:ＨＰ = MIN(MAXBASE:LOCAL:ＨＰ, BASE:LOCAL:ＨＰ)
						ENDSELECT
						CALL SHOW_PICTURE, "NONFLOORD", "POIZON BAR"
					ENDIF
				ENDIF
			ELSE
				CALL MESSAGE_WINDOW_D, "바텐더", "그렇습니까"
			ENDIF
		ELSEIF RESULT == 1
			CALL MESSAGE_WINDOW_D, "대머리 남자", "메두사를 쓰러뜨릴 수 있는 자가 있을 줄이야/…일찌기 마왕 로키에게 대항한 자가 있었다/그건 대마도사 롤이다/허나、그는 로키와의 싸움으로 목숨을 잃었다고 한다"
		ELSEIF RESULT == 2
			CALL MESSAGE_WINDOW_D, "여자아이", "갈은 롤의 친구였어/갈이라면 뭔가 알고 있을지도 몰라"
		ELSEIF RESULT == 3
			CALL MESSAGE_WINDOW_D, "여자", "메두사에겐 언니가 두 명 있어/세 사람을  아울러 고르곤 세자매로 부르고 있어/메두사를 쓰러뜨린 당신이라면 고르곤의 힘을 빌려/메두사를 동료마로 삼을 수도 있지 않을까？"
		ELSEIF RESULT == 9
			CALL MESSAGE_WINDOW_D, "바텐더", "또、부디"
			RETURN 0
		ENDIF
		GOTO START
	CASE 97
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞카지노다"
		CALL CASINO, 2
	CASE 98
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞변경의 가게다"
		CALL MESSAGE_WINDOW_D, "가게 주인", "＞무언가、사 줘"
		IF FLAG:현M == 0
			CALL DUNGEON_SHOP(1, "외상약", 1, "마석", 50, "보옥", 300, "도반옥", 50, "디스포이즌", 20, "디스패라이즈", 20, "디스챰", 20, "전망구슬", 30, "개비의열매", 500, "어택나이프", 5, "전갈의채찍", 5, "픽시나이프", 500, "가라시지의법의", 200, "퍼레이드아머", 800, "프로그헬름", 20, "스타글러브", 100)
		ELSEIF FLAG:현M == 9
			CALL DUNGEON_SHOP(1, "외상약", 1, "마석", 50, "보옥", 300, "도반옥", 50, "디스포이즌", 20, "디스패라이즈", 20, "디스챰", 20, "디스톤", 20, "개비의열매", 500, "봉마의방울", 300, "집마의피리", 300)
		ELSEIF FLAG:현M == 14
			CALL DUNGEON_SHOP(1, "외상약", 1, "마석", 50, "보옥", 300, "도반옥", 50, "디스포이즌", 20, "디스패라이즈", 20, "디스챰", 20, "디스톤", 20, "개비의열매", 500, "봉마의방울", 300, "집마의피리", 300, "아세이미나이프",300, "와일드스피어", 500, )
		ELSEIF FLAG:현M == 18
			CALL DUNGEON_SHOP(1, "외상약", 1, "마석", 50, "보옥", 300, "도반옥", 50, "디스포이즌", 20, "디스패라이즈", 20, "디스챰", 20, "디스톤", 20, "네이팜탄", 10, "액화질소봄베", 10, "라이어트밤", 10, "시아귀미", 10, "충독명", 10)
		ELSEIF FLAG:현M == 27
			CALL DUNGEON_SHOP(1, "외상약", 1, "마석", 50, "보옥", 300, "도반옥", 50, "디스포이즌", 20, "디스패라이즈", 20, "디스챰", 20, "디스톤", 20, "개비의열매", 500, "눈속임의구슬", 50, "블리자드로브", 2000, "날개장식", 1000)
		ENDIF
		PRINTL 가게 주인:
		PRINTW 「또 잘 부탁해」
	;出口
	CASE 99
		IF !STRFLAG_D(@"M{FLAG:현M}", 1)
			CALL SHOW_PICTURE, "D"
			CALL MESSAGE_WINDOW_D, "", "＞현세로 통하는 구멍을 찾아냈다/＞이 구멍을 통해 현세와 마궁을 출입할 수 있다"
		ENDIF
		CALL DUNGEON_EXIT
ENDSELECT
@TILE_MARK_COMMON_5_4, ARG, ARG:1, ARG:2
SELECTCASE ARG / 10
	CASE 901, 2700
		RESULTS = 店
	CASE 1000
		RESULTS = \@STRFLAG_D("Y코") ? □ # ！\@
	CASE 1002
		RESULTS = \@ITEM:자수정 ? □ # 宝\@
	CASE 3000
		RESULTS = ■
	CASEELSE
		RESULTS = ！
ENDSELECT
@EVENT_5, ARG
#LOCALSIZE 10
#LOCALSSIZE 1
SELECTCASE DA:(FLAG:현X):(FLAG:현Y) / 10
	CASE 100
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞학생복을 입은 미형의 청년이 있다"
		CALL MESSAGE_WINDOW_D, "청년", "인간이 어떻게 이런 곳에…？/……아니、그런 것보다、강한 데빌 서머너같습니다만…/나는 나카지마 아케미라고 합니다/혹시、괜찮다면 당신에게 부탁하고 싶은 것이…"
		CALL MESSAGE_WINDOW_D, "", "＞그렇게 말한 아케미는、자신이 악마 소환 프로그램을 자작해서、로키를 소환한 일/＞ 힘을 빌린 대가로、로키에게 혼을 요구받은 일、/＞로키에게 혼을 요구받은 일、/>시라사기 유미코가 목숨을 잃은 일을 이야기했다/"
		CALL MESSAGE_WINDOW_D, "아케미", "로키는 그녀의 유해를 가지고 사라졌습니다/녀석이 무엇을 하고 싶은 건지 알 수 없습니다/하지만、녀석의 손으로 그녀가 농락되는 일은 참을 수가 없습니다/게다가、나는 무슨 일이 있어도 그녀의 원수를 갚고 싶습니다"
		CALL MESSAGE_WINDOW_D, "아케미", "그 때문에 당신의 힘을 빌려주었으면 합니다/물론、그냥 도와달라고 하진 않습니다/내가 할 수 있는 것은 무엇이든 할 작정입니다"
		CALL INPUT_SELECT_D, "[0] 힘을 빌려준다/[1] 노예가 될 것을 요구한다/[2] 거절한다"
		IF RESULT == 0
			CALL MESSAGE_WINDOW_D, "아케미", "감사합니다/내가 할 수 있는 것은…/그렇게 많진 않습니다만…"
			IF FLAG:ＣＯＭＰ용량 < 20
				CALL MESSAGE_WINDOW_D, "아케미", "그래/그 ＣＯＭＰ를 보여주세요"
				CALL MESSAGE_WINDOW_D, "", "＞아케미에게 ＣＯＭＰ를 보여주었다"
				CALL MESSAGE_WINDOW_D, "아케미", "여기를 이렇게하면…"
				CALL MESSAGE_WINDOW_D, "", "＞아케미의 개조 덕분에、ＣＯＭＰ용량이 ２증가했다"
				FLAG:ＣＯＭＰ용량 += 1
			ENDIF
			CALL MESSAGE_WINDOW_D, "", "＞나카지마 아케미가 동료가 됐다"
			CALL ADD_NEW_COMPANION, [[キャラ:아케미]], 200
			SIF RESULT == 1
				CFLAG:(RESULT:1):전투참가불가능 = -1
			LOCAL:1 = -1
			LOCAL:2 = -1
			FOR LOCAL, 6, 0, -1
				LOCALS = 포지션{LOCAL} 
				IF FLAG:LOCALS < 0
					LOCAL:1 = LOCAL
					BREAK
				ENDIF
			NEXT
			SIF LOCAL:1 > 0
				CALL INSERT_POSITION, LOCAL:1, GETCHARA([[キャラ:아케미]])
		ELSEIF RESULT == 1
			CALL MESSAGE_WINDOW_D, "아케미", "노예…그런 말도 안되는 일…！/아니…、그래서 힘을 빌려주는 거라면…/이것도 대가인가…"
			CALL MESSAGE_WINDOW_D, "아케미", "알겠습니다/나에게 무얼해도 상관없어요"
			PRINTW 「」
			CALL ADD_NEW_COMPANION, [[キャラ:아케미]], 200
			IF RESULT == 1
				CFLAG:(RESULT:1):전투참가불가능 = 0
				CFLAG:(RESULT:1):이벤트가입 = 1
			ENDIF
			CALL MESSAGE_WINDOW_D, "", "＞나카지마 아케미를 손에 넣었다"
		ELSE
			CALL MESSAGE_WINDOW_D, "아케미", "……그렇습니까/아뇨、상관없어요/그럼、나는 먼저 앞서갈테니까"
			CALL MESSAGE_WINDOW_D, "", "＞아케미는 마궁의 안으로 가버렸다"
		ENDIF
		CALLF STRFLAG_D("아케미회화", 1)
		DA:(FLAG:현X):(FLAG:현Y) = 1
	CASE 600
		IF STRFLAG_D("갈의뢰")
			CALLF STRFLAG_D("네코마타회화", 1)
			DA:(FLAG:현X):(FLAG:현Y) = 1
			CALL MESSAGE_WINDOW_D, "", "＞방 안에는 강해보이는 악마가 있다！"
			CALL MESSAGE_WINDOW_D, "악마", "나는 티아마트！/목숨이 아까우면 500마카 두고 가세요"
			CALL INPUT_YN_D
			IF RESULT == 0
				IF MONEY:1 < 500
					CALL MESSAGE_WINDOW_D, "티아마트", "뭐야. 부족하잖아/뭐 좋아요/가진 것 만으로 용서 해 주죠"
					CALL MESSAGE_WINDOW_D, "티아마트", "자、이젠 가도 돼요/응、무슨 일이죠？/무엇인가 찾고 있는 것 같은데"
					MONEY:1 = 0
				ELSE
					MONEY:1 -= 500
					CALL MESSAGE_WINDOW_D, "티아마트", "우후후、고마워요/그러고 보니、당신、무엇인가 찾고 있는 것 같군요？"
				ENDIF
				CALL MESSAGE_WINDOW_D, "티아마트", "갈의 방패를 훔친 네코마타？/아、그 쓰레기…/그거라면、어두운 곳에 버려져 있을 거에요/무언가 비추는 것을 가지고 가면 금방 찾아내겠죠"
				CALL MESSAGE_WINDOW_D, "", "＞티아마트는 떠났다"
			ELSE
				CALL MESSAGE_WINDOW_D, "", "＞용왕 티아마트에게 싸움을 걸었다！"
				FLAG:도주불가플래그 = 1
				FLAG:회화불능플래그 = 1
				FLAG:선제기습취소 = 1
				CALL SET_ENEMY,9,[[キャラ:네코마타]],25,0,1
				NAME:(CHARANUM-1) = 티아마트
				CALLNAME:(CHARANUM-1) = 티아마트
				CALL BATTLE_START
				FLAG:도주불가플래그 = 0
				FLAG:회화불능플래그 = 0
				FLAG:선제기습취소 = 0
				CALL SHOW_PICTURE, "D"
				CALL MESSAGE_WINDOW_D, "티아마트", "아-파！"
				CALL MESSAGE_WINDOW_D, "", "＞티아마트의 모습이 재빠르게 변해간다/＞티아마트는 마수 네코마타였다！"
				CALL MESSAGE_WINDOW_D, "네코마타", "그、그만둬、살려줘/그래。당신, 갈에게 부탁 받고 왔지？"
				CALL MESSAGE_WINDOW_D, "네코마타", "방패는 1층의 어두운 곳에 버렸어요/잠깐 어두운 동안은 찾아낼 수 없을지도/저기、방패의 장소를 알았으면、/놓아 줄래요？"
				CALL INPUT_SELECT_D, "[0] 놔준다/[1] 죽인다/[2] 범한다"
				IF RESULT == 0
					CALL MESSAGE_WINDOW_D, "네코마타", "후우、다행이다…/아、그래/이것을 갖고 가면 돼요"
					CALL MESSAGE_WINDOW_D, "", "＞전망구슬을 받았다"
					CALL MESSAGE_WINDOW_D, "네코마타", "그럼 이만！/바이바이"
					CALL GET_ITEMS,"전망구슬", 1
				ELSEIF RESULT == 1
					CALL MESSAGE_WINDOW_D, "네코마타", "싫、싫어。그만둬…꺄아！"
					CALL MESSAGE_WINDOW_D, "", "＞네코마타를 죽였다/＞네코마타는 200마카를 가지고 있었다＞200마카를 입수했다"
					CALL INCREASE_LD, 2
					MONEY:1 += 200
				ELSE
					CALL MESSAGE_WINDOW_D, "네코마타", "아、아니。뭐 하는 거야？ 꺄아！"
					CALL MESSAGE_WINDOW_D, "", "＞네코마타를 밀어 넘어뜨렸다"
					CALL ADD_NEW_COMPANION, [[キャラ:네코마타]], 200, 1
					CALL INCREASE_LD, 2
					;若干、旧1風に調整
					;IF RESULT
						TARGET = RESULT:1
						FLAG:던전내조교 = 1
						;회화타입を女・청소년に
						ABL:회화타입 = 304
						CSTR:일인칭 = あたし
						CSTR:이인칭 = 당신
						CFLAG:전신복 = [[衣装:레오타드]]
					;ENDIF
					RETURN 0
				ENDIF
			ENDIF
		ELSE
			CALL MESSAGE_WINDOW_D, "", "＞발자국이 있고、짐승의 털 같은 것이 흩어져 있다"
		ENDIF
	CASE 700
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞문을 열자、근육질의 거대한 짐승이 기다리고 있었다"
		CALL MESSAGE_WINDOW_D, "마왕 미노타우로스", @"기다리고 있었다、%\@TALENT:MASTER:남자?꼬마놈#계집년\@%！/나는 마왕 미노타우로스！/여기부터 앞은 대마궁…、우리 마족의 금단의 땅…"
		IF FLAG:나오야루트
			CALL MESSAGE_WINDOW_D, "마왕 미노타우로스", "그대가 진정으로 벨의 힘을 계승해、/왕이 되기에 적합한 존재인가 어떤가 확인해 주마！"
		ELSE
			CALL MESSAGE_WINDOW_D, "마왕 미노타우로스", "그대에게 이곳에 발을 디딜 자격이 있을까、확인하겠다！/인간이여! 내 번개에 맞아라！"
		ENDIF
		CALL MESSAGE_WINDOW_D, "", "＞마왕 미노타우로스가 １체 나타났다！"
		FLAG:도주불가플래그 = 1
		FLAG:회화불능플래그 = 1
		FLAG:선제기습취소 = 1
		CALL SET_MINOTAUR
		CALL BATTLE_START
		FLAG:도주불가플래그 = 0
		FLAG:회화불능플래그 = 0
		FLAG:선제기습취소 = 0
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "마왕 미노타우로스", "제…제법이지 않은가…"
		CALL MESSAGE_WINDOW_D, "", "＞미노타우로스는 숨이 끊어졌다…"
		DA:(FLAG:현X):(FLAG:현Y) = 1
		;FLAG:(10000+[[キャラ:미노타우로스]]) = 1
		CALL LIFTING_A_BAN([[キャラ:미노타우로스]])
		CALLF STRFLAG_D("미노타우로스격파", 1)
		CALLF STRFLAG_NUM_D("대마궁진행", "+=", , 1)
	CASE 900
		CALL MESSAGE_WINDOW_D, "", "＞호화롭게 만들어진 방에 들어가자、/＞한 남자가 훌륭한 의자에 앉아 있는 것이 눈에 들어온다/＞신주쿠에서 만났던、노는 분위기의 남자다…"
		CALL MESSAGE_WINDOW_D, "노는 분위기의 남자", "이야,  확실히 여기로 온다고 생각은 했지만/정말로 올 줄이야/대단하군"
		CALL MESSAGE_WINDOW_D, "노는 분위기의 남자", "이미、알고 있다고 생각하지만、나는 로키/이【발할라의 회랑】을 다스리는 마왕이다"
		CALL MESSAGE_WINDOW_D, "", "＞노는 분위기의 남자의 모습이 빠르게 변해가、/＞푸른 피부의 거대한 악마가 나타났다"
		CALL MESSAGE_WINDOW_D, "마왕 로키", "이것이 나의 본모습이다/지상에서 놀려면 인간의 모습을 하고 있는 쪽이 편리해서、/보통은 변신을 하고 있지만 말이야"
		IF FINDCHARA_B([[キャラ:아케미]]) == 2
			CALL MESSAGE_WINDOW_D, "아케미", "마왕 로키、그녀의 원수를 갚겠어！"
			CALL MESSAGE_WINDOW_D, "마왕 로키", "이런、나카지마/자네도 와있었군/게다가、이 인간에게 협력하고 있을 줄은…/"
			CALL MESSAGE_WINDOW_D, "마왕 로키", "딱 좋아/나는 평소에도、너나 나오야 군이 손을 잡으면、/세계를 바꿀 수 있다고 생각했어/"
			CALL MESSAGE_WINDOW_D, "아케미", "무슨 꿍꿍이인지는 모르지만、이젠 네가 마음대로 하게 놔두지 않는다"
			CALL MESSAGE_WINDOW_D, "마왕 로키", "이런 이런……/원래、내게 힘을 빌려 달라고 말한 것은 네가 아닌가/뭐어、사랑스러운 그녀의 일로、화가 난 걸 모르진 않지만"
			CALL MESSAGE_WINDOW_D, "마왕 로키", "내가 힘을 빌려 주면、/그녀를 명계에서 데리고 돌아갈 수도 있지"
			CALL MESSAGE_WINDOW_D, "아케미", "뭐라고？/……아니、안 속아！"
			CALL MESSAGE_WINDOW_D, "마왕 로키", "속일 생각은 없다고/뭐어、일단은、나를 쓰러뜨리는 거다/그것을 할 수 없다고 하면、/나는 너희에게 힘을 빌려 줄 생각은 없으니까"
		ENDIF
		CALL MESSAGE_WINDOW_D, "마왕 로키", "자、그러면……/네가 이【발할라의 회랑】을 이어 받을 자격이 있는지 /벨의 왕이 되는데 자격이 있는지 없는지、시험해볼까？"
		IF STRFLAG_D("부적완성")
			CALL MESSAGE_WINDOW_D, "", "＞로키가 일어선 그 때、/【롤의 부적】이 빛을 발했다"
			CALL MESSAGE_WINDOW_D, "마왕 로키", "웃…그것은…/롤의 힘인가……？/아니、그뿐만이 아니라……"
			CALL MESSAGE_WINDOW_D, "마왕 로키", "쿠、후후、재미있군/이렇게、편리한 도구를 만들어 내거나、악마의 힘을 빌리거나、/그것이야말로、인간이야"
			CALL MESSAGE_WINDOW_D, "마왕 로키", "하지만、그것 만으로 이길 수 있을 정도로、/이 마왕 로키는 만만치 않아/자、자네의 지혜는 잘 봤다/다음은 힘을 보여라"
		ENDIF
		CALL MESSAGE_WINDOW_D, "", "＞마왕 로키가 １체 나타났다！"
		FLAG:도주불가플래그 = 1
		FLAG:회화불능플래그 = 1
		FLAG:선제기습취소 = 1
		CALL SET_LOKI
		CALL BATTLE_START
		DA:(FLAG:현X):(FLAG:현Y) = 1
		CALLF STRFLAG_D("로키격파", 1)
		CALLF STRFLAG_NUM_D("대마궁진행", "+=", , 1)
		;FLAG:(10000+[[キャラ:로키]]) = 1
		CALL LIFTING_A_BAN([[キャラ:로키]])
		FLAG:도주불가플래그 = 0
		FLAG:회화불능플래그 = 0
		FLAG:선제기습취소 = 0
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞로키를 쓰러뜨렸다"
		IF STRFLAG_D("부적완성")
			CALL MESSAGE_WINDOW_D, "", "＞롤의 부적은 부숴졌다…"
			ITEM:롤의부적 = -1
		ENDIF
		CALL MESSAGE_WINDOW_D, "마왕 로키", "후후、대단하구나…/이제부터、네가 이【발할라의 회랑】의 지배자다/이제부터는 나도 너의 동료마로서、협력해주지"
		CALL MESSAGE_WINDOW_D, "", "＞마왕 로키가 동료마가 되었다"
		CALL ADD_NEW_COMPANION, [[キャラ:로키]], 1000, 1
		IF RESULT
			BASE:(RESULT:1):LV = 40
			BASE:(RESULT:1):ＥＸＰ = 5*(39)*(40)*(41)/3
			FOR LOCAL:1, 1, 7
				BASE:(RESULT:1):GET_BASESTATUS(LOCAL:1) -= 5
			NEXT
			FOR LOCAL:1, 1, 21
				SIF ABL:(RESULT:1):("습득LV"+TOSTR(LOCAL:1)) > 0
					ABL:(RESULT:1):("습득LV"+TOSTR(LOCAL:1)) -= 30
			NEXT
			ABL:(RESULT:1):수태아이템 = [[스킬:니플헤임]] + 10000
			CALL SYNC_STATUS,(RESULT:1)
			CALL HEALTH_CHARA,(RESULT:1)
		ENDIF
		IF FINDCHARA_B([[キャラ:아케미]]) % 10 == 2
			CALL MESSAGE_WINDOW_D, "마왕 로키", @"자、나카시마/이렇게 되어버린 거다/요컨데 %\@TALENT:MASTER:남자 ? 그 #그녀\@%와 나는 동료가 되었다는 이야기지"
			CALL MESSAGE_WINDOW_D, "마왕 로키", @"%\@TALENT:MASTER:남자?그#그녀\@%가 너의 복수를 도와주는 일은 예상 밖의 일이었던 것으로/이대로 계속할 수는 없겠지？"
			CALL MESSAGE_WINDOW_D, "아케미", "큭…"
			CALL MESSAGE_WINDOW_D, "마왕 로키", "그렇지만、안심하는 게 좋아/조금 전 잠깐 말했지만、그녀를 구하는 것은 가능해/그녀가 특별한 힘을 가지고 있는 걸 알고 있잖아？"
			CALL MESSAGE_WINDOW_D, "마왕 로키", "그래、명부에 갈 수 있는 자의 도움이 있다면、/명계에서 데리고 돌아올 수도 있어/자랑이 아니지만、나도 아가씨 덕분에 그 길은 자세하게 알지"
			CALL MESSAGE_WINDOW_D, "마왕 로키", "이【발할라의 회랑】에는 명계에 연결된 입구가 있으니까/거기까지 나를 데려가면、명계에 갈 수 있게 해 주지/물론、나와 계약하고 있는 그가 원하는 바여야 하지만…"
			CALL MESSAGE_WINDOW_D, "마왕 로키", "뭐어、나카지마는 우수하니까、/여기서 은혜를 입혀둬도 손해는 없으려나아？"
			CALL MESSAGE_WINDOW_D, "", @"＞로키는 히죽히죽 웃고 있다…/＞아케미는 분한 듯이 얼굴을 일그러뜨리며、%CALLNAME:MASTER%에게 머리를 숙였다"
			CALL MESSAGE_WINDOW_D, "아케미", "죄송하지만…당신의 힘을 빌려 주세요……/뭐든지 할테니까……"
			CALL MESSAGE_WINDOW_D, "마왕 로키", "그래 그래、솔직한 것이 제일、/갖고 싶은 것이 있다면 제대로 머리를 낮추지 않으면"
			CALLF STRFLAG_D("명계플래그", 1)
		ENDIF
		CALL MESSAGE_WINDOW_D, "", @"＞%마스터는% 로키가 있던 방을 뒤로 하고、탐색을 재개했다"
	CASE 901, 2700
		CALL SHOW_PICTURE, "D"
		IF FLAG:월령 == 0
			CALL MESSAGE_WINDOW_D, "가게 주인", "이봐 이봐 오늘은 초승달이라고/일 따위 못 해 먹겠어/또 와줘"
		ELSE
			CALL MESSAGE_WINDOW_D, "가게 주인", "어서 와。여긴 주얼리 상점이야"
			IF ITEM:자수정 == 1
				CALL MESSAGE_WINDOW_D, "가게 주인", "그【자수정】예쁘구나　무언가와 바꿀거야？"
				$CHOICE_RAG
				CALL INPUT_SELECT_D, "[0] 용의 수염/[1] 카미나리 오코시/[2] 아레스의목걸이/[3] 하늘의곡옥/[4] 런던부츠/[9] 교환하지 않는다", , , 2, 4
				SELECTCASE RESULT
					CASE 0
						CALL MESSAGE_WINDOW_D, "가게 주인", "그 수염에는 저주가 걸려있어……/농담이야"
						LOCALS = 
						LOCAL:3 = 0
						FOR LOCAL:1, 1, 7
							LOCAL = POS(LOCAL:1)
							SIF LOCAL == -1
								CONTINUE
							;회복량
							LOCAL:2 = MAXBASE:LOCAL:ＨＰ
							LOCALS += @"＞TARGET:[{LOCAL:1,2}] %CALLNAME:LOCAL,20,LEFT%　>>>>>>　"
							IF GET_STATE(CFLAG:LOCAL:상태이상) == "DYING"
								LOCALS += @"%조사처리(CALLNAME:LOCAL, "는")% 숨을 되찾았다！"
							ELSE
								LOCALS += @"{LOCAL:2}회복 %\@GET_STATE(CFLAG:LOCAL:상태이상) == "GOOD"?# ＋ 상태회복\@%"
							ENDIF
							CFLAG:LOCAL:상태이상 = GET_STATE_NUM("GOOD")
							CALL VAR_HP,LOCAL,LOCAL:2,3
							IF ++LOCAL:3 == 4
								CALL MESSAGE_WINDOW_D, "", LOCALS
								LOCALS = 
							ELSE
								LOCALS += "/"
							ENDIF
						NEXT
						CALL MESSAGE_WINDOW_D, "", LOCALS
					CASE 1
						CALL MESSAGE_WINDOW_D, "가게 주인", "부디……"
						CALL MESSAGE_WINDOW_D, "", "＞갑자기 머리 위에서 격렬한 번개가！/＞엄청난 데미지를 받았다"
						LOCALS = 
						LOCAL:3 = 0
						FOR LOCAL:1, 1, 7
							LOCAL = POS(LOCAL:1)
							SIF LOCAL == -1
								CONTINUE
							SIF GET_STATE(CFLAG:LOCAL:상태이상) == "DYING"
								CONTINUE
							;데미지量
							LOCAL:2 = BASE:LOCAL:ＨＰ - 1
							LOCALS += @"TARGET:[{LOCAL:1,2}] %CALLNAME:LOCAL,20,LEFT%　>>>>>>　{LOCAL:2}데미지！"
							CALL VAR_HP,LOCAL,-LOCAL:2,3
							IF ++LOCAL:3 == 4
								CALL MESSAGE_WINDOW_D, "", LOCALS
								LOCALS = 
							ELSE
								LOCALS += "/"
							ENDIF
						NEXT
						CALL MESSAGE_WINDOW_D, "", LOCALS
					CASE 2, 3, 4
						LOCALS = %AUTO_SPLIT("아레스의목걸이/하늘의곡옥/런던부츠", "/",RESULT-2)%
						IF ITEM:LOCALS > 0
							CALL MESSAGE_WINDOW_D, "가게 주인", @"이런、%LOCALS% 가지고 있잖아/다른 건 안돼"
							PRINTFORML 「
							PRINTFORMW 　」
							GOTO CHOICE_RAG
						ELSE
							CALL MESSAGE_WINDOW_D, "가게 주인", "이봐…부디…"
							CALL MESSAGE_WINDOW_D, "", @"＞【%LOCALS%】을(를) 손에 넣었다"
							PRINTFORMW 
							ITEM:LOCALS = 1
						ENDIF
					CASE 9
						CALL MESSAGE_WINDOW_D, "가게 주인", "그런가。유감이군/생각이 바뀌면 잘 부탁해"
						RETURN 0
				ENDSELECT
				ITEM:자수정 = 0
			ELSE
				CALL MESSAGE_WINDOW_D, "가게 주인", "나는 돈에 관심 없어/흥미 있는 건 아름다운 보석 뿐이다/그리고、지금 내가 찾고 있는 건【자수정】이다/【자수정】을 손에 넣으면 또 와줘"
				CALLF STRFLAG_D("보석가게초회",1)
			ENDIF
		ENDIF
	CASE 1000
		SIF STRFLAG_D("Y코")
			RETURN 0
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞썩은 냄새가 난다…"
		IF STRFLAG_D("명계플래그") && FINDCHARA_B([[キャラ:로키]], 1) > 0
			IF !STRFLAG_D("첫명계",1)
				CALL MESSAGE_WINDOW_D, "마왕 로키", "여기가 저승의 입구야/예전에 어리석은 연인을 감싸다、/죽어버린 비극의 히로인이 있었단 말이다"
				IF FINDCHARA_B([[キャラ:아케미]]) == 2
					CALL MESSAGE_WINDOW_D, "아케미", "く……"
					CALL MESSAGE_WINDOW_D, "마왕 로키", "큭큭、그런 무서운 얼굴 하지 말아줘/여하튼、도움이 될테니까/그렇지？"
					CALL MESSAGE_WINDOW_D, "아케미", "………"
					CALL MESSAGE_WINDOW_D, "마왕 로키", "그건 제쳐두고……"
				ENDIF
				CALL MESSAGE_WINDOW_D, "마왕 로키", "이 앞은 죽은 자의 나라다/어둡고 차가운 암흑 속에 휩싸여있지 /한 번 발 디디면、/놈들은 산 자의 나라로 돌아가는 걸 허락하지 않겠지"
				CALL MESSAGE_WINDOW_D, "마왕 로키", "죽은 자의 동료가 되고 싶지 않다면、어둠으로부터 자신을 지킬 모든 걸 익히고、/어둠을 물리치는 빛을 준비하지 않으면 안 된다/준비는 되어있겠지？"
				CALL INPUT_YN_D
				IF RESULT == 0
					CALL MESSAGE_WINDOW_D, "마왕 로키", "크크크…그럼 가볼까/네가 망자들에 동참할 정도로/멍청한 짓을 할 리 없다고 믿겠어"
					FLAG:COMP사용불능 = 1
					FLAG:탈출스킬금지 = 1
					CALL DUNGEON_WORP_ID, 60, -61, 1
				ELSE
					CALL MESSAGE_WINDOW_D, "마왕 로키", "그런가、그렇다면 준비를 하는거다/뭐、상대는 이미 죽었어/시간은 얼마든지 있어"
				ENDIF
			ELSE
				CALL MESSAGE_WINDOW_D, "마왕 로키", "죽은 자의 나라에 가는건가？"
				CALL INPUT_YN_D
				IF RESULT == 0
					CALL MESSAGE_WINDOW_D, "마왕 로키", "크크크…그럼 가볼까/네가 망자들에 동참할 정도로/멍청한 짓을 할 리 없다고 믿겠어"
					FLAG:탈출스킬금지 = 1
					FLAG:COMP사용불능 = 1
					CALL DUNGEON_WORP_ID, 60, -61, 1
				ELSE
					CALL MESSAGE_WINDOW_D, "마왕 로키", "크크크……"
				ENDIF
			ENDIF
		ENDIF
	CASE 1001
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞악마가 쇠사슬에 묶여져있어…"
		CALL MESSAGE_WINDOW_D, "악마", @"오오、여행자여 내 이름은 릭 %\@!STRFLAG_D("로키격파") ?/마왕 로키에 의해 이 꼴이 돼버렸다! # \@%/이 쇠사슬에서 벗어날 수 있게 날 도와주지 않겠는가？"
		CALL INPUT_YN_D
		IF RESULT == 0
			$CHAIN
			CALL MESSAGE_WINDOW_D, "", "＞누가 쇠사슬을 제거할지 선택해주세요？"
			LOCALS = 
			FOR LOCAL, 1, 7
				SIF POS(LOCAL) >= 0 && CFLAG:POS(LOCAL):상태이상 == 0
					LOCALS += @"[{LOCAL}] %CALLNAME:POS(LOCAL)%/"
			NEXT
			LOCALS += "[9] やめておく"
			CALL INPUT_SELECT_D, LOCALS, , , 2
			IF RESULT < 7
				LOCAL = POS(RESULT)
				CALL MESSAGE_WINDOW_D, "", @"＞%조사처리(CALLNAME:LOCAL,"는")% 혼신의 힘을 다했다/＞철그렁 철그렁…"
				IF MAXBASE:LOCAL:힘 >= 50
					CALL MESSAGE_WINDOW_D, "", "＞쇠사슬이 빠졌다！"
					CALL MESSAGE_WINDOW_D, "릭", "감사합니다、정말 감사합니다/답례로 이 팔찌를 드리겠습니다/반드시 도움이 될겁니다"
					CALL MESSAGE_WINDOW_D, "", "＞【릭의 팔찌】를 손에 넣었다"
					ITEM:릭의팔찌 = 1
					DA:(FLAG:현X):(FLAG:현Y) = 1
					VARSET RESULT, -1
					LOCAL:1 = 0
					FOR LOCAL, 0, CHARANUM
						SIF ABL:LOCAL:종족 == 0
							CONTINUE
						SIF ABL:LOCAL:종족 == 13
							CONTINUE
						SIF ABL:LOCAL:종족 == 36
							CONTINUE
						SIF ABL:LOCAL:종족 == 45
							CONTINUE
						RESULT:(LOCAL:1) = MIN(BASE:LOCAL:LV, CSVBASE(NO:LOCAL, GETNUM(BASE, "LV"), 0)) * 1000 + TALENT:LOCAL:남자 * 100 + ABL:LOCAL:종족
						LOCAL:1++
					NEXT
					LOCAL:2 = -1
					WHILE MAXARRAY(RESULT) >= 0
						FOR LOCAL:1, 1, 6
							FOR LOCAL, (MAXARRAY(RESULT) % 100 - 1) * 100, MAXARRAY(RESULT) % 100 * 100 + 1
								SIF !EXISTCSV(LOCAL,0)
									CONTINUE
								SIF CSVBASE(LOCAL, GETNUM(BASE, "LV"), 0) != MAXARRAY(RESULT) / 1000 + LOCAL:1
									CONTINUE
								SIF GETCHARA(LOCAL) >= 0
									CONTINUE
								SIF CSVCFLAG(LOCAL,(GETNUM(CFLAG,"합체조건있음")),0) == 1
									CONTINUE
								SIF CSVTALENT(LOCAL,GETNUM(TALENT,"남자"),0) != (MAXARRAY(RESULT) % 1000) / 100
									CONTINUE
								SIF CSVCFLAG(LOCAL,(GETNUM(CFLAG,"특수합체만")),0) == 1
									CONTINUE
								LOCAL:2 = LOCAL
							NEXT
							SIF LOCAL:2 >= 0
								BREAK
						NEXT
						SIF LOCAL:2 >= 0
							BREAK
						LOCAL:1 = -1
						WHILE 1
							LOCAL:1++
							SIF MAXARRAY(RESULT) > RESULT:(LOCAL:1)
								CONTINUE
							RESULT:(LOCAL:1) = -1
							BREAK
						WEND
					WEND
					IF LOCAL:2 >= 0
						CALL MESSAGE_WINDOW_D, "릭", "이것이 나의 진정한 모습입니다"
						CALL MESSAGE_WINDOW_D, "", @"＞펑！/＞릭은 갑자기 %CSVCALLNAME(LOCAL:2,0)%(으)로 모습을 바꿨다"
						CALL MESSAGE_WINDOW_D, CSVCALLNAME(LOCAL:2,0), "꼭 동행시켜주십시오"
						CALL INPUT_YN_D
						IF RESULT == 0
							CALL ADD_NEW_COMPANION, LOCAL:2, 1000
							FLAG:(LOCAL:2+20000) = MAX(100, FLAG:(LOCAL:2+20000))
							CALL MESSAGE_WINDOW_D, "", @"%CSVCALLNAME(LOCAL:2,0)%(이)가 동료마가 되었다！"
						ELSE
							CALL MESSAGE_WINDOW_D, CSVCALLNAME(LOCAL:2,0), "그것은 유감…"
							CALL MESSAGE_WINDOW_D, "", @"%CSVCALLNAME(LOCAL:2,0)%은(는) 떠났다"
						ENDIF
					ELSE
						CALL MESSAGE_WINDOW_D, "", "＞릭은 예를 표하고 떠났다"
					ENDIF
				ELSE
					CALL MESSAGE_WINDOW_D, "", @"＞%CALLNAME:LOCAL%의 힘으로는 쇠사슬을 풀 수 없다！"
					GOTO CHAIN
				ENDIF
			ELSE
				CALL MESSAGE_WINDOW_D, "", "＞릭을 그대로 두고 그 곳을 떠났다…"
			ENDIF
		ELSE
			CALL MESSAGE_WINDOW_D, "", "＞릭을 그대로 두고 그 곳을 떠났다…"
		ENDIF
	CASE 1002
		SIF !ITEM:자수정
			CALL GET_TREASURE, GETNUM(ITEM, "자수정"), 1, FLAG:현던전, FLAG:현M + 25, 63
	;------------------------------
	;天空の街ビエン
	;------------------------------
	CASE 1400
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞방 중앙에는 반인반수의 생물을 본뜬 상이 안치되어 있다/＞들어보니 묵직하면서 이상한 힘이 느껴진다…/＞【타바사의 상】을 손에 넣었다！"
		ITEM:타바사의상 = 1
		DA:(FLAG:현X):(FLAG:현Y) = 1
	CASE 1600
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞마왕 메두사다！"
		CALL MESSAGE_WINDOW_D, "마왕 메두사", "비엔의 마을들은 나를 따르려 하지 않았다/그래서 돌로 만들어 주었지/자아、너희들도 그렇게 해 주마！"
		CALL MESSAGE_WINDOW_D, "", "＞마왕 메두사가 나타났다！"
		FLAG:도주불가플래그 = 1
		FLAG:회화불능플래그 = 1
		FLAG:선제기습취소 = 1
		CALL SET_MEDOUSA
		CALL BATTLE_START
		FLAG:도주불가플래그 = 0
		FLAG:회화불능플래그 = 0
		FLAG:선제기습취소 = 0
		;FLAG:(10000+[[キャラ:메두사]]) = 1
		CALL LIFTING_A_BAN([[キャラ:메두사]])
		CALLF STRFLAG_D("메두사격파", 1)
		CALLF STRFLAG_NUM_D("대마궁진행", "+=", , 1)
		CALL MESSAGE_WINDOW_D, "마왕 메두사", "서、설마 이 내가…"
		CALL MESSAGE_WINDOW_D, "", @"＞마왕 메두사를 쓰러뜨렸다！%\@ITEM:타바사의상 ? /＞【타바사의 상】는 부서졌다！ # \@%/＞황소의 키를 손에 넣었다！"
		ITEM:타바사의상 *= -1
		ITEM:황소의키 = 1
		DA:(FLAG:현X):(FLAG:현Y) = 1
	CASE 1601
		CALL MESSAGE_WINDOW_D, "", "＞한 자루의 검이 바위에 꽂혀 있다"
		;ステの판정はなしに
		IF FINDCHARA_B([[キャラ:아케미]]) == 2
			CALL MESSAGE_WINDOW_D, "아케미", "이건 히노카쿠츠치의 검……/이런 곳에 불려갔던 건가…/기다려 주세요"
			CALL MESSAGE_WINDOW_D, "", "＞아케미는 바위에서 검을 뽑아내었다/＞【히노카쿠츠치의 검】을 손에 넣었다"
			CALL GET_ITEMS,"히노카쿠츠치의검", 1
			IF STRFLAG_D("로키격파")
				CALL MESSAGE_WINDOW_D, "아케미", "이것이 있다면、일기당천이다"
			ELSE
				CALL MESSAGE_WINDOW_D, "아케미", "이것만 있으면、저 로키라도 반드시…"
			ENDIF
			DA:(FLAG:현X):(FLAG:현Y) = 1
			CALLF STRFLAG_D("히노카쿠츠치의검",1)
		ELSE
			;유미코が함락している場合、主人公で引き抜ける
			CALL INPUTABLE_CHARA(MASTER)
			IF RESULT == 1
				CALL MESSAGE_WINDOW_D, "", "＞뽑습니까？"
				CALL INPUT_YN_D
				IF RESULT == 0
					IF GETCHARA([[キャラ:유미코]]) >= 0 && 함락(GETCHARA([[キャラ:유미코]]))
						CALL MESSAGE_WINDOW_D, "", "＞힘을 집중하자 의외로 시원스럽게 검을 뽑아낼 수 있었다/＞【히노카쿠츠치의 검】을 손에 넣었다"
						CALL GET_ITEMS,"히노카쿠츠치의검", 1
						DA:(FLAG:현X):(FLAG:현Y) = 1
						CALLF STRFLAG_D("히노카쿠츠치의검",1)
					ELSE
						LOCALS = ＞검은 뽑히지 않아！/＞검에서 뿜어져 나와、%CALLNAME:MASTER%의 몸을 감쌌다！/
						LOCAL =  MAXBASE:MASTER:화염==999 ? 0 # MAXBASE:MASTER:ＨＰ* 50 / 100 * MAXBASE:MASTER:화염 / 100
						CALL VAR_HP, MASTER, -LOCAL
						IF LOCAL > 0
							LOCALS += @"＞%마스터는% 데미지를 입었다" 
						ELSEIF LOCAL == 0
							LOCALS += @"＞하지만、%마스터는% 데미지를 입지 않았다"
						ELSE
							LOCALS += "%마스터는% 회복했다"
						ENDIF
						CALL MESSAGE_WINDOW_D, "", LOCALS
					ENDIF
				ELSE
					CALL MESSAGE_WINDOW_D, "", "＞검이 발하는 이상한 오라를 감지하고 만지는 것을 그만두었다…"
				ENDIF
			ELSE
				CALL MESSAGE_WINDOW_D, "", "＞동료들은 검이 발하는 이상한 오라를 감지하고 만지는 것을 그만두었다…"
			ENDIF
		ENDIF
	;------------------------------
	;マズルカの回廊
	;------------------------------
	;ラグSHOP、901と一緒
	;CASE 2700
	;섀도우
	CASE 2600
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞방 안쪽으로부너 눌려서 다 죽어가는 것 같은 목소리가 들린다"
		CALL MESSAGE_WINDOW_D, "목소리", "…누구 있나요？/도와… 곤란해"
		CALL MESSAGE_WINDOW_D, "", "＞목소리를 따라가니 소녀가 있었다…"
		CALL MESSAGE_WINDOW_D, "소녀", "아아、다행이다…/어떻게 할까 어쩔 줄을 몰랐어…/실은、이 근처를 탐색하던 중에 무기를 잃어 버려서…"
		CALL MESSAGE_WINDOW_D, "소녀", "밖에 악마가 우글거리고 있어서/계속 여기 숨어 있었어"
		CALL MESSAGE_WINDOW_D, "소녀", "…그런데 보아하니、/뭔가 무기를 가지고 있는 것 같은데…/뭐든지 하나라도 좋으니/몸을 보호하기 위해 한 개 정도 주지 않겠나요？"
		CALL INPUT_YN_D
		IF RESULT == 0
			$SHADOW
			CALL INCREASE_LD, 4
			CALL MESSAGE_WINDOW_D, "소녀", "정말？ 기뻐요！/그럼、보답해드리지 않으면……/저기、이쪽으로……"
			SIF IS_LOOKSLIKE_MALE(MASTER)
				CALL MESSAGE_WINDOW_D, "", "＞소녀는 그렇게 말하며 옷에 손을 대었다……"
			CALL INPUT_YN_D("소녀에게 다가간다", "사양해 둔다")
			IF RESULT == 0
				CALL MESSAGE_WINDOW_D, "소녀", "우후、딱 걸렸네요。이거나 처먹으세요！"
				CALL MESSAGE_WINDOW_D, "", @"＞소녀가 어떤 가루를 뿌렸다…/＞＞%CALLNAME:MASTER%들은 마비에 걸렸다！"
				CALL MESSAGE_WINDOW_D, "소녀", @"자아、그럼 최후의 일격을 날려 볼까요%ハート()%"
				LOCAL = 1
			ELSE
				CALL MESSAGE_WINDOW_D, "소녀", "답례를 하겠다고 하는데、건방진！/따끔한 맛을 보여주마！"
			ENDIF
		ELSE
			LOCAL = 0
			CALL MESSAGE_WINDOW_D, "소녀", "혹시 무기를 가지고 있지 않아？/으응、그렇진 않겠지？/부탁해、하나라도 좋으니까！"
			CALL INPUT_SELECT_D, "[0]무기를 건낸다/[1] 무기는 없다고 대답한다/[2] 무기대신 몸을 요구한다"
			IF RESULT == 0
				GOTO SHADOW
			ELSEIF RESULT == 1
				CALL MESSAGE_WINDOW_D, "소녀", "정말로 갖고 있지 않아？/알았어。믿을께/우후…무기가 없다면…/이거、딱 좋은데！"
			ELSE
				CALL INCREASE_LC, -4
				CALL INCREASE_LD, -4
				CALL MESSAGE_WINDOW_D, "소녀", "어……？/응……알았어/나도 목숨이 걸린 건데、/이 정도는 싼 거지요…"
				CALL MESSAGE_WINDOW_D, "", @"＞소녀는 그러면서 얼굴을 빨갛게 물들이며、옷에 손을 대었다…/＞%마스터는% 소녀의 옆으로 걸어갔다/＞그러자 소녀가 히죽 웃더니、어떤 가루를 뿌렸다/＞%CALLNAME:MASTER%들은 마비에 걸렸다！"
				CALL MESSAGE_WINDOW_D, "소녀", "후후、음란한 마음을 품으니 이렇게 되는 거야/지옥에서 자신의 어리석음을 저주해라！"
				LOCAL = 1
			ENDIF
		ENDIF
		IF LOCAL
			FOR LOCAL, 1, 7
				SIF POS(LOCAL) < 0 || GET_STATE(CFLAG:(POS(LOCAL)):상태이상) == "DYING" || GET_STATE(CFLAG:(POS(LOCAL)):상태이상) == "STONE"
					CONTINUE
				CFLAG:(POS(LOCAL)):상태이상 = GET_STATE_NUM("PALYZE")
			NEXT
		ENDIF
		CALL MESSAGE_WINDOW_D, "", "＞외도 섀도우가 １체 나타났다！"
		FLAG:도주불가플래그 = 1
		FLAG:회화불능플래그 = 1
		FLAG:선제기습취소 = 1
		CALL SET_ENEMY,9,[[キャラ:섀도우]],50,0,1
		LOCAL = CHARANUM - 1
		ABL:LOCAL:스킬1 = [[스킬:마하무드온]]
		ABL:LOCAL:스킬2 = [[스킬:유혹의안개]]
		ABL:LOCAL:스킬3 = [[스킬:잔다인]]
		ABL:LOCAL:스킬4 = [[스킬:텐타라후]]
		ABL:LOCAL:아이템1 = GETNUM(ITEM, "지혜의향")
		ABL:LOCAL:입수확률1 = 100
		CALL BATTLE_START
		FLAG:도주불가플래그 = 0
		FLAG:회화불능플래그 = 0
		FLAG:선제기습취소 = 0
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞외도 섀도우는 힘이 다했다"
		CALLF STRFLAG_D("섀도우격파", 1)
		DA:(FLAG:현X):(FLAG:현Y) = 1
	;라토스의상
	CASE 2800
		$LATOS
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞꺼림칙한 기운을 뿜어내고 있는 저주에 쓰이는 물건같은 동상이 대좌에 안치되어 있다……"
		CALL INPUT_SELECT_D, "[0] 동상을 가진다/[1] 동상을 잘 조사한다/[9] 방에서 나간다"
		REDRAW 0
		IF RESULT == 0
			CALL MESSAGE_WINDOW_D, "", "＞동상을 들자 큰 소리를 내며 방 전체가 흔들린다！"
			$LATOS2
			CALL SET_ALIGNMENT("CENTER")
			CLEARLINE LINECOUNT - FLAG:커맨드표시행수
			PRINTFORML ┌%"─"*36%┐
			PRINT │
			PRINTBUTTON @"%"[0] 동상을 대좌에 되돌린다",36,LEFT%", 0
			PRINTBUTTON @"%"[1] 동상 대신에 무언가를 대좌에 놓는다",36,LEFT%", 1
			PRINTL │
			PRINT │
			PRINTBUTTON @"%"[2] 대좌를 조사한다",36,LEFT%", 2
			PRINTBUTTON @"%"[3] 방을 조사한다",36,LEFT%", 3
			PRINTL │
			PRINT │
			PRINTBUTTON @"%"[9] 방에서 나간다",72,LEFT%", 9
			PRINTL │
			PRINTFORML └%"─"*36%┘
			CALL SET_ALIGNMENT("LEFT")
			CALL TINPUTINT(5000, -1, 1, 0, 1, 2 ,3, 9)
			SELECTCASE RESULT
				CASE 0
					CALL SHOW_FORCEMOVE, "RR", "D", , , @"＞像を戻すと、部屋の揺れはおさまった…/＞像を손に入れることは出来なかった！"
					RETURN 0
				CASE 1
					CALL SET_ALIGNMENT("CENTER")
					CLEARLINE LINECOUNT - FLAG:커맨드표시행수
					PRINTFORML ┌%"─"*36%┐
					PRINTFORML │%"＞받침대에 올려놓을 아이템명을 입력해주세요",72,LEFT%│
					PRINTFORML │%" ",72%│
					PRINTFORML │%" ",72%│
					PRINTFORML └%"─"*36%┘
					CALL SET_ALIGNMENT("LEFT")
					TINPUTS 10000, "時間切れ", 1
					IF RESULTS != "時間切れ"
						IF GETNUM(ITEM, RESULTS) == -1 || ITEM:RESULTS < 1
							CALL MESSAGE_WINDOW_D, "", @"＞%조사처리(RESULTS,"를")% 가지고 있지 않다！"
						ELSE
							IF RESULTS == "아레스의목걸이"
								CALL MESSAGE_WINDOW_D, "", "＞【아레스의 목걸이】를 놔두자、방의 흔들림이 잦아들었다/＞【라토스의 상】을 손에 넣었다！"
								ITEM:라토스의상 = 1
								ITEM:아레스의목걸이 = 0
								DA:(FLAG:현X):(FLAG:현Y) = 1
								RETURN 0
							ELSE
								CALL MESSAGE_WINDOW_D, "", @"＞%RESULTS%를 두었지만、함정이 해제되는 기색은 없다……"
							ENDIF
						ENDIF
					ENDIF
				CASE 2
					CALL MESSAGE_WINDOW_D, "", "＞무언가를 두면 함정을 해제할 수 있는 것 같다"
				CASE 3
					CALL MESSAGE_WINDOW_D, "", "＞대좌 외에 이상한 곳은 없다"
				CASE 9
					CALL MESSAGE_WINDOW_D, "", "＞문이 열리지 않는다！"
			ENDSELECT
			CALL MESSAGE_WINDOW_D, "", @"＞벽이 무너져 %CALLNAME:MASTER% 일행에게 쏟아져 내린다！"
			LOCALS = 
			LOCAL:2 = 0
			FOR LOCAL,1,7
				SIF POS(LOCAL) < 0
					CONTINUE
				SIF GET_STATE(CFLAG:(POS(LOCAL)):상태이상) == "DYING"
					CONTINUE
				LOCAL:3 = MAXBASE:POS(LOCAL):ＨＰ*RAND(5, 26)/100
				LOCALS += @"＞TARGET:[{LOCAL,2}] %CALLNAME:POS(LOCAL),20,LEFT%　>>>>>>　{LOCAL:3}데미지"
				CALL VAR_HP,POS(LOCAL),-LOCAL:3
				IF ++LOCAL:2 == 4
					CALL MESSAGE_WINDOW_D, "", LOCALS
					LOCALS = 
				ELSE
					LOCALS += "/"
				ENDIF
			NEXT
			CALL MESSAGE_WINDOW_D, "", LOCALS
			LOCAL:4 = 0
			;生存キャラ체크
			FOR LOCAL, 1, 7
				SIF POS(LOCAL) < 0
					CONTINUE
				SIF GET_STATE(CFLAG:(POS(LOCAL)):상태이상) == "STONE"
					CONTINUE
				SIF GET_STATE(CFLAG:(POS(LOCAL)):상태이상) == "DYING"
					CONTINUE
				SIF POS(LOCAL) != MASTER && !함락(POS(LOCAL))
					CONTINUE
				LOCAL:4 = 1
			NEXT
			SIF LOCAL:4 == 1
				GOTO LATOS2
			;全滅していた場合はゲームオーバー
			CALL DEADEND
			QUIT
		ELSEIF RESULT == 1
			CALL MESSAGE_WINDOW_D, "", "＞아무래도 대좌에는 함정이 장치되어 있는 것 같다/＞동상을 움직이면 함정이 움직이는 것 같지만、/＞함정을 해제할 방법을 모른다"
			GOTO LATOS
		ELSE
			REDRAW 1
			CALL SHOW_FORCEMOVE, "RR", "D", , , @"＞%CALLNAME:MASTER%은(는) 상(像)을 남기고、방을 나왔다"
		ENDIF
		REDRAW 1
	CASE 3001
		CALL SHOW_PICTURE, "D"
		IF !ITEM:은릴리프
			CALL MESSAGE_WINDOW_D, "", "＞……어디선가、요정의 목소리가 들린다"
			CALL MESSAGE_WINDOW_D, "요정", "짝짝짝/여기는 무서운 괴물투성이/이 문에는 장치가 있어…"
			RETURN 0
		ELSEIF ITEM:은릴리프 == 1
			CALL MESSAGE_WINDOW_D, "", "＞……어디선가、요정의 목소리가 들린다"
			CALL MESSAGE_WINDOW_D, "요정", "짝짝짝/여기는 무서운 괴물투성이/이 방에는 장치가 있어…"
			CALL MESSAGE_WINDOW_D, "요정", "은 릴리프를 꺼내봐/무섭고 무서운 괴물의 여왕님을 만날거야…"
			CALL MESSAGE_WINDOW_D, "", "＞【은 릴리프】를 꺼냅니까？"
			CALL INPUT_YN_D
			IF RESULT == 0
				IF STRFLAG_D("릴리프파손") && FLAG:월령 != 8
					CALL MESSAGE_WINDOW_D, "요정", "어머나、릴리프가 망가져 있어/이래서야 문은 열리지 않아"
					CALL MESSAGE_WINDOW_D, "요정", "하지만 괜찮아/망가진 릴리프라도 마력은 있으니까/만월이 되면 또 와요/그렇다면 그 릴리프로도 괜찮아"
				ELSE
					DA:(FLAG:현X):(FLAG:현Y) = 1
					DA:(FLAG:현X-2):(FLAG:현Y) = 1
					CALL MESSAGE_WINDOW_D, "", "＞【은 릴리프】가 벽에 빨려들어갔다！/＞문이 나타났다！/문 저쪽에서 목소리가 들렸다"
					CALL SHOW_PICTURE, "D"
					ITEM:은릴리프 = -1
					CALL MESSAGE_WINDOW_D, "목소리", "이 속임수를 깨다니 제법이군/자、안으로 들어와도 좋아/포상을 주지"
					CALL SHOW_FORCEMOVE, "LL", "D", , "", @"＞%CALLNAME:MASTER%は문는 문을 열고, 방안으로 들어섰다"
					CALL MESSAGE_WINDOW_D, "", "＞그러나 방 안에는 아무도 없다"
					CALL MESSAGE_WINDOW_D, "헤카테", "포상은 이 나의 아름다운 모습이다/제대로 눈에 새겨두는게 좋아/단 볼 수 있다면 말이야…"
					IF ITEM:라토스의상
						CALL MESSAGE_WINDOW_D, "", "＞라토스의 상】을 들었다！/빛이 헤카테를 감쌌다！/＞헤카테의 모습이 보이게 되었다！"
						CALL MESSAGE_WINDOW_D, "헤카테", "내 모습을 폭로하다니……/도구를 사용했다고는 해도 훌륭하다"
						IF FLAG:월령 == 8
							CALL MESSAGE_WINDOW_D, "헤카테", "하지만 만월의 힘을 받은 나는 무적이다/아무리 너희들이 지혜를 짜낸다고 해도、/접근조차 어려울 것이다！"
						ELSEIF FLAG:월령 == 0
							CALL MESSAGE_WINDOW_D, "헤카테", "그리고 달빛이 없을 때 내 본모습을 찾아다오/그 지혜야말로 그분이 너희들 인간에게 기대하고 있는 것/그보다 지혜가 아닌 것도 볼까"
						ELSE
							CALL MESSAGE_WINDOW_D, "헤카테", "도구를 사용하는 지혜、이것이 그분이 말하는 인간의 힘/그러나 도구가 있다고 원래의 힘이 약하다는 법은 없지/인간이여。네 힘이 얼마만큼인지 보여봐라"
						ENDIF
						
					ELSE
						IF FLAG:월령 == 8
							CALL MESSAGE_WINDOW_D, "헤카테", "자、너희들의 힘、시험해보자꾸나/라고 말해봤자 아무리 너희들이 강해도/만월의 빛에 감싸인 나를 이길 수 있을 리 없겠지만"
						ELSEIF FLAG:월령 == 0
							CALL MESSAGE_WINDOW_D, "헤카테", "초생달을 선택할 정도의 지혜는 있었구나/하지만 너희들 정도는 달빛이 없어도 충분하다/각오해라！"
						ELSE
							CALL MESSAGE_WINDOW_D, "헤카테", "너희들의 힘이 달빛에 감싸인 나에게/통할지 시험해주마！"
						ENDIF
					ENDIF
					CALL MESSAGE_WINDOW_D, "", "＞마왕 헤카테가 １체 나타났다！"
					FLAG:도주불가플래그 = 1
					FLAG:회화불능플래그 = 1
					FLAG:선제기습취소 = 1
					CALL SET_HECATE
					CALL BATTLE_START
					DA:(FLAG:현X):(FLAG:현Y) = 1
					CALLF STRFLAG_D("헤카테격파", 1)
					CALLF STRFLAG_NUM_D("대마궁진행", "+=", , 1)
					;FLAG:(10000+[[キャラ:헤카테]]) = 1
					CALL LIFTING_A_BAN([[キャラ:헤카테]])
					FLAG:도주불가플래그 = 0
					FLAG:회화불능플래그 = 0
					FLAG:선제기습취소 = 0
					CALL SHOW_PICTURE, "D"
					CALL MESSAGE_WINDOW_D, "", @"＞헤카테를 쓰러뜨렸다%\@ITEM:라토스의상?/＞라토스의 상은 부서졌다…#\@%"
					ITEM:라토스의상 *= -1
					CALL MESSAGE_WINDOW_D, "헤카테", "……분명 그분의 마음에 들만하구나/당신은 정말 강하네……"
					IF ABL:MASTER:속성LD == 3 && ABL:MASTER:속성LC == 3
						CALL MESSAGE_WINDOW_D, "헤카테", "이제、지금부터는 네가 이【마주르카의 회랑】의 지배자다/이제부터는 나도 당신에게 힘을 빌려주지"
						CALL MESSAGE_WINDOW_D, "헤카테", "자、함께 나아가자/그 분은 당신 스스로의 다리로/자신의 근원에 도착을 것을 희망하고 계시니…/될 수 있다면 나도 그 행보를 도와주지"
						CALL ADD_NEW_COMPANION, [[キャラ:헤카테]], 1000, 1
						IF RESULT
							BASE:(RESULT:1):LV += 3
							BASE:(RESULT:1):마력 += 3
							BASE:(RESULT:1):지혜 += 2
							ABL:(RESULT:1):스킬4 = [[스킬:부흐다인]]
							ABL:(RESULT:1):스킬5 = [[스킬:마그다인]]
							ABL:(RESULT:1):스킬6 = [[스킬:만월의여왕]]
							ABL:(RESULT:1):스킬7 = [[스킬:마린카린]]
							ABL:(RESULT:1):스킬8 = [[스킬:시바브]]
							CALL SYNC_STATUS,(RESULT:1)
							CALL HEALTH_CHARA,(RESULT:1)
						ENDIF
					ELSE
						CALL MESSAGE_WINDOW_D, "헤카테", "이제、지금부터는 네가 이【마주르카의 회랑】의 지배자다/앞으로 나아가도 좋아/그 분은 당신 스스로의 다리로 자신의 근원에 도착할 것을 희망하고 계시니…"
					ENDIF
				ENDIF
			ENDIF
		ENDIF
	;이자나미(세트)の封印
	CASE 3600
		IF !STRFLAG_D("세트봉인해제")
			CALL MESSAGE_WINDOW_D, "", "＞이마와 오른쪽 눈、왼쪽 눈의 위치에 큰 구멍이 있는 가면을 쓰고있는 동상이 서있다‥…"
			IF ITEM:정옥 && ITEM:황옥 &&ITEM:고옥
				CALL MESSAGE_WINDOW_D, "", @"＞%마스터가% 가지고 있는 정옥、황옥、고옥 등 3가지 구슬이/＞갑자기 강하게 빛나기 시작했다/＞아무래도 이 구슬을 가면 구멍에 끼워야 하는 것 같다……"
				CALL MESSAGE_WINDOW_D, "", "＞오른쪽 눈에 넣을 구슬을 선택하십시오"
				CALL INPUT_SELECT_D, "[0] 정옥/[1] 황옥/[2] 고옥"
				LOCAL:1 = RESULT
				CALL MESSAGE_WINDOW_D, "", "＞왼쪽 눈에 넣을 구슬을 선택하십시오"
				CALL INPUT_SELECT_D, @"%\@ LOCAL:1 == 0 ? # [0] 정옥/\@%%\@ LOCAL:1 == 1 ?  # [1] 황옥/\@%%\@ LOCAL:1 == 2 ? # [2] 고옥/\@%"
				LOCAL:2 = RESULT
				FOR LOCAL, 0, 3
					SIF LOCAL == LOCAL:1
						CONTINUE
					SIF LOCAL == LOCAL:2
						CONTINUE
					LOCAL:3 = LOCAL
				NEXT
				LOCALS = 
				FOR LOCAL, 0, 3
					IF LOCAL == 0
						LOCALS += "＞오른쪽 눈에"
					ELSEIF LOCAL == 1
						LOCALS += "＞왼쪽 눈에"
					ELSE
						LOCALS += "＞이마에"
					ENDIF
					IF LOCAL:(LOCAL+1) == 0
						LOCALS += "정옥을 넣는다/"
					ELSEIF LOCAL:(LOCAL+1) == 1
						LOCALS += "황옥을 넣는다/"
					ELSE
						LOCALS += "고옥을 넣는다/"
					ENDIF
				NEXT
				LOCALS += "＞이걸로 좋습니까？"
				CALL MESSAGE_WINDOW_D, "", LOCALS
				CALL INPUT_SELECT_D, "[0] 예/[1] 아니오/[9] 옥을 끼워넣는것을 그만두고 물러선다"
				;LOCAL:1 右　LOCAL:2　左 LOCAL;3 額　/ 0 정옥 1 황옥 2 고옥
				;正解は右が고옥、左が정옥、額が황옥
				IF RESULT == 9
					CALL MESSAGE_WINDOW_D, "", "＞구슬을 꺼내고 상으로부터 멀어졌다……"
				ELSEIF LOCAL:1 == 2 && LOCAL:2 == 0 && LOCAL:3 == 1
					ITEM:정옥 = -1
					ITEM:황옥 = -1
					ITEM:고옥 = -1
					CALL MESSAGE_WINDOW_D, "", "＞가면을 채운 구슬이 격렬하게 빛났다！/＞가면이 부서지고 상의 본모습이 드러났다！"
					CALL MESSAGE_WINDOW_D, "", "＞……어디선가 무시무시한 포효소리가 들려온다/＞강대한 악마가 눈을 뜬 것 같다……"
					CALLF STRFLAG_D("세트봉인해제", 1)
				ELSE
					CALLF STRFLAG_D("봉인해제실패", 1)
					CALL MESSAGE_WINDOW_D, "", "＞현실에 맹렬한 회오리가 일어났다！"
					CALL SHOW_FORCEMOVE, "DD", "D"
				ENDIF
			ENDIF
		ELSE
			CALL MESSAGE_WINDOW_D, "", "＞날쌔고 용맹한 모습을 한 동상이 서 있었다‥…"
		ENDIF
	CASE 3601
		CALL MESSAGE_WINDOW_D, "", "＞벽에 문자가 새겨져 있다…/＞『초생달에는 문이 열리지 않아』"
	CASE 3800
		CALL MESSAGE_WINDOW_D, "", "＞작은 오니가 들어간 병이 떨어져 있다/＞주워들고 봅니까？"
		CALL INPUT_YN_D
		IF RESULT == 0
			CALL MESSAGE_WINDOW_D, "동자귀신", "나는 루스/함께 데려가 주세요/반드시 도움이 될 테니까…"
			CALL MESSAGE_WINDOW_D, "", "＞루스의 작은 병을 손에 넣었다"
			ITEM:루스의작은병 = 1
			DA:(FLAG:현X):(FLAG:현Y) = 1
		ENDIF
	;ホーリーの壷
	CASE 3900
		CALL MESSAGE_WINDOW_D, "", "＞오래된 단지가 있다/＞안을 보니 바닥에 뭔가가 창백하게 빛나고 있다…/＞손을 넣어 봅니까？"
		CALL INPUT_YN_D
		IF RESULT == 0
			CALL MESSAGE_WINDOW_D, "", @"＞손에 반응이 없다/＞빛나고 있는 무언가는 손에 넣을 수 없는 것 같다/＞%마스터는% 그 장소를 뒤로 했다…"
		ELSE
			CALL MESSAGE_WINDOW_D, "", @"＞%마스터는% 그 장소를 뒤로 했다…"
		ENDIF
ENDSELECT
;	IF 던전플래그:5:10 == 0 && FLAG:현M == 0
;		CUSTOMDRAWLINE =
;		PRINTW 거대한 외관과는 다르게 이상야릇하게도 좁은 복도가 계속된다。
;		PRINTW 그 언밸런스한 광경에 위화감을 느끼면서도 
;		PRINTW 일단은 계단까지 겨우 도착했다。
;		PRINTL 
;		PRINTW 그러자 눈앞에 갑자기 전의 그 초로의 신사가 나타났다。
;		PRINTW 신사는 조용히 이야기를 시작했다…。
;		PRINTL 
;		PRINTW 「…일찍이、사람의 몸인데도、사람이 되지 못하는 두뇌를 가진 인간 남자가 있었습니다。
;		PRINTW 그리고 그 사람을 어쩔 수 없이 사랑해 버린 인간 여자가 있었습니다。
;		PRINTW 그들은 수많은 전투와 윤회의 여행을 거쳐 마침내 금단의 땅으로 발을 디뎠습니다。
;		PRINTL 
;		PRINTW …그것은 대마궁。사람과 악마의 영혼을 한없이 유혹하는 수련의 땅입니다。
;		PRINTL 
;		PRINTW …왜 내가 그런 것을 알고 있는가？
;		PRINTW 그런 것은 아무래도 좋습니다。
;		PRINTW 중요한 것은…이렇게…당신도 이 탑이 보이게 되버렸다는 것이지요…。
;		PRINTW …그렇게 무서운 얼굴 하지 마시지요。
;		PRINTW 전에도 말했었지요？ 나는 당신의 팬입니다。
;		PRINTW 보다 강하고、보다 아름답고、보다 흉폭하게 빛나는 당신을 보고 싶은 거지요…」
;		PRINTL 
;		PRINTW …찰나의 순간、신사는 사라졌다…。
;		PRINTW 우선 서두르자…。
;		던전플래그:5:10 = 1
;		DA:(FLAG:현X):(FLAG:현Y) = 1
;
;	ELSEIF 던전플래그:5:11 == 0 && FLAG:현M == 7 && FLAG:현X == 14 && FLAG:현Y == 2
;		CUSTOMDRAWLINE =
;		PRINTW 하늘도 뚫어버릴 것 같은 높이의 이 탑 안도、그 광경이 이상했다。
;		PRINTL 
;		PRINTW 방 중앙에 자리잡고 있는 그것은…
;		PRINTW 악마였다。남자 악마。
;		PRINTW 악마에 대해 말하는 건 이상한 이야기지만、나이는 젊어 보인다。
;		PRINTL 
;		PRINTW 불타는듯한 붉은 머리에 보석같은 녹색 피부…
;		PRINTW 청색 바탕의 비단으로 만들어진 복장을 입었는데、자신의 신장보다 컸다
;		PRINTW 거대한 창을 들고、지금이라도 당장 전투태세에 들어갈 것 같은 분위기다。
;		PRINTL 
;		PRINTW 하지만…그럴 수는 없다。
;		PRINTL 
;		PRINTW 전혀 움직이는 기색이 없는 것이다。
;		PRINTL 
;		PRINTW 살아 있는 모습 그대로 였는데、정말 꿈쩍도 하지 않았다！
;		PRINTW 마치 시간이 멈춘 것 같은 것과 같이…。
;		PRINTL 
;		PRINTFORMW 기분 나쁜 것을 본 표정이 된 %CALLNAME:MASTER% 일행은 
;		PRINTW 그 악마 앞에서 떨어지려고 했지만…
;		PRINTW 갑자기 그 악마의 눈동자가 요염하게 빛나는 것처럼 보인 다음…
;		PRINTFORMW %CALLNAME:MASTER%의 몸에 불가사의한 힘이 솟구쳤다！
;		PRINTL 
;		PRINTFORMW %CALLNAME:MASTER%의 모든 능력이 상승했다！
;			BASE:MASTER:힘 += 1
;			BASE:MASTER:지혜 += 1
;			BASE:MASTER:마력 += 1
;			BASE:MASTER:인내력 += 1
;			BASE:MASTER:속도 += 1
;			BASE:MASTER:운 += 1
;		PRINTL 
;		PRINTFORMW 그것과 동시에 말로 표현할 수 없는 오한이 %마스터를% 엄습하기 시작했다。
;		PRINTL 
;		PRINTW 무언가 돌이킬 수 없는 일을 해 버렸을지도 모른다…。
;		PRINTW …우선 서두르자…。
;		던전플래그:5:11 = 1
;		DA:(FLAG:현X):(FLAG:현Y) = 1

;	ELSEIF 던전플래그:5:12 == 0 && FLAG:현M == 7 && FLAG:현X == 9 && FLAG:현Y == 11
;
;	ENDIF
;=======
;宝箱
;=======
@TREASURE_5
#LOCALSIZE 3
#LOCALSSIZE 3
LOCAL:2 = (DA:(FLAG:현X):(FLAG:현Y) / 10) % 100
;個数,-1のとき、마카・0の時、\となる
LOCAL = 1
;IDは현M*100＋X個눈の宝箱の法則でふられている
SELECTCASE DA:(FLAG:현X):(FLAG:현Y) / 10
	;------------------------------
	;ダイダロスの塔
	;------------------------------
	;500마카
	CASE 0
		LOCALS = 마카
		LOCAL = 500
	CASE 100
		LOCALS = 마석
		LOCAL = 2
	CASE 101
		LOCALS = 보옥
	CASE 200
		LOCALS = 네이팜탄
		LOCAL = 3
	CASE 201
		LOCALS = 관음신부
		LOCAL = 2
	CASE 300
		LOCALS = 마카
		LOCAL = 100
	CASE 400
		LOCALS = MAG
		LOCAL = 5000
	CASE 401
		LOCALS = 스킬카드【충격의벽】
	CASE 500
		LOCALS = 마카
		LOCAL = 50
	CASE 700
		LOCALS = MAG
		LOCAL = 12000
	CASE 701
		LOCALS = 스킬카드【마구날뛰기】
	CASE 702
		LOCALS = 마카
		LOCAL = 42
	CASE 703
		LOCALS = 야마타노드링크
	CASE 704
		LOCALS = 물반경
	CASE 705
		LOCALS = 힘의향
	CASE 706
		LOCALS = 힘의향
	CASE 707
		LOCALS = 스킬카드【마하・지온가】
	CASE 708
		LOCALS = 스킬카드【지온가】
	CASE 709
		LOCALS = 마카
		LOCAL = 1500
	;------------------------------
	;ヴァルハラの回廊
	;------------------------------
	CASE 900
		LOCALS = 스킬카드【절대영도】
	CASE 901
		LOCALS = 스킬카드【마하・부흐다인】
	CASE 902
		LOCALS = 마카
		LOCAL = 2000
	CASE 903
		LOCALS = ￥
		LOCAL = 100000
	CASE 904
		LOCALS = MAG
		LOCAL = 50000
	CASE 905
		LOCALS = 마력의향
	CASE 906
		LOCALS = 힘의향
	CASE 907
		LOCALS = 보옥
		LOCAL = 3
	CASE 908
		LOCALS = 마석
		LOCAL = 3
	CASE 909
		LOCALS = 덫
		LOCALS:1 = POISON
		LOCAL = 30
		LOCALS:2 = 신경
	CASE 910
		LOCALS = 덫
		LOCALS:1 = ＭＰ
		LOCAL = 30
	CASE 1000
		LOCALS = 도반옥
	CASE 1001
		LOCALS = 덫
		LOCALS:1 = ＨＰ
		LOCAL = 30
	CASE 1002
		LOCALS = 마석
		LOCAL = 3
	CASE 1003
		LOCALS = 덫
		LOCALS:1 = POISON
		LOCAL = 30
		LOCALS:2 = 신경
	CASE 1004
		LOCALS = 덫
		LOCALS:1 = ＭＰ
		LOCAL = 30
	CASE 1005
		LOCALS = 이와쿠라의물
		LOCAL = 2
	;------------------------------
	;天空の街ビエン
	;------------------------------
	CASE 1200
		LOCALS = 마석
		LOCAL = 3
	CASE 1300
		LOCALS = 마카
		LOCAL = 720
	CASE 1301
		LOCALS = 페르세우스의검
	CASE 1400
		LOCALS = 디스톤
		LOCAL = 3
	CASE 1401
		LOCALS = 마카
		LOCAL = 372
	CASE 1402
		LOCALS = 덫
		LOCALS:1 = ＨＰ
		LOCAL = 25
	CASE 1403
		LOCALS = 덫
		LOCALS:1 = STONE
		LOCAL = 30
		LOCALS:2 = 주살
	CASE 1404
		LOCALS = ＭＡＧ
		LOCAL = 10000
	CASE 1405
		LOCALS = 헤르메스의샌들
	CASE 1406
		LOCALS = 스킬카드【페트라디】
	CASE 1407
		LOCALS = 덫
		LOCALS:1 = ＭＰ
		LOCAL = 20
	CASE 1408
		LOCALS = 마카
		LOCAL = 2772
	CASE 1409
		LOCALS = 마력의향
	CASE 1410
		LOCALS = 은의마니샤
		LOCAL = 3
	CASE 1411
		LOCALS = 보옥륜
		LOCAL = 3
	CASE 1412
		LOCALS = 스킬카드【페트라아이】
	CASE 1413
		LOCALS = 스킬카드【암리타】
	CASE 1500
		LOCALS = 제마의투구
	CASE 1501
		LOCALS = 마석
		LOCAL = 3
	CASE 1600
		LOCALS = 은의마니샤
	;------------------------------
	;マズルカの回廊
	;------------------------------
	CASE 1900
		LOCALS = 마카
		LOCAL = 360
	CASE 2100
		LOCALS = 은의마니샤
	CASE 2300
		LOCALS = 명왕신부
		LOCAL = 2
	CASE 2500
		LOCALS = 덫
		LOCALS:1 = ＭＰ
		LOCAL = 20
	CASE 2501
		LOCALS = 마석
		LOCAL = 3
	CASE 2502
		LOCALS = 마반경
		LOCAL = 1
	CASE 2600
		LOCALS = 운의향
	CASE 2601
		LOCALS = 스킬카드【그라다인】
	CASE 2602
		LOCALS = 보옥
		LOCAL = 3
	CASE 2900
		LOCALS = 야마타노드링크
		LOCAL = 2
	CASE 3000
		LOCALS = 마카
		LOCAL = 5700
	CASE 3001
		LOCALS = 마력의향
		LOCAL = 1
	CASE 3002
		LOCALS = 스킬카드【황천의회심】
	CASE 3003
		LOCALS = 스킬카드【정천의회심】
	CASE 3004
		LOCALS = 챠크라포트
	;------------------------------
	;炎の腐海
	;------------------------------
	CASE 3200
		LOCALS = 보옥
	CASE 3201
		LOCALS = MAG
		LOCAL = 98000
	CASE 3300
		LOCALS = 마반경
	CASE 3400
		LOCALS = 덫
		LOCALS:1 = ＭＰ
		LOCAL = 20
	CASE 3500
		LOCALS = 솔빙오브
	CASE 3700
		LOCALS = 화염의곡옥
	CASE 3701
		LOCALS = 덫
		LOCALS:1 = ＭＰ
		LOCAL = 20
	CASE 3800
		LOCALS = 열화의곡옥
	CASE 3900
		LOCALS = 마카
		LOCAL = 2200
ENDSELECT
IF LOCALS == "￥"
	CALL GET_TREASURE_MONEY, 0, LOCAL, FLAG:현던전, FLAG:현M + 25, (DA:(FLAG:현X):(FLAG:현Y) / 10) % 100
ELSEIF LOCALS == "마카"
	CALL GET_TREASURE_MONEY, 1, LOCAL, FLAG:현던전, FLAG:현M + 25, (DA:(FLAG:현X):(FLAG:현Y) / 10) % 100
ELSEIF LOCALS == "MAG" || LOCALS == "ＭＡＧ"
	CALL GET_TREASURE_MAG, 0, LOCAL, FLAG:현던전, FLAG:현M + 25, (DA:(FLAG:현X):(FLAG:현Y) / 10) % 100
ELSEIF LOCALS == "덫"
	;LOCALS:1 종류 LOCAL 데미지量or확률 LOCALS:2 相性
	CALL GET_TREASURE_TRAP, LOCALS:1, LOCAL, GET_TYPE_NUM(LOCALS:2), FLAG:현던전, FLAG:현M + 25, (DA:(FLAG:현X):(FLAG:현Y) / 10) % 100
ELSE
	IF GETNUM(ITEM, LOCALS) == -1
		PRINTL ＞아이템 이름의 지정이 잘못되었습니다
		PRINTW ＞아이템의 취득 처리를 중단합니다
	ELSE
		CALL GET_TREASURE, GETNUM(ITEM, LOCALS), LOCAL , FLAG:현던전, FLAG:현M + 25, (DA:(FLAG:현X):(FLAG:현Y) / 10) % 100
	ENDIF
ENDIF
;=======
;メッセンジャー(8)
;ARGは進入時の時に真
;IDは50未満が部屋の中、50以上外
;ARGがの場合RETURNして打ち切る
;=======
@TILE_MARK_COMMON_5_8, ARG, ARG:1, ARG:2
SETCOLOR 0x00ff00
RESULTS = ｍ
@MESSAGE_5, ARG
#LOCALSIZE 10
;移動時で이벤트タイルである場合、표시更新する
SIF DA:(FLAG:현X):(FLAG:현Y) > 10 && ARG
	CALL SHOW_PICTURE, "D"
SELECTCASE DA:(FLAG:현X):(FLAG:현Y) / 10
	CASE 0
		IF STRFLAG_D("미노타우로스격파", 0)
			IF FLAG:나오야루트
				CALL MESSAGE_WINDOW_D, "장로", "미노타우로스를 쓰러뜨렸습니까…/역시 귀하께선…"
				CALL MESSAGE_WINDOW_D, "장로", "이것으로 귀하는 이 다이달로스 타워의 지배자가 되셨습니다/미노타우로스도 당신을 따를 겁니다/그의 마왕과 동향에서 태어난 반신 반수의 악마와/마왕의 힘을 가진 악마를 사교의관에서 합체하면 좋을 겁니다"
			ELSE
				CALL MESSAGE_WINDOW_D, "장로", "그 미노타우로스를 쓰러뜨리다니…/당신은 정말 인간입니까…？"
			ENDIF
		ELSE
			CALL MESSAGE_WINDOW_D, "장로", "일찍이、신들과 악마의 싸움이 있었습니다/악마들은 패했고 지상으로 떨어졌습니다만/그 때 신으로부터 빼앗은 것을 대마궁에 숨기고 있다던가…"
			IF FLAG:나오야루트
				CALL MESSAGE_WINDOW_D, "장로", "대마궁의 지배자 루시퍼 님은 다시、/신들과의 결전에 도전하려 하고 있습니다"
				CALL MESSAGE_WINDOW_D, "장로", "그 때문에 신들로부터 빼앗은 힘을 계승할 수 있는 사람을 기다리고 있다던가/귀하는 인간입니다만、/혹시 어쩌면 루시퍼님이 기다리고 계신 건 아닌지？"
			ENDIF
		ENDIF
	CASE 1
		CALL MESSAGE_WINDOW_D, "마계인", "마궁의 안에서 당신의 동료마가 될 악마도 많이 있겠지요/말해봤자겠지요？"
	CASE 2
		CALL MESSAGE_WINDOW_D, "마계인", "여기는 미콘의 거리/다이달로스탑의 8층입니다"
	CASE 3
		CALL MESSAGE_WINDOW_D, "마계인", "마궁을 진행하려면 힘이 필요하구나！"
	CASE 4
		CALL MESSAGE_WINDOW_D, "", "사교의관은 이용하고 있어？/마궁의 안쪽까지 가겠다면 강한 악마를 만들고 나서/가는게 좋을거야！"
	CASE 100
		CALL MESSAGE_WINDOW_D, "마계인", "이 마궁은 6개의 에리어로 나누어져 있어요/그리고 각각의 에리어당 1명의 마왕이 지배하고 있지요/그 최고 지배자는 루시퍼"
		CALL MESSAGE_WINDOW_D, "마계인", "그러나 마왕끼리 사이가 좋다는 것은 아니고/그 루시퍼의 지위라도/노리고 있는 자가 있을 정도에요/악마의 세계도 복잡하지요"
	CASE 200
		CALL MESSAGE_WINDOW_D, "마계인", "악마는 보물을 좋아합니다/그것은 큰 마궁의 마왕도 똑같아서、/다들 보물을 저장하고 있습니다"
	CASE 300
		CALL MESSAGE_WINDOW_D, "마계인", "이 다이달로스탑을 지배하는 것은 미노타우로스라고 합니다/미노타우로스는 반신반수의 마왕인데 마력은 그렇게 높지 않지만、/그 완력에서 나오는 공격은 무서운 파괴력을 가지고 있습니다"
	CASE 400
		CALL MESSAGE_WINDOW_D, "마계인", "최근 인간계에 악마소환이라는 것이 유행하고 있는 바람에/이 마궁도 상당히 현실세계와의 경계가 애매모호하게 되어 있어요/덕분에 현실세계와 벽이 얇은 부분이 곳곳에 있기 때문에/그런 부분을 찾아내는 경우에는 상당히 자유롭게 현실세계와 왕래할 수 있답니다"
	CASE 500
		CALL MESSAGE_WINDOW_D, "마계인", "미노타우로스는 사실、/아스테리오스라는 이름인것 같은데/아무래도 그 이름은 천둥을 의미한다던가"
	CASE 501
		CALL MESSAGE_WINDOW_D, "마계인", "응？/뭐냐 그건？/여기서 돈을 달라고 하면 마카야"
	CASE 600
		CALL MESSAGE_WINDOW_D, "마계인", "전에 남쪽에 네코마타가 어정거리고 있었어/장난꾸러기 녀석이니까、/짐을 도둑맞지 않게 조심해야 할거야"
	CASE 601
		CALL MESSAGE_WINDOW_D, "마계인", "비엔 마을？/옛날에는 아름다운 마을이었다고 들었어요"
	CASE 700
		SIF ARG
			RETURN 0
		CALL MESSAGE_WINDOW_D, "마계인", "옛날 뱀을 좋아하는 생물이 있었는데/그 녀석만은 메두사도 무서워했던 것 같아/그 이름은「타바사」다"
	CASE 701
		CALL MESSAGE_WINDOW_D, "마계인", "【타바사의 상】이 없다면、메두사와의 싸움에 도전해도/돌이 되는 결말일 것이다"
	CASE 702
		PRINTL :
		IF STRFLAG_D("메두사격파")
			CALL MESSAGE_WINDOW_D, "마계인", "비엔 마을을 이용하면、/단숨에 대마궁의 안쪽으로 갈 수 있겠지요/하지만 안쪽에는 강적들이 숨어있으므로 조심하세요"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "비엔이 움직이면 대마궁의 다양한 곳을 갈 수 있지만…"
		ENDIF
	CASE 703
		SIF ARG
			RETURN 0
		IF STRFLAG_D("메두사격파")
			CALL MESSAGE_WINDOW_D, "마계인", "비엔 마을이 움직이기 시작했다는데요"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "아 우선 천공의 마을 비엔/이름 그대로 하늘을 날고 이동할 수 있다고 한다/하지만 지금은…"
		ENDIF
	CASE 704
		SIF ARG
			RETURN 0
		IF STRFLAG_D("메두사격파")
			CALL MESSAGE_WINDOW_D, "마계인", "당신、메두사를 처치했다면서요"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "그 마을는 또 날지 못할거야/왜냐하면 메두사에 의해 거리가 돌이 되었거든"
		ENDIF
	CASE 705
		SIF ARG
			RETURN 0
		IF STRFLAG_D("메두사격파")
			CALL MESSAGE_WINDOW_D, "마계인", "메두사가 쓰러져、/도시가 부활했다고 합니다/모처럼 놀러 가 볼까？"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "천공의 마을에 사는 거주자들은 메두사의 지배를 싫어해/【타바사의 상】을 모두들 숨기고/서지지 않게 하기 위해서야/그 탓에 주민들은…"
		ENDIF
	CASE 900
		CALL MESSAGE_WINDOW_D, "마계인", "쥬얼리 샵의 신작【아레스의 목걸이】라고 알아？/디자인은 멋지지만、좀 무거워서 어깨가 결리더군요"
	CASE 901
		CALL MESSAGE_WINDOW_D, "마계인", "지하소굴에 처박히면 끝장이야/도망치려 해도 그 쇠사슬、/상당한 힘이 없으면 벗어날 수 없다"
	CASE 902
		CALL MESSAGE_WINDOW_D, "마계인", "영웅 페르세우스가 메두사를 쓰러뜨리는데 사용한 3개의 장비가/비엔 마을 어딘가에 있는 것 같아/전부 모으면 메두사의 마력에도 틀림없이 대항 할 수 있을거야"
	CASE 903
		CALL MESSAGE_WINDOW_D, "마계인", "메두사는 미노타우로스에게/수컷소를 본 뜬 열쇠를 만들어 주었다고 해/천공의 마을을 봉쇄해버리기 위해"
	CASE 904
		CALL MESSAGE_WINDOW_D, "마계인", "로키는 빙결의 비의를 가지고 있다던가…/쓰러뜨릴려면 빙결 대책은 필수지요"
	CASE 905
		CALL MESSAGE_WINDOW_D, "마계인", "【아레스의 목걸이】란건、시드 이빨 3개와 같은 무게야"
	CASE 906
		IF !ITEM:롤의부적
			CALL MESSAGE_WINDOW_D, "마계인", "지금、생각할게 있으니 이야기가 있다면 나중에 해"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "그 부적 단순한 장식이 아닌 것 같구나/박식한 최면술 할아버지에게라도/물어보게나！"
			CALLF STRFLAG_D("부적정보", 1)
		ENDIF
	CASE 907
		CALL MESSAGE_WINDOW_D, "마계인", "로키의 마법은 강력하다고 합니다/마법에 대항할 수 있도록 하지 않으면、/쓰러뜨리는 것은 불가능하다네요"
	CASE 908
		CALL MESSAGE_WINDOW_D, "마계인", "자신있는 공격에 효과가 없는 상대가 나올 것을 생각해서/만능 속성의 공격수단을 준비해 두는 것은 매우 유용합니다/마왕 로키도 그런식으로 생각하고 있다던가…"
	CASE 1000
		;一般아이템で아메지스트がでるかもしれないのでとりあえず
		IF ITEM:자수정 == 1
			CALL MESSAGE_WINDOW_D, "마계인", "그건【자수정】……으음、대단한데 너"
		ELSEIF STRFLAG_D("보석가게초회")
			CALL MESSAGE_WINDOW_D, "마계인", "이런、【자수정】을 찾고 있습니까？/그러면 더 남쪽을 찾아봐야겠구나/뭐、너에겐 무리겠지만"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "【자수정】은 아름다울 뿐만 아니라 이상한 마력을 지니고 있다/만약 손에 넣으면 소중하게 다루도록 해/뭐、너에겐 무리겠지만"
		ENDIF
	CASE 1001
		CALL MESSAGE_WINDOW_D, "마계인", "이１층에 이상한 가게를 하고 있는 녀석이 있다네"
	CASE 1002
		IF FINDCHARA_B([[キャラ:아케미]]) == 2
			CALL MESSAGE_WINDOW_D, "요모츠시코메", "오오、당신이야말로 이자나기의 환생체！/당신의 도움이 되도록 비엔 마을에/히노카쿠츠치가 소환되었습니다！"
			CALL MESSAGE_WINDOW_D, "요모츠시코메", "가장 높은 곳의 바닥을 잘 조사하면 길을 열 수 있습니다！/그럼 무운을 기원하겠습니다"
			CALL MESSAGE_WINDOW_D, "", "＞요모츠시코메는 그 정도만 아케미에게 알리고 어딘가에 가 버렸다"
			DA:(FLAG:현X):(FLAG:현Y) = 1
			CALLF STRFLAG_D("요모츠시코메회화", 1)
		ELSE
			CALL MESSAGE_WINDOW_D, "요모츠시코메", "이자나기의 전생체를 찾고 있습니다/만날 일이 있으면、/여기에 와달라고 말해주세요"
		ENDIF
	CASE 1300
		IF STRFLAG_D("메두사격파")
			CALL MESSAGE_WINDOW_D, "마계인", "메두사가 쓰러진 것 같아/에、당신이？/우와、대단해。나에겐 관계없는데"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "동쪽에 이상한 할아버지가 있어요/메두사를 쓰러뜨릴지 물어보는데/나와는 관계 없잖아？"
			CALL MESSAGE_WINDOW_D, "마계인", "뭐？ 만나고 싶다고？/２층에서가 아니면 갈 수 없는 곳이다"
		ENDIF
	CASE 1301
		IF !STRFLAG_D("메두사격파")
			IF ITEM:작은열쇠
				CALL MESSAGE_WINDOW_D, "노인", "비엔 마을 메두사의 약점을 가지고 있었고/그리고 그것을 녀석에게 넘겨주지 않았기 때문에 멸해졌던 것이다…/부탁한다。녀석을 쓰러뜨려 모두를 해방시켜 줘"
			ELSE
				CALL MESSAGE_WINDOW_D, "노인", "자네、메두사를 쓰러뜨릴텐가？"
				CALL INPUT_YN_D
				IF RESULT == 0
					CALL MESSAGE_WINDOW_D, "노인", "역시 그런가/그러면 이것을 자네에게 맡기지/이 열쇠만 있으면 메두사를 봉인할 것이 손에 들어온다/부탁하네"
					CALL MESSAGE_WINDOW_D, "", "＞작은 열쇠를 손에 넣었다"
					ITEM:작은열쇠 = 1
				ELSE
					CALL MESSAGE_WINDOW_D, "노인", "그런가、틀렸구나"
				ENDIF
			ENDIF
		ELSE
			CALL MESSAGE_WINDOW_D, "노인", "메두사를 쓰러뜨렸는가！/잘 해냈구나！"
			PRINTW 「」
		ENDIF
	CASE 1302
		IF STRFLAG_D("메두사격파")
			CALL MESSAGE_WINDOW_D, "선장", "나는 천공의 도시의 선장입니다/우리들과 우리들의 도시를 구해줘서/정말로 고마워요"
			LOCAL = STRFLAG_NUM_D("비엔위치")
			IF STRFLAG_D("마주르카가능") || STRFLAG_D("안피니가능")
				LOCALS = 
				CALL MESSAGE_WINDOW_D, "선장", "도시를 움직입니까？"
				SIF LOCAL != 0
					LOCALS += "[0] ヴァルハラの回廊へ/"
				SIF STRFLAG_D("마주르카가능") && LOCAL != 1
					LOCALS += "[1] マズルカの回廊へ/"
				SIF STRFLAG_D("안피니가능") && LOCAL != 2
					LOCALS += "[2] アンフィニ宮殿へ/"
				LOCALS += "[9] 動かさない"
				CALL INPUT_SELECT_D, LOCALS
				IF RESULT == 9
					CALL MESSAGE_WINDOW_D, "선장", "그렇습니까/그러면 천천히 가세요"
					PRINTL :
					PRINTW 「」
					RETURN 0
				ELSEIF RESULT == 0
					CALLF STRFLAG_NUM_D("비엔위치", "=", , 0)
				ELSEIF RESULT == 1
					CALLF STRFLAG_NUM_D("비엔위치", "=", , 1)
				ELSEIF RESULT == 2
					CALLF STRFLAG_NUM_D("비엔위치", "=", , 2)
				ENDIF
				CALL MESSAGE_WINDOW_D, "선장", "그러면 이동합니다"
				CALL MESSAGE_WINDOW_D, "", "………………/…………/……"
				CALL MESSAGE_WINDOW_D, "선장", "다왔습니다/거기의 문으로 가보세요"
			ELSEIF ITEM:주유권
				CALL MESSAGE_WINDOW_D, "선장", "답례로 도시를 움직여 당신을 돕고 싶지만…/죄송합니다"
			ENDIF
		ELSE
			CALL MESSAGE_WINDOW_D, "", "＞돌이 된 사람이 있다"
		ENDIF
	CASE 1400
		PRINTL :
		IF STRFLAG_D("메두사격파")
			CALL MESSAGE_WINDOW_D, "마계인", "그 무서운 메두사가 쓰러졌다니…"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "메두사는 석화의사안을 가지고 있습니다/그 시선을 받으면 바위로 변해 버립니다/그리고 보통의 석화와 달리、/막을 수가 없습니다"
		ENDIF
	CASE 1401
		IF STRFLAG_D("메두사격파")
			CALL MESSAGE_WINDOW_D, "마계인", "아아、이렇게 도시가 부활한 것을 볼 수 있다니！"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "그 문 너머에/석화된 동포들이 잠들어 있습니다…"
		ENDIF
	CASE 1402
		IF !ITEM:주유권
			CALL MESSAGE_WINDOW_D, "장로", "고마워요。젊은이！/나는 비엔 마을의 장로다"
			CALL MESSAGE_WINDOW_D, "장로", "여러분이 메두사를 쓰러뜨려 준 덕분에/이 도시도 옛날과 같게 움직이기 시작했다！/답례로 이 도시를 자유롭게 이용할 수 있는【주유권】을 주지"
			CALL MESSAGE_WINDOW_D, "", "＞주유권을 손에 넣었다"
			PRINTW 
			ITEM:주유권 = 1
			CALL MESSAGE_WINDOW_D, "장로", "이것으로 대마궁 어디에나 갈 수 있어/마음대로지만……/아무래도 아직 움직이기 시작한 바로 직후라……/원하는 곳에 갈 수 있으려면 시간이 걸릴 것 같군"
			CALL MESSAGE_WINDOW_D, "장로", "마카가 있으면 기능 회복이 빨라질 테지만…/그러니 그 주유권을 사용하는 것은 조금 기다려 줘"
		ELSE
			IF !STRFLAG_D("마주르카가능")
				CALL MESSAGE_WINDOW_D, "장로", "3000마카 정도 있으면、/마주르카의 회랑까지 갈 수는 있지만…"
				CALL INPUT_YN_D("지불한다", "지불하지 않는다")
				IF RESULT == 0
					IF MONEY:1 < 3000
						CALL MESSAGE_WINDOW_D, "", "＞그러나 마카가 부족했다"
					ELSE
						CALL MESSAGE_WINDOW_D, "장로", "오오、괜찮겠습니까？/이것으로 이 도시도 살아날 겁니다！"
						CALLF STRFLAG_D("마주르카가능",1)
						MONEY:1 -= 3000
					ENDIF
				ELSE
					CALL MESSAGE_WINDOW_D, "장로", "아무튼 잠깐 기다려 주세요/조만간 복구하겠지요"
				ENDIF
			ELSEIF !STRFLAG_D("안피니가능")
				CALL MESSAGE_WINDOW_D, "장로", "10000마카 정도 있으면、/안피니 회랑까지 갈 수야 있겠지만…"
				CALL INPUT_YN_D("지불한다", "지불하지 않는다")
				IF RESULT == 0
					IF MONEY:1 < 10000
						CALL MESSAGE_WINDOW_D, "", "＞그러나 마카가 부족했다"
					ELSE
						CALL MESSAGE_WINDOW_D, "장로", "오오、괜찮겠습니까？/이것으로 이 도시도 살아날 겁니다！"
						CALLF STRFLAG_D("안피니가능",1)
						MONEY:1 -= 10000
					ENDIF
				ELSE
					CALL MESSAGE_WINDOW_D, "장로", "아무튼 잠깐 기다려 주세요/조만간 복구하겠지요"
				ENDIF
			ELSE
				CALL MESSAGE_WINDOW_D, "마계인", "천공의 마을 비엔、마음껏 사용해 주십시오"
			ENDIF
		ENDIF
	CASE 1403
		CALL MESSAGE_WINDOW_D, "최면술사", "이런、젊은이。내 힘이 필요한건가？"
		CALL INPUT_SELECT_D, @"[0] 네/[1] 아니오/%\@ STRFLAG_D("부적정보") && !STRFLAG_D("부적완성") ? [2] 마력봉인구에 대해 질문한다#\@%"
		IF RESULT == 0
			CALL MESSAGE_WINDOW_D, "최면술사", "당신은 점점 졸려진다～/졸린다～/졸려～ 졸 ～ 려"
			CALL MESSAGE_WINDOW_D, "", "＞의식이 멀어져 간다……"
			CALL SHOW_PICTURE, "EMPTY"
			CALL DUNGEON_WORP_ID, 0, 999, 1
		ELSEIF RESULT == 1
			CALL MESSAGE_WINDOW_D, "최면술사", "그런가/나는 언제라도 여기에 있으니/힘이 필요하면 언제라도 와도 좋다"
			PRINTW 「」
		ELSEIF RESULT == 2
			IF STRFLAG_D("최면술사협력")
				IF FINDCHARA_B([[キャラ:헬]]) > 0 || FINDCHARA_B([[キャラ:펜리르]]) > 0
					IF 함락(RESULT:1)
						IF NO:(RESULT:1) == [[キャラ:헬]]
							CALL MESSAGE_WINDOW_D, "최면술사", "흠、헬을 데려 온 건가/아무래도 로키를 쓰러뜨릴 때 도움을 줬나보군？"
							CALL MESSAGE_WINDOW_D, "헬", "뭐…/저런 부모 조금 고생하는 편이 좋아요/그 녀석 탓에 내가 얼마나 고생을 했는지…/아아、정말 나는 불행해…！"
							CALL MESSAGE_WINDOW_D, "최면술사", "음、이의는 없네、시작한다"
							CALL MESSAGE_WINDOW_D, "최면술사", "당신은 점점 졸려진다～/졸린다～/졸려～ 졸 ～ 려"
							CALL MESSAGE_WINDOW_D, "", "＞헬이 잠듬과 동시에/＞헬로부터 뭔가 검은 안개가 나오더니/＞안개는 부적에 흡수 되었다…"
							CALL MESSAGE_WINDOW_D, "최면술사", "좋아、다 됐다"
							CALL MESSAGE_WINDOW_D, "헬", "응、후아아。어、벌써 끝났어？/뭐야… 꽤나 곤란한 것이라 생각했었는데…/이래서야 별 거 아니잖아"

						ELSE
							CALL MESSAGE_WINDOW_D, "최면술사", "흠、펜리르을 데리고 왔는가/아무래도 로키를 쓰러뜨릴 때 도움을 줬나보군？"
							CALL MESSAGE_WINDOW_D, "펜리르", "아우웅、저 녀석、아버지만 아니었으면 날려 버렸을텐데/주인님이 죽이는 걸 싫어하시는 바람에！"
							CALL MESSAGE_WINDOW_D, "최면술사", "음、이의는 없네、시작한다"
							CALL MESSAGE_WINDOW_D, "최면술사", "당신은 점점 졸려진다～/졸린다～/졸려～ 졸 ～ 려"
							CALL MESSAGE_WINDOW_D, "", "＞펜리르이 잠이 들자…/＞그리고 펜리르에서 어쩐지 검은 안개가 나오더니/＞안개는 부적에 흡수 되었다…"
							CALL MESSAGE_WINDOW_D, "최면술사", "좋아、다 됐다"
							CALL MESSAGE_WINDOW_D, "펜리르", "뭐야、벌써인가/이 정도로 간단한 일 이었다니！/이 일이 주인님이/아버지를 물리칠 때 도움이 된다면 대만족이다"
						ENDIF
						CALL MESSAGE_WINDOW_D, "최면술사", "뭐、어쨌든 이걸로 로키의 마력을 봉할 수가 있다/고는 해도 완전하지는 않지만/꽤 약하게는 할 수 있을거야"
						CALL MESSAGE_WINDOW_D, "", "＞완성된【롤의 부적】을 손에 넣었다！"
						CALLF STRFLAG_D("부적완성", 1)
					ELSE
						CALL MESSAGE_WINDOW_D, "최면술사", @"흠…%\@NO:(RESULT:1) == [[キャラ:헬]]?헬#펜리르\@%은 없어보이는군…/자네에겐 심복이 없는것 같구려/이것으로는 부적을 만들 수 없네"
					ENDIF
				ELSE
					CALL MESSAGE_WINDOW_D, "최면술사", "좋아/헬이나 펜리르/어느 쪽이던 데려오지 않으면 부적은 완성되지 않아"
				ENDIF
			ELSEIF !STRFLAG_D("최면술사주문", 1)
				CALL MESSAGE_WINDOW_D, "최면술사", "호오【롤의 부적】을 가지고 있잖나！/그것은 일찍이 대마도사 롤이 만든 물건/로키의 마법을 봉하지"
				CALL MESSAGE_WINDOW_D, "최면술사", "하지만 보니까…미완성이로군/완정시키는 방법은 알지만……흠……/그렇지 자네는 노예상인이기도 하다는 이야기가 있던데/노예와 교환해 부적의 완성법을 가르쳐 주는 걸로 하지"
				LOCAL:2 = RAND:5 + 109
				CALLF STRFLAG_NUM_D("최면술사(가슴)", "=", , LOCAL:2)
				WHILE 1
					LOCAL:3 = 10 + RAND:27
					SIF LOCAL:3 == 18
						CONTINUE
					SIF LOCAL:3 == 19
						CONTINUE
					SIF LOCAL:3 == 29
						CONTINUE
					SIF LOCAL:3 == 32
						CONTINUE
					SIF LOCAL:3 == 34
						CONTINUE
					BREAK
				WEND
				CALLF STRFLAG_NUM_D("최면술사(성격)", "=", , LOCAL:3)
				LOCAL:4 = RAND:11 + 1
				CALLF STRFLAG_NUM_D("최면술사(종족)", "=", , LOCAL:4)
				CALL MESSAGE_WINDOW_D, "최면술사", @"내가 여자 취향이 좀 까다로워/우선 가슴은 %\@LOCAL:2 == 113 ? 적당한 크기#%TALENTNAME:(LOCAL:2)%\@%에/%TALENTNAME:(LOCAL:3)% 라는 느낌의 아가씨로/종족은 %STR:(LOCAL:4)%로 해서 이것만은 절대로 양보할 수 없네"
				CALL MESSAGE_WINDOW_D, "최면술사", "좋아/노예를 데려오면 부적을 만드는 방법을 가르쳐주겠어"
			ELSE
				CALL MESSAGE_WINDOW_D, "최면술사", @"그런데 가슴이 %\@STRFLAG_NUM_D("최면술사(가슴)") == 113 ? 적당한 크기#%TALENTNAME:STRFLAG_NUM_D("최면술사(가슴)")%\@%에 %TALENTNAME:STRFLAG_NUM_D("최면술사(성격)")% 로、%STR:STRFLAG_NUM_D("최면술사(종족)")% 라면야…"
				LOCALS = 
				FOR LOCAL, 1, 7
					LOCAL:LOCAL = 9
					SIF POS(LOCAL) == -1
						CONTINUE
					SIF CFLAG:POS(LOCAL):매각가능 == 0
						CONTINUE
					SIF TALENT:POS(LOCAL):남자
						CONTINUE
					SIF POS(LOCAL) == MASTER
						CONTINUE
					SIF CFLAG:POS(LOCAL):매각불가플래그
						CONTINUE
					IF STRFLAG_NUM_D("최면술사(가슴)") == 113
						SIF TALENT:POS(LOCAL):절벽 || TALENT:POS(LOCAL):거유 || TALENT:POS(LOCAL):폭유 || TALENT:POS(LOCAL):마유
							CONTINUE
					ELSE
						SIF TALENT:POS(LOCAL):STRFLAG_NUM_D("최면술사(가슴)") == 0
							CONTINUE
					ENDIF
					SIF TALENT:POS(LOCAL):STRFLAG_NUM_D("최면술사(성격)") == 0
						CONTINUE
					SIF ABL:POS(LOCAL):종족 != STRFLAG_NUM_D("최면술사(종족)")
						CONTINUE
					LOCALS += @"[{LOCAL}] %CALLNAME:POS(LOCAL)%/"
				NEXT
				IF LOCALS != ""
					$SAIMIN_CHOICE
					CALL MESSAGE_WINDOW_D, "", "＞건내줄 노예를 선택해 주세요"
					LOCALS += "[9] 그만둔다"
					CALL INPUT_SELECT_D, LOCALS
					IF RESULT == 9
						CALL MESSAGE_WINDOW_D, "최면술사", "허면/노예를 주지 않는건가？/말해 두지만 나는 노예를 줄 때까지 협력할 생각이 없어"
					ELSE
						LOCAL = POS(RESULT)
						CALL MESSAGE_WINDOW_D, "최면술사", @"흠、%CALLNAME:LOCAL%(으)로 좋은가？"
						CALL INPUT_YN_D
						SIF RESULT == 1
							GOTO SAIMIN_CHOICE
						CALL 캐릭터삭제, LOCAL
						CALL MESSAGE_WINDOW_D, "최면술사", "그러면 확실히 받았네/그러면、협력해볼까/이 부적은 정확히 말하자면 로키 본인의 마력이 /충분하지 않아서 그런거니까、로키의 힘을 빌리면……"
						CALL MESSAGE_WINDOW_D, "최면술사", "이런、그렇게 무서운 얼굴을 하진말게/물론 로키를 쓰러뜨리기 위해서、/로키의 힘을 빌릴 수야 없을 테니"
						CALL MESSAGE_WINDOW_D, "최면술사", "그래서 로키 자식들의 힘을 빌리는 거네/자네가 심복으로 헬이나 펜리르 어느쪽을 여기에 데려오고/그들이 진심으로 자에게게 협력할 마음이 있다면 부적을 완성시켜 주겠네"
						CALLF STRFLAG_D("최면술사협력", 1)
					ENDIF
				ELSE
					CALL MESSAGE_WINDOW_D, "최면술사", "없구만/이 정도가 자네를 도와줄 수 있는 부분이라네"
				ENDIF
			ENDIF
		ENDIF
	;------------------------------
	;マズルカの回廊
	;------------------------------
	CASE 1800
		IF STRFLAG_D("헤카테격파")
			CALL MESSAGE_WINDOW_D, "마계인", "잠깐만、당신은 새로운 마주르카의 회랑의 지배자로군요"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "이 마주르카의 회랑을 다스리는 것은 헤카테입니다/위대한 마술의 달인이며 달을 관장하는 악마입니다"
		ENDIF
	CASE 1801
		CALL MESSAGE_WINDOW_D, "마계인", "마주르카의 회랑은 발할라의 회랑과 불꽃의 부해와 접해 있습니다/여기는 넓고 기니까 준비를 제대로 하세요！"
	CASE 1900
		CALL MESSAGE_WINDOW_D, "마계인", @"세상에는 달이 찬 정도에 따라、/위력이나 효과가 달라지는 마법이나 특기가 있는데/그리고 헤카테의 비의는 만월일 때 강대한 위력을 발휘한다/헤카테와 %\@STRFLAG_D("헤카테격파")?#\@% 싸운다면 조심해"
	CASE 2000
		CALL MESSAGE_WINDOW_D, "마계인", "【라토스의 상】은 시드 이빨 ３개의 무게를 갖고 있다는 말을 들었다만"
	CASE 2100
		CALL MESSAGE_WINDOW_D, "마계인", "지난번에 이상한 남자를 보았어/헤카테가 이러니 저러니 말하면서/알몸으로 돌아다니더라고"
	CASE 2101
		IF STRFLAG_D("헤카테격파")
			CALL MESSAGE_WINDOW_D, "마계인", "【은 릴리프】가 있다면、헤카테의 방을 자유로이 다닐 수 있데！/에、이제 와서라도？"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "헤카테의 방에는 헤카테가 허락하지 않으면 들여놓지 않는데/다만、소문에 의하면 어떤 것이 있으면 허가없이 언제든지 가능하다던가"
		ENDIF
	CASE 2200
		CALL MESSAGE_WINDOW_D, "마계인", "헤카테는 【라토스의 상】앞에서는 모습을 드러낸다는 것 같아"
	CASE 2300
		IF STRFLAG_D("헤카테격파")
			CALL MESSAGE_WINDOW_D, "마계인", "헤카테의 지배도 끝났다……/소중한 릴리프를 훔친 것도/이것의 예고였는지도 모른다네요"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "【은릴리프】가 도둑맞다니/헤카테의 중요한 물건인 것 같은데/그러면 엄청나게 분노할거야"
		ENDIF
	CASE 2400
		IF STRFLAG_D("헤카테격파")
			CALL MESSAGE_WINDOW_D, "마계인", "헤카테가 쓰러졌으니、릴리프를 훔친 바보녀석은/지금쯤 안심하고 있지 않을까"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "설마、릴리프를 훔친 것은 가이아가 아니겠지？/생명이 노려질테니 그런걸 살 녀석은 없을테고/아무리 그 녀석이라도 그런 바보 짓을 하진 않겠지？"
		ENDIF
	CASE 2500
		CALL MESSAGE_WINDOW_D, "마계인", "가이아라는 남자는 어두운 곳을 좋아했어"
	CASE 2501
		IF STRFLAG_D("헤카테격파")
			CALL MESSAGE_WINDOW_D, "마계인", "홀리의 항아리라는 것이、불꽃 속에 있냐고 물어보더군"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "헤카테는 모습을 숨길 수 있다/그리고 모습을 감추고 있는 한/검에 부상당할 일은 없는 것 같다"
		ENDIF
	CASE 2600
		CALL MESSAGE_WINDOW_D, "마계인", "【라토스의상】을 대에서 잡으면 함정에 걸린다고 하는데/아무래도 상을 싣고 있는 받침대가 가볍게 되면 안되는 것 같다"
	CASE 2700
		CALL MESSAGE_WINDOW_D, "마계인", "쥬얼리 샵에서 찾는 물건은 발할라의 회랑에 있는 것 같아요"
	CASE 2701
		CALL MESSAGE_WINDOW_D, "마계인", "불꽃의 부해에서 병에 담긴 작은 오니를 봤어"
	CASE 2702
		CALL MESSAGE_WINDOW_D, "마계인", "【라토스의 상】의 무게 알아？"
	CASE 2703
		CALL MESSAGE_WINDOW_D, "마계인", "뭐야！ 젊은이잖아、인간이 여기까지 오다니/라고 생각했더만 네 뒤로 마왕의 모습이 보이는구나"
	CASE 2704
		CALL MESSAGE_WINDOW_D, "마계인", "７층에 있는 아저씨가 라토스의 비밀을 알고 있을거야"
	CASE 2705
		IF STRFLAG_D("헤카테격파")
			CALL MESSAGE_WINDOW_D, "마계인", "헤카테가 쓰러졌다고 하는구나/새로운 지배자는 어떤 느낌일까"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "보름달이 가까워짐에 따라 헤카테는 점점 잔인하게 될거야/반대로 초생달이 가까워지면 점점 얌전하게 되어가지만/초생달이 뜨면 헤카테는 모습을 감춰버린다지요"
		ENDIF
	CASE 2706
		IF STRFLAG_D("헤카테격파")
			CALL MESSAGE_WINDOW_D, "마계인", "헤카테의 힘을 신경도 안쓸 줄이야…/도대체 그 힘은 어디서 나오는거야？"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "헤카테의 마력은 만월의 밤에 최고조에 이르는데/만월의 밤만은 절대로 피하지 않으면 안 됩니다"
		ENDIF
	CASE 2800
		CALL MESSAGE_WINDOW_D, "마계인", "불꽃의 부해는 말대로 불길에 휩싸여 있는 곳이지요/움직이는 것만으로도 체력을 소모해 버려요"
	CASE 2900
		IF STRFLAG_D("헤카테격파")
			CALL MESSAGE_WINDOW_D, "마계인", "무적의 헤카테를 박살내다니、당신은 무적이군요！"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "헤카테는 달빛으로 파워업해서 무적인거야"
		ENDIF
	CASE 3000
		IF STRFLAG_D("헤카테격파")
			CALL MESSAGE_WINDOW_D, "마계인", "헤카테를 쓰러뜨리다니……/언젠가 그런 일이 찾아오길 계속 기다리고 있었지만……/설마 정말로 인간이……"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "여기가 마주르카의 회랑의 종점/그 앞에 헤카테가 있지/헤카테를 쓰러뜨리고자 한다면/목숨이 아까우니 돌아갑시다"
		ENDIF
	;------------------------------
	;炎の腐海
	;------------------------------
	CASE 3400
		IF STRFLAG_D("세트격파")
			CALL MESSAGE_WINDOW_D, "마계인", "설마 세트의 봉인을 풀고 쓰러뜨리다니/믿을 수 없습니다……"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "이 불꽃의부해에서는 지배자가 없습니다/그 대신에 세트가 봉인되어 있습니다"
		ENDIF
	CASE 3600
		IF STRFLAG_D("세트봉인해제")
			CALL MESSAGE_WINDOW_D, "마계인", "봉인을 풀어 버릴 줄이야……/으음……자네야말로 이 대마궁의 진정한 지배자라고해야 할지도 모르겠군……"
		ELSE
			CALL MESSAGE_WINDOW_D, "마계인", "동쪽 외각에 세트의 봉인이 있는데…/하지만 이 마궁의 지배자들이 인정하지 않는 한 봉인은 녹지 않아…"
		ENDIF
	CASE 3700
		IF !ARG
			IF STRFLAG_D("세트격파")
				CALL MESSAGE_WINDOW_D, "악마", "……설마 정말로 인간이/안피니 궁전에 가도록해라/루시퍼님이 기다리고 있다"
			ELSE
				CALL MESSAGE_WINDOW_D, "악마", "루시퍼님의 전언이다/됐나？ 잘 들어라"
				CALL MESSAGE_WINDOW_D, "악마", "「세트의 봉인을 푼 것을 확인했다」/「만약、네가 자신의 힘을 보여줄 생각이라면 세트를 쓰러뜨려 보아라」"
				CALL MESSAGE_WINDOW_D, "악마", "확실히 전했다"
			ENDIF
		ENDIF
	CASE 3701
		CALL MESSAGE_WINDOW_D, "노인", "자네、뭔가 큰 일을 저지르려고 하나 본데/나의 낡은 지식이 도움이 될지도 모르겠군/어떤 고문서의 한 구절이야"
		CALL MESSAGE_WINDOW_D, "노인", "「하얀 용의 혼、부해의…」/응? 어디다 버렸냐고？/허허허 역시나 잊어버렸다네"
	CASE 3800
		CALL MESSAGE_WINDOW_D, "마계인", "세트는 사막과 이방의 신이다/그러나 그것만이 아니라 뭔가가 있는 것 같다"
	CASE 3900
		CALL MESSAGE_WINDOW_D, "마계인", "이 땅에 봉인되어 있는 세트도 불완전한 힘 밖에 가지고 있지 않는 것 같다/어쩌면 세트가 진정한 힘을 되찾으면/루시퍼님과도 필적할지도……"

;４： 	プルシキを倒したならば　여신像の部屋に行くことだ
;５： 	<プルシキ討伐後>
;え！プルシキを倒しちゃったの？
ENDSELECT
;=======
;罠
;=======
@TILE_MARK_COMMON_5_5, ARG, ARG:1, ARG:2
SELECTCASE ARG / 10
	;落とし穴(P)
	CASE 1
		RESULTS = \@GET_FLOOR_ANALYZE_T(ARG:1, ARG:2) == 2 ?　#□\@
	CASEELSE
		RESULTS = \@GET_FLOOR_ANALYZE_T(ARG:1, ARG:2) == 2 ?덫#□\@
ENDSELECT
@TRAP_5
SELECTCASE DA:(FLAG:현X):(FLAG:현Y) / 10
	;落とし穴
	CASE 1
		SELECTCASE FLAG:현M
			CASE 13
				CALL SHOW_FLOOR
				TWAIT 1000, 1
				CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X,  FLAG:현Y
			CASE 14
				CALL SHOW_FLOOR
				TWAIT 1000, 1
				CALL DUNGEON_WORP_ID, 13, 15, 0
			CASE 15
				CALL SHOW_FLOOR
				TWAIT 1000, 1
				CALL DUNGEON_WORP_ID, 14, 15, 0
			CASEELSE
				PRINTL ＞함정이다！
				TWAIT 1000, 1
				CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X,  FLAG:현Y
			ENDSELECT
	;HP데미지(H)
	CASE 2
		CALL DUNGEON_TRAP_HP, 10 + RAND:11
	;MP데미지(M)
	CASE 3
		CALL DUNGEON_TRAP_MP, 10 + RAND:11
ENDSELECT
RETURN 1
@TILE_MARK_COMMON_5_6, ARG, ARG:1, ARG:2
SELECTCASE ARG % 100
	CASE 6
		IF FLAG:현M == 25
			RESULTS = 강
		ELSE
			RESULTS = 승
		ENDIF
	CASE 16
		RESULTS = →
	CASE 26
		RESULTS = ↓
	CASE 96
		RESULTS = \@GET_FLOOR_ANALYZE_T(ARG:1, ARG:2) == 2 ?Ｗ#□\@
ENDSELECT
@TILE_MARK_COMMON_5_7, ARG, ARG:1, ARG:2
SELECTCASE ARG % 100
	CASE 7
		RESULTS = 강
	CASE 17
		RESULTS = ←
	CASE 27
		RESULTS = ↑
	CASE 97
		RESULTS = □
ENDSELECT
;=======
;ワープゾーン
;=======
@WORP_5
#LOCALSIZE 1
LOCAL = DA:(FLAG:현X):(FLAG:현Y)
;w ワープゾーン
IF LOCAL == 96
	CALL MESSAGE_WINDOW_D, "", "＞워프 존이다！"
	CALL SHOW_PICTURE, "EMPTY"
	;ビエン地下
	IF FLAG:현M == 12
		CALL DUNGEON_WORP_ID, 12, 12001, 1
	;炎の腐海
	ELSEIF FLAG:현M == 35
		CALL DUNGEON_WORP_ID, 36, 96, 1
	ELSEIF FLAG:현M == 36
		CALL DUNGEON_WORP_ID, 35, 96, 1
	ENDIF
	RETURN 0
ENDIF
SELECTCASE LOCAL % 100
	CASE 6
		;ダイダロス &  ヴァルハラ & マズルカ腐海側 & 腐海マズルカ側
		IF FLAG:현M < 11 || RANGE(FLAG:현M, 27, 35)
			;マズルカ→腐海
			IF FLAG:현M == 32
				CALL DUNGEON_UPSTAIRS_ID, FLAG:현M - 2, LOCAL - 1999
			ELSE
				CALL DUNGEON_UPSTAIRS_ID, FLAG:현M - 1, LOCAL - 999
			ENDIF
		;マズルカ8F
		ELSEIF FLAG:현M == 25
			CALL DUNGEON_DOWNSTAIRS_ID, FLAG:현M + 1, LOCAL + 1000
		;マズルカ7F
		ELSEIF FLAG:현M == 26
			CALL DUNGEON_UPSTAIRS_ID, FLAG:현M - 1, LOCAL - 1000
		ELSE
			CALL DUNGEON_UPSTAIRS_ID, FLAG:현M + 1, LOCAL + 1001
		ENDIF
	CASE 7
		;ダイダロス & ヴァルハラ &マズルカ腐海側 & 腐海マズルカ側
		IF FLAG:현M <11 || RANGE(FLAG:현M, 26, 35)
			;腐海→マズルカ
			IF FLAG:현M == 30
				CALL DUNGEON_DOWNSTAIRS_ID, FLAG:현M + 2, LOCAL + 1999
			ELSE
				CALL DUNGEON_DOWNSTAIRS_ID, FLAG:현M + 1, LOCAL + 999
			ENDIF
		ELSE
			CALL DUNGEON_DOWNSTAIRS_ID, FLAG:현M - 1, LOCAL - 1001
		ENDIF
	CASE 16
		;ダイダロス→ヴァルハラ
		IF FLAG:현M == 7
			CALL DUNGEON_WORP_ID, FLAG:현M+2, LOCAL+2001, 1
		;腐海→アンフィニ
		ELSEIF FLAG:현M == 39
			CALL DUNGEON_WORP_ID, FLAG:현M+3, LOCAL+3001, 1
		;ヴァルハラ→マズルカ
		ELSEIF FLAG:현M == 9
			CALL DUNGEON_WORP_ID, 18, 18017, 1
		ELSE
			CALL DUNGEON_WORP_ID, FLAG:현M+1, LOCAL+1001, 1
		ENDIF
		FLAG:현X += 1
		SIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 2
			FLAG:현X += 1
	CASE 17
		;ヴァルハラ→ダイダロス　
		IF FLAG:현M == 9
			CALL DUNGEON_WORP_ID, FLAG:현M-2, LOCAL-2001, 1
		;腐海→アンフィニ
		ELSEIF FLAG:현M == 42
			CALL DUNGEON_WORP_ID, FLAG:현M-3, LOCAL-3001, 1
		;マズルカ→ヴァルハラ
		ELSEIF FLAG:현M == 18
			CALL DUNGEON_WORP_ID, 9, 9016, 1
		ELSE
			CALL DUNGEON_WORP_ID, FLAG:현M-1, LOCAL-1001, 1
		ENDIF
		FLAG:현X -= 1
		SIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 2
			FLAG:현X -= 1
	CASE 26
		CALL DUNGEON_WORP_ID, FLAG:현M+2, LOCAL+2001, 1
		FLAG:현Y += 1
		SIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 2
			FLAG:현Y += 1
	CASE 27
		CALL DUNGEON_WORP_ID, FLAG:현M-2, LOCAL-2001, 1
		FLAG:현Y -= 1
		SIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 2
			FLAG:현Y -= 1
ENDSELECT
CALL ONE_WAY(902, 912, 922, 932, 942, 952, 962, 972)
@GET_DUNGEON_LV_5
RETURN 21, 19, 25, 30
@TILE_MARK_COMMON_5_D, ARG, ARG:1, ARG:2
IF FLAG:라이트마 || (EQUIP:MASTER:다크스캐너 && NUM_SUMMONER())
	SELECTCASE -ARG/10
		CASE 700, 2501, 6000, 6001
				RESULTS = ！
		CASE 3800
			IF STRFLAG_D("세트격파")
				RESULTS = □
			ELSE
				RESULTS = ！
			ENDIF
		CASE 2500
			RESULTS = \@GET_FLOOR_ANALYZE_T(ARG:1, ARG:2) == 2 ?　#□\@
		CASEELSE
			RESULTS = □
	ENDSELECT
ELSE
	SETCOLOR 0x202020
	SELECTCASE -ARG/10
		CASE 2500
			RESULTS = \@GET_FLOOR_ANALYZE_T(ARG:1, ARG:2) == 2 ?　#□\@
		CASE 2501, 6000, 6001
			RESULTS = ！
		CASE 3800
			IF STRFLAG_D("세트격파")
				RESULTS = □
			ELSE
				RESULTS = ！
			ENDIF
		CASEELSE
			RESULTS = □
	ENDSELECT
ENDIF
@DARK_5, ARG
#LOCALSIZE 2
;명계用ワープ
IF FLAG:현M == 60
	;処理を軽くするためにMAKE_FLOORを通さないようにして飛ばす
	IF DA:(FLAG:현X):(FLAG:현Y) % 100 == -61
		CALL MESSAGE_WINDOW_D, "", "＞워프 존이다！"
		CALL SHOW_PICTURE, "EMPTY"
		LOCAL = 던전플래그:5:(99 + DA:(FLAG:현X):(FLAG:현Y) / 100)
		FLAG:현X = LOCAL % 100
		FLAG:현Y = LOCAL / 100
		CALL AUTOMAP
		CALL ONE_WAY(902, 912, 922, 932, 942, 952, 962, 972)
	ENDIF
ENDIF
SELECTCASE -DA:(FLAG:현X):(FLAG:현Y)/10
	CASE 700
		SIF ARG || (!FLAG:라이트마 && (!EQUIP:MASTER:다크스캐너 || !NUM_SUMMONER()))
			RETURN 0
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞오래된 무기와 방어구가 널려있다"
		IF STRFLAG_D("갈의뢰")
			CALL MESSAGE_WINDOW_D, "", "………………/…………/……"
			CALL MESSAGE_WINDOW_D, "", "＞갈의 방패를 손에 넣었다！"
			;CALLF STRFLAG_D("盾ゲット",1)
			ITEM:갈의방패 = 1
			DA:(FLAG:현X):(FLAG:현Y) = -1
		ENDIF
		RETURN 1
	;落とし穴
	CASE 2500
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞함정이다！", , "버튼을 이용한다/NOWAIT"
		TWAIT 1000, 1
		CALL DUNGEON_WORP, FLAG:현M+1, 35, 26
		RETURN 1
	;가이아
	CASE 2501
		CALL SHOW_PICTURE, "D"
		IF !STRFLAG_D("가이아초회", 1)
			CALL MESSAGE_WINDOW_D, "목소리", "허?!/헤카ー…테、그럼、저기 있는 건…/나、나는 가이아다/너는 누구냐！？"
			CALL INPUT_YN_D("이름을 댄다", "조용히 노려본다")
			IF RESULT == 0
				CALL MESSAGE_WINDOW_D, "가이아", "그런가……네가 소문의…… 과연……/그렇다면 네가 사줬으면 하는게 있다"
			ELSE
				CALL MESSAGE_WINDOW_D, "가이아", "히익……/아、아아 그런가……/너는 최근 소란을 피우고 있는 인간이로군/그、그러면 꼭 사주길 바라는게 있다"
			ENDIF
			CALL MESSAGE_WINDOW_D, "가이아", "너는 헤카테를 쓰러뜨릴 생각인가？/그렇다면 반드시 이【은 릴리프】가 도움이 될 것이다/아니、이걸 목적으로 여기 왔겠지！"
			CALL MESSAGE_WINDOW_D, "가이아", "이걸 손에 넣는데 고생했다구/네가 나에게 주는 것에 따라서는 양보하지 않을 것도 아닌데 말야？/응？"
		ENDIF
		CALL MESSAGE_WINDOW_D, "가이아", "자、무엇을 줄텐가？"
		LOCAL:1 = LINECOUNT
		$GAIA
		CLEARLINE LINECOUNT - LOCAL:1
		CALL INPUT_SELECT_D("[0] ￥을 제공한다/[1] 마카를 제공한다/[2] 여자를 제공한다/[3] 죽여서 뺏는다/[9] 아무것도 주지 않는다")
		SELECTCASE RESULT
			CASE 0
				CALL MESSAGE_WINDOW_D, "가이아", "￥？/뭐야 그건？/……종이쪼가리잖아"
				CALL MESSAGE_WINDOW_D, "가이아", "그런 건 받아봐야 쓸데없다/다른 걸 줘"
				GOTO GAIA
			CASE 1
				CALL MESSAGE_WINDOW_D, "가이아", "그래、역시 마카지…/그러면、가진 돈의 절반을 주면 되겠군な"
				CALL INPUT_YN_D
				IF RESULT == 0
					IF MONEY:1 < 10000
						CALL MESSAGE_WINDOW_D, "가이아", "……아、너、그 정도 밖에 없는 건가/그 정도로는 양보할 수 없어！/좀 더 마카를 벌어와！"
					ELSE
						CALL MESSAGE_WINDOW_D, "가이아", "헤에、여유구나/그렇다면 좀 더 산적 목소리로！/가진 돈 전부 어때？"
						CALL INPUT_YN_D
						IF RESULT == 0
							CALL MESSAGE_WINDOW_D, "가이아", "그 정도면 팔아주지！/반품은 받아주지 않아"
							CALL MESSAGE_WINDOW_D, "", "＞가이아는【은릴리프】를 건네주며 자취를 감췄다/＞【은 릴리프】를 손에 넣었다"
							MONEY:1 = 0
							ITEM:은릴리프 += 1
							DA:(FLAG:현X):(FLAG:현Y) = 1
						ELSE
							CALL MESSAGE_WINDOW_D, "가이아", "뭐、뭐야、뻔뻔하잖아"
						ENDIF
					ENDIF
				ELSE
					CALL MESSAGE_WINDOW_D, "가이아", "뭐라고！/난 이걸 필사적으로 손에 넣었다고！/좀 더 마카를 벌어와！"
				ENDIF
			CASE 2
				IF !STRFLAG_D("가이아주문초회", 1)
					CALL MESSAGE_WINDOW_D, "가이아", "그렇구나……/여자라도 좋지만、누구든 되는 건 아니야"
					CALL MESSAGE_WINDOW_D, "가이아", "【얌전한】【솔직함】【아픔에 약한】에、거기에【헌신적】도다/물론 제대로 팔릴만한 물건이어야 하니 /길들여지지 않았으면 곤란하겠지……/아무튼 이 정도로 봐주도록 하지"
				ELSE
					CALL MESSAGE_WINDOW_D, "가이아", "【얌전한】【솔직함】【아픔에약한】【헌신적】인 여자다/잊어버리지 마？"
				ENDIF
				VARSET A
				FOR LOCAL, 0, CHARANUM
					;主人はダメ
					SIF LOCAL == MASTER
						CONTINUE
					SIF !CFLAG:LOCAL:PT플래그
						CONTINUE
					SIF CFLAG:LOCAL:PT플래그 == 1 && ABL:LOCAL:종족 == 0
						CONTINUE
					SIF IS_MALE(LOCAL)
						CONTINUE
					SIF !CFLAG:LOCAL:매각가능
						CONTINUE
					SIF CFLAG:LOCAL:매각불가능
						CONTINUE
					SIF CFLAG:LOCAL:이자리에없는플래그
						CONTINUE
					SIF !TALENT:LOCAL:얌전함
						CONTINUE
					SIF !TALENT:LOCAL:솔직함
						CONTINUE
					SIF !TALENT:LOCAL:헌신적
						CONTINUE
					SIF !TALENT:LOCAL:아픔에약함
						CONTINUE
					A:LOCAL = 1
				NEXT
				IF MATCH(A, 1)
					CALL INPUT_CHARA_LIST("가이아에게 줄 노예를 선택해주십시오", "DUNGEON5_GAIA")
					IF RESULT == 1000
						CALL MESSAGE_WINDOW_D, "가이아", "뭐야。아직도 준비되지 않는거야？/역시 무리라면、돈으로도 괜찮은데？"
					ELSE
						LOCAL = RESULT
						CALL MESSAGE_WINDOW_D, "가이아", "호호오…이건…꽤나、크흐흐/좋아、계약성립이다！/이봐、가져가！"
						CALL MESSAGE_WINDOW_D, "가이아", "＞【은 릴리프】를 손에 넣었다"
						CALL MESSAGE_WINDOW_D, "", @"＞%CALLNAME:LOCAL%을(를) 잃었다"
						CALL MESSAGE_WINDOW_D, "가이아", "자… 그럼、조속히 즐겨볼까/그럼！"
						CALL MESSAGE_WINDOW_D, "", "＞그렇게 말하며、가이아는 자취를 감췄다…"
						ITEM:은릴리프 += 1
						DA:(FLAG:현X):(FLAG:현Y) = 1
						CALL 캐릭터삭제(LOCAL)
					ENDIF
				ELSE
					CALL MESSAGE_WINDOW_D, "가이아", "뭐、역시、즉시 준비가 된다면야/무리라면 마카도 좋지만……、/일단 즐거운 일을 기대하고 있지"
				ENDIF
			CASE 3
				CALL MESSAGE_WINDOW_D, "가이아", "뭐、뭘하는 건가？/호、혹시… 그만둬/그만둬"
				CALL MESSAGE_WINDOW_D, "", @"＞가이아는 %CALLNAME:MASTER%의 의도를 알아채고 물러섰다"
				CALL MESSAGE_WINDOW_D, "가이아", "아、알았어。이거면 되는거지？/이봣！"
				CALL MESSAGE_WINDOW_D, "", "＞가이아는【은 릴리프】를 엉뚱한 방향으로 던졌다/＞%마스터가%【은릴리프】에 정신이 팔린 동안/가이아는 도망쳤다……"
				CALL MESSAGE_WINDOW_D, "", @"＞%마스터는%【은 릴리프】를 손에 넣었다/＞하지만【은 릴리프】는 망가져서 삐뚤어져 버렸다…"
				ITEM:은릴리프 += 1
				DA:(FLAG:현X):(FLAG:현Y) = 1
				CALLF STRFLAG_D("릴리프파손", 1)
			CASE 9
				CALL MESSAGE_WINDOW_D, "가이아", "뭐라고……뭐 좋아/바로 이게 필요하다는걸 알게 되겠지/뭐、서두르지 않으면 다른 녀석한테 팔아버릴지도 모르지만"
		ENDSELECT
		RETURN 1
	;세트
	CASE 3800
		IF STRFLAG_D("세트격파")
			RETURN 0
		ELSE
			CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞현실에는 거대한 검은 용이 있었다……"
		CALL MESSAGE_WINDOW_D, "사신 세트", "너는…/심판하는 자…가 아니구나…/설마라곤 해도…발을 디딘 자를…/간과할 수 없다…"
		CALL MESSAGE_WINDOW_D, "", "＞사신 세트가 １체 나타났다！"
			CALL SET_SET
			FLAG:도주불가플래그 = 1
			FLAG:회화불능플래그 = 1
			FLAG:선제기습취소 = 1
			CALL BATTLE_START
			FLAG:도주불가플래그 = 0
			FLAG:회화불능플래그 = 0
			FLAG:선제기습취소 = 0
			DA:(FLAG:현X):(FLAG:현Y) = -1
			CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "사신 세트", "저항하지 마라…/어째서 힘든 길을 가는가…"
		CALL MESSAGE_WINDOW_D, "", "＞사신 세트는 힘이 다했다"
			CALLF STRFLAG_D("세트격파", 1)
			DA:(FLAG:현X):(FLAG:현Y) = 1
			CALL LIFTING_A_BAN([[キャラ:세트]])
			;FLAG:11629 = 1
			RETURN 1
		ENDIF
	CASE 6000
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞빛이 가득 차 흘러 넘친다…/＞여기서 현실세계로 돌아 갈 수 있을 것 같다/＞되돌아갑니까？"
		CALL INPUT_YN_D
		IF RESULT == 0
			FLAG:탈출스킬금지 = 0
			FLAG:COMP사용불능 = 0
			CALL DUNGEON_WORP_ID, 10, 10004, 1
		ENDIF
		RETURN 1
	CASE 6001
		CALL SHOW_PICTURE, "D"
		CALL MESSAGE_WINDOW_D, "", "＞소녀가 누워있다……"
		IF FINDCHARA_B([[キャラ:아케미]]) == 2
			CALL MESSAGE_WINDOW_D, "아케미", "시라사기…！"
			CALL MESSAGE_WINDOW_D, "", "＞아케미는 소녀에게 달려가 안아 일으켰다……/＞아케미의 눈으로부터 눈물이 흘러 넘쳐、소녀에게로 떨어진다……/＞그러자、소녀는 천천히 눈을 떴다……"
			CALL MESSAGE_WINDOW_D, "소녀", "나카지마 군…와 주었군요…"
			CALL MESSAGE_WINDOW_D, "", "＞아케미를 응시한 소녀의 눈에도 순식간에 눈물이 넘치기 시작한다…/＞그리고、두 사람은 강하게 서로를 끌어안았다…"
			CALL MESSAGE_WINDOW_D, "", "＞시라사키 유미코를 구했다…"
		ELSE
			IF FINDCHARA_B([[キャラ:아케미]]) == 1
				CALL MESSAGE_WINDOW_D, "", @"＞이 소녀가 시라사기 유미코인 것 같다/＞유미코는 일어날 기미가 없다……/＞%마스터는% 일단 잠 들어있는 유미코를 데리고、/＞탐색을 계속했다…"
			ELSE
				CALL MESSAGE_WINDOW_D, "", "＞소녀로부터 불가사의한 힘이 느껴진다/＞단지 그 뿐만은 아닌 것 같지만……"
				CALL INPUT_YN_D("데리고 돌아간다", "내버려 둔다")
				IF RESULT == 0
					CALL MESSAGE_WINDOW_D, "", "＞시라사기 유미코를 손에 넣었다"
					CALL ADD_NEW_COMPANION, [[キャラ:유미코]], 200, 1
				ELSE
					CALL MESSAGE_WINDOW_D, "", "＞소녀를 방치하고、계속 나아가기로 했다…"
				ENDIF
			ENDIF
		ENDIF
		CALLF STRFLAG_D("Y코", 1)
		DA:(FLAG:현X):(FLAG:현Y) = -1
		RETURN 1
ENDSELECT
;화염床
SIF RANGE(FLAG:현M, 32, 39)
	CALL FIRE_TILE_5
RETURN 0

@EVENT_NEWMOON_DUNGEON5
;新月時に封印해제실패を해제
CALLF STRFLAG_D("봉인해제실패", -1)

;------------------
;가이아に譲る奴隷を選択
;------------------
@DUNGEON5_GAIA(ARG:0)
SIF A:(ARG:0)
	RETURN 1
RETURN 0
@TRAIN_DUNGEON_5
BASE:ＨＰ = 1
BASE:ＭＰ = 0
CALL MESSAGE_WINDOW_D, "", @"＞네코마타는 녹초가 되었다/＞%마스터는% 노예로서 네코마타를 데리고 돌아가리로 했다/＞마수 네코마타를 입수했다"
CFLAG:전투참가불가능 = 1
@ONE_WAY(ARG, ARG:1, ARG:2, ARG:3, ARG:4, ARG:5, ARG:6, ARG:7)
#LOCALSIZE 2
FOR LOCAL:1, 0, FLAG:최대Y
	FOR LOCAL, 0, FLAG:최대X
		SELECTCASE DA:LOCAL:(LOCAL:1)
			CASE 0
				CONTINUE
			CASE ARG, ARG:1
				DA:LOCAL:(LOCAL:1) = FLAG:현Y > LOCAL:1 ? ARG # ARG:1
			CASE ARG:2, ARG:3
				DA:LOCAL:(LOCAL:1) = FLAG:현X < LOCAL ? ARG:2 # ARG:3
			CASE ARG:4, ARG:5
				DA:LOCAL:(LOCAL:1) = FLAG:현Y < LOCAL:1 ? ARG:4 # ARG:5
			CASE ARG:6, ARG:7
				DA:LOCAL:(LOCAL:1) = FLAG:현X > LOCAL ? ARG:6 # ARG:7
		ENDSELECT
	NEXT
NEXT
;炎の腐海の床데미지
;仕様上、色変えでひっかかるので4歩の一回の頻度にしておく
@FIRE_TILE_5
#LOCALSIZE 2
IF LOCAL:1 ++ == 3
	CLEARLINE 1
	SETBGCOLOR COLOR("red")
	RESETBGCOLOR
	FOR LOCAL, 1, 7
		SIF POS(LOCAL) < 0
			CONTINUE
		SIF GET_STATE(CFLAG:POS(LOCAL):상태이상) == "DYING"
			CONTINUE
		BASE:POS(LOCAL):ＨＰ = MAX(BASE:POS(LOCAL):ＨＰ - RAND(1, 25), 1)
	NEXT
	LOCAL:1 = 0
ENDIF

