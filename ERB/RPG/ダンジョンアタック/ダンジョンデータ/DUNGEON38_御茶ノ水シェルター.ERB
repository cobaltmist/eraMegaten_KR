;=======================================================================
;오차노미즈 쉘터
;=======================================================================
;던전플래그:38:1 突入フラグ
;=======================================================================
;攻略조건
;=======================================================================

@PREREQUISITE_DUNGEON_38
SIF 이벤트플래그:70:1 != 1
	RETURN 0
RETURN 1

;=======================================================================
;던전名
;=======================================================================
@GET_DUNGEON_NAME_38
RESULTS = 오차노미즈 쉘터

;=======================================================================
;플로어名표시
;=======================================================================
@FLOORNAME_38
PRINT 오차노미즈 쉘터
SELECTCASE FLAG:현M
	CASE 0
		PRINTL   １Ｆ
	CASE 1
		PRINTL   Ｂ１Ｆ
	CASE 2
		PRINTL   Ｂ２Ｆ
	CASE 3
		PRINTL   Ｂ３Ｆ
	CASE 4
		PRINTL   Ｂ４Ｆ
	CASE 5
		PRINTL   Ｂ５Ｆ
	CASE 6
		PRINTL   Ｂ６Ｆ
	CASE 7
		PRINTL   Ｂ７Ｆ
	CASE 8
		PRINTL   Ｂ８Ｆ
	CASE 9
		PRINTL   Ｂ９Ｆ
	CASE 10
		PRINTL   Ｂ１０Ｆ
	CASEELSE
		PRINTL
ENDSELECT


;=======================================================================
;特殊タイル표시
;=======================================================================

@TILE_MARK_38_0_4_7
RESULTS = Ｅ


@TILE_MARK_38_4_5_3
RESULTS = □


@TILE_MARK_38_5_3_3
RESULTS = Ｅ


@TILE_MARK_38_7_13_1
RESULTS = Ｅ

@TILE_MARK_38_8_13_1
RESULTS = Ｅ

;=======================================================================
;スタート地点입력
;=======================================================================
@START_DUNGEON_38,ARG
FLAG:현M = 0
FLAG:현X = 4
FLAG:현Y = 1
;CALL AUTOMAP

;=======================================================================
;攻略開始時の이벤트
;=======================================================================
@EVENT_DUNGEON_START_38
IF 던전플래그:38:1 == 0
	CALL MESSAGE_WINDOW_D, "", "＞" + CALLNAME:MASTER + "은 파누엘과 쉘터를 구하기 위해/＞오차노미즈 쉘터로 찾아왔다…"
	CALL MESSAGE_WINDOW_D, "", "＞와보고서야 알았지만、이곳은 무시무시하게 뜨겁다/＞더불어 이곳저곳에 불길이 타오르고 있어 이미 출구도 상실했다/＞약간의 대미지는 각오해야 할까…"
	CALL MESSAGE_WINDOW_D, "파누엘", "당신을 기다리고 있었습니다、사람의 자식이여/나의 이름은 파누엘、대천사 중 하나입니다"
	CALL MESSAGE_WINDOW_D, "파누엘", "나는 지하 9층에 있는 대피소의 주민들을 지키고 있습니다/당신이 쓰러뜨려주셨으면 하는 악마、아임은 그 문을 뚫으려 하고 있답니다/제발 그 악마를 처단해주십시오"
	던전플래그:38:1 = 1
ENDIF

;=======================================================================
;탈출時の이벤트
;=======================================================================
@EVENT_DUNGEON_END_38
CALL MESSAGE_WINDOW_D, "", "＞파누엘에게서 협력 보수 150000엔을 입수했다/＞또한 명성 200 입수했다"
MONEY += 150000
FLAG:명성 += 200
이벤트플래그:70:2 = 2

;=======================================================================
;指定したマスに進入가능か
;=======================================================================
@CAN_ENTER_38,ARG,ARG:1

CALL CAN_ENTER,ARG,ARG:1
RETURN RESULT

;=======================================================================
;플로어데이터
;=======================================================================
@MAKE_FLOOR_38
SELECTCASE FLAG:현M
	CASE 0
	;１階
		FLAG:최대X = 12
		FLAG:최대Y = 12
					;012345678
		CALL MAKE_FLOOR_LINE, 0,"         "
		CALL MAKE_FLOOR_LINE, 1,"   111   "
		CALL MAKE_FLOOR_LINE, 2,"    2    "
		CALL MAKE_FLOOR_LINE, 3,"    1    "
		CALL MAKE_FLOOR_LINE, 4,"  11111  "
		CALL MAKE_FLOOR_LINE, 5,"  111 1  "
		CALL MAKE_FLOOR_LINE, 6,"  2 5    "
		CALL MAKE_FLOOR_LINE, 7,"  1 9    "
		CALL MAKE_FLOOR_LINE, 8,"  1      "
		CALL MAKE_FLOOR_LINE, 9,"  15117  "
		CALL MAKE_FLOOR_LINE,10,"         "
							    ;012345678


	CASE 1
	;地下１階
		FLAG:최대X = 7
		FLAG:최대Y = 7
							   ;0123456
		CALL MAKE_FLOOR_LINE,0,"       "
		CALL MAKE_FLOOR_LINE,1," 11111 "
		CALL MAKE_FLOOR_LINE,2," 11 11 "
		CALL MAKE_FLOOR_LINE,3," 11511 "
		CALL MAKE_FLOOR_LINE,4," 1   1 "
		CALL MAKE_FLOOR_LINE,5," 7   6 "
		CALL MAKE_FLOOR_LINE,6,"       "

	CASE 2
	;地下２階
		FLAG:최대X = 7
		FLAG:최대Y = 7
		CALL MAKE_FLOOR_LINE,0,"       "
		CALL MAKE_FLOOR_LINE,1," 51111 "
		CALL MAKE_FLOOR_LINE,2," 1 511 "
		CALL MAKE_FLOOR_LINE,3," 1  11 "
		CALL MAKE_FLOOR_LINE,4," 1   1 "
		CALL MAKE_FLOOR_LINE,5," 7   6 "
		CALL MAKE_FLOOR_LINE,6,"       "

	CASE 3
	;地下３階
		FLAG:최대X = 7
		FLAG:최대Y = 7
							   ;0123456
		CALL MAKE_FLOOR_LINE,0,"       "
		CALL MAKE_FLOOR_LINE,1," 11511 "
		CALL MAKE_FLOOR_LINE,2," 11111 "
		CALL MAKE_FLOOR_LINE,3," 11  1 "
		CALL MAKE_FLOOR_LINE,4," 1   1 "
		CALL MAKE_FLOOR_LINE,5," 7   6 "
		CALL MAKE_FLOOR_LINE,6,"       "


	CASE 4
	;地下４階
		FLAG:최대X = 7
		FLAG:최대Y = 7
		                       ;0123456
		CALL MAKE_FLOOR_LINE,0,"       "
		CALL MAKE_FLOOR_LINE,1," 11121 "
		CALL MAKE_FLOOR_LINE,2," 511 1 "
		CALL MAKE_FLOOR_LINE,3," 1   9 "
		CALL MAKE_FLOOR_LINE,4," 1   1 "
		CALL MAKE_FLOOR_LINE,5," 7   6 "
		CALL MAKE_FLOOR_LINE,6,"       "
	


	CASE 5
	;地下５階
		FLAG:최대X = 11
		FLAG:최대Y = 13
					 ;01234567890123
		CALL MAKE_FLOOR_LINE, 0,"           "
		CALL MAKE_FLOOR_LINE, 1," 111112116 "
		CALL MAKE_FLOOR_LINE, 2," 1         "
		CALL MAKE_FLOOR_LINE, 3," 1 9       "
		CALL MAKE_FLOOR_LINE, 4," 5 2 1     "
		CALL MAKE_FLOOR_LINE, 5," 5 1211    "
		CALL MAKE_FLOOR_LINE, 6," 1 1       "
		CALL MAKE_FLOOR_LINE, 7," 1 1211    "
		CALL MAKE_FLOOR_LINE, 8," 1 1 11    "
		CALL MAKE_FLOOR_LINE, 9," 2 2       "
		CALL MAKE_FLOOR_LINE,10," 11111     "
		CALL MAKE_FLOOR_LINE,11," 1111127   "
		CALL MAKE_FLOOR_LINE,12,"           "

		;宝箱の設置
		CALL SET_TILE,5,4,던전플래그:38:10,0,3
		

	CASE 6
	;地下６階
		FLAG:최대X = 14
		FLAG:최대Y = 10
					;01234567890123
		CALL MAKE_FLOOR_LINE, 0,"              "
		CALL MAKE_FLOOR_LINE, 1,"     1 11     "
		CALL MAKE_FLOOR_LINE, 2,"     2  1     "
		CALL MAKE_FLOOR_LINE, 3,"     1  2     "
		CALL MAKE_FLOOR_LINE, 4," 111 1 1111   "
		CALL MAKE_FLOOR_LINE, 5," 111212511121 "
		CALL MAKE_FLOOR_LINE, 6," 111 1  111   "
		CALL MAKE_FLOOR_LINE, 7,"     1    1   "
		CALL MAKE_FLOOR_LINE, 8," 72115   611  "
		CALL MAKE_FLOOR_LINE, 9,"              "

		;宝箱の設置
		CALL SET_TILE,1,4,던전플래그:38:11,0,3


	CASE 7
	;地下７階
		FLAG:최대X = 15
		FLAG:최대Y = 11
					;01234567890123
		CALL MAKE_FLOOR_LINE, 0,"               "
		CALL MAKE_FLOOR_LINE, 1,"             9 "
		CALL MAKE_FLOOR_LINE, 2,"             2 "
		CALL MAKE_FLOOR_LINE, 3,"  111111111151 "
		CALL MAKE_FLOOR_LINE, 4,"   1551  2 1 1 "
		CALL MAKE_FLOOR_LINE, 5," 121111 11 1 1 "
		CALL MAKE_FLOOR_LINE, 6,"   11   11 6 7 "
		CALL MAKE_FLOOR_LINE, 7," 121    2      "
		CALL MAKE_FLOOR_LINE, 8,"     151111111 "
		CALL MAKE_FLOOR_LINE, 9,"               "
		CALL MAKE_FLOOR_LINE,10,"               "

		;宝箱の設置
		CALL SET_TILE,0,5,던전플래그:38:12,0,3

	CASE 8
	;地下８階
		FLAG:최대X = 15
		FLAG:최대Y = 13
							    ;01234567890123
		CALL MAKE_FLOOR_LINE, 0,"               "
		CALL MAKE_FLOOR_LINE, 1,"  1 1 1 1 1  9 "
		CALL MAKE_FLOOR_LINE, 2,"  2 2 2 2 2  2 "
		CALL MAKE_FLOOR_LINE, 3,"  111111111111 "
		CALL MAKE_FLOOR_LINE, 4,"   1  1  2 1 1 "
		CALL MAKE_FLOOR_LINE, 5," 121111 11 1 5 "
		CALL MAKE_FLOOR_LINE, 6,"   1    11 6 7 "
		CALL MAKE_FLOOR_LINE, 7," 121 1  2      "
		CALL MAKE_FLOOR_LINE, 8,"   1 2  1    1 "
		CALL MAKE_FLOOR_LINE, 9,"   1 1  1    2 "
		CALL MAKE_FLOOR_LINE,10,"   2 1 5551111 "
		CALL MAKE_FLOOR_LINE,11,"   111 1 1 1 1 "
		CALL MAKE_FLOOR_LINE,12,"               "


	CASE 9
	;地下９階
		FLAG:최대X = 13
		FLAG:최대Y = 13
							    ;01234567890123
		CALL MAKE_FLOOR_LINE, 0,"             "
		CALL MAKE_FLOOR_LINE, 1,"      1      "
		CALL MAKE_FLOOR_LINE, 2,"      2      "
		CALL MAKE_FLOOR_LINE, 3,"   7111      "
		CALL MAKE_FLOOR_LINE, 4,"      121    "
		CALL MAKE_FLOOR_LINE, 5,"    111 2    "
		CALL MAKE_FLOOR_LINE, 6,"      1 1    "
		CALL MAKE_FLOOR_LINE, 7,"    611   11 "
		CALL MAKE_FLOOR_LINE, 8," 11   1  111 "
		CALL MAKE_FLOOR_LINE, 9," 11 12421111 "
		CALL MAKE_FLOOR_LINE,10,"  2   1   11 "
		CALL MAKE_FLOOR_LINE,11," 111111   11 "
		CALL MAKE_FLOOR_LINE,12,"             "


	CASE 10
	;地下１０階
		FLAG:최대X = 13
		FLAG:최대Y = 13
		
		
					;0123456789012
		CALL MAKE_FLOOR_LINE, 0,"             "
		CALL MAKE_FLOOR_LINE, 1," 111 11  1   "
		CALL MAKE_FLOOR_LINE, 2," 111 11  2   "
		CALL MAKE_FLOOR_LINE, 3,"  2  2   1   "
		CALL MAKE_FLOOR_LINE, 4," 55555   121 "
		CALL MAKE_FLOOR_LINE, 5,"   55526 1   "
		CALL MAKE_FLOOR_LINE, 6," 12555   121 "
		CALL MAKE_FLOOR_LINE, 7,"   1     1   "
		CALL MAKE_FLOOR_LINE, 8,"   155551121 "
		CALL MAKE_FLOOR_LINE, 9," 121  2  2   "
		CALL MAKE_FLOOR_LINE,10,"   1 11 11   "
		CALL MAKE_FLOOR_LINE,11," 121 11 1121 "
		CALL MAKE_FLOOR_LINE,12,"             "

		;宝箱の設置
		CALL SET_TILE,9,1,던전플래그:38:13,0,3
	CASEELSE

ENDSELECT

;=======================================================================
;[5]조사　実行時の이벤트
;=======================================================================
@EVENT_CHECK_DUNGEON_38

;==========
;出口の処理
;==========
IF DA:(FLAG:현X):(FLAG:현Y) == 8
	CALL DUNGEON_EXIT
	RETURN 1
;========
;宝の処理
;========
;% 10は10で割ったあまり、つまり下一桁がでてきます
;그리고、下一桁はタイルの종류を表す
	SELECTCASE FLAG:현M
	CASE 0
	CASE 1
	CASE 2
	CASE 3
	CASE 4
	CASE 5
		CALL GET_TREASURE, 5514 , 10 , FLAG:현던전, LOCAL , 10
		던전플래그:38:10 = 1
	CASE 6
		CALL GET_TREASURE, 1031 , 3 , FLAG:현던전, LOCAL , 11
		던전플래그:38:11 = 1
	CASE 7
		CALL GET_TREASURE, 1002 , 2 , FLAG:현던전, LOCAL , 12
		던전플래그:38:12 = 1		
	CASE 8
		
	CASE 9
		
	CASE 10
		CALL GET_TREASURE, 277 , 1 , FLAG:현던전, LOCAL , 13
		던전플래그:38:13 = 1		
	CASEELSE
ENDSELECT
;=======
;階段
;=======
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 6
SELECTCASE FLAG:현M
	CASE 0
	CASE 1
		CALL DUNGEON_UPSTAIRS,0,5,9
	CASE 2
		CALL DUNGEON_UPSTAIRS,1,1,4
	CASE 3
		CALL DUNGEON_UPSTAIRS,2,1,4
	CASE 4
		CALL DUNGEON_UPSTAIRS,3,1,4
	CASE 5
		CALL DUNGEON_UPSTAIRS,4,1,4
	CASE 6
		CALL DUNGEON_UPSTAIRS,5,7,11
	CASE 7
		CALL DUNGEON_UPSTAIRS,6,3,8
	CASE 8
		CALL DUNGEON_UPSTAIRS,7,13,5
	CASE 9
		CALL DUNGEON_UPSTAIRS,8,13,6
	CASE 10
		CALL DUNGEON_UPSTAIRS,9,4,3
	CASEELSE
ENDSELECT

RETURN 1

ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 7
SELECTCASE FLAG:현M
	CASE 0
		CALL DUNGEON_DOWNSTAIRS,1,5,4
	CASE 1
		CALL DUNGEON_DOWNSTAIRS,2,5,4
	CASE 2
		CALL DUNGEON_DOWNSTAIRS,3,5,4
	CASE 3
		CALL DUNGEON_DOWNSTAIRS,4,5,4
	CASE 4
		CALL DUNGEON_DOWNSTAIRS,5,9,1
	CASE 5
		CALL DUNGEON_DOWNSTAIRS,6,10,8
	CASE 6
		CALL DUNGEON_DOWNSTAIRS,7,11,5
	CASE 7
		CALL DUNGEON_DOWNSTAIRS,8,11,5
	CASE 8
		CALL DUNGEON_DOWNSTAIRS,9,5,7
	CASE 9
		CALL DUNGEON_DOWNSTAIRS,10,6,5
	CASEELSE
ENDSELECT
RETURN 1
;========
;이벤트
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 4

ELSE
	CALL MESSAGE_WINDOW_D, "", "＞아무것도 없는 것 같다"
	RETURN 0
ENDIF

;=======================================================================
;タイル進入時の이벤트
;=======================================================================
@EVENT_ENTER_DUNGEON_38,ARG
;ARG = 進入時の向き　0の場合ワープなど
;==========
;出口の処理
;==========
IF DA:(FLAG:현X):(FLAG:현Y) % 10 == 8
	CALL DUNGEON_EXIT
	RETURN 1
;========
;宝の処理
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 3
	SELECTCASE FLAG:현M
	CASE 0
	CASE 1
	CASE 2
	CASE 3
	CASE 4
	CASE 5
		CALL GET_TREASURE, 5514 , 10 , FLAG:현던전, LOCAL , 10
		던전플래그:38:10 = 1
	CASE 6
		CALL GET_TREASURE, 1031 , 3 , FLAG:현던전, LOCAL , 11
		던전플래그:38:11 = 1
	CASE 7
		CALL GET_TREASURE, 1002 , 2 , FLAG:현던전, LOCAL , 12
		던전플래그:38:12 = 1		
	CASE 8
		
	CASE 9
		
	CASE 10
		CALL GET_TREASURE, 277 , 1 , FLAG:현던전, LOCAL , 13
		던전플래그:38:13 = 1		
	CASEELSE
ENDSELECT
	RETURN RESULT
;=======
;階段
;=======
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 6
SELECTCASE FLAG:현M
	CASE 0
	CASE 1
		CALL DUNGEON_UPSTAIRS,0,5,9
	CASE 2
		CALL DUNGEON_UPSTAIRS,1,1,4
	CASE 3
		CALL DUNGEON_UPSTAIRS,2,1,4
	CASE 4
		CALL DUNGEON_UPSTAIRS,3,1,4
	CASE 5
		CALL DUNGEON_UPSTAIRS,4,1,4
	CASE 6
		CALL DUNGEON_UPSTAIRS,5,7,11
	CASE 7
		CALL DUNGEON_UPSTAIRS,6,3,8
	CASE 8
		CALL DUNGEON_UPSTAIRS,7,13,5
	CASE 9
		CALL DUNGEON_UPSTAIRS,8,13,6
	CASE 10
		CALL DUNGEON_UPSTAIRS,9,4,3
	CASEELSE
ENDSELECT

RETURN 1

ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 7
SELECTCASE FLAG:현M
	CASE 0
		CALL DUNGEON_DOWNSTAIRS,1,5,4
	CASE 1
		CALL DUNGEON_DOWNSTAIRS,2,5,4
	CASE 2
		CALL DUNGEON_DOWNSTAIRS,3,5,4
	CASE 3
		CALL DUNGEON_DOWNSTAIRS,4,5,4
	CASE 4
		CALL DUNGEON_DOWNSTAIRS,5,9,1
	CASE 5
		CALL DUNGEON_DOWNSTAIRS,6,10,8
	CASE 6
		CALL DUNGEON_DOWNSTAIRS,7,11,5
	CASE 7
		CALL DUNGEON_DOWNSTAIRS,8,11,5
	CASE 8
		CALL DUNGEON_DOWNSTAIRS,9,5,7
	CASE 9
		CALL DUNGEON_DOWNSTAIRS,10,6,5
	CASEELSE
ENDSELECT
RETURN 1

;========
;罠の処理
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 5
	CALL DUNGEON_TRAP_HP,10
	RETURN 0
;==========
;扉の処理
;==========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) == 2
	CALL DUNGEON_DOOR,ARG
	RETURN 1
;========================
;이벤트
;========================
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 4
SELECTCASE FLAG:현M
	CASE 0

	CASE 1
		
	CASE 2
		
	CASE 3
		
	CASE 4

	CASE 5

	CASE 6

	CASE 7

	CASE 8
		
	CASE 9
		CALL MESSAGE_WINDOW_D, "", "＞" + CALLNAME:MASTER + "는 타오르는 불꽃과 악마를 뚫고 오차노미즈 쉘터의 거주구역에 도착했다"
		CALL MESSAGE_WINDOW_D, "", "＞그곳에선 현재 머리 셋 달린 악마가 문에다 불꽃을 후려치고 있는 순간이었다…"
		CALL MESSAGE_WINDOW_D, "아임", "그 썩어빠진 천사년이、소용없는 저항이나 계속하는군…/음、뭐냐 네놈들！"
		CALL MESSAGE_WINDOW_D, "아임", "네놈들, 아바돈을 해치웠던… 오호라 파누엘、이놈들이 비장의 카드더냐！"
		CALL MESSAGE_WINDOW_D, "아임", "좋다、이 화염공 아임의 힘、진득하게 맛보도록 하여라！"
		FLAG:도주불가플래그 = 1
		FLAG:회화불능플래그 = 1
		FLAG:선제기습취소 = 1
		CALL SET_ENEMY,9,1761,55,0,5;아임
		MAXBASE:(CHARANUM-1):파마 = 0
		MAXBASE:(CHARANUM-1):주살 = 0
		CFLAG:(CHARANUM-1):행동횟수 = 2
		BASE:(CHARANUM-1):힘 += 10
		BASE:(CHARANUM-1):지혜 += 10
		BASE:(CHARANUM-1):마력 += 10
		BASE:(CHARANUM-1):인내력 += 10
		BASE:(CHARANUM-1):속도 += 10
		BASE:(CHARANUM-1):운 += 10
		CALL BATTLE_START
		FLAG:도주불가플래그 = 0
		FLAG:회화불능플래그 = 0
		FLAG:선제기습취소 = 0
		CALL MESSAGE_WINDOW_D, "아임", "네놈들、설마、이 몸마저 해치우다니…"
		CALL MESSAGE_WINDOW_D, "", "＞타천사 아임은 사라졌다…"
		CALL MESSAGE_WINDOW_D, "파누엘", "사람의 자식이여、당신 덕분에 이 쉘터는 구원 받았습니다"
		CALL MESSAGE_WINDOW_D, "파누엘", "머잖아 이 쉘터도 다시 일어서겠지요/그럼 당신을 밖까지 모셔드리겠습니다/사람의 자식이여、힘を貸してくれてありがとう…"
		;파누엘合体解禁
		FLAG:10349 = 1
		CALL SHOW_PICTURE, "D"
		CALL INPUT_SELECT_D("[1] 파누엘을 요구한다/[2] 보수를 받는다")
			IF RESULT == 1
				CALL MESSAGE_WINDOW_D, "파누엘", "…！/알겠습니다、쉘터의 주민들은 구원받은 판국이지요/이에 보답하기 위해서라면、이 몸쯤이야 바치겠습니다…"
				CALL MESSAGE_WINDOW_D, "", "＞대천사 파누엘이 동료마로 들어왔다"
				CALL ADD_NEW_COMPANION,349,15000
				LOCAL = GETCHARA(349)
				TARGET = LOCAL
				TALENT:억압 = 0
			ENDIF
		이벤트플래그:70:1 = 2
		FLAG:탈출 = 1
	CASEELSE

ENDSELECT

ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 9
SELECTCASE FLAG:현M
	CASE 0
		CALL MESSAGE_WINDOW_D, "", "＞엘리베이터 내부에서 찜구이가 된 고기의 냄새가 난다…"
	CASE 1
		
	CASE 2
		
	CASE 3
		
	CASE 4

	CASE 5
		CALL MESSAGE_WINDOW_D, "", "＞엘리베이터 내부에서 찜구이가 된 고기의 냄새가 난다…"
	CASE 6
		
	CASE 7
		CALL MESSAGE_WINDOW_D, "", "＞엘리베이터 내부에서 찜구이가 된 고기의 냄새가 난다…"
	CASE 8
		CALL MESSAGE_WINDOW_D, "", "＞엘리베이터 내부에서 찜구이가 된 고기의 냄새가 난다…"
	CASE 9
		
	CASEELSE
ENDSELECT
ENDIF


;--------------------------------
;炎데미지
;--------------------------------
@EVENT_BATTLE_ACTEND_DUNGEON38
LOCAL = FLAG:행동순1
SIF LOCAL < 0
	RETURN 0
SIF CFLAG:LOCAL:상태이상 == GET_STATE_NUM("DYING")
	RETURN 0
IF MAXBASE:LOCAL:화염 == 999
	LOCAL:1 = 0
ELSE
	LOCAL:1 = RAND:20 + 10
	IF CFLAG:LOCAL:화염무효화횟수 > 0
		LOCAL:1 = 0
		CFLAG:LOCAL:화염무효화횟수 -= 1
	ELSE
		LOCAL:1 = LOCAL:1 * MAXBASE:LOCAL:화염 / 100
	ENDIF
ENDIF
IF LOCAL:1 < 0
	LOCALS:1 = {-LOCAL:1}회복
ELSEIF LOCAL:1 == 0
	LOCALS:1 = BLOCK
ELSE
	LOCALS:1 = {LOCAL:1}데미지
ENDIF
LOCALS = 화염이 %조사처리(CALLNAME:LOCAL,"를")% 덮쳤다！
CALL MESSAGE_B(1, LOCALS)
PRINTFORMW TARGET:[{LOCAL,2}] %CALLNAME:LOCAL,20,LEFT%　>>>>>>　%LOCALS:1%
CALL VAR_HP, LOCAL, -(LOCAL:1), 0


;=======================================================================
;인카운트율
;=======================================================================
@ENCOUNT_RATE_38
FLAG:인카운트율 = FLAG:미조우걸음수*5

;=======================================================================
;エンカウント処理
;=======================================================================
@CHECK_ENCOUNT_38
IF RAND:100 < FLAG:인카운트율
	CALL ENEMY_TABLE
	RETURN 1
ELSE
	FLAG:미조우걸음수 += 1
	RETURN 0
ENDIF

;=======================================================================
;적の종족の종류数
;=======================================================================
@CLASS_NUM_38
RETURN CLASS_NUM_COMMON("上級")
;=======================================================================
;적の総数
;ARGは出現する적の종류です
;=======================================================================
@ENEMY_NUM_38, ARG
RETURN ENEMY_NUM_COMMON("上級", ARG)

;=======================================================================
;적の종류
;=======================================================================
@ENEMY_38, ARG
	IF RAND:4 == 0
		RETURN 1033, 30;피샤차
	ELSEIF RAND:3 == 0
		RETURN 1712, 43;시트리
	ELSEIF RAND:2 == 0
		RETURN [[キャラ:오르트로스]], 45
	ELSE
		RETURN [[キャラ:잭랜턴]], 40
	ENDIF
