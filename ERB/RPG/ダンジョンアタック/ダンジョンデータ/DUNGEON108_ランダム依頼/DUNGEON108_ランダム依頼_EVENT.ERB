;========================================

;戦闘開始時の処理

;========================================
@EVENT_BATTLE_START_DUNGEON108
SELECTCASE 의뢰플래그:108:1
	;ソドモラ
	CASE 61
		IF (던전플래그:108:36 == 13 || 던전플래그:108:36 == 14 || 던전플래그:108:36 == 15) && 던전플래그:108:39 <= 9
			던전플래그:108:39 += 1
		ELSEIF 던전플래그:108:36 == 1 && 던전플래그:108:39 <= 50
			던전플래그:108:39 += 1
		ENDIF
	CASEELSE
		TRYCALLFORM EVENT_BATTLE_START_DUNGEON108_{의뢰플래그:108:1}
ENDSELECT




;========================================
;行動終了時の処理
;========================================
@EVENT_BATTLE_ACTEND_DUNGEON108
SELECTCASE 의뢰플래그:108:1
	CASE 7, 39,46, 71
		LOCAL = FLAG:행동순1
		SIF CFLAG:LOCAL:PT플래그 == 0
			RETURN 0
		SIF LOCAL < 0
			RETURN 0
		SIF CFLAG:LOCAL:상태이상 == GET_STATE_NUM("DYING")
			RETURN 0
		IF MAXBASE:LOCAL:화염 == 999
			LOCAL:1 = 0
		ELSE
			LOCAL:1 = RAND:20 + 50
			IF CFLAG:LOCAL:화염무효화횟수 > 0
				LOCAL:1 = 0
				CFLAG:LOCAL:화염무효화횟수 -= 1
			ELSE
				LOCAL:1 = LOCAL:1 * MAXBASE:LOCAL:화염 / 100
			ENDIF
		ENDIF
		IF LOCAL:1 < 0
			LOCALS:1 = {-LOCAL:1}回復
		ELSEIF LOCAL:1 == 0
			LOCALS:1 = BLOCK
		ELSE
			LOCALS:1 = {LOCAL:1}ダメージ
		ENDIF
		SELECTCASE 의뢰플래그:108:1
			CASE 7
				LOCALS = トラップの爆発が%CALLNAME:LOCAL%を襲う！
			CASE 39
				LOCALS = 周囲の砲台からの砲撃が%CALLNAME:LOCAL%を襲う！
			CASE 46
				LOCALS = 高温の大気が%CALLNAME:LOCAL%を襲う！
			CASE 71
				LOCALS = 無差別な爆発が%CALLNAME:LOCAL%を襲う！
		ENDSELECT
		SETCOLORBYNAME Red
		CALL MESSAGE_B(1, LOCALS)
		PRINTFORMW TARGET:[{LOCAL,2}] %CALLNAME:LOCAL,20,LEFT%　>>>>>>　%LOCALS:1%
		RESETCOLOR
		CALL VAR_HP, LOCAL, -(LOCAL:1), 0
	CASE 29
		SIF 의뢰플래그:108:1 == 29 && 던전플래그:108:20 == 0
			RETURN 0
		LOCAL = FLAG:행동순1
		SIF CFLAG:LOCAL:PT플래그 == 0
			RETURN 0
		SIF LOCAL < 0
			RETURN 0
		SIF CFLAG:LOCAL:상태이상 == GET_STATE_NUM("DYING")
			RETURN 0
		IF MAXBASE:LOCAL:비구 == 999
			LOCAL:1 = 0
		ELSE
			LOCAL:1 = RAND:20 + 50
			IF CFLAG:LOCAL:비구무효화횟수 > 0
				LOCAL:1 = 0
				CFLAG:LOCAL:비구무효화횟수 -= 1
			ELSE
				LOCAL:1 = LOCAL:1 * MAXBASE:LOCAL:비구 / 100
			ENDIF
		ENDIF
		IF LOCAL:1 < 0
			LOCALS:1 = {-LOCAL:1}回復
		ELSEIF LOCAL:1 == 0
			LOCALS:1 = BLOCK
		ELSE
			LOCALS:1 = {LOCAL:1}ダメージ
		ENDIF
		SELECTCASE 의뢰플래그:108:1
			CASE 29
				LOCALS = 木々の陰から放たれた矢が%CALLNAME:LOCAL%を襲う！
		ENDSELECT
		SETCOLORBYNAME Red
		CALL MESSAGE_B(1, LOCALS)
		PRINTFORMW TARGET:[{LOCAL,2}] %CALLNAME:LOCAL,20,LEFT%　>>>>>>　%LOCALS:1%
		RESETCOLOR
		CALL VAR_HP, LOCAL, -(LOCAL:1), 0
	CASE 57, 68
		LOCAL = FLAG:행동순1
		SIF CFLAG:LOCAL:PT플래그 == 0
			RETURN 0
		SIF LOCAL < 0
			RETURN 0
		SIF CFLAG:LOCAL:상태이상 == GET_STATE_NUM("DYING")
			RETURN 0
		IF MAXBASE:LOCAL:신경 == 999
			LOCAL:1 = 0
		ELSE
			LOCAL:1 = RAND:20 + 50
			IF CFLAG:LOCAL:신경무효화횟수 > 0
				LOCAL:1 = 0
				CFLAG:LOCAL:신경무효화횟수 -= 1
			ELSE
				LOCAL:1 = LOCAL:1 * MAXBASE:LOCAL:신경 / 100
			ENDIF
		ENDIF
		IF LOCAL:1 < 0
			LOCALS:1 = {-LOCAL:1}回復
		ELSEIF LOCAL:1 == 0
			LOCALS:1 = BLOCK
		ELSE
			LOCALS:1 = {LOCAL:1}ダメージ
		ENDIF
		SELECTCASE 의뢰플래그:108:1
			CASE 57
				LOCALS = ＭＡＧで有毒に変異した花粉が%CALLNAME:LOCAL%を襲う！
			CASE 68
				LOCALS = 辺りに漂う猛毒のハーラーハラが%CALLNAME:LOCAL%を襲う！
		ENDSELECT
		SETCOLORBYNAME Red
		CALL MESSAGE_B(1, LOCALS)
		PRINTFORMW TARGET:[{LOCAL,2}] %CALLNAME:LOCAL,20,LEFT%　>>>>>>　%LOCALS:1%
		RESETCOLOR
		CALL VAR_HP, LOCAL, -(LOCAL:1), 0
	;ソドモラ
	CASE 61
		CALL EVENT_BATTLE_ACTEND_DUNGEON108_SODOMORRAH
	CASE 66
		CALL EVENT_BATTLE_ACTEND_DUNGEON108_66
ENDSELECT