
;=======================================================================
;スマイル号
;=======================================================================

;=======================================================================
;
;=======================================================================
@PREREQUISITE_DUNGEON_98
;今が「夜」
IF TIME == 3
	SIF 이벤트플래그:78:0 == 2
		RETURN 1
	
ENDIF

RETURN 0

;=======================================================================
;던전名
;=======================================================================
@GET_DUNGEON_NAME_98
RESULTS = 스마일 호

;=======================================================================
;フ로어名표시
;=======================================================================
@FLOORNAME_98
PRINT 스마일 호(スマイル号) 
SELECTCASE FLAG:현M
	CASE 0
		PRINTL 1층 갑판
	CASE 1
		PRINTL 메인 홀
	CASE 2
		PRINTL 카지노
	CASE 3
		PRINTL 상가
	CASE 4
		PRINTL 라이브 무대
	
	CASEELSE
		PRINTL
ENDSELECT

;=======================================================================
;스타ト地点입력
;=======================================================================
;CALL AUTOMAP
;RETURN 0

;=======================================================================
;攻略開始時の이벤트
;=======================================================================
;@EVENT_DUNGEON_START_98
;IF 던전플래그:98:0 == 0
;ENDIF
;=======================================================================
;탈출時の이벤트
;=======================================================================
@EVENT_DUNGEON_END_98
PRINTFORML 　

;던전탈출時、報酬フラグ貰い待ちだと賞金と名声を得ます。
;IF 던전플래그:98:9 == 1
;	PRINTFORML 　
;	;クリア상태始末クリア
;	IF 던전플래그:98:1 == 1 
;		PRINTFORMW 스마일 호에 있던 현금을 챙겨 ￥50000을 얻었다. 명성 20을 얻었다.
;		
;		MONEY += 50000
;		FLAG:명성 += 20
;	ENDIF
;	IF 던전플래그:98:2 == 1 
;		PRINTFORMW 유명 갑부 가문인 『츠루마키』의 차기 계승자 츠루마키 코코로를 손에 넣었다.
;	ENDIF
;	IF 던전플래그:98:3 == 1 
;		PRINTFORMW 유명 갑부 가문인 『츠루마키』의 차기 계승자 츠루마키 코코로를 살해하고, 그녀 몸에 있던 고가의 보물 일부를 챙겼다. ￥10000을 얻었다.
;		MONEY += 10000
;	ENDIF
;	이벤트플래그:78:0 = 3
;ENDIF

;=======================================================================
;指定したマスに進入가능か
;=======================================================================
@CAN_ENTER_98, ARG, ARG:1
;SELECTCASE DA:ARG:(ARG:1)
;ENDSELECT

;カギ持ってない、扉開けてない
;IF FLAG:현M == 2 && ARG == 6 && ARG:1 == 6 && 던전플래그:89:2 < 4 && 던전플래그:89:6 == 0
;	PRINTFORMW 문은 잠겨있다……
;	RETURN 0
;カギ持ってる、扉開けてない
;ELSEIF FLAG:현M == 2 && ARG == 6 && ARG:1 == 6 && 던전플래그:89:2 == 4 && 던전플래그:89:6 == 0
;	PRINTFORMW 가지고 있던 열쇠로 문을 열었다……
;	;扉開錠フラグ開けたへ
;	던전플래그:89:6 = 1
;	RETURN 0
;ENDIF

CALL CAN_ENTER,ARG,ARG:1
RETURN RESULT

;=======================================================================
;フ로어데이터
;=======================================================================

@MAKE_FLOOR_98
SELECTCASE FLAG:현M
	CASE 0
	;１階、ロビー
		FLAG:최대X = 28 
		FLAG:최대Y = 20 
							;	  0123456789012345678
		CALL MAKE_FLOOR_LINE, 0, "                   "
		CALL MAKE_FLOOR_LINE, 1, "    11110001111    "
		CALL MAKE_FLOOR_LINE, 2, "   1111110111111   "
		CALL MAKE_FLOOR_LINE, 3, "  114111101111411  "
		CALL MAKE_FLOOR_LINE, 4, "  111111111111114  "
		CALL MAKE_FLOOR_LINE, 5, "  111111111111411  "
		CALL MAKE_FLOOR_LINE, 6, "  141111111111111  "
		CALL MAKE_FLOOR_LINE, 7, "  114111411111411  "
		CALL MAKE_FLOOR_LINE, 8, "  111100020004111  "
		CALL MAKE_FLOOR_LINE, 9, "  111100060001111  "
		CALL MAKE_FLOOR_LINE,10, "  111100000001111  "
		CALL MAKE_FLOOR_LINE,11, "  111100000001111  "
		CALL MAKE_FLOOR_LINE,12, "  111000000000111  "
		CALL MAKE_FLOOR_LINE,13, "  111000000000111  "
		CALL MAKE_FLOOR_LINE,14, "  020000000000020  "
		CALL MAKE_FLOOR_LINE,15, "  010000000000010  "
		CALL MAKE_FLOOR_LINE,16, "  010000000000010  "
		CALL MAKE_FLOOR_LINE,17, "  010000000000010  "
		CALL MAKE_FLOOR_LINE,18, "  030000000000030  "
		CALL MAKE_FLOOR_LINE,19, "  000000000000000  "
		
		DA:8:7 += 10
		DA:16:18 += 10
		
	CASE 1
	;２階
		FLAG:최대X = 28 
		FLAG:최대Y = 20
	
							;	  0123456789012345678901234567
		CALL MAKE_FLOOR_LINE, 0, "                           "
		CALL MAKE_FLOOR_LINE, 1, "                           "
		CALL MAKE_FLOOR_LINE, 2, "              7            "
		CALL MAKE_FLOOR_LINE, 3, "       1  111111111  3     "
		CALL MAKE_FLOOR_LINE, 4, "  111121  111111111  1211  "
		CALL MAKE_FLOOR_LINE, 5, "  311  1  111111111  1  1  "
		CALL MAKE_FLOOR_LINE, 6, "  111121  111111111  1211  "
		CALL MAKE_FLOOR_LINE, 7, "       112114111111211  1  "
		CALL MAKE_FLOOR_LINE, 8, "          100010001     1  "
		CALL MAKE_FLOOR_LINE, 9, "   131    100010001     1  "
		CALL MAKE_FLOOR_LINE,10, "   111  1212101012121   1  "
		CALL MAKE_FLOOR_LINE,11, "    2     100010001     1  "
		CALL MAKE_FLOOR_LINE,12, "    11111212104012421   2  "
		CALL MAKE_FLOOR_LINE,13, "    2     400000000   111  "
		CALL MAKE_FLOOR_LINE,14, "   111    011111111211111  "
		CALL MAKE_FLOOR_LINE,15, "   131    100010001        "
		CALL MAKE_FLOOR_LINE,16, "          000040000        "
		CALL MAKE_FLOOR_LINE,17, "          000020000        "
		CALL MAKE_FLOOR_LINE,18, "          001111100        "
		CALL MAKE_FLOOR_LINE,19, "          000060000        "
		
		;CALL SET_TILE, 14 , 3 , 던전플래그:98:1 , 0 , 0
		;CALL SET_TILE, 14 , 16 , 던전플래그:98:2 , 0 , 7905
		
		DA:12:7 += 1000
		DA:14:16 += 1010
		DA:10:13 += 1020
		DA:14:12 += 1020
		DA:18:12 += 1020
		
		DA:2:5 += 1000
		DA:21:3 += 1010
		DA:4:9 += 1020
	CASE 2
	;３階
		FLAG:최대X = 17 
		FLAG:최대Y = 20 
							;	  01234567890123456
		CALL MAKE_FLOOR_LINE, 0, "                 "
		CALL MAKE_FLOOR_LINE, 1, "  0700000000000  "
		CALL MAKE_FLOOR_LINE, 2, "  1101111111110  "
		CALL MAKE_FLOOR_LINE, 3, "  1101411411110  "
		CALL MAKE_FLOOR_LINE, 4, "  1101111110000  "
		CALL MAKE_FLOOR_LINE, 5, "  1111111112110  "
		CALL MAKE_FLOOR_LINE, 6, "  0000002000130  "
		CALL MAKE_FLOOR_LINE, 7, "  0111111110000  "
		CALL MAKE_FLOOR_LINE, 8, "  0100000100110  "
		CALL MAKE_FLOOR_LINE, 9, "  0111111112130  "
		CALL MAKE_FLOOR_LINE,10, "  0020000020110  "
		CALL MAKE_FLOOR_LINE,11, "  1111000010000  "
		CALL MAKE_FLOOR_LINE,12, "  1111    1111   "
		CALL MAKE_FLOOR_LINE,13, "  1111    1111   "
		CALL MAKE_FLOOR_LINE,14, "  1111    1111   "
		CALL MAKE_FLOOR_LINE,15, "   2        2    "
		CALL MAKE_FLOOR_LINE,16, "   111111111111  "
		CALL MAKE_FLOOR_LINE,17, "   2          2  "
		CALL MAKE_FLOOR_LINE,18, "   1          6  "
		CALL MAKE_FLOOR_LINE,19, "                 "
		
		DA:13:6 += 2000
		DA:13:9 += 2010
		
	CASE 3
	;３階
		FLAG:최대X = 26 
		FLAG:최대Y = 20 
							;	  01234567890123456789012345
		CALL MAKE_FLOOR_LINE, 0, "                          "
		CALL MAKE_FLOOR_LINE, 1, "  131       7       111   "
		CALL MAKE_FLOOR_LINE, 2, "  111211111 11111412131   "
		CALL MAKE_FLOOR_LINE, 3, "  111 1          1  111   "
		CALL MAKE_FLOOR_LINE, 4, "      1   4      1        "
		CALL MAKE_FLOOR_LINE, 5, "      1   2      1  113   "
		CALL MAKE_FLOOR_LINE, 6, "      111111111111  1     "
		CALL MAKE_FLOOR_LINE, 7, "      1 2    1   1  1     "
		CALL MAKE_FLOOR_LINE, 8, "      1 1    1   1111     "
		CALL MAKE_FLOOR_LINE, 9, "      1      1      1     "
		CALL MAKE_FLOOR_LINE,10, "  11111      1   1111     "
		CALL MAKE_FLOOR_LINE,11, "  1       3  123 1        "
		CALL MAKE_FLOOR_LINE,12, "  1       2  1   1        "
		CALL MAKE_FLOOR_LINE,13, "  111111111111   1111     "
		CALL MAKE_FLOOR_LINE,14, "   2 2 2            124   "
		CALL MAKE_FLOOR_LINE,15, "   4 3 1      1111  1     "
		CALL MAKE_FLOOR_LINE,16, "       11111111  1  124   "
		CALL MAKE_FLOOR_LINE,17, "              3  1111     "
		CALL MAKE_FLOOR_LINE,18, "                    6     "
		CALL MAKE_FLOOR_LINE,19, "                          "
		
		DA:17:2 += 3000
		DA:22:14 += 3010
		DA:22:16 += 3020
		DA:3:15 += 3030
		DA:10:4 += 3040
		
		DA:3:1 += 3000
		DA:21:2 += 3010
		DA:5:15 += 3020
		DA:13:17 += 3030
		DA:22:5 += 3040
		
		
	CASE 4
	;３階
		FLAG:최대X = 13 
		FLAG:최대Y = 12 
							;	  0123456789012
		CALL MAKE_FLOOR_LINE, 0, "             "
		CALL MAKE_FLOOR_LINE, 1, "             "
		CALL MAKE_FLOOR_LINE, 2, "  111111111  "
		CALL MAKE_FLOOR_LINE, 3, "  111111111  "
		CALL MAKE_FLOOR_LINE, 4, "  111111111  "
		CALL MAKE_FLOOR_LINE, 5, "  111141111  "
		CALL MAKE_FLOOR_LINE, 6, "      2      "
		CALL MAKE_FLOOR_LINE, 7, "      1T     "
		CALL MAKE_FLOOR_LINE, 8, "      1      "
		CALL MAKE_FLOOR_LINE, 9, "      7      "
		CALL MAKE_FLOOR_LINE,10, "             "
		CALL MAKE_FLOOR_LINE,11, "             "
		
		DA:6:5 += 4000
		
	CASE 10
	CASEELSE
ENDSELECT

;=======================================================================
;タイル調整
;=======================================================================
@MAKE_FLOOR_LINE_COMMON_98, ARG, ARG:1, ARG:2

SIF ARG:1 == 0 && ARG:2 == 0
	VARSET LOCAL

;=======================================================================
;特殊タイル표시
;TILE_MARK_COMMON_{FLAG:현던전}_X
;=======================================================================
;ARG:1、ARG:2がX座標とY座標
;ARGはそこに代入されている値
;RESULTSに代入した문자がマップに표시されますが、必ず全角1문자分になるようにしてください。そうでないと표시が崩れます。

@TILE_MARK_COMMON_98_4, ARG , ARG:1 , ARG:2
SELECTCASE ARG / 10
	;CASE 2 , 4
	;	RESULTS = ↑
	;CASE 1 , 3
	;	RESULTS = ↓
		
	CASE 0 , 113 , 201
		SETCOLOR 0x00ff00
		RESULTS = 屍
	CASEELSE
		;特に설정しない場合、"！"と표시されます
		RETURN 1
ENDSELECT

;特殊タイルの표시
;末꼬리の_9は特殊タイルであることを示す9
@TILE_MARK_COMMON_98_9, ARG , ARG:1 , ARG:2
SELECTCASE ARG / 10
	;CASE 400
		
		
	CASEELSE
		;特に설정しない場合、"■"が표시されます
		RETURN 1
ENDSELECT

;=======================================================================
;[5]조사　実行時の이벤트
;=======================================================================
@EVENT_CHECK_DUNGEON_98
;==========
;出입の処理
;==========
IF DA:(FLAG:현X):(FLAG:현Y) == 8
	CALL DUNGEON_EXIT
	RETURN 1
;========
;宝の処理
;========
;% 10は10で割ったあまり、つまり下一桁がでてきます
;그리고、下一桁はタイルの종류を表す
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 3
	CALL TREASURE_98
	RETURN RESULT
;=======
;階段
;=======
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 6
	CALL UPSTAIRS_98
	RETURN RESULT

ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 7
	CALL DOWNSTAIRS_98
	RETURN RESULT
;========
;이벤트
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 4
	SELECTCASE DA:(FLAG:현X):(FLAG:현Y) / 10
		;１Ｆ이벤트
		CASE 0
			CALL MESSAGE_WINDOW_D, "", "＞양복을 입은 경호원의 시체가 있다…. 시체는 끔찍하게 훼손되어 있다."
		CASE 1
			CALL MESSAGE_WINDOW_D, "", "＞스마일 호/＞츠루마키 가문 소유"
			CALL MESSAGE_WINDOW_D, "", "＞「석양의 괴도단」의 아기고양이들에게 도전장을 보낸다/＞…라고 적혀 있다."
			
		;２Ｆ이벤트
		CASE 100
			CALL MESSAGE_WINDOW_D, "", "＞고가로 보이는 피아노가 있다."
			
		CASE 101
			IF 던전플래그:98:1 == 1
			CALL MESSAGE_WINDOW_D, "", "＞카오루를 만난 장소다"
			ENDIF
			
		CASE 102
			CALL MESSAGE_WINDOW_D, "", "＞복도가 바리케이드로 막혀 있다. 악마를 막기 위해 세운 것 같다./＞아무래도 이 길로는 지나갈 수 없을 것 같다. 다른 길을 찾자."
			
		;２Ｆ이벤트
		CASE 200
			CALL MESSAGE_WINDOW_D, "", "＞피 묻은 카지노 룰렛이 있다."
			
		CASE 300
			IF 던전플래그:98:2 == 1
			CALL MESSAGE_WINDOW_D, "", "＞코코로를 만난 장소다"
			ENDIF
			
		CASE 301
			CALL MESSAGE_WINDOW_D, "스피커", "＞눈도 깜박이지 마! 하이텐션 보이스로 (붕붕!)/＞화려하게 저질러버리자!"
			CALL MESSAGE_WINDOW_D, "", "＞『헬로 해피 월드』의 노래가 시끄럽게 울리고 있다/＞선전중인 괴도 컨셉 음악인 모양이다"
			
		CASE 302
			IF 던전플래그:98:11 == 0
				CALL MESSAGE_WINDOW_D, "스피커", "＞안녕 모두가 사랑하는 미셸이야/＞한정 뽑기를 위한 스타 결제 많이많이 부탁해"
				CALL MESSAGE_WINDOW_D, "", "＞곰인형 캐릭터에 달린 스피커가 뽑기 기계 쿠폰을 선전하고 있다"
				CALL MESSAGE_WINDOW_D, "", "＞…뽑기 기계를 부수면 안의 돈을 꺼낼 수 있을 것 같다"
				CALL MESSAGE_WINDOW_D, "", "＞뽑기 기계 속 ￥5000엔을 얻었다"
				MONEY += 5000
				던전플래그:98:11 = 1
			ELSE
				CALL MESSAGE_WINDOW_D, "스피커", "＞안녕 모두가 사랑하는 미셸이야/＞지금 가챠 돌리지 않으면 후회할 거야/＞4성 코코로 한정 가챠에 복각도 없다고"
				CALL MESSAGE_WINDOW_D, "", "＞곰인형 캐릭터에 달린 스피커가 뽑기 기계 쿠폰을 선전하고 있다"
			ENDIF
			
		CASE 303
			CALL MESSAGE_WINDOW_D, "", "＞마네킹 앞의 시체는 아무런 말도 하지 않는다"
			
		CASE 304
			CALL MESSAGE_WINDOW_D, "", "＞잘 보니 화장품 가게 안쪽에 토막난 경호원들의 시체가 늘어져 있다/＞마치 행진하는 군인들처럼 일렬로 서 있다"
			CALL MESSAGE_WINDOW_D, "", "＞쌓여 있는 시체 위로 노래가 울린다/＞매장 스피커로 『헬로 해피 월드』의 노래 『시끌‧벅적‧우당탕 행진곡』이 연주되고 있다"
			CALL MESSAGE_WINDOW_D, "", "＞이게 일종의 「행진」인 셈일까?/＞아무래도 악마들의 장난인 모양이다"
	ENDSELECT
ELSE
	PRINTFORMW 何も無いようだ
	RETURN 0
ENDIF

;=======================================================================
;タイル進入時の이벤트
;=======================================================================
@EVENT_ENTER_DUNGEON_98,ARG
;ARG = 進入時の向き　0の場合ワープなど
;==========
;出입の処理
;==========
IF DA:(FLAG:현X):(FLAG:현Y) % 10 == 8
	CALL DUNGEON_EXIT
	RETURN 1
;========
;宝の処理
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 3
	CALL TREASURE_98
	RETURN RESULT
;=======
;階段
;=======
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 6
	CALL UPSTAIRS_98
	RETURN RESULT

ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 7
	CALL DOWNSTAIRS_98
	RETURN RESULT

;==========
;扉の処理
;==========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 2
	CALL DUNGEON_DOOR,ARG
	RETURN 1

;========
;이벤트
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 4
	SELECTCASE DA:(FLAG:현X):(FLAG:현Y) / 10
		;１Ｆ이벤트
		CASE 0
			CALL MESSAGE_WINDOW_D, "", "＞양복을 입은 경호원의 시체가 있다…. 시체는 끔찍하게 훼손되어 있다."
			RETURN 0
			
		CASE 1
			CALL MESSAGE_WINDOW_D, "", "＞스마일 호/＞츠루마키 가문 소유"
			CALL MESSAGE_WINDOW_D, "", "＞「석양의 괴도단」의 아기고양이들에게 도전장을 보낸다/＞…라고 적혀 있다."
			RETURN 0
			
		;２Ｆ이벤트
		CASE 100
			PRINTFORMW 고가로 보이는 피아노가 있다.
			RETURN 0
			
		CASE 101
			IF 던전플래그:98:1 == 0
				CUSTOMDRAWLINE =
				PRINTL 
				CALL MESSAGE_WINDOW_D, "", "＞당신이 문가에 다가가자, 지금까지 보았던 경호원들과 다른 옷을 입은 여자가 있다. /＞어깨에 부상을 입고 문에 기댄 채 앉아 있는 여성. 자기 힘으로는 일어날 수도 없어 보인다."
				CALL MESSAGE_WINDOW_D, "", "＞가면에 화려한 의상까지, 그녀는 마치 어린이 만화 속 「괴도」처럼 보였다./＞그녀가 「석양의 괴도단」일까…아니, 이 여자는 찾아야 할 대상과 전혀 닮지 않았다."
				CALL MESSAGE_WINDOW_D, "괴도 헬로해피", "아아, 나를 만나러 아기고양이가 왔는데 일어날 수조차 없다니./얼마나 덧없는 상황인가…으읏."
				CALL MESSAGE_WINDOW_D, "", "＞그녀는 당신이 말을 걸자, 피가 흐르는 어깨를 누르며 말했다."
				CALL MESSAGE_WINDOW_D, "괴도 헬로해피", "석양의 괴도단？ 아니. 내가 바로 「괴도 헬로해피」, 석양의 괴도단에게 도전장을 보낸 괴도다/…미안, 장난을 칠 때가 아니겠지."
				CALL MESSAGE_WINDOW_D, "괴도 헬로해피", "사방에는 유령이 돌아다니고…사람들이 죽고…. 셰익스피어도 이런 풍경을 보면 아무 말도 할 수 없을 거야"
				CALL MESSAGE_WINDOW_D, "", "＞유령이라는 말을 하며, 그녀는 눈에 보일 정도로 몸을 떨었다./지금 스마일 호에서 무슨 일이 일어나고 있는 것인가. 당신은 그걸 물었다."
				CALL MESSAGE_WINDOW_D, "세타 카오루", "나는 세타 카오루. 오늘 사건은 나와 내 친구 「코코로」가 계획했어/아기 고양이는 코코로가 누구인지 모르려나…그녀는 이 배의 주인이자, 밴드 「헬로 해피 월드」의 보컬이야"
				CALL MESSAGE_WINDOW_D, "세타 카오루", "나와 코코로는 석양의 괴도단의 정체를 알고 있어/그녀들은 괴도단 활동으로 사람들을 도우려 하고 있지/그런 그녀들을 위해 작은 이벤트를 열어주려던 것 뿐이었어"
				CALL MESSAGE_WINDOW_D, "", "＞이벤트？ 거기에 대해 묻자 카오루가 한숨을 토했다"
				CALL MESSAGE_WINDOW_D, "세타 카오루", "원래는 코코로의 저택에 장난 「함정」들을 만들고 그녀들과 괴도 대결을 하자며 초대할 작정이었지"
				CALL MESSAGE_WINDOW_D, "세타 카오루", "이 배가 코코로의 것이라고 했던가？ 그녀는 돈이 아주 많단다. 이런 장난도 불가능한 게 아니지/문제는 그녀가 어디에선가 「사 왔다」는 프로그램이었어"
				CALL MESSAGE_WINDOW_D, "세타 카오루", "유령을 불러내는 프로그램. 이걸 이용해 석양의 괴도단에게 재미있는 장난을 해 주려던 것 뿐이었는데…/우리도 위험할 수 있다는 생각은 했어. 주변에 사는 사람들에게 민폐일 수도 있다고 생각했고"
				CALL MESSAGE_WINDOW_D, "세타 카오루", "그래서 저택이 아닌 배 위에서 행사를 하기로 했었는데…아아. 유령은 역시 인간이 다룰 수 있는 게 아니었어"
				CALL MESSAGE_WINDOW_D, "", "＞유령을 불러내는 프로그램이라는 건 아마 악마소환 프로그램을 말하는 것이리라/＞그렇다면 석양의 괴도단은？"
				CALL MESSAGE_WINDOW_D, "세타 카오루", "분명 이 배 안쪽에 아직 남아 있을 거야./아기고양이, 부탁하겠어. 그녀들을 구해 줘. 그리고, 코코로를 도와 주는 거야."
				CALL MESSAGE_WINDOW_D, "", "＞더 이상 물을 것은 없으리라. 이 여자는 어떻게 하지？/＞부상, 그리고 이곳에 날뛰는 악마들 때문에 그녀를 여기 그냥 두면 금방 살해당할 것이다"
				PRINTL 
				PRINTFORML 카오루의 처우
				PRINTL [0] 보트로 데려간다
				PRINTL [1] 지금 죽인다
				;PRINTL [2] 악마에게 죽도록 한다
				$INPUT_LOOP1
				INPUT
				IF RESULT == 0
					CALL MESSAGE_WINDOW_D, "세타 카오루", "정말 고맙게 됐어…으윽."
					CALL MESSAGE_WINDOW_D, "", "＞카오루는 스마일 호 외부 보트에 보호되었다/＞얌전히 집으로 돌려보낼 수도 있지만, 그렇지 않을 수도 있다."
					PRINTL 
					PRINTL 카오루를 구금할까?
					CALL INPUT_YN
						IF RESULT == 0
							CALL INCREASE_LD, -8
							CALL MESSAGE_WINDOW_D, "", "＞이미 부상을 입은 일반인이다. 기습적인 한 번의 공격으로 단번에 그녀를 기절시킬 수 있었다./＞일단 팔다리와 입을 모두 결박한 후, 카오루를 보트 안쪽에 수납했다. 스마일 호 수색을 계속 진행하자."
							CALL ADD_NEW_COMPANION,7906,100
						ELSE
							CALL INCREASE_LD, 8
							CALL MESSAGE_WINDOW_D, "", "＞아니. 그럴 필요는 없다. 카오루를 보트 안쪽에서 쉬게 했다./＞수색이 끝나면 집으로 귀가시킬 것이다. 스마일 호 수색을 계속 진행하자."
						ENDIF
				ELSEIF RESULT == 1
					CALL INCREASE_LD, -16
					CALL MESSAGE_WINDOW_D, "세타 카오루", "자, 잠깐. 지금 뭐 하는 거야！！"
					CALL MESSAGE_WINDOW_D, "", "＞그녀는 보호할 가치가 없다. 그렇게 판단했을 뿐이다/＞총을 꺼내 겨누자, 겁에 질린 카오루가 다급히 몸을 일으키려 했다/＞하지만 벽을 짚은 손이 아무리 허우적거려도, 힘이 풀린 다리는 말을 듣지 않는 것 같았다"
					CALL MESSAGE_WINDOW_D, "세타 카오루", "말로 하는 게 어때, 셰, 셰익스피어도 이렇게 말하지 않았나… 인생이란…"
					CALL MESSAGE_WINDOW_D, "", "＞더 들을 가치도 없다. 총구가 불을 뿜었다/＞그것으로 끝이었다./＞세타 카오루의 지갑에서, ￥5000를 얻었다."
					
					MONEY += 5000
				ELSE
					GOTO INPUT_LOOP1
				ENDIF
			ENDIF
			던전플래그:98:1 = 1
			RETURN 0
			
		CASE 102
			CALL MESSAGE_WINDOW_D, "", "＞복도가 바리케이드로 막혀 있다. 악마를 막기 위해 세운 것 같다./＞아무래도 이 길로는 지나갈 수 없을 것 같다. 다른 길을 찾자."
			RETURN 0
			
		;２Ｆ이벤트
		CASE 200
			CALL MESSAGE_WINDOW_D, "", "＞피 묻은 카지노 룰렛이 있다."
			RETURN 0
			
		CASE 300
			IF 던전플래그:98:2 == 0
				CUSTOMDRAWLINE =
				PRINTL 
				CALL MESSAGE_WINDOW_D, "츠루마키 코코로", "도대체 어째서 이렇게 되어버린 걸까./재미있는 이벤트를 열려고 했던 것 뿐인데…."
				CALL MESSAGE_WINDOW_D, "", "＞스마일 호의 주인, 츠루마키 코코로가 피 묻은 원피스를 입은 채 상가에 멍하니 서 있는 것이 보였다./＞악마들의 공격을 피해 도망다니느라 피폐해진 것 같았다/＞당신은 코코로에게 다가가 상황에 대해 물었다."
				CALL MESSAGE_WINDOW_D, "츠루마키 코코로", "그냥 우연히 얻은 프로그램을 썼을 뿐이야/악마하고 친구가 되어서 괴도단 놀이를 하는 Afterglow 애들을 놀라게 해 주려던 것 뿐이었는데"
				CALL MESSAGE_WINDOW_D, "츠루마키 코코로", "악마하고는 친구가 될 수 없었어…/Afterglow 애들이 「개심」이라거나 다른 특별한 힘을 가지고 있냐고?"
				CALL MESSAGE_WINDOW_D, "츠루마키 코코로", "그런 이야기는 들은 적 없어…그것보다 Afterglow 애들이 안에 남아 있는데…/그 애들, 상가 건너편 공연장에 있거든…."
				CALL MESSAGE_WINDOW_D, "", "＞아무래도 그녀는 악마나 페르소나 사용자 같은 개념은 전혀 모르는 것 같다…/＞그녀를 어떻게 할까. 어차피 이대로 방치한 채 가면 악마에게 죽을 뿐이다"
				CALL MESSAGE_WINDOW_D, "", "＞그런 고민을 하고 있을 때, 배 바깥에서 확성기로 지르는 것 같은 여자 목소리가 울렸다/＞코코로 님！！ 안에 계십니까？/＞또 다른 헬리콥터 세 대가 「스마일 호」 위를 둘러싸고 있다"
				CALL MESSAGE_WINDOW_D, "", "＞배에서 연락이 끊기자, 그녀의 가문이 사람을 보낸 모양이었다/＞지금 그녀에게 손을 대는 건 위험하다"
				CALL MESSAGE_WINDOW_D, "", "＞그녀는 「악마와 친구가 될 수 있을 것」이라는 생각을 품은 순진한 소녀다/＞당신은  생존자를 대신 데리고 나올 테니/＞걱정하지 말고 먼저 위로 가라고 말했다/＞코코로는 당신의 말을 믿고 먼저 배 위로 탈출하기로 했다"
				CALL MESSAGE_WINDOW_D, "츠루마키 코코로", "분명 당신은 좋은 사람일 거야. 꼭 모두를 구해 줘"
				CALL MESSAGE_WINDOW_D, "", "＞츠루마키 코코로는 당신에게 외샹악을 하나 주었다. 그녀는 배 위로 떠났다/츠루마키 코코로라…기억해 두는 것이 좋을 것이다"
				
				CALL GET_ITEMS,"외상약", 3
			ENDIF
			던전플래그:98:2 = 1
			RETURN 0
			
		CASE 301
			CALL MESSAGE_WINDOW_D, "", "＞스마일 호 방문객을 위한 기념품 판매/＞인기 걸즈 밴드 『헬로 해피 월드』의 싱글 음반 판매중"
			RETURN 0
			
		CASE 302
			CALL MESSAGE_WINDOW_D, "", "＞정체를 알 수 없는 핑크색 곰인형이 잔뜩 쌓여 있다/＞상가의 인형 가게인 모양이다"
			RETURN 0
			
		CASE 303
			CALL MESSAGE_WINDOW_D, "", "＞화려한 여성복들이 늘어선 옷가게다/＞원피스를 입은 마네킹 앞에, 시체가 머리가 없어진 채 떨어져 있다"
			RETURN 0
			
		CASE 304
			CALL MESSAGE_WINDOW_D, "", "＞화장품 가게다/＞내부는 엉망이 되어 있다"
			RETURN 0
			
		CASE 400
			CALL MESSAGE_WINDOW_D, "", "＞스마일 호에는 라이브 공연을 할 수 있는 크고 화려한 공연장이 있다./＞공연장 객석을 따라 걷자, 무대 위에 둥글게 모여, 나무 막대기를 무기처럼 든 다섯 소녀들을 볼 수 있다."
			CALL MESSAGE_WINDOW_D, "미타케 란", "젠장…. 뭐가 어떻게 되어가는 거야. 저 괴물들은 뭐고"
			CALL MESSAGE_WINDOW_D, "우에하라 히마리", "란, 란! 저기 사람이 있어！"
			CALL MESSAGE_WINDOW_D, "아오바 모카", "호오, 드디어 구조대가 도착한 건가？"
			CALL MESSAGE_WINDOW_D, "미타케 란", "구조대라고 하기에는 뭔가 수상한데"
			CALL MESSAGE_WINDOW_D, "", "＞당신은 「석양의 괴도단」에 대한 것을 묻는다/＞그녀들에게 페르소나를 구사하는 능력이 있는지, 타인을 「개심」하는 방법을 아는지"
			CALL MESSAGE_WINDOW_D, "", "＞하지만 그녀들의 표정은 당황한 채다"
			CALL MESSAGE_WINDOW_D, "우에하라 히마리", "무슨 이야기를 하는 건지 전혀 모르겠어"
			CALL MESSAGE_WINDOW_D, "하자와 츠구미", "뭔가 잘못 알고 오신 거 아닌가요？ 그것보다 어서 탈출해야 해요"
			CALL MESSAGE_WINDOW_D, "", "＞…현재로서는 그녀들이 정말 모르는 체를 하는 것처럼 보이지는 않는다./＞하지만 여기까지 와서 그냥 돌아가는 건 말도 안 되는 일이겠지."
			CALL MESSAGE_WINDOW_D, "", "＞일단 그녀들을 구속해 돌아가 심문하자. 당신은 같이 가 줘야 겠다고 말하며 무대 위로 한 걸음 나아갔다."
			CALL MESSAGE_WINDOW_D, "미타케 란", "잠깐. 같이 간다니？ 그거 탈출을 의미하는 거 맞지？"
			CALL MESSAGE_WINDOW_D, "아오바 모카", "뭔가 분위기가 이상한데"
			CALL MESSAGE_WINDOW_D, "우에하라 히마리", "뭐야？ 그, 그거 진짜 총이에요？ 뭐에요？"
			CALL MESSAGE_WINDOW_D, "미타케 란", "…쳐"
			CALL MESSAGE_WINDOW_D, "하자와 츠구미", "라, 란！"
			CALL MESSAGE_WINDOW_D, "미타케 란", "도망쳐！！"
			CALL MESSAGE_WINDOW_D, "", "＞란이 손에 무기로 쥐고 있던 접이식 의자를 던진다. /＞정확히 날아온 의자가 당신을 맞춰 뒤로 밀쳐낸다."
			CALL MESSAGE_WINDOW_D, "", "＞빈틈이 생겼다…소녀들이 무대 뒤로 도망친다/＞놓칠 수 없다"
			CALL MESSAGE_WINDOW_D, "미타케 란", "으윽！！"
			CALL MESSAGE_WINDOW_D, "", "＞의자를 던진 란의 손목을 잡아 끌었다. 균형을 잃은 란이 바닥에 쓰러졌다"
			CALL MESSAGE_WINDOW_D, "우에하라 히마리", "란을 도와야…！"
			CALL MESSAGE_WINDOW_D, "미타케 란", "오지 마！/내가 할 수 있어…내가…너희들을 지킬 거야！"
			CALL MESSAGE_WINDOW_D, "", "＞란이 이를 악물고 일어났다/＞……！란의 모습이 심상치 않다"
			CALL MESSAGE_WINDOW_D, "미타케 란", "아악！ 으윽…"
			CALL MESSAGE_WINDOW_D, "", "＞나는 그대. 그대는 나. 이를 악문 란이 당신의 앞을 가로막고 섰다/＞란의 머리 위로 페르소나가 나타났다"
			CALL MESSAGE_WINDOW_D, "아오바 모카", "란의 머리 위에…뭔가가 떠 있어"
			CALL MESSAGE_WINDOW_D, "미타케 란", "이건…뭐지？/어째서인지 힘이 느껴져"
			CALL MESSAGE_WINDOW_D, "미타케 란", "아무래도 상관 없어. 나는 이 힘으로 널 막을 테니까/너는 이 앞으로 한 발자국도 못 와！"
			CALL MESSAGE_WINDOW_D, "", "＞아무래도 싸울 수밖에 없다. 당신은 무기를 겨누었다"
 			
			FLAG:도주불가플래그 = 1
			FLAG:회화불능플래그 = 1
			FLAG:선제기습취소 = 1
			CUSTOMDRAWLINE =
			WAIT
			CALL SET_ENEMY,9,7900,18,0,1 ;미타케 란
			EQUIP:(CHARANUM-1):몸통 = [[아이템:보스의갑옷]]
			EQUIP:(CHARANUM-1):악세사리 = [[아이템:스테미너벨트]]
			;CFLAG:(CHARANUM-1):ＨＰ보정 += 500
			CFLAG:(CHARANUM-1):ＭＰ보정 += 3000
			EQUIP:(CHARANUM-1):검 = 2008
			MAXBASE:(CHARANUM-1):힘   += 12
			MAXBASE:(CHARANUM-1):지혜 += 18
			MAXBASE:(CHARANUM-1):마력 += 15
			MAXBASE:(CHARANUM-1):인내력 += 9
			MAXBASE:(CHARANUM-1):속도 += 11
			MAXBASE:(CHARANUM-1):운   += 7
			CFLAG:(CHARANUM-1):행동횟수 = 2
			MAXBASE:(CHARANUM-1):파마 = 0
			MAXBASE:(CHARANUM-1):주살 = 0
			ABL:(CHARANUM-1):스킬1 = 1416
			ABL:(CHARANUM-1):스킬2 = 14
			ABL:(CHARANUM-1):스킬3 = 507
			ABL:(CHARANUM-1):스킬4 = 110
			ABL:(CHARANUM-1):스킬5 = 105
			EQUIP:(CHARANUM-1):검 = 2001
			CALL SYNC_STATUS,(CHARANUM-1)
			CALL HEALTH_CHARA,(CHARANUM-1)
			CALL BATTLE_START
			FLAG:도주불가플래그 = 0
			FLAG:회화불능플래그 = 0
			FLAG:선제기습취소 = 0
			
			CALL MESSAGE_WINDOW_D, "미타케 란", "아아악！ 제기랄！"
			CALL MESSAGE_WINDOW_D, "", "＞지금 막 페르소나 능력에 각성한 초심자다/＞기합만으로 상대가 될 리가 없다"
			CALL MESSAGE_WINDOW_D, "", "＞Afterglow 멤버들의 「석양의 괴도단」은 확실히 개심과도, 페르소나와도 관계가 없었다./＞하지만 지금 그녀들 중 한 명이 페르소나 사용자로 각성했다"
			CALL MESSAGE_WINDOW_D, "", "＞란은 데려갈 가치가 있을 지도 모른다/＞이미 다른 네 명은 도망쳐버렸지만"
			CALL MESSAGE_WINDOW_D, "미타케 란", "뭐야. 나를 잡아가려고？/소용 없어. 내 친구들은 벌써 다 도망쳤으니까. 그거면 된 거야…"
			CALL MESSAGE_WINDOW_D, "", "＞당신은 기절한 미타케 란을 데리고, 스마일 호를 빠져나왔다/＞스마일 호에 있던 현금을 챙겨 ￥10000을 얻었다. 명성 20을 얻었다."
			
			CALL ADD_NEW_COMPANION,7900,200
			
			MONEY += 10000
			FLAG:명성 += 20
			DA:(FLAG:현X):(FLAG:현Y) = 1
			이벤트플래그:78:0 = 3
			FLAG:탈출 = 1
			RETURN 1
	ENDSELECT
	
ELSEIF DA:(FLAG:현X):(FLAG:현Y) %10 == 9
	SELECTCASE DA:(FLAG:현X):(FLAG:현Y) /10
		CASE 100
			CALL MESSAGE_WINDOW_D, "", "＞고가로 보이는 피아노가 있다/＞핏자국이 남아 있다"
			RETURN 1
	ENDSELECT
ENDIF
RETURN 0

;=======================================================================
;宝箱の中身
;=======================================================================
@TREASURE_98
#LOCALSIZE 3
;宝箱のフラグ管理用変数の번호
LOCAL = FLAG:현M + 70
;そのマップの何番눈の宝箱か
LOCAL:1 = (DA:(FLAG:현X):(FLAG:현Y) / 10) % 100

;/10はIDを10で割る。つまり、下一桁をなくして、二桁눈と三桁눈を二桁の数字として取り出している
SELECTCASE DA:(FLAG:현X):(FLAG:현Y) / 10
	CASE 0
		CALL GET_TREASURE, [[아이템:외상약]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
	CASE 1
		CALL GET_TREASURE, [[아이템:스킬카드【아쿠아】]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
	;２Ｆ
	CASE 100
		CALL GET_TREASURE_MAG, , 100 , FLAG:현던전, LOCAL , LOCAL:1
	CASE 101
		CALL GET_TREASURE, [[아이템:보옥]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
	CASE 102
		CALL GET_TREASURE, [[아이템:스킬카드【디아라마】]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
	CASE 200
		CALL GET_TREASURE, [[아이템:스킬카드【타루・카쟈】]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
	CASE 201
		CALL GET_TREASURE, [[아이템:갖지못한자의반지]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
	;３Ｆ
	CASE 300
		CALL GET_TREASURE, [[아이템:힘의향]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
	CASE 301
		CALL GET_TREASURE, [[아이템:스킬카드【그라이】]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
	CASE 302
		CALL GET_TREASURE_MAG, , 50 , FLAG:현던전, LOCAL , LOCAL:1
	CASE 303
		CALL GET_TREASURE, [[아이템:디스포이즌]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
	CASE 304
		CALL GET_TREASURE, [[아이템:마력의향]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
ENDSELECT
RETURN 1

;=======================================================================
;階段置き場
;=======================================================================
;上り階段処理
@UPSTAIRS_98
SELECTCASE FLAG:현M
	CASE 0
		SIF FLAG:현X == 9 && FLAG:현Y == 9
			CALL DUNGEON_UPSTAIRS,1,14,3
	CASE 1
		SIF FLAG:현X == 14 && FLAG:현Y == 19
			CALL DUNGEON_UPSTAIRS,2,3,2
	CASE 2
		SIF FLAG:현X == 14 && FLAG:현Y == 18
			CALL DUNGEON_UPSTAIRS,3,12,2
	CASE 3
		SIF FLAG:현X == 20 && FLAG:현Y == 18
			CALL DUNGEON_UPSTAIRS,4,6,8
	CASEELSE
ENDSELECT
RETURN 1

;下り階段処理
@DOWNSTAIRS_98
SELECTCASE FLAG:현M
	CASE 1
		SIF FLAG:현X == 14 && FLAG:현Y == 2
			CALL DUNGEON_DOWNSTAIRS,0,9,8
	CASE 2
		SIF FLAG:현X == 3 && FLAG:현Y == 1
			CALL DUNGEON_DOWNSTAIRS,1,14,18
	CASE 3
		SIF FLAG:현X == 12 && FLAG:현Y == 1
			CALL DUNGEON_DOWNSTAIRS,2,14,17
	CASE 4
		SIF FLAG:현X == 6 && FLAG:현Y == 9
			CALL DUNGEON_DOWNSTAIRS,3,20,19
		CASEELSE
ENDSELECT
RETURN 1