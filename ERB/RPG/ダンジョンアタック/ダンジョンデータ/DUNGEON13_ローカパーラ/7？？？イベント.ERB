;=======================================================================
;指定したマスに進入可能か
;=======================================================================
@SEISIN_ENTER,ARG,ARG:1
;DA:ARG:(ARG:1)
;ARG、ARG:1はそれぞれ대상のマスのX、Y座標を表しています。
;この던전ではエレベーターの扉が一度右側から開けておかないと左側からは開けられない、という処理に사용しています。
SELECTCASE FLAG:現M
	CASE 35
		IF ARG == 16 && ARG:1 == 9 && 던전フラグ:13:15 < 7
			CALL MESSAGE_WINDOW_D, "", "＞05의 마크의 문은 닫혀 있다"
			RETURN 0
		ENDIF
	CASE 9
		IF ARG == 3 && ARG:1 == 4 && 던전フラグ:13:4 < 14
			CALL MESSAGE_WINDOW_D, "", "＞엘리베이터다"
			CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀 있다"
			RETURN 0
		ENDIF
		
ENDSELECT
RETURN 1
;=======================================================================
;정신세계タイル
;=======================================================================
;이벤트タイル特殊표시4
@SEISIN_TILE, ARG
SELECTCASE ARG / 10
	CASEELSE
		RESULTS = ！
ENDSELECT

;이벤트タイル特殊표시9
@SEISIN_TILE2, ARG , ARG:1 , ARG:2
SELECTCASE ARG / 10
	CASEELSE
		RESULTS = □
ENDSELECT

;=======================================================================
;정신세계調べ이벤트(4)
;=======================================================================
@SEISIN_event_sw

SELECTCASE DA:(FLAG:現X):(FLAG:現Y) / 10
	CASE 4000
		CALL MESSAGE_WINDOW_D, "", "다른 적들은 일단 물러났지만…/곧 되돌아오겠지 "
		CALL MESSAGE_WINDOW_D, "", "뭐 그때는 또/되돌려보내주자 "
ENDSELECT


;=======================================================================
;정신세계調べ이벤트(9)
;=======================================================================
@SEISIN_event2_sw
;=======================================================================
;정신세계侵入이벤트(4)
;=======================================================================
@SEISIN_event
#LOCALSIZE 3

SELECTCASE DA:(FLAG:現X):(FLAG:現Y) / 10
	CASE 4400
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),30,31
	CASE 4401
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),20,31
	CASE 4402
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),30,17
	CASE 4403
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M)+1,31,21
		
	CASE 4528
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),12,11
		SIF GETBIT(FLAG:발견ED, 45)
			CALL DUNGEON_WORP,(FLAG:現M),20,17
;------------------------------------------------------------------------
	CASE 4506
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),12,11
	CASE 4507
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),18,11
;------------------------------------------------------------------------
	CASE 4501
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),12,11
	CASE 4502
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),25,14
;------------------------------------------------------------------------
	CASE 4504
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),26,17
	CASE 4505
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),18,11
;------------------------------------------------------------------------
	CASE 4514
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),28,26
	CASE 4517
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),25,14
;------------------------------------------------------------------------
	CASE 4521
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),18,25
	CASE 4524
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),25,14
;------------------------------------------------------------------------
	CASE 4520
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),26,17
	CASE 4525
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),14,25
;------------------------------------------------------------------------
	CASE 4526
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),26,17
	CASE 4527
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),13,17
;------------------------------------------------------------------------
	CASE 4513
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),12,27
	CASE 4516
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),12,11
;------------------------------------------------------------------------
	CASE 4518
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),13,17
	CASE 4519
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),29,28
;------------------------------------------------------------------------
	CASE 4522
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),14,21
	CASE 4523
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),13,17
;------------------------------------------------------------------------
	CASE 4509
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),29,22
	CASE 4510
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),13,17
;------------------------------------------------------------------------
	CASE 4508
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),13,17
	CASE 4511
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),15,13
;------------------------------------------------------------------------
	CASE 4500
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),13,17
	CASE 4503
		CALL MESSAGE_WINDOW_D, "", "워프존이다！ "
		CALL DUNGEON_WORP,(FLAG:現M),20,17
		
		
;------------------------------------------------------------------------
;ボス前
	CASE 4515
		CALL MESSAGE_WINDOW_D, "", "저편에서 무서운 낌새를 느꼈다 "
		CALL INPUT_SELECT_D, "[1]안으로 들어간다/[0]가지 않는다 "
		IF RESULT == 1
			CALL DUNGEON_WORP,(FLAG:現M),(FLAG:現X),(FLAG:現Y)-2
		ELSE
			CALL DUNGEON_WORP,(FLAG:現M),(FLAG:現X),(FLAG:現Y)+1
		ENDIF
;ボス戦
	CASE 4512
				CALL MESSAGE_WINDOW_D, "악마", "흐음… 이 아가씨의 지식을 쓰기 위해서 최면처럼 조종했는데…/설마 이 정신세계에 들어올 줄이야… "
				CALL MESSAGE_WINDOW_D, "악마", "이 몸은 다신연합의 한 기둥 바엘/나도 신에 의해 권위를 빼앗긴것이다/그것을 다시 빼앗기위해 싸우고있다 "
				CALL MESSAGE_WINDOW_D, "악마", "그것을 방해한다면/이 자리에서 지워버리지 "
				
				FLAG:도주불가플래그 = 1
				FLAG:회화불능플래그 = 1
				FLAG:선제기습취소 = 1
				
				CALL SET_ENEMY,9,270,70,0,2
				CFLAG:(CHARANUM-1):행동횟수 = 3
				CFLAG:(CHARANUM-1):ＭＰ보정 = 4000
				CFLAG:(CHARANUM-1):속도보정 = 0
				CFLAG:(CHARANUM-1):명중보정 = 100
				CFLAG:(CHARANUM-1):810 = 800
				CSTR:(CHARANUM-1):사고패턴 = ローカバエル
				ABL:(CHARANUM-1):스킬1 = 1043;림도라온
				ABL:(CHARANUM-1):스킬2 = 326 ;まるかじり
				ABL:(CHARANUM-1):스킬3 = 256;아그네야스트라
				ABL:(CHARANUM-1):스킬4 = 524 ;파워브레스
				ABL:(CHARANUM-1):스킬5 = 523;랜더마이저
				ABL:(CHARANUM-1):스킬6 = 2003;메기도라온
				CFLAG:(CHARANUM-1):BS무효플래그 = 1
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
			
				CALL BATTLE_START
			FLAG:도주불가플래그 = 0
			FLAG:회화불능플래그 = 0
			FLAG:선제기습취소 = 0
			FLAG:인카운터율 = 0
			FLAG:未遭遇歩数 = 0
			
				CALL MESSAGE_WINDOW_D, "악마", "바보같은…이몸의…풍양이… "
				CALL MESSAGE_WINDOW_D, "", "악마는 사라져 갔다 "
				CALL MESSAGE_WINDOW_D, "모르가나", "좋아、이것으로 돌아갈 수 있겠어 "
				CALL MESSAGE_WINDOW_D, "", "모르가나로부터 받은 앱을 사용하여 되돌아왔다 "
				CALL DUNGEON_WORP,0,14,18
			던전フラグ:13:1 = 11
			CALL MESSAGE_WINDOW_D, "모르가나", "이것으로 후타바는 무사하다구 "
			CALL MESSAGE_WINDOW_D, "모르가나", "하지만… 상당히 위험한 악마였으니까/정신에 상당한 데미지가 있어 "
			CALL MESSAGE_WINDOW_D, "모르가나", "그래도 안심해/잠시 자면 건강해질거야 "
			CALL MESSAGE_WINDOW_D, "모르가나", "…언제 일어날지는 모르겠지만 말야… "
				CALL MESSAGE_WINDOW_D, "", @"＞명성 250을 얻었다"
				FLAG:명성 += 250
	CASE 405
		IF 던전フラグ:13:2 < 7
			CALL MESSAGE_WINDOW_D, "프레드", "부탁해！/도와줘… "
			;この命令で이벤트は破壊され、ただの床になる
			DA:(FLAG:現X):(FLAG:現Y) = 1
			던전フラグ:13:2 = 7
		ENDIF
ENDSELECT
;=======================================================================
;정신세계侵入이벤트（9）
;=======================================================================
@SEISIN_event2
SELECTCASE DA:(FLAG:現X):(FLAG:現Y) / 10
	CASE 4000
		CALL DUNGEON_WORP,(FLAG:現M)+2,12,45
	CASE 4204
		CALL DUNGEON_WORP,(FLAG:現M)-2,3,1
	CASE 4200
		CALL MESSAGE_WINDOW_D, "", "통제실 같은 곳에 도착했다 "
	CASE 100
		CALL DUNGEON_WORP,(FLAG:現M),(FLAG:現X),(FLAG:現Y)
		CALL DUNGEON_WORP,2,3,22
ENDSELECT
SIF (FLAG:現X) == 0
	CALL DUNGEON_WORP,(FLAG:現M),(FLAG:現X)+38,(FLAG:現Y)
SIF (FLAG:現Y) == 0
	CALL DUNGEON_WORP,(FLAG:現M),(FLAG:現X),(FLAG:現Y)+38
SIF (FLAG:現X) == 39
	CALL DUNGEON_WORP,(FLAG:現M),(FLAG:現X)-38,(FLAG:現Y)
SIF (FLAG:現Y) == 39
	CALL DUNGEON_WORP,(FLAG:現M),(FLAG:現X),(FLAG:現Y)-38

;=======================================================================
;정신세계宝箱
;=======================================================================
@SEISIN_takara
#LOCALSIZE 3
;宝箱のフラグ管理用変数の番号
LOCAL = FLAG:現M / 5 + 80
;そのマップの何番눈の宝箱か
LOCAL:1 = (DA:(FLAG:現X):(FLAG:現Y) / 10) % 100
LOCAL:1 += FLAG:現M % 5 * 10

SELECTCASE DA:(FLAG:現X):(FLAG:現Y) / 10
	CASE 4200
		CALL GET_TREASURE, [[아이템:암리타샤워]] , 1 , FLAG:現던전, LOCAL , LOCAL:1
	CASE 4201
		CALL GET_TREASURE, [[아이템:중압의곡옥]] , 1 , FLAG:現던전, LOCAL , LOCAL:1
	CASE 4202
		CALL GET_TREASURE, [[아이템:마반경]] , 1 , FLAG:現던전, LOCAL , LOCAL:1
	CASE 4100
		CALL GET_TREASURE_MONEY , 0 , 300000 , FLAG:現던전, LOCAL , LOCAL:1
	CASE 4203
		CALL GET_TREASURE, 11103 , 1 , FLAG:現던전, LOCAL , LOCAL:1
	;マップ番号*100+そのマップで何番눈の宝箱かを示す数値でどの宝箱かを判別します。
	;例えば0の場合、0版のマップの0番눈の宝箱であることを表しています。

ENDSELECT
RETURN 1
;=======================================================================
;정신세계적
;=======================================================================
@SEISIN_enemy, ARG
		IF ARG == 0
			IF FLAG:現M == 44
				SIF RAND:6 == 0		
					RETURN [[キャラ:에스]]		
				SIF RAND:5 == 0		
					RETURN [[キャラ:모르간]]		
				SIF RAND:4 == 0		
					RETURN [[キャラ:베탈라]]		
				SIF RAND:3 == 0		
					RETURN [[キャラ:북두성군]]		
				SIF RAND:2 == 0		
					RETURN [[キャラ:도플갱어]]		
							
					RETURN [[キャラ:도철]]
			ELSEIF FLAG:現M == 45 && (FLAG:現X < 9 || FLAG:現X > 30) && (FLAG:現Y < 9 || FLAG:現Y > 30)
				
				SIF RAND:6 == 0		
					RETURN [[キャラ:이시스]]		
				SIF RAND:5 == 0		
					RETURN [[キャラ:헤임달]]		
				SIF RAND:4 == 0		
					RETURN [[キャラ:마야(용신)]]		
				SIF RAND:3 == 0		
					RETURN [[キャラ:보후・마나흐]]		
				SIF RAND:2 == 0		
					RETURN [[キャラ:레토]]		
							
					RETURN [[キャラ:카마엘]]
			ELSEIF FLAG:現M == 45
				SIF RAND:16 == 0		
					RETURN [[キャラ:헤임달]]		
				SIF RAND:15 == 0		
					RETURN [[キャラ:마야(용신)]]		
				SIF RAND:14 == 0		
					RETURN [[キャラ:에스]]		
				SIF RAND:13 == 0		
					RETURN [[キャラ:베탈라]]		
				SIF RAND:5 == 0		
					RETURN [[キャラ:이시스]]		
				SIF RAND:4 == 0		
					RETURN [[キャラ:모르간]]		
				SIF RAND:3 == 0		
					RETURN [[キャラ:아즈라엘]]		
				SIF RAND:2 == 0		
					RETURN [[キャラ:아누비스]]		
				
					RETURN [[キャラ:오시리스]]		
				
			ENDIF
				SIF RAND:15 == 0		
					RETURN [[キャラ:에스]]		
				SIF RAND:14 == 0		
					RETURN [[キャラ:모르간]]		
				SIF RAND:13 == 0		
					RETURN [[キャラ:베탈라]]		
				SIF RAND:12 == 0		
					RETURN [[キャラ:북두성군]]		
				SIF RAND:11 == 0		
					RETURN [[キャラ:도플갱어]]		
				SIF RAND:10 == 0	
					RETURN [[キャラ:도철]]
				SIF RAND:9 == 0		
					RETURN [[キャラ:이시스]]		
				SIF RAND:8 == 0		
					RETURN [[キャラ:헤임달]]		
				SIF RAND:7 == 0		
					RETURN [[キャラ:마야(용신)]]		
				SIF RAND:6 == 0		
					RETURN [[キャラ:보후・마나흐]]		
				SIF RAND:5 == 0		
					RETURN [[キャラ:레토]]		
				SIF RAND:4 == 0	
					RETURN [[キャラ:아즈라엘]]
				SIF RAND:3 == 0		
					RETURN [[キャラ:아즈라엘]]		
				SIF RAND:2 == 0		
					RETURN [[キャラ:아누비스]]		
				
					RETURN [[キャラ:오시리스]]		
		ELSEIF ARG == 1
			SIF FLAG:現M == 44
				RETURN 57 + RAND:4
				
				RETURN 60 + RAND:4
		ENDIF
;=======================================================================
;정신세계적스테이터스설정
;=======================================================================
@SEISIN_ENEMY_STATUS,ARG

SIF FLAG:現M > 45
	RETURN 0
SELECTCASE NO:ARG
	CASE [[キャラ:오시리스]]
		ABL:(CHARANUM-1):스킬1 = 2003;메기도라
		ABL:(CHARANUM-1):스킬2 = 603;마카라칸
		ABL:(CHARANUM-1):스킬3 = 1317;마하코우하
		ABL:(CHARANUM-1):스킬4 = 1310;티없는위광
		ABL:(CHARANUM-1):스킬5 = 1414;천년의저주
		ABL:(CHARANUM-1):스킬6 = 1420;에이가온
	CASE [[キャラ:아누비스]]
		ABL:(CHARANUM-1):스킬1 = 1304;빛의심판
		ABL:(CHARANUM-1):스킬2 = 1406;어둠의심판
		ABL:(CHARANUM-1):스킬3 = 2416;마카카쟈오토
		ABL:(CHARANUM-1):스킬4 = 503;마카카쟈
		ABL:(CHARANUM-1):스킬5 = 1304;빛의심판
		ABL:(CHARANUM-1):스킬6 = 1406;어둠의심판
	CASE [[キャラ:아즈라엘]]
		ABL:(CHARANUM-1):스킬1 = 2002;메기도라
		ABL:(CHARANUM-1):스킬2 = 1412;무도온
		ABL:(CHARANUM-1):스킬3 = 508;스쿤・다
		ABL:(CHARANUM-1):스킬4 = 1308;하마온
		ABL:(CHARANUM-1):스킬5 = 1405;헬즈아이
		ABL:(CHARANUM-1):스킬6 = 718;트리스아기온
	CASE [[キャラ:레토]]
		ABL:(CHARANUM-1):스킬1 = 1304;빛의심판
		ABL:(CHARANUM-1):스킬2 = 512;컨센트레이트
		ABL:(CHARANUM-1):스킬3 = 1309;마한마온
		ABL:(CHARANUM-1):스킬4 = 1338;혼의단죄
		ABL:(CHARANUM-1):스킬5 = 2038;빛나는낙인
		ABL:(CHARANUM-1):스킬6 = 1330;멸망의빛
	CASE [[キャラ:카마엘]]
		ABL:(CHARANUM-1):스킬1 = 2415;라쿠카쟈오토
		ABL:(CHARANUM-1):스킬2 = 1308;하마온
		ABL:(CHARANUM-1):스킬3 = 1309;마한마온
		ABL:(CHARANUM-1):스킬4 = 316;흑점격
		ABL:(CHARANUM-1):스킬5 = 261;낙인의일격
		ABL:(CHARANUM-1):스킬6 = 149;세이크리드애로
		ABL:(CHARANUM-1):스킬7 = 1231;파마가드킬
	CASE [[キャラ:보후・마나흐]]
		ABL:(CHARANUM-1):스킬1 = 1304;빛의심판
		ABL:(CHARANUM-1):스킬2 = 1317;마하코우하
		ABL:(CHARANUM-1):스킬3 = 1309;마한마온
		ABL:(CHARANUM-1):스킬4 = 406;메・디아라한
		ABL:(CHARANUM-1):스킬5 = 2038;빛나는낙인
		ABL:(CHARANUM-1):스킬6 = 1313;댐네이션
		ABL:(CHARANUM-1):스킬7 = 1231;파마가드킬
	CASE [[キャラ:마야(용신)]]
		ABL:(CHARANUM-1):스킬1 = 205;메가톤프레스
		ABL:(CHARANUM-1):스킬2 = 1816;마그네스톰
		ABL:(CHARANUM-1):스킬3 = 12;광란의강조
		ABL:(CHARANUM-1):스킬4 = 406;메・디아라한
		ABL:(CHARANUM-1):스킬5 = 2038;빛나는낙인
		ABL:(CHARANUM-1):스킬6 = 1313;댐네이션
	CASE [[キャラ:헤임달]]
		ABL:(CHARANUM-1):스킬1 = 1708;선풍진
		ABL:(CHARANUM-1):스킬2 = 808;아이온의비
		ABL:(CHARANUM-1):스킬3 = 316;흑점격
		ABL:(CHARANUM-1):스킬4 = 806;마하・부흐다인
		ABL:(CHARANUM-1):스킬5 = 2038;빛나는낙인
		ABL:(CHARANUM-1):스킬6 = 1338;혼의단죄
	CASE [[キャラ:이시스]]
		ABL:(CHARANUM-1):스킬1 = 2002;메기도라
		ABL:(CHARANUM-1):스킬2 = 808;아이온의비
		ABL:(CHARANUM-1):스킬3 = 541;사만・다
		ABL:(CHARANUM-1):스킬4 = 806;마하・부흐다인
		ABL:(CHARANUM-1):스킬5 = 1306;헤븐즈도어
		ABL:(CHARANUM-1):스킬6 = 1313;댐네이션
		ABL:(CHARANUM-1):스킬7 = 1232;파마가드브레이크
	CASE [[キャラ:도철]]
		ABL:(CHARANUM-1):스킬1 = 258;네거티브파일
		ABL:(CHARANUM-1):스킬2 = 1422;마하주온
		ABL:(CHARANUM-1):스킬3 = 1405;헬즈아이
		ABL:(CHARANUM-1):스킬4 = 326;베어먹기
		ABL:(CHARANUM-1):스킬5 = 1413;마하무도온
	CASE [[キャラ:에스]]
		ABL:(CHARANUM-1):스킬1 = 1006;마하・잔다인
		ABL:(CHARANUM-1):스킬2 = 1423;저주비문
		ABL:(CHARANUM-1):스킬3 = 1815;스펠그룸
		ABL:(CHARANUM-1):스킬4 = 405;메・디아라마
		ABL:(CHARANUM-1):스킬5 = 515;도발
		ABL:(CHARANUM-1):스킬6 = 1422;마하주온
	CASE [[キャラ:모르간]]
		ABL:(CHARANUM-1):스킬1 = 1005;마하・잔마
		ABL:(CHARANUM-1):스킬2 = 1423;저주비문
		ABL:(CHARANUM-1):스킬3 = 1605;마하・아쿠에스
		ABL:(CHARANUM-1):스킬4 = 405;메・디아라마
		ABL:(CHARANUM-1):스킬5 = 515;도발
		ABL:(CHARANUM-1):스킬6 = 1425;나락의파동
		ABL:(CHARANUM-1):스킬7 = 1432;주살가드브레이크
	CASE [[キャラ:베탈라]]
		ABL:(CHARANUM-1):스킬1 = 259;철사권
		ABL:(CHARANUM-1):스킬2 = 148;데스샤워
		ABL:(CHARANUM-1):스킬3 = 524;파워브레스
		ABL:(CHARANUM-1):스킬4 = 405;메・디아라마
		ABL:(CHARANUM-1):스킬5 = 515;도발
		ABL:(CHARANUM-1):스킬6 = 315;배드비트
	CASE [[キャラ:북두성군]]
		ABL:(CHARANUM-1):스킬1 = 259;철사권
		ABL:(CHARANUM-1):스킬2 = 1423;저주비문
		ABL:(CHARANUM-1):스킬3 = 1425;나락의파동
		ABL:(CHARANUM-1):스킬4 = 1406;어둠의심판
		ABL:(CHARANUM-1):스킬5 = 1403;축시의참배
		ABL:(CHARANUM-1):스킬6 = 1431;주살가드킬
	CASE [[キャラ:도플갱어]]
		ABL:(CHARANUM-1):스킬1 = 259;철사권
		ABL:(CHARANUM-1):스킬2 = 705;마하・라기온
		ABL:(CHARANUM-1):스킬3 = 405;메・디아라마
		ABL:(CHARANUM-1):스킬4 = 1402;마하무도
		ABL:(CHARANUM-1):스킬5 = 1413;마하무도온
		ABL:(CHARANUM-1):스킬6 = 1431;주살가드킬
ENDSELECT

@SET_ACTION_ローカバエル,ARG
IF CFLAG:ARG:행동한횟수 == 0 && (FLAG:경과턴수 % 4 == 0 || (FLAG:경과턴수 % 2 == 0 && 現HP割合(ARG) <= 33))
	LOCAL = 0
	FOR LOCAL:1, 1, 11
		CALL RANDOM_TARGET,ARG,2511
		IF CFLAG:POS(CFLAG:ARG:타겟):ステート != GET_STATE_NUM("FLY")
			CFLAG:ARG:입력행동 = 2511
			RETURN 1
		ENDIF
	NEXT
		FOR LOCAL, 1, 7
			SIF POS(LOCAL) < 0
				CONTINUE
			SIF GET_STATE(CFLAG:POS(LOCAL):ステート) == "DYING"
				CONTINUE
			IF CFLAG:POS(LOCAL):ステート != GET_STATE_NUM("FLY")
				CFLAG:ARG:타겟 = LOCAL
				CFLAG:ARG:입력행동 = 2511
				RETURN 1
			ENDIF
		NEXT
	GOTO TWO_ACTION
ELSE
	$TWO_ACTION
	LOCAL = 0
	SIF CFLAG:ARG:공격강화 < 0
		LOCAL -= CFLAG:ARG:공격강화
	SIF CFLAG:ARG:방어강화 < 0
		LOCAL -= CFLAG:ARG:방어강화
	SIF CFLAG:ARG:마법위력강화 < 0
		LOCAL -= CFLAG:ARG:마법위력강화
	SIF CFLAG:ARG:마법효과강화 < 0
		LOCAL -= CFLAG:ARG:마법효과강화
	SIF CFLAG:ARG:명중강화 < 0
		LOCAL -= CFLAG:ARG:명중강화/2
	SIF CFLAG:ARG:회피강화 < 0
		LOCAL -= CFLAG:ARG:회피강화/2
	IF CFLAG:ARG:행동한횟수 == 0 && ((1 + RAND:100 < LOCAL) || (FLAG:경과턴수 % 10 == 9))
		CFLAG:ARG:입력행동 = 2512
		CALL RANDOM_TARGET,ARG,2512
		RETURN 1
	ENDIF
	
		$DECIDE_ACTION
		CALL SEARCH_ACT,ARG
		IF RESULT == 0
			CFLAG:ARG:입력행동 = -1
			CFLAG:ARG:방어플래그 = 1
			RETURN 0
		ENDIF
;		PRINTFORML [{CFLAG:ARG:5}]の스킬数 {RESULT}
		LOCAL = RAND:RESULT
		;스킬番号決定
		LOCAL:1 = S:(10+LOCAL)
;		PRINTFORML [{CFLAG:ARG:5}]の스킬 {LOCAL:1}
		$TARGET_LOOP
		
		CALL RANDOM_TARGET,ARG,LOCAL:1
		CALLFORM SKILL_TARGET_{LOCAL:1}
		;ここで스킬番号を行動内容に代入
		SIF CFLAG:ARG:타겟 == -1
			GOTO DECIDE_ACTION
		CFLAG:ARG:입력행동 = LOCAL:1
	
	
	
	
ENDIF
