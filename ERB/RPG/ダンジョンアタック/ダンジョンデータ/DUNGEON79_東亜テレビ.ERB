
;=======================================================================

;던전플래그:79:0 = 1.クリアフラグ
;던전플래그:79:1 = 1.初回
;던전플래그:79:2 = 1.中ボス撃破
;던전플래그:79:10- = 1.宝箱

;博物館クリア後に出現、おおむね原作通りの구조
;処理がごちゃごちゃしている統一感０、とりあえず動作はしているはず
;フリーなんで適当に改変してください、というか修正して欲しい
;宝は原作通り、ないのはそれっぽいの

;=======================================================================
;攻略조건
;=======================================================================
@PREREQUISITE_DUNGEON_79
IF  던전플래그:86:0 == 1 & !던전플래그:79:0
	RETURN 1
ENDIF

;=======================================================================
;던전名
;=======================================================================
@GET_DUNGEON_NAME_79
RESULTS = 토우아TV

;=======================================================================
;플로어名표시
;=======================================================================
@FLOORNAME_79
PRINT  토우아TV
SELECTCASE FLAG:현M
	CASE 0
		PRINTL 1F
	CASE 1
		PRINTL 2F
	CASE 2
		PRINTL 3F
	CASE 3
		PRINTL 4F
	CASE 4
		PRINTL 5F
	CASE 5
		PRINTL 6F
	CASE 6
		PRINTL 7F
	CASE 7
		PRINTL 8F
	CASE 8
		PRINTL 전파탑・1F
	CASE 9
		PRINTL 전파탑・4F
	CASE 10
		PRINTL 전파탑・8F
	CASE 11
		PRINTL 전파탑・13F
	CASE 12
		PRINTL 전파탑・15F
	CASE 13
		PRINTL 전파탑・17F
	CASE 14
		PRINTL 전파탑・19F
	CASE 15
		PRINTL 전파탑・20F
	CASEELSE
		PRINTL
ENDSELECT
;=======================================================================
;スタート地点입력
;=======================================================================
@START_DUNGEON_79,ARG
FLAG:현M = 0
FLAG:현X = 7
FLAG:현Y = 1

;=======================================================================
;スタート時이벤트
;=======================================================================
@EVENT_DUNGEON_START_79
IF 던전플래그:79:1 == 0
	CALL SHOW_PICTURE, "NONFLOORD"
	CALL MESSAGE_WINDOW_D, "", @"＞%조사처리(CALLNAME:MASTER,"는")% 이계화한 토우아TV의 조사의뢰를 받았다/＞토우아TV가 악마에게 점령당한 것 같다/＞신속하게 대상을 찾아내 처리해야 할 것이다"
	던전플래그:79:1 = 1
ENDIF

;=======================================================================
;플로어데이터
;=======================================================================
@MAKE_FLOOR_79
SELECTCASE FLAG:현M
	CASE 0
		FLAG:최대X = 17 
		FLAG:최대Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 6     8   11126 "
		CALL MAKE_FLOOR_LINE, 2," 2     2   111   "
 		CALL MAKE_FLOOR_LINE, 3," 111   1   111   "
		CALL MAKE_FLOOR_LINE, 4," 111   1   2     "
		CALL MAKE_FLOOR_LINE, 5," 11121 1 111     "
		CALL MAKE_FLOOR_LINE, 6,"     1 2 1       "
		CALL MAKE_FLOOR_LINE, 7,"     11111       "
		CALL MAKE_FLOOR_LINE, 8,"       111       "
		CALL MAKE_FLOOR_LINE, 9,"       11111     "
		CALL MAKE_FLOOR_LINE,10,"       1 2 1     "
		CALL MAKE_FLOOR_LINE,11,"     111 1 12111 "
		CALL MAKE_FLOOR_LINE,12,"     2   1   111 "
		CALL MAKE_FLOOR_LINE,13,"   111   1   111 "
		CALL MAKE_FLOOR_LINE,14,"   111   2     2 "
		CALL MAKE_FLOOR_LINE,15," 62111   1     6 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456
		
		
	CASE 1
		FLAG:최대X = 20 
		FLAG:최대Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 76 111111111 67 "
		CALL MAKE_FLOOR_LINE, 2," 11 1       1 11 "
 		CALL MAKE_FLOOR_LINE, 3," 1111 11111 1111 "
		CALL MAKE_FLOOR_LINE, 4," 1    2   2    1 "
		CALL MAKE_FLOOR_LINE, 5," 1 11115551111 1 "
		CALL MAKE_FLOOR_LINE, 6," 1 1       111 1 "
		CALL MAKE_FLOOR_LINE, 7," 1 1   E21 111 1 "
		CALL MAKE_FLOOR_LINE, 8," 1 2     1     1 "
		CALL MAKE_FLOOR_LINE, 9," 1 111 5141111 1 "
		CALL MAKE_FLOOR_LINE,10," 1 111       1 1 "
		CALL MAKE_FLOOR_LINE,11," 1 11111111121 1 "
		CALL MAKE_FLOOR_LINE,12," 1    2   1    1 "
		CALL MAKE_FLOOR_LINE,13," 1111 115 1 1111 "
		CALL MAKE_FLOOR_LINE,14," 11 1       1 11 "
		CALL MAKE_FLOOR_LINE,15," 76 111111111 67 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456789
		
		CASE 2
		FLAG:최대X = 17 
		FLAG:최대Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 6 7     1111126 "
		CALL MAKE_FLOOR_LINE, 2," 2 2     2   1   "
 		CALL MAKE_FLOOR_LINE, 3," 111     1   127 "
		CALL MAKE_FLOOR_LINE, 4," 1       1       "
		CALL MAKE_FLOOR_LINE, 5," 1   4 41114     "
		CALL MAKE_FLOOR_LINE, 6," 1   1           "
		CALL MAKE_FLOOR_LINE, 7," 12111 E21 5     "
		CALL MAKE_FLOOR_LINE, 8,"     1   1 1     "
		CALL MAKE_FLOOR_LINE, 9,"     5 111 11121 "
		CALL MAKE_FLOOR_LINE,10,"           1   1 "
		CALL MAKE_FLOOR_LINE,11,"     41114 4   1 "
		CALL MAKE_FLOOR_LINE,12,"       1       1 "
		CALL MAKE_FLOOR_LINE,13," 721   1     111 "
		CALL MAKE_FLOOR_LINE,14,"   1   2     2 2 "
		CALL MAKE_FLOOR_LINE,15," 6211111     7 6 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456
		
		
		CASE 3
		FLAG:최대X = 17 
		FLAG:최대Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 7 1         127 "
		CALL MAKE_FLOOR_LINE, 2," 2 1         1   "
 		CALL MAKE_FLOOR_LINE, 3," 111 6211121 111 "
		CALL MAKE_FLOOR_LINE, 4,"           1     "
		CALL MAKE_FLOOR_LINE, 5,"     111111111   "
		CALL MAKE_FLOOR_LINE, 6,"     1       1   "
		CALL MAKE_FLOOR_LINE, 7,"     4 E2111 1   "
		CALL MAKE_FLOOR_LINE, 8,"     1   1 2 1   "
		CALL MAKE_FLOOR_LINE, 9,"     1 311 1 1   "
		CALL MAKE_FLOOR_LINE,10,"     1     1 2   "
		CALL MAKE_FLOOR_LINE,11,"     1111111 6   "
		CALL MAKE_FLOOR_LINE,12,"                 "
		CALL MAKE_FLOOR_LINE,13," 111         111 "
		CALL MAKE_FLOOR_LINE,14,"   1         1 2 "
		CALL MAKE_FLOOR_LINE,15," 721         1 7 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456
		
		CASE 4
		FLAG:최대X = 17 
		FLAG:최대Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 111112111111    "
		CALL MAKE_FLOOR_LINE, 2," 1   1      1    "
 		CALL MAKE_FLOOR_LINE, 3," 1 7 1      1    "
		CALL MAKE_FLOOR_LINE, 4," 1 121      1    "
		CALL MAKE_FLOOR_LINE, 5," 1 6 1      1    "
		CALL MAKE_FLOOR_LINE, 6," 1          1    "
		CALL MAKE_FLOOR_LINE, 7," 111 4 E    1    "
		CALL MAKE_FLOOR_LINE, 8," 2   2 2 1111111 "
		CALL MAKE_FLOOR_LINE, 9," 1   1 121  2  1 "
		CALL MAKE_FLOOR_LINE,10," 1   1 1 1 716 1 "
		CALL MAKE_FLOOR_LINE,11," 123 121 1     1 "
		CALL MAKE_FLOOR_LINE,12,"         1111111 "
		CALL MAKE_FLOOR_LINE,13,"                 "
		CALL MAKE_FLOOR_LINE,14,"                 "
		CALL MAKE_FLOOR_LINE,15,"                 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456
		
		CASE 5
		FLAG:최대X = 17 
		FLAG:최대Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 111112111111    "
		CALL MAKE_FLOOR_LINE, 2," 1   1      1    "
 		CALL MAKE_FLOOR_LINE, 3," 1 6 1      1    "
		CALL MAKE_FLOOR_LINE, 4," 1 121      1    "
		CALL MAKE_FLOOR_LINE, 5," 1 7 1      1    "
		CALL MAKE_FLOOR_LINE, 6," 1   1      1    "
		CALL MAKE_FLOOR_LINE, 7," 11111 E    1    "
		CALL MAKE_FLOOR_LINE, 8,"       2 1111111 "
		CALL MAKE_FLOOR_LINE, 9," 11111 121  2  1 "
		CALL MAKE_FLOOR_LINE,10," 11111 1   617 1 "
		CALL MAKE_FLOOR_LINE,11," 3151121 1     1 "
		CALL MAKE_FLOOR_LINE,12," 11111   1111111 "
		CALL MAKE_FLOOR_LINE,13," 11111           "
		CALL MAKE_FLOOR_LINE,14,"                 "
		CALL MAKE_FLOOR_LINE,15,"                 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456
		
		CASE 6
		FLAG:최대X = 17 
		FLAG:최대Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1," 11111           "
		CALL MAKE_FLOOR_LINE, 2," 1   1           "
 		CALL MAKE_FLOOR_LINE, 3," 1 7 1           "
		CALL MAKE_FLOOR_LINE, 4," 1 121           "
		CALL MAKE_FLOOR_LINE, 5," 1 6 1           "
		CALL MAKE_FLOOR_LINE, 6," 1   1           "
		CALL MAKE_FLOOR_LINE, 7," 11111 E         "
		CALL MAKE_FLOOR_LINE, 8," 2     2 1111111 "
		CALL MAKE_FLOOR_LINE, 9," 11111 1 1  2  1 "
		CALL MAKE_FLOOR_LINE,10," 1   1 1 1 716 1 "
		CALL MAKE_FLOOR_LINE,11," 1 1 1 2 1     1 "
		CALL MAKE_FLOOR_LINE,12," 1 2 11111111111 "
		CALL MAKE_FLOOR_LINE,13," 11111           "
		CALL MAKE_FLOOR_LINE,14,"                 "
		CALL MAKE_FLOOR_LINE,15,"                 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456
		
		CASE 7
		FLAG:최대X = 17 
		FLAG:최대Y = 17 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"   4             "
		CALL MAKE_FLOOR_LINE, 2,"   2             "
 		CALL MAKE_FLOOR_LINE, 3," 111 72111111    "
		CALL MAKE_FLOOR_LINE, 4," 1          2    "
		CALL MAKE_FLOOR_LINE, 5," 1 1111114111    "
		CALL MAKE_FLOOR_LINE, 6," 1 2 1   33      "
		CALL MAKE_FLOOR_LINE, 7," 1 1 1           "
		CALL MAKE_FLOOR_LINE, 8," 1 1 111 5 51111 "
		CALL MAKE_FLOOR_LINE, 9," 1 1   1 2 1 2 1 "
		CALL MAKE_FLOOR_LINE,10," 1 1   1 111 7 1 "
		CALL MAKE_FLOOR_LINE,11," 1 5   1 131   1 "
		CALL MAKE_FLOOR_LINE,12," 1     1 1151111 "
		CALL MAKE_FLOOR_LINE,13," 1111111 1   2 1 "
		CALL MAKE_FLOOR_LINE,14,"         12111 1 "
		CALL MAKE_FLOOR_LINE,15,"                 "
		CALL MAKE_FLOOR_LINE,16,"                 "
		;                        01234567890123456
		
		CASE 8
		FLAG:최대X = 17 
		FLAG:최대Y = 15 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"                 "
		CALL MAKE_FLOOR_LINE, 2,"                 "
		CALL MAKE_FLOOR_LINE,13,"                 "
		CALL MAKE_FLOOR_LINE, 4,"                 "
 		CALL MAKE_FLOOR_LINE, 5,"     11111 111   "
		CALL MAKE_FLOOR_LINE, 6,"     1   1 1 1   "
		CALL MAKE_FLOOR_LINE, 7,"   111 a 1 5 5   "
		CALL MAKE_FLOOR_LINE, 8,"   5   2 2 1 5   "
		CALL MAKE_FLOOR_LINE, 9,"   5   1 b 1 5   "
		CALL MAKE_FLOOR_LINE,10,"   5   1   1 1   "
		CALL MAKE_FLOOR_LINE,11,"   111 11111 1   "
		CALL MAKE_FLOOR_LINE,12,"     1       1   "
		CALL MAKE_FLOOR_LINE,13,"     111111111   "
		CALL MAKE_FLOOR_LINE,14,"                 "
		;                        01234567890123456
		
		CASE 9
		FLAG:최대X = 17 
		FLAG:최대Y = 13 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"                 "
		CALL MAKE_FLOOR_LINE, 2,"                 "
		CALL MAKE_FLOOR_LINE, 3,"                 "
		CALL MAKE_FLOOR_LINE, 4,"                 "
 		CALL MAKE_FLOOR_LINE, 5,"   11123 11111   "
		CALL MAKE_FLOOR_LINE, 6,"   111   1   1   "
		CALL MAKE_FLOOR_LINE, 7,"   111 a 1   1   "
		CALL MAKE_FLOOR_LINE, 8,"   1   2 2   1   "
		CALL MAKE_FLOOR_LINE, 9,"   1   1 b 111   "
		CALL MAKE_FLOOR_LINE,10,"   1   1   111   "
		CALL MAKE_FLOOR_LINE,11,"   11111 32111   "
		CALL MAKE_FLOOR_LINE,12,"                 "
		;                        01234567890123456
		
		CASE 10
		FLAG:최대X = 17 
		FLAG:최대Y = 15 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"                 "
		CALL MAKE_FLOOR_LINE, 2,"     1111111     "
		CALL MAKE_FLOOR_LINE, 3,"     1     2     "
		CALL MAKE_FLOOR_LINE, 4,"     1   111     "
 		CALL MAKE_FLOOR_LINE, 5,"     1   2 1     "
		CALL MAKE_FLOOR_LINE, 6,"     1   1 1     "
		CALL MAKE_FLOOR_LINE, 7,"     1 a 1 1     "
		CALL MAKE_FLOOR_LINE, 8,"     1 2 2 1     "
		CALL MAKE_FLOOR_LINE, 9,"     1 1 b 1     "
		CALL MAKE_FLOOR_LINE,10,"     1 1   1     "
		CALL MAKE_FLOOR_LINE,11,"     1 2 111     "
		CALL MAKE_FLOOR_LINE,12,"     111 2       "
		CALL MAKE_FLOOR_LINE,13,"         4       "
		CALL MAKE_FLOOR_LINE,14,"                 "
		;                        01234567890123456
		
		CASE 11
		FLAG:최대X = 17 
		FLAG:최대Y = 15 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"                 "
		CALL MAKE_FLOOR_LINE, 2,"                 "
		CALL MAKE_FLOOR_LINE, 3,"   11111111111   "
		CALL MAKE_FLOOR_LINE, 4,"   1         1   "
 		CALL MAKE_FLOOR_LINE, 5,"   1253111   1   "
		CALL MAKE_FLOOR_LINE, 6,"   1     1   2   "
		CALL MAKE_FLOOR_LINE, 7,"   111 a 1   6   "
		CALL MAKE_FLOOR_LINE, 8,"       2 2       "
		CALL MAKE_FLOOR_LINE, 9,"   6   1 b 111   "
		CALL MAKE_FLOOR_LINE,10,"   2   1     1   "
		CALL MAKE_FLOOR_LINE,11,"   1   1113521   "
		CALL MAKE_FLOOR_LINE,12,"   1         1   "
		CALL MAKE_FLOOR_LINE,13,"   11111111111   "
		CALL MAKE_FLOOR_LINE,14,"                 "
		;                        01234567890123456
		
		CASE 12
		FLAG:최대X = 17 
		FLAG:최대Y = 15 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"                 "
		CALL MAKE_FLOOR_LINE, 2,"                 "
		CALL MAKE_FLOOR_LINE, 3,"   111111111     "
		CALL MAKE_FLOOR_LINE, 4," c 1       1     "
 		CALL MAKE_FLOOR_LINE, 5," 2 1 11111 11111 "
		CALL MAKE_FLOOR_LINE, 6," 1 1 1   1     1 "
		CALL MAKE_FLOOR_LINE, 7," 1 1 5 a 1   7 1 "
		CALL MAKE_FLOOR_LINE, 8," 1 2   2 2   2 1 "
		CALL MAKE_FLOOR_LINE, 9," 1 7   1 b 5 1 1 "
		CALL MAKE_FLOOR_LINE,10," 1     1   1 1 1 "
		CALL MAKE_FLOOR_LINE,11," 11111 11111 1 2 "
		CALL MAKE_FLOOR_LINE,12,"     1       1 d "
		CALL MAKE_FLOOR_LINE,13,"     111111111   "
		CALL MAKE_FLOOR_LINE,14,"                 "
		;                        01234567890123456
		
		CASE 13
		FLAG:최대X = 17 
		FLAG:최대Y = 15 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"                 "
		CALL MAKE_FLOOR_LINE, 2,"                 "
		CALL MAKE_FLOOR_LINE, 3,"   1111111       "
		CALL MAKE_FLOOR_LINE, 4," c 1     1       "
 		CALL MAKE_FLOOR_LINE, 5," 2 1   621 11123 "
		CALL MAKE_FLOOR_LINE, 6," 1 1       1   5 "
		CALL MAKE_FLOOR_LINE, 7," 1 1111111 1   1 "
		CALL MAKE_FLOOR_LINE, 8," 1   1     1   1 "
		CALL MAKE_FLOOR_LINE, 9," 1   1 1111111 1 "
		CALL MAKE_FLOOR_LINE,10," 5   1       1 1 "
		CALL MAKE_FLOOR_LINE,11," 32111 126   1 2 "
		CALL MAKE_FLOOR_LINE,12,"       1     1 d "
		CALL MAKE_FLOOR_LINE,13,"       1111111   "
		CALL MAKE_FLOOR_LINE,14,"                 "
		;                        01234567890123456
		
		CASE 14
		FLAG:최대X = 17 
		FLAG:최대Y = 15 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
		CALL MAKE_FLOOR_LINE, 1,"   111111111     "
		CALL MAKE_FLOOR_LINE, 2,"   1 2     1     "
		CALL MAKE_FLOOR_LINE, 3,"   1 11111 111   "
		CALL MAKE_FLOOR_LINE, 4," c 1     1   1   "
 		CALL MAKE_FLOOR_LINE, 5," 2 11127 121 1   "
		CALL MAKE_FLOOR_LINE, 6," 1         1 1   "
		CALL MAKE_FLOOR_LINE, 7," 11111 62111 111 "
		CALL MAKE_FLOOR_LINE, 8,"     1         1 "
		CALL MAKE_FLOOR_LINE, 9,"     1 1111121 1 "
		CALL MAKE_FLOOR_LINE,10,"     1 1       1 "
		CALL MAKE_FLOOR_LINE,11,"     1 1 72111 2 "
		CALL MAKE_FLOOR_LINE,12,"     1 2     1 d "
		CALL MAKE_FLOOR_LINE,13,"     111111111   "
		CALL MAKE_FLOOR_LINE,14,"                 "
		;                        01234567890123456
		
		CASE 15
		FLAG:최대X = 17 
		FLAG:최대Y =  7 
		;                        01234567890123456
		CALL MAKE_FLOOR_LINE, 0,"                 "
 		CALL MAKE_FLOOR_LINE, 1," 111111151111111 "
		CALL MAKE_FLOOR_LINE, 2," 1             1 "
		CALL MAKE_FLOOR_LINE, 3," 1111127 4211111 "
		CALL MAKE_FLOOR_LINE, 4," 1             1 "
		CALL MAKE_FLOOR_LINE, 5," 111111111111111 "
		CALL MAKE_FLOOR_LINE, 6,"                 "
		;                        01234567890123456
		
	
	CASEELSE
ENDSELECT


;=======================================================================
;タイル調整
;=======================================================================
@MAKE_FLOOR_LINE_COMMON_79, ARG, ARG:1, ARG:2
#LOCALSIZE 20
SIF ARG:1 == 0 && ARG:2 == 0
	VARSET LOCAL
SELECTCASE ARG
	CASE 3
		IF GETBIT(던전플래그:(FLAG:현던전):(FLAG:현M+10), LOCAL:3)
			DA:(ARG:1):(ARG:2) = 1
			ELSE
			DA:(ARG:1):(ARG:2) = FLAG:현M *1000 + LOCAL:3 * 10 + 3
		ENDIF
		LOCAL:3++
	CASE 4 TO 9
		DA:(ARG:1):(ARG:2) = FLAG:현M *1000 + LOCAL:ARG * 10 + ARG
		LOCAL:ARG++
	
ENDSELECT

;=======================================================================
;指定したマスに進入가능か
;=======================================================================
@CAN_ENTER_79,ARG,ARG:1


IF FLAG:현M == 0 && ARG == 4 && ARG:1 == 5
		IF FLAG:현X < ARG
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:현M == 0 && ARG == 12 && ARG:1 == 11
		IF FLAG:현X > ARG
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:현M == 0 && ARG == 11 && ARG:1 == 4
		IF FLAG:현Y < ARG:1
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:현M == 0 && ARG == 5 && ARG:1 == 12
		IF FLAG:현Y > ARG:1
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
		ELSE
	ENDIF
ENDIF


	IF FLAG:현M == 2 && ARG == 2 && ARG:1 == 7
		IF FLAG:현X > ARG
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:현M == 2 && ARG == 9 && ARG:1 == 2
		IF FLAG:현Y > ARG:1
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:현M == 2 && ARG == 7 && ARG:1 == 14
		IF FLAG:현Y < ARG:1
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:현M == 2 && ARG == 14 && ARG:1 == 9
		IF FLAG:현X < ARG
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:현M == 4 && ARG == 6 && ARG:1 == 1
		IF FLAG:현X < ARG
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
		ELSE
	ENDIF
ENDIF


IF FLAG:현M == 5 && ARG == 6 && ARG:1 == 1
		IF FLAG:현X < ARG
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
		ELSE
	ENDIF
ENDIF


IF FLAG:현M == 4 && ARG == 8 && ARG:1 == 9
		IF FLAG:현X > ARG
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
		ELSE
	ENDIF
ENDIF


IF FLAG:현M == 5 && ARG == 8 && ARG:1 == 9
		IF FLAG:현X > ARG
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:현M == 6 && ARG == 7 && ARG:1 == 11
		IF FLAG:현Y > ARG:1
	CALL MESSAGE_WINDOW_D, "", "＞문은 닫혀있다"
		RETURN 0
		ELSE
	ENDIF
ENDIF

IF FLAG:현M == 4 && ARG == 5 && ARG:1 == 8 && 던전플래그:79:2 == 0
	CALL MESSAGE_WINDOW_D, "", "＞이 방은 동력실인 것 같다/＞문 건너편에서 소리가 울려오고있다/＞문을 엽니까？"
			CALL INPUT_YN_D
		SIF RESULT
			RETURN 0
ENDIF

IF FLAG:현M == 15 && ARG == 10 && ARG:1 == 3 
	CALL MESSAGE_WINDOW_D, "", "＞여기가 전파탑의 정상인 것 같다/＞문을 엽니까？"
			CALL INPUT_YN_D
		SIF RESULT
			RETURN 0
ENDIF



CALL CAN_ENTER,ARG,ARG:1
RETURN RESULT

;=======================================================================
;タイル定義
;=======================================================================
@DEFINE_TILES_79, ARGS, ARG, ARG:1
SELECTCASE ARGS
	CASE "a"
		RETURN 19
	CASE "b"
		RETURN 29
	CASE "c"
		RETURN 39
	CASE "d"
		RETURN 49
	ENDSELECT

@TILE_MARK_COMMON_79_4, ARG , ARG:1 , ARG:2
SELECTCASE ARG / 10
	CASE 0 , 100 , 300 , 701
		SETCOLOR 0x00ff00
		RESULTS = ｍ
	CASE 1 , 700 
		RESULTS = ↑
	CASE 1 , 1000 
		RESULTS = ↓
	CASEELSE
		RETURN 1
ENDSELECT


@TILE_MARK_COMMON_79_9, ARG, ARG:1, ARG:2
SELECTCASE FLAG:현M
	CASE 8,9,10,11,12,13,14
	RESULTS = Ｅ
	CASEELSE
	RETURN 1
ENDSELECT

@TILE_MARK_COMMON_79_5, ARG, ARG:1, ARG:2
SELECTCASE FLAG:현M
	CASE 2
RESULTS = ！
	CASEELSE
RESULTS = \@GET_FLOOR_ANALYZE_T(ARG:1, ARG:2) == 2 ?덫#□\@
ENDSELECT

;=======================================================================
;[5]調べる　実行時の이벤트
;=======================================================================
@EVENT_CHECK_DUNGEON_79

;==========
;出口の処理
;==========
IF DA:(FLAG:현X):(FLAG:현Y) == 8
		CALL DUNGEON_EXIT
	RETURN 1
;========
;宝の処理
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 3
	CALL TRESURING_CALLING_79
	RETURN RESULT

;=======
;階段
;=======
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 6
	CALL UPSTAIRS_79
	RETURN RESULT

ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 7
	CALL DOWNSTAIRS_79
	RETURN RESULT

;==========
;이벤트の処理
;==========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 4
	 
	SELECTCASE FLAG:현M
	CASE 1
		IF FLAG:현X == 9 && FLAG:현Y == 9
			CALL MESSAGE_WINDOW_D, "ＴＶ국원", "어이、뭐야 저거。/괴담얘기나 괴기현상의 소재는、오래될수록 좋은거라고。/책임자、불러와！　책임자！ 진짜 뭔 프로그램 찍고 있는거야。"
		ENDIF
	CASE 3
		IF FLAG:현X == 5 && FLAG:현Y == 7
			CALL MESSAGE_WINDOW_D, "여자 아나운서", "유、유령입니다！ 유령이 나왔습니다！/토、토우아ＴＶ국 안에 유령입니다、저도 처음으로 목격해버렸습니다。/누군가 거짓말이라도 좋으니까 몰래카메라라고 말해줘어！！ "
		ENDIF
	CASE 7
		IF FLAG:현X == 9 && FLAG:현Y == 5
			CALL MESSAGE_WINDOW_D, "ＡＤ", "절대 틀림없슴다、저것은 기타리스트인 스피디임다。/저、동력실에서 봤슴다。위험한 약에 손을 대서 가버린/그 스피디가 틀림없슴다아。"
			CALL MESSAGE_WINDOW_D, "ＡＤ", "으으………너는 천재였어。/알지 못했던 우리들이 바보였다/부탁이니까 성불해줘ー。"
		ENDIF
		ENDSELECT
	RETURN 1

ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 9
SELECTCASE DA:(FLAG:현X):(FLAG:현Y) /10
			CASE 1
				CALL DUNGEON_ELEVATOR, 19
			CASE 2
				CALL DUNGEON_ELEVATOR, 29
			CASE 3
				CALL DUNGEON_ELEVATOR, 39
			CASE 4
				CALL DUNGEON_ELEVATOR, 49
		ENDSELECT
		RETURN 1

ELSE
	CALL MESSAGE_WINDOW_D, "", "＞아무것도 없는 것 같다"
	RETURN 0
ENDIF

;=======================================================================
;タイル進入時の이벤트
;=======================================================================
@EVENT_ENTER_DUNGEON_79,ARG
;ARG = 進入時の向き　0の場合ワープなど
;==========
;出口の処理
;==========
IF DA:(FLAG:현X):(FLAG:현Y)  == 8
	CALL DUNGEON_EXIT
	RETURN 1

;========
;宝の処理
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 3
	CALL TRESURING_CALLING_79
	RETURN RESULT
	
;========
;罠の処理
;========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 ==  5 
	CALL TRAP_79
	RETURN RESULT
	
;==========
;扉の処理
;==========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 2
	CALL DUNGEON_DOOR,ARG
	RETURN 1

;=======
;階段
;=======
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 6
	CALL UPSTAIRS_79
	RETURN RESULT

ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 7
	CALL DOWNSTAIRS_79
	RETURN RESULT

ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 9
SELECTCASE DA:(FLAG:현X):(FLAG:현Y) /10
			CASE 1
				CALL DUNGEON_ELEVATOR, 19
			CASE 2
				CALL DUNGEON_ELEVATOR, 29
			CASE 3
				CALL DUNGEON_ELEVATOR, 39
			CASE 4
				CALL DUNGEON_ELEVATOR, 49
		ENDSELECT
RETURN 1
		
;==========
;이벤트の処理
;==========
ELSEIF DA:(FLAG:현X):(FLAG:현Y) % 10 == 4
	 
	SELECTCASE FLAG:현M 
		
		CASE 2
			IF FLAG:현X == 5 && FLAG:현Y == 5
				FLAG:현M = 2
				FLAG:현X = 5
				FLAG:현Y = 11
			ELSEIF FLAG:현X == 7 && FLAG:현Y == 5
				FLAG:현M = 2
				FLAG:현X = 15
				FLAG:현Y = 13
			ELSEIF FLAG:현X == 11 && FLAG:현Y == 3
				FLAG:현M = 2
				FLAG:현X = 5
				FLAG:현Y = 5
			ELSEIF FLAG:현X == 5 && FLAG:현Y == 11
				FLAG:현M = 2
				FLAG:현X = 11
				FLAG:현Y = 11
			ELSEIF FLAG:현X == 11 && FLAG:현Y == 11
				FLAG:현M = 2
				FLAG:현X = 11
				FLAG:현Y = 5
			ELSEIF FLAG:현X == 9 && FLAG:현Y == 11
				FLAG:현X = 1
				FLAG:현Y = 3
			ELSEIF FLAG:현X == 11 && FLAG:현Y == 5
				FLAG:현X = 5
				FLAG:현Y = 5
			ENDIF
			
		CASE 4
			IF FLAG:현X == 5 && FLAG:현Y == 7 && 던전플래그:79:2 == 0
			
			CALL MESSAGE_WINDOW_D, "", "＞이계화한 방안에 3 체의 악마가 있었다"
			CALL MESSAGE_WINDOW_D, "유리아", "나、절대아이돌！/슈퍼 아이돌！！영원히 아이돌이야！！"
			CALL MESSAGE_WINDOW_D, "스피디", "이몸의 기타테크닉은 세계 제일！/이몸은、슈퍼스타！！　누구에게도 지지 않는다！！"
			CALL MESSAGE_WINDOW_D, "스피디", "오르곤고스트님의 에너지로/이몸들은、영원히 슈퍼스타다！！/방해하는 녀석은、몰살이다아！！"
			CALL MESSAGE_WINDOW_D, "미키야", "……………………。 "
			CALL MESSAGE_WINDOW_D, "", "＞원령 유리아가 １체 나왔다！/＞원령 스피디가 １체 나왔다！/＞원령 미키야가 １체 나왔다！"
			
			FLAG:도주불가플래그 = 1
			FLAG:회화불능플래그 = 1
			FLAG:선제기습취소 = 1
			
				;유리아(원령)
				CALL SET_ENEMY,8,[[キャラ:유리아(원령)]],40,0,1
				CFLAG:(CHARANUM-1):ＨＰ보정 += 500
				CFLAG:(CHARANUM-1):ＭＰ보정 += 1000
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
				
				;스피디
				CALL SET_ENEMY,9,[[キャラ:스피디]],43,0,1
				CFLAG:(CHARANUM-1):ＨＰ보정 += 500
				CFLAG:(CHARANUM-1):ＭＰ보정 += 1000
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
				
				;미키야
				CALL SET_ENEMY,10,[[キャラ:미키야]],38,0,1
				CFLAG:(CHARANUM-1):ＨＰ보정 += 500
				CFLAG:(CHARANUM-1):ＭＰ보정 += 1000
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
				
				CALL BATTLE_START
				FLAG:도주불가플래그 = 0
				FLAG:회화불능플래그 = 0
				FLAG:선제기습취소 = 0
				
			CALL MESSAGE_WINDOW_D, "유리아", "……시러어어어어어！！/아이돌은、ＴＶ에 나오지 못하며어어언……"
			CALL MESSAGE_WINDOW_D, "스피디", "……역시、천재는 죽지 않으면 안되는 건가…"
			CALL MESSAGE_WINDOW_D, "미키야", "……………………。 "
			CALL MESSAGE_WINDOW_D, "", "＞원령 유리아는 힘이 다했다…/＞원령 스피디는 힘이 다했다…/＞원령 미키야는 힘이 다했다…"
			CALL MESSAGE_WINDOW_D, "", "＞동력실의 기능은、정지했다。"
				
				던전플래그:79:2 = 1
				RETURN 1
			ELSE
				CALL MESSAGE_WINDOW_D, "", "＞동력실의 기능은、멈춰있다。"
	
				RETURN 1
			ENDIF
				
		CASE 7
			IF FLAG:현X == 3 && FLAG:현Y == 1
						CALL MESSAGE_WINDOW_D, "", "＞전파탑에 갑니까？"
			CALL INPUT_YN_D
				IF RESULT == 0
					FLAG:현M = 10
					FLAG:현X = 9
					FLAG:현Y = 13
					CALL MAKE_FLOOR, FLAG:현던전
					CALL AUTOMAP
				ENDIF
			ENDIF
				
		CASE 10
			IF FLAG:현X == 9 && FLAG:현Y == 13
						CALL MESSAGE_WINDOW_D, "", "＞토우아TV에 갑니까？"
			CALL INPUT_YN_D
				IF RESULT == 0
					FLAG:현M = 7
					FLAG:현X = 3
					FLAG:현Y = 1
					CALL MAKE_FLOOR, FLAG:현던전
					CALL AUTOMAP
				ENDIF
			ENDIF
			
		CASE 15
			IF FLAG:현X == 9 && FLAG:현Y == 3 && 던전플래그:79:2 == 1

			CALL MESSAGE_WINDOW_D, "", "＞방 안에 얼굴 형태를 한/＞작은 영체가 흔들흔들 아른거리고 있었다"
			CALL MESSAGE_WINDOW_D, "오르곤고스트", "으오오오오오오……/동력실의 3인조는、어떻게 된거야……/에너지가 전혀 모이지 않는다고오……"
			CALL MESSAGE_WINDOW_D, "", "＞외도 오르곤고스트가 １체 나왔다！"
			
			FLAG:도주불가플래그 = 1
			FLAG:회화불능플래그 = 1
			FLAG:선제기습취소 = 1
			
				;오르곤고스트
				CALL SET_ENEMY,9,[[キャラ:오르곤고스트]],45,0,1
				CFLAG:(CHARANUM-1):ＭＰ보정 = +1000
				BASE:(CHARANUM-1):검격 = 150
				BASE:(CHARANUM-1):비구 = 100
				BASE:(CHARANUM-1):타격 = 100
				BASE:(CHARANUM-1):전술 = 150
				BASE:(CHARANUM-1):화염 = 100
				BASE:(CHARANUM-1):빙결 = 200
				BASE:(CHARANUM-1):충격 = 100
				BASE:(CHARANUM-1):지변 = 100
				BASE:(CHARANUM-1):수격 = 100
				BASE:(CHARANUM-1):질풍 = 100
				BASE:(CHARANUM-1):중력 = 100
				BASE:(CHARANUM-1):핵열 = 100
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
				ABL:(CHARANUM-1):스킬3 = [[스킬:지온가]]
				ABL:(CHARANUM-1):스킬4 = [[스킬:방전]]
				
				CALL BATTLE_START
				FLAG:도주불가플래그 = 0
				FLAG:회화불능플래그 = 0
				FLAG:선제기습취소 = 0
				
			CALL MESSAGE_WINDOW_D, "오르곤고스트", "ぅおおおおおお……/エ、エナジーがなければ……/勝てん……。"
			
			ELSE
			
			CALL MESSAGE_WINDOW_D, "", "＞방 안에 얼굴 형태를 한/＞거대한 영체가 흔들흔들 어른거리고 있었다"
			CALL MESSAGE_WINDOW_D, "오르곤고스트", "구오오오오오오오오오！/에너지가、넘친다 넘쳐！/전파가 전기가 원념이、모인다 모여！"
			CALL MESSAGE_WINDOW_D, "오르곤고스트", "기분째진다고오오오오오오오오오오오오오！/너도、나의 에너지로 해주겠다아！"
			CALL MESSAGE_WINDOW_D, "", "＞외도 오르곤고스트가 １체 나왔다！"
			
			FLAG:도주불가플래그 = 1
			FLAG:회화불능플래그 = 1
			FLAG:선제기습취소 = 1
			
							;오르곤고스트
				CALL SET_ENEMY,9,[[キャラ:오르곤고스트]],60,0,1
				CFLAG:(CHARANUM-1):ＨＰ보정 += 2000
				CFLAG:(CHARANUM-1):ＭＰ보정 += 3000
				CFLAG:(CHARANUM-1):행동횟수 = 2
				CFLAG:(CHARANUM-1):속도보정 = 15
				BASE:(CHARANUM-1):힘 += 5
				BASE:(CHARANUM-1):지혜 += 5
				BASE:(CHARANUM-1):마력 += 5
				BASE:(CHARANUM-1):인내력 += 5
				BASE:(CHARANUM-1):속도 += 5
				BASE:(CHARANUM-1):운 += 5
				CALL SYNC_STATUS,(CHARANUM-1)
				CALL HEALTH_CHARA,(CHARANUM-1)
				
				CALL BATTLE_START
				FLAG:도주불가플래그 = 0
				FLAG:회화불능플래그 = 0
				FLAG:선제기습취소 = 0
			
				CALL MESSAGE_WINDOW_D, "오르곤고스트", "구오오오오오오오……/에너지가、빠져나간다 빠져나가……。"
			
			ENDIF
			
			CALL MESSAGE_WINDOW_D, "", "＞외도 오르곤고스트는 힘이 다했다…"
			CALL MESSAGE_WINDOW_D, "", "＞이계화한 토우아TV는 원래대로 돌아갔다/＞보수로 계좌에 ￥50000이 지급되었다"
		MONEY += 50000
		던전플래그:79:0 = 1
		FLAG:탈출 = 1
		
	ENDSELECT
ENDIF



	
SELECTCASE DA:(FLAG:현X):(FLAG:현Y) /10
			CASE 1
				CALL DUNGEON_ELEVATOR, 19
			CASE 2
				CALL DUNGEON_ELEVATOR, 29
			CASE 3
				CALL DUNGEON_ELEVATOR, 39
			CASE 4
				CALL DUNGEON_ELEVATOR, 49
		ENDSELECT
		RETURN 0

;========
;階段移動
;========
@UPSTAIRS_79
SELECTCASE FLAG:현M
	CASE 0
		SIF FLAG:현X == 1 && FLAG:현Y == 1
			CALL DUNGEON_UPSTAIRS,1,1,1
		SIF FLAG:현X == 1 && FLAG:현Y == 15
			CALL DUNGEON_UPSTAIRS,1,1,15
		SIF FLAG:현X == 15 && FLAG:현Y == 1
			CALL DUNGEON_UPSTAIRS,1,15,1
		SIF FLAG:현X == 15 && FLAG:현Y == 15
			CALL DUNGEON_UPSTAIRS,1,15,15
	CASE 1
		SIF FLAG:현X == 2 && FLAG:현Y == 1
			CALL DUNGEON_UPSTAIRS,2,3,1
		SIF FLAG:현X == 14 && FLAG:현Y == 1
			CALL DUNGEON_UPSTAIRS,2,15,3
		SIF FLAG:현X == 2 && FLAG:현Y == 15
			CALL DUNGEON_UPSTAIRS,2,1,13
		SIF FLAG:현X == 14 && FLAG:현Y == 15
			CALL DUNGEON_UPSTAIRS,2,13,15
	CASE 2
		SIF FLAG:현X == 1 && FLAG:현Y == 1
			CALL DUNGEON_UPSTAIRS,3,1,1
		SIF FLAG:현X == 1 && FLAG:현Y == 15
			CALL DUNGEON_UPSTAIRS,3,1,15
		SIF FLAG:현X == 15 && FLAG:현Y == 1
			CALL DUNGEON_UPSTAIRS,3,15,1
		SIF FLAG:현X == 15 && FLAG:현Y == 15
			CALL DUNGEON_UPSTAIRS,3,15,15
	CASE 3
		SIF FLAG:현X == 5 && FLAG:현Y == 3
			CALL DUNGEON_UPSTAIRS,4,3,3
		SIF FLAG:현X == 13 && FLAG:현Y == 11
			CALL DUNGEON_UPSTAIRS,4,11,10
	CASE 4
		SIF FLAG:현X == 3 && FLAG:현Y == 5
			CALL DUNGEON_UPSTAIRS,5,3,5
		SIF FLAG:현X == 13 && FLAG:현Y == 10
			CALL DUNGEON_UPSTAIRS,5,13,10
	CASE 5
		SIF FLAG:현X == 11 && FLAG:현Y == 10
			CALL DUNGEON_UPSTAIRS,6,11,10
		SIF FLAG:현X == 3 && FLAG:현Y == 3
			CALL DUNGEON_UPSTAIRS,6,3,3
	CASE 6
		SIF FLAG:현X == 3 && FLAG:현Y == 5
			CALL DUNGEON_UPSTAIRS,7,5,3
		SIF FLAG:현X == 13 && FLAG:현Y == 10
			CALL DUNGEON_UPSTAIRS,7,13,10
	CASE 11
		SIF FLAG:현X == 13 && FLAG:현Y == 7
			CALL DUNGEON_UPSTAIRS,12,13,7
		SIF FLAG:현X == 3 && FLAG:현Y == 9
			CALL DUNGEON_UPSTAIRS,12,3,9
	CASE 12
		SIF FLAG:현X == 3 && FLAG:현Y == 9
			CALL DUNGEON_UPSTAIRS,13,3,9
		SIF FLAG:현X == 3 && FLAG:현Y == 9
			CALL DUNGEON_UPSTAIRS,13,13,7
	CASE 13
		SIF FLAG:현X == 7 && FLAG:현Y == 5
			CALL DUNGEON_UPSTAIRS,14,7,5
		SIF FLAG:현X == 9 && FLAG:현Y == 11
			CALL DUNGEON_UPSTAIRS,14,9,11
	CASE 14
		SIF FLAG:현X == 7 && FLAG:현Y == 7
			CALL DUNGEON_UPSTAIRS,15,7,3
	CASEELSE
ENDSELECT
RETURN 1

@DOWNSTAIRS_79
SELECTCASE FLAG:현M
	CASE 1
		SIF FLAG:현X == 1 && FLAG:현Y == 1
			CALL DUNGEON_DOWNSTAIRS,0,1,1
		SIF FLAG:현X == 1 && FLAG:현Y == 15
			CALL DUNGEON_DOWNSTAIRS,0,1,15
		SIF FLAG:현X == 15 && FLAG:현Y == 1
			CALL DUNGEON_DOWNSTAIRS,0,15,1
		SIF FLAG:현X == 15 && FLAG:현Y == 15
			CALL DUNGEON_DOWNSTAIRS,0,15,15
	CASE 2
		SIF FLAG:현X == 3 && FLAG:현Y == 1
			CALL DUNGEON_DOWNSTAIRS,1,2,1
		SIF FLAG:현X == 15 && FLAG:현Y == 3
			CALL DUNGEON_DOWNSTAIRS,1,14,1
		SIF FLAG:현X == 1 && FLAG:현Y == 13
			CALL DUNGEON_DOWNSTAIRS,1,2,15
		SIF FLAG:현X == 13 && FLAG:현Y == 15
			CALL DUNGEON_DOWNSTAIRS,1,14,15
	CASE 3
		SIF FLAG:현X == 1 && FLAG:현Y == 1
			CALL DUNGEON_DOWNSTAIRS,2,1,1
		SIF FLAG:현X == 1 && FLAG:현Y == 15
			CALL DUNGEON_DOWNSTAIRS,2,1,15
		SIF FLAG:현X == 15 && FLAG:현Y == 1
			CALL DUNGEON_DOWNSTAIRS,2,15,1
		SIF FLAG:현X == 15 && FLAG:현Y == 15
			CALL DUNGEON_DOWNSTAIRS,2,15,15
	CASE 4
		SIF FLAG:현X == 3 && FLAG:현Y == 3
			CALL DUNGEON_DOWNSTAIRS,3,5,3
		SIF FLAG:현X == 11 && FLAG:현Y == 10
			CALL DUNGEON_DOWNSTAIRS,3,13,11
	CASE 5
		SIF FLAG:현X == 3 && FLAG:현Y == 5
			CALL DUNGEON_DOWNSTAIRS,4,3,5
		SIF FLAG:현X == 13 && FLAG:현Y == 10
			CALL DUNGEON_DOWNSTAIRS,4,13,10
	CASE 6
		SIF FLAG:현X == 3 && FLAG:현Y == 3
			CALL DUNGEON_DOWNSTAIRS,5,3,3
		SIF FLAG:현X == 11 && FLAG:현Y == 10
			CALL DUNGEON_DOWNSTAIRS,5,11,10
	CASE 7
		SIF FLAG:현X == 5 && FLAG:현Y == 3
			CALL DUNGEON_DOWNSTAIRS,6,3,5
		SIF FLAG:현X == 13 && FLAG:현Y == 10
			CALL DUNGEON_DOWNSTAIRS,6,13,10
	CASE 12
		SIF FLAG:현X == 13 && FLAG:현Y == 7
			CALL DUNGEON_DOWNSTAIRS,11,13,7
		SIF FLAG:현X == 3 && FLAG:현Y == 9
			CALL DUNGEON_DOWNSTAIRS,11,3,9
	CASE 13
		SIF FLAG:현X == 3 && FLAG:현Y == 9
			CALL DUNGEON_DOWNSTAIRS,12,3,9
		SIF FLAG:현X == 3 && FLAG:현Y == 9
			CALL DUNGEON_DOWNSTAIRS,12,13,7
	CASE 14
		SIF FLAG:현X == 7 && FLAG:현Y == 5
			CALL DUNGEON_DOWNSTAIRS,13,7,5
		SIF FLAG:현X == 9 && FLAG:현Y == 11
			CALL DUNGEON_DOWNSTAIRS,13,9,11
	CASE 15
		SIF FLAG:현X == 7 && FLAG:현Y == 3
			CALL DUNGEON_DOWNSTAIRS,14,7,7
	CASEELSE
ENDSELECT
RETURN 1
;=======================================================================
;エレベーター
;=======================================================================
@DUNGEON_ELEVATOR_79, ARG
VARSET RESULT, -1
VARSET RESULTS

IF FLAG:현M < 8

RESULT:1 = 1
RESULT:2 = 2
RESULT:3 = 3
RESULT:4 = 4
RESULT:5 = 5
RESULT:6 = 6
RESULTS:1 = ２Ｆ
RESULTS:2 = ３Ｆ
RESULTS:3 = ４Ｆ
RESULTS:4 = ５Ｆ
RESULTS:5 = ６Ｆ
RESULTS:6 = ７Ｆ
RETURN -1

ENDIF

SELECTCASE ARG
	CASE 19
		RESULT:1 = 8
		RESULT:2 = 9
		RESULT:3 = 10
		RESULT:4 = 11
		RESULT:5 = 12
		RESULTS:1 = １Ｆ
		RESULTS:2 = ４Ｆ
		RESULTS:3 = ８Ｆ
		RESULTS:4 = １３Ｆ
		RESULTS:5 = １５Ｆ
		RETURN -1
	CASE 29
		RESULT:1 = 8
		RESULT:2 = 9
		RESULT:3 = 10
		RESULT:4 = 11
		RESULT:5 = 12
		RESULTS:1 = １Ｆ
		RESULTS:2 = ４Ｆ
		RESULTS:3 = ８Ｆ
		RESULTS:4 = １３Ｆ
		RESULTS:5 = １５Ｆ
		RETURN -1
	CASE 39
		RESULT:1 = 12
		RESULT:2 = 13
		RESULT:3 = 14
		RESULTS:1 = １５Ｆ
		RESULTS:2 = １７Ｆ
		RESULTS:3 = １９Ｆ
		RETURN -1
	CASE 49
		RESULT:1 = 12
		RESULT:2 = 13
		RESULT:3 = 14
		RESULTS:1 = １５Ｆ
		RESULTS:2 = １７Ｆ
		RESULTS:3 = １９Ｆ
		RETURN -1
ENDSELECT

;=======================================================================
;宝箱の中身
;=======================================================================
@TRESURING_CALLING_79
#LOCALSIZE 3
LOCAL = FLAG:현M + 10

LOCAL:1 = (DA:(FLAG:현X):(FLAG:현Y) / 10) % 100
SELECTCASE DA:(FLAG:현X):(FLAG:현Y) / 10
		CASE 300
			CALL GET_TREASURE_MONEY, 1 , 100 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 400
			CALL GET_TREASURE, [[아이템:복수의토시]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 500
			CALL GET_TREASURE, [[아이템:함광의검]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 700		
			CALL GET_TREASURE, [[아이템:메기도스톤]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 701
			CALL GET_TREASURE, [[아이템:속도의향]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 702		
			CALL GET_TREASURE, [[아이템:Ｍ249미니미]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 900
			CALL GET_TREASURE, [[아이템:보옥]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 901
			CALL GET_TREASURE, [[아이템:코어실드]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 1100
			CALL GET_TREASURE, [[아이템:지혜의향]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 1101
			CALL GET_TREASURE, [[아이템:스턴그레네이드]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 1300
			CALL GET_TREASURE, [[아이템:극한의곡옥]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
		CASE 1301
			CALL GET_TREASURE, [[아이템:청룡언월도]] , 1 , FLAG:현던전, LOCAL , LOCAL:1
	ENDSELECT
RETURN 1


;========
;罠置き場
;========
@TRAP_79
SELECTCASE FLAG:현M
	CASE 1
		IF  FLAG:현X == 7 && FLAG:현Y == 9
			CALL MESSAGE_WINDOW_D, "", "＞함정이다！"
			CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X,  FLAG:현Y
		ELSEIF  FLAG:현X == 8 && FLAG:현Y == 13
			CALL DUNGEON_TRAP_POISON,40
		ELSE
			CALL DUNGEON_TRAP_HP,15
		ENDIF
	CASE 8
		CALL DUNGEON_TRAP_HP,15
	CASE 15
		CALL DUNGEON_TRAP_MP,10
	CASEELSE
		CALL MESSAGE_WINDOW_D, "", "＞함정이다！"
				CALL DUNGEON_WORP, FLAG:현M-1, FLAG:현X,  FLAG:현Y
	ENDSELECT

;=======================================================================
;인카운트율
;=======================================================================
@ENCOUNT_RATE_79

SELECTCASE FLAG:현M
	CASE 8,9,10,11,12,13
		FLAG:인카운트율 = 5 + FLAG:미조우걸음수*5
	CASE 14,15
		FLAG:인카운트율 = 10 + FLAG:미조우걸음수*5
	CASEELSE
		FLAG:인카운트율 = FLAG:미조우걸음수*5
ENDSELECT
SIF FLAG:미조우걸음수 < 5
	FLAG:인카운트율 = 0
;=======================================================================
;필요레벨눈安
;권장LV 雑魚최저LV 雑魚最高LV ボスLV 
;=======================================================================
@GET_DUNGEON_LV_79
RETURN 40, 34, 43, 60 

;=======================================================================
;エンカウント処理
;=======================================================================
@CHECK_ENCOUNT_79
IF RAND:100 < FLAG:인카운트율
	CALL ENEMY_TABLE
	RETURN 1
ELSE
	FLAG:미조우걸음수 += 1
	RETURN 0
ENDIF
;=======================================================================
;적の종족の종류数
;=======================================================================
@CLASS_NUM_79
RETURN CLASS_NUM_COMMON("上級")
;=======================================================================
;적の総数
;ARGは出現する적の종류です
;=======================================================================
@ENEMY_NUM_79, ARG
RETURN ENEMY_NUM_COMMON("上級", ARG)
;=======================================================================
;적の종류
;=======================================================================
@ENEMY_79, ARG
SELECTCASE FLAG:현M
	CASE 0,1,2,
		SELECTCASE RAND:100
			CASE IS < 30
				RETURN [[キャラ:나가]], 34
			CASE IS < 55
				RETURN [[キャラ:유키죠로]], 34
			CASE IS < 70
				RETURN [[キャラ:파워]], 35
			CASE IS < 85
				RETURN [[キャラ:카라스텐구]], 35
			CASE IS < 100
				RETURN [[キャラ:카완챠]], 35
		ENDSELECT
	CASE 3,4,5,6,7
		SELECTCASE RAND:100
			CASE IS < 30
				RETURN [[キャラ:비프론스]], 37
			CASE IS < 55
				RETURN [[キャラ:가샤도쿠로]], 39
			CASE IS < 70
				RETURN [[キャラ:카라스텐구]], 38
			CASE IS < 85
				RETURN [[キャラ:짐]], 38
			CASE IS < 100
				RETURN [[キャラ:콥스]], 37
			ENDSELECT
	CASE 8,9,10,11,12,13
		SELECTCASE RAND:100
			CASE IS < 30
				RETURN [[キャラ:레기온]], 41
			CASE IS < 55
				RETURN [[キャラ:스프리건]], 43
			CASE IS < 70
				RETURN [[キャラ:짐]], 40
			CASE IS < 85
				RETURN [[キャラ:서큐버스]], 40
			CASE IS < 100
				RETURN [[キャラ:가샤도쿠로]], 40
			ENDSELECT
	CASEELSE
		SELECTCASE RAND:100
			CASE IS < 30
				RETURN [[キャラ:바질리스크]], 43
			CASE IS < 55
				RETURN [[キャラ:서큐버스]], 44
			CASE IS < 70
				RETURN [[キャラ:쿠치사케]], 42
			CASE IS < 85
				RETURN [[キャラ:아마존]], 43
			CASE IS < 100
				RETURN [[キャラ:버쳐]], 43
			ENDSELECT	
ENDSELECT

;=======================================================================
;윤간참가악마
;=======================================================================
@DUNGEON_RAPE_DEVIL_79
;랜덤にどの악마が出るか決定
;RETURN CSV番号 , 人数 , 레벨
SELECTCASE RAND:3
	CASE 0
		RETURN [[キャラ:나가]] , 3 + RAND:10 , CSVBASE([[キャラ:나가]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 1
		RETURN [[キャラ:나가・라쟈]] , 3 + RAND:10 , CSVBASE([[キャラ:나가・라쟈]] , GETNUM(BASE , "LV") , 0) + RAND:3
	CASE 2
		RETURN [[キャラ:콥스]] , 3 + RAND:10 , CSVBASE([[キャラ:콥스]] , GETNUM(BASE , "LV") , 0) + RAND:3
ENDSELECT