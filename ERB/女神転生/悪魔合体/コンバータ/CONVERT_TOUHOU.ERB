@CONVERT_TOUHOU, ARG , ARG:1 , ARG:2 , ARG:3 = -1
;ARG ,악마１
;ARG:1　악마２
;ARG:2　악마３
;ARG:3　元々のRESULT
;

;LOCAL ：악마１종족
;LOCAL:1 ：악마２종족
;LOCAL:2 ：악마３종족
;LOCAL:3 ：악마종족
;LOCAL:4 ：악마LV

#LOCALSSIZE 5

;合体処理をもう一度行う
;合体結果の種族を検索
IF ARG:2 > 0
	LOCAL = ABL:(ARG:0):종족
	LOCAL:1 = ABL:(ARG:1):종족
	LOCAL:2 = ABL:(ARG:2):종족
	;バブルソートもどき
	SIF LOCAL > LOCAL:1
		SWAP LOCAL , LOCAL:1
	SIF LOCAL:1 > LOCAL:2
		SWAP LOCAL:1 , LOCAL:2
	SIF LOCAL > LOCAL:1
		SWAP LOCAL , LOCAL:1
	CALL SEARCH_RACE, LOCAL , LOCAL:1
	SIF RESULT == 13
		RESULT = LOCAL
	CALL SEARCH_RACE, MIN(RESULT , LOCAL:2), MAX(RESULT , LOCAL:2)
	IF RESULT == 13
		RETURN ARG:3
	ELSE
	
	ENDIF
ELSE
	CALL SEARCH_RACE,MIN(ABL:ARG:종족,ABL:(ARG:1):종족),MAX(ABL:ARG:종족,ABL:(ARG:1):종족)
	SIF RESULT == 13
		RETURN ARG:3
ENDIF
;その種族の悪魔をリスト化 Ｄあたりにリストを入れる
;女専用種族を男で作ろうとする場合、オトコ専用種族に変換する。
IF RESULT == 1 && TALENT:ARG:남자
	RESULT = 15
ELSEIF RESULT == 2 && TALENT:ARG:남자
	RESULT = 16
ENDIF
LOCAL:3 = RESULT
	;合体不可の組み合わせなら0を返す
SIF LOCAL:3 == 0
	RETURN 0

;作成したリストから二体の平均レベルに合わせて悪魔を選ぶ
IF ARG:2 > 0
	;平均に足すレベル
	IF EQUIP:MASTER:파라켈수스 == 0
		LOCAL:4 = (CSVBASE(NO:ARG,GETNUM(BASE,"LV"),0) + CSVBASE(NO:(ARG:1),GETNUM(BASE,"LV"),0) + CSVBASE(NO:(ARG:2),GETNUM(BASE,"LV"),0))/3 + FUSION_PLUS_LV(3,1)
	ELSE
		LOCAL:4 = (BASE:ARG:LV + BASE:(ARG:1):LV + BASE:(ARG:2):LV)/3 + FUSION_PLUS_LV(3,1)
	ENDIF
ELSE
	;平均に足すレベル
	IF EQUIP:MASTER:파라켈수스 == 0
		LOCAL:4 = (CSVBASE(NO:ARG,GETNUM(BASE,"LV"),0) + CSVBASE(NO:(ARG:1),GETNUM(BASE,"LV"),0))/2 + FUSION_PLUS_LV(2,1)
	ELSE
		LOCAL:4 = (BASE:ARG:LV + BASE:(ARG:1):LV)/2 + FUSION_PLUS_LV(2,1)
	ENDIF
ENDIF

;디버그용
;PRINTFORML 종족 ＝ {LOCAL:3}
;PRINTFORML 元キャラ레벨 ＝ {LOCAL:4}

SELECTCASE LOCAL:3
	;지모신
	CASE 1
		;4821	유카리 56
		SIF LOCAL:4 >= CSVBASE(4821,GETNUM(BASE,"LV"),0)
			RETURN 4821
		;에이키　ＬＶ４８くらい
		SIF LOCAL:4 >= CSVBASE(4835,GETNUM(BASE,"LV"),0)
			RETURN 4835
		;카나코　ＬＶ４３くらい
		SIF LOCAL:4 >= CSVBASE(4842,GETNUM(BASE,"LV"),0)
			RETURN 4842
		;4838 히나　ＬＶ３４くらい
		SIF LOCAL:4 >= CSVBASE(4838,GETNUM(BASE,"LV"),0)
			RETURN 4838
		;파르시　ＬＶ２７くらい
		SIF LOCAL:4 >= CSVBASE(4858,GETNUM(BASE,"LV"),0)
			RETURN 4858
		;시즈하　ＬＶ２１くらい
		SIF LOCAL:4 >= CSVBASE(4836,GETNUM(BASE,"LV"),0)
			RETURN 4836
		;미노리코　ＬＶ１７くらい
		SIF LOCAL:4 >= CSVBASE(4837,GETNUM(BASE,"LV"),0)
			RETURN 4837
		;카소다니 쿄코　ＬＶ１０くらい
		RETURN 4877
	;여신
	CASE 2
		;4853	요리히메　ＬＶ５４
		SIF LOCAL:4 >= CSVBASE(4853,GETNUM(BASE,"LV"),0)
			RETURN 4853
		;4852	토요히메　ＬＶ５０
		SIF LOCAL:4 >= CSVBASE(4852,GETNUM(BASE,"LV"),0)
			RETURN 4852
		;4828	에이린　ＬＶ47
		SIF LOCAL:4 >= CSVBASE(4828,GETNUM(BASE,"LV"),0)
			RETURN 4828
		;4851	텐시　ＬＶ43
		SIF LOCAL:4 >= CSVBASE(4851,GETNUM(BASE,"LV"),0)
			RETURN 4851
		;4829	카구야　ＬＶ39
		SIF LOCAL:4 >= CSVBASE(4829,GETNUM(BASE,"LV"),0)
			RETURN 4829
		;4850	이쿠　ＬＶ35
		SIF LOCAL:4 >= CSVBASE(4850,GETNUM(BASE,"LV"),0)
			RETURN 4850
		;5801	와카사기히메　LV20
		RETURN 5801
	;마왕
	CASE 3
		;플랑도르　ＬＶ５０くらい
		SIF LOCAL:4 >= CSVBASE(4810,GETNUM(BASE,"LV"),0)
			RETURN 4810
		;레밀리아　ＬＶ４６くらい
		SIF LOCAL:4 >= CSVBASE(4809,GETNUM(BASE,"LV"),0)
			RETURN 4809
		;스와코　ＬＶ４２くらい
		SIF LOCAL:4 >= CSVBASE(4843,GETNUM(BASE,"LV"),0)
			RETURN 4843
		;앨리스　ＬＶ３８くらい
		SIF LOCAL:4 >= CSVBASE(4813,GETNUM(BASE,"LV"),0)
			RETURN 4813
		;곽청아　ＬＶ34くらい
		SIF LOCAL:4 >= CSVBASE(4879,GETNUM(BASE,"LV"),0)
			RETURN 4879
		;코이시　ＬＶ31くらい
		SIF LOCAL:4 >= CSVBASE(4863,GETNUM(BASE,"LV"),0)
			RETURN 4863
		;4860_사도리　ＬＶ28くらい
		SIF LOCAL:4 >= CSVBASE(4860,GETNUM(BASE,"LV"),0)
			RETURN 4860
		;코마치　ＬＶ24くらい
		SIF LOCAL:4 >= CSVBASE(4834,GETNUM(BASE,"LV"),0)
			RETURN 4834
		;릴리블랙
		RETURN 4855
	;천사
	CASE 4
		;5816_純여우　ＬＶ50
		SIF LOCAL:4 >= CSVBASE(5816,GETNUM(BASE,"LV"),0)
			RETURN 5816
		;5809_こころ　ＬＶ42
		SIF LOCAL:4 >= CSVBASE(5809,GETNUM(BASE,"LV"),0)
			RETURN 5809
		;5804_弁々　ＬＶ36
		SIF LOCAL:4 >= CSVBASE(5804,GETNUM(BASE,"LV"),0)
			RETURN 5804
		;5805_八橋　ＬＶ28
		SIF LOCAL:4 >= CSVBASE(5805,GETNUM(BASE,"LV"),0)
			RETURN 5805
		;5813_ドレミー　ＬＶ24
		SIF LOCAL:4 >= CSVBASE(5813,GETNUM(BASE,"LV"),0)
			RETURN 5813
		;5812_鈴瑚　ＬＶ12
		SIF LOCAL:4 >= CSVBASE(5812,GETNUM(BASE,"LV"),0)
			RETURN 5812
		;5811_清蘭　ＬＶ7
		SIF LOCAL:4 >= CSVBASE(5811,GETNUM(BASE,"LV"),0)
			RETURN 5811
	;요마
	CASE 5
		;유카　ＬＶ４６くらい
		SIF LOCAL:4 >= CSVBASE(4833,GETNUM(BASE,"LV"),0)
			RETURN 4833
		;4827_鈴仙　ＬＶ３４くらい
		SIF LOCAL:4 >= CSVBASE(4827,GETNUM(BASE,"LV"),0)
			RETURN 4827
		;케이네　ＬＶ３０くらい
		SIF LOCAL:4 >= CSVBASE(4825,GETNUM(BASE,"LV"),0)
			RETURN 4825
		;メイリン　ＬＶ２６くらい
		SIF LOCAL:4 >= CSVBASE(4805,GETNUM(BASE,"LV"),0)
			RETURN 4805
		;루미아　ＬＶ１４くらい
		SIF LOCAL:4 >= CSVBASE(4802,GETNUM(BASE,"LV"),0)
			RETURN 4802
		;소악마
		RETURN 4806
	;요정
	CASE 6
		;5815_クラウンピース　ＬＶ42
		SIF LOCAL:4 >= CSVBASE(5815,GETNUM(BASE,"LV"),0)
			RETURN 5815
		;치르노　ＬＶ２４くらい
		SIF LOCAL:4 >= CSVBASE(4804,GETNUM(BASE,"LV"),0)
			RETURN 4804
		;릴리화이트　ＬＶ２１くらい
		SIF LOCAL:4 >= CSVBASE(4814,GETNUM(BASE,"LV"),0)
			RETURN 4814
		;대요정　ＬＶ１８
		SIF LOCAL:4 >= CSVBASE(4803,GETNUM(BASE,"LV"),0)
			RETURN 4803
		;루나　ＬＶ１５
		SIF LOCAL:4 >= CSVBASE(4845,GETNUM(BASE,"LV"),0)
			RETURN 4845
		;스타　ＬＶ１２
		SIF LOCAL:4 >= CSVBASE(4846,GETNUM(BASE,"LV"),0)
			RETURN 4846
		;서니　ＬＶ１０
		RETURN 4844
	;요귀
	CASE 7
		;4859_勇儀　ＬＶ５１くらい
		SIF LOCAL:4 >= CSVBASE(4859,GETNUM(BASE,"LV"),0)
			RETURN 4859
		;스이카　ＬＶ４７くらい
		SIF LOCAL:4 >= CSVBASE(4822,GETNUM(BASE,"LV"),0)
			RETURN 4822
		;4876	카센　ＬＶ３７くらい
		SIF LOCAL:4 >= CSVBASE(4876,GETNUM(BASE,"LV"),0)
			RETURN 4876
		;파츄리　ＬＶ３０くらい
		SIF LOCAL:4 >= CSVBASE(4807,GETNUM(BASE,"LV"),0)
			RETURN 4807
		;레티　ＬＶ２５くらい
		SIF LOCAL:4 >= CSVBASE(4811,GETNUM(BASE,"LV"),0)
			RETURN 4811
		;4869_一輪　ＬＶ２１くらい
		SIF LOCAL:4 >= CSVBASE(4869,GETNUM(BASE,"LV"),0)
			RETURN 4869
		;니토리　ＬＶ１７くらい
		SIF LOCAL:4 >= CSVBASE(4839,GETNUM(BASE,"LV"),0)
			RETURN 4839
		;코가사　ＬＶ11くらい
		RETURN 4868
	;용왕
	;마수枠パンパンじゃないですか！
	CASE 8
		;5807_바늘妙丸　ＬＶ44
		SIF LOCAL:4 >= CSVBASE(5807,GETNUM(BASE,"LV"),0)
			RETURN 5807
		;5803_影狼　ＬＶ34
		SIF LOCAL:4 >= CSVBASE(5803,GETNUM(BASE,"LV"),0)
			RETURN 5803
		;5802_蛮奇　ＬＶ27
			RETURN 5802
	;마수
	CASE 9
		;4820_藍　ＬＶ50くらい
		SIF LOCAL:4 >= CSVBASE(4820,GETNUM(BASE,"LV"),0)
			RETURN 4820
		;4872	쇼우　ＬＶ４６くらい
		SIF LOCAL:4 >= CSVBASE(4872,GETNUM(BASE,"LV"),0)
			RETURN 4872
		;4874_ぬえ　ＬＶ４２くらい
		SIF LOCAL:4 >= CSVBASE(4874,GETNUM(BASE,"LV"),0)
			RETURN 4874
		;모미지　ＬＶ38くらい
		SIF LOCAL:4 >= CSVBASE(4840,GETNUM(BASE,"LV"),0)
			RETURN 4840
		;4867_ナズーリン　ＬＶ３４くらい
		SIF LOCAL:4 >= CSVBASE(4867,GETNUM(BASE,"LV"),0)
			RETURN 4867
		;마미조우　ＬＶ30くらい
		SIF LOCAL:4 >= CSVBASE(4883,GETNUM(BASE,"LV"),0)
			RETURN 4883
		;오린　ＬＶ２６くらい
		SIF LOCAL:4 >= CSVBASE(4861,GETNUM(BASE,"LV"),0)
			RETURN 4861
		;4812_橙　ＬＶ23くらい
		SIF LOCAL:4 >= CSVBASE(4812,GETNUM(BASE,"LV"),0)
			RETURN 4812
		;테위　ＬＶ１９くらい
		SIF LOCAL:4 >= CSVBASE(4826,GETNUM(BASE,"LV"),0)
			RETURN 4826
		;야마메　ＬＶ15くらい
		SIF LOCAL:4 >= CSVBASE(4857,GETNUM(BASE,"LV"),0)
			RETURN 4857
	;리글　ＬＶ１１くらい
	RETURN 4823
	;요조
	CASE 10
		;空　ＬＶ５２くらい
		SIF LOCAL:4 >= CSVBASE(4862,GETNUM(BASE,"LV"),0)
			RETURN 4862
		;4830_妹紅　ＬＶ４８くらい
		SIF LOCAL:4 >= CSVBASE(4830,GETNUM(BASE,"LV"),0)
			RETURN 4830
		;아야　ＬＶ４３くらい
		SIF LOCAL:4 >= CSVBASE(4831,GETNUM(BASE,"LV"),0)
			RETURN 4831
		;4875_はたて　ＬＶ３８くらい
		SIF LOCAL:4 >= CSVBASE(4875,GETNUM(BASE,"LV"),0)
			RETURN 4875
		;미스티아　ＬＶ16くらい
		SIF LOCAL:4 >= CSVBASE(4824,GETNUM(BASE,"LV"),0)
			RETURN 4824
		;4864_朱鷺子　ＬＶ11くらい
		RETURN 4864
	;외도
	CASE 11
		;4819_幽々子　ＬＶ５１くらい
		SIF LOCAL:4 >= CSVBASE(4819,GETNUM(BASE,"LV"),0)
			RETURN 4819
		;4881_布都　ＬＶ４３くらい
		SIF LOCAL:4 >= CSVBASE(4881,GETNUM(BASE,"LV"),0)
			RETURN 4881
		;요우무　ＬＶ３９くらい
		SIF LOCAL:4 >= CSVBASE(4818,GETNUM(BASE,"LV"),0)
			RETURN 4818
		;4880_屠自古　ＬＶ３３くらい
		SIF LOCAL:4 >= CSVBASE(4880,GETNUM(BASE,"LV"),0)
			RETURN 4880
		;요시카　ＬＶ２９くらい
		SIF LOCAL:4 >= CSVBASE(4878,GETNUM(BASE,"LV"),0)
			RETURN 4878
		;무라사　ＬＶ２５くらい
		SIF LOCAL:4 >= CSVBASE(4871,GETNUM(BASE,"LV"),0)
			RETURN 4871
		;루나사　ＬＶ２１くらい
		SIF LOCAL:4 >= CSVBASE(4817,GETNUM(BASE,"LV"),0)
			RETURN 4817
		;메를란　ＬＶ１８くらい
		SIF LOCAL:4 >= CSVBASE(4816,GETNUM(BASE,"LV"),0)
			RETURN 4816
		;리리카　ＬＶ１５くらい
		SIF LOCAL:4 >= CSVBASE(4815,GETNUM(BASE,"LV"),0)
			RETURN 4815
		;메디슨　ＬＶ１１くらい
		SIF LOCAL:4 >= CSVBASE(4832,GETNUM(BASE,"LV"),0)
			RETURN 4832
		;키스메　ＬＶ8くらい
		RETURN 4856
	;CASE 13	
	;귀신
	CASE 15
		;5814_サグメ　ＬＶ38
		SIF LOCAL:4 >= CSVBASE(5814,GETNUM(BASE,"LV"),0)
			RETURN 5814
		;5806_正邪　ＬＶ30
			RETURN 5806
	;마신
	;CASE 16

ENDSELECT


;コンバート先がない場合、そのまま返す
RETURN ARG:3

;=====================================================
;조마×지령殿タッグ＋友人　＝　博麗霊夢
;=====================================================
;마리사
@FUSION_SPECIAL_4402_4801,ARG,ARG:1
RETURN 4800
;すいか
@FUSION_SPECIAL_4402_4822,ARG,ARG:1
RETURN 4800
;아야
@FUSION_SPECIAL_4402_4831,ARG,ARG:1
RETURN 4800
;유카리
@FUSION_SPECIAL_4402_4821,ARG,ARG:1
RETURN 4800

;=====================================================
;조마×지령殿タッグ＋友人　＝　霧雨魔理沙
;=====================================================
;레이무
@FUSION_SPECIAL_4402_4800,ARG,ARG:1
RETURN 4801
;파츄리
@FUSION_SPECIAL_4402_4807,ARG,ARG:1
RETURN 4801
;앨리스
@FUSION_SPECIAL_4402_4813,ARG,ARG:1
RETURN 4801
;니토리
@FUSION_SPECIAL_4402_4839,ARG,ARG:1
RETURN 4801

;=====================================================
;조마×紅魔郷－パチェ　＝　十六夜사키夜
;=====================================================
;루미아
@FUSION_SPECIAL_4402_4802,ARG,ARG:1
RETURN 4808
;치르노
@FUSION_SPECIAL_4402_4804,ARG,ARG:1
RETURN 4808
;めいりん
@FUSION_SPECIAL_4402_4805,ARG,ARG:1
RETURN 4808
;레밀리아
@FUSION_SPECIAL_4402_4809,ARG,ARG:1
RETURN 4808
;フランドール
@FUSION_SPECIAL_4402_4810,ARG,ARG:1
RETURN 4808

;=====================================================
;조마×풍신録連中　＝　東風谷早苗
;=====================================================
;秋静葉
@FUSION_SPECIAL_4402_4836,ARG,ARG:1
RETURN 4841
;秋穣子
@FUSION_SPECIAL_4402_4837,ARG,ARG:1
RETURN 4841
;鍵山雛
@FUSION_SPECIAL_4402_4838,ARG,ARG:1
RETURN 4841
;犬走椛
@FUSION_SPECIAL_4402_4840,ARG,ARG:1
RETURN 4841
;八坂神奈子
@FUSION_SPECIAL_4402_4842,ARG,ARG:1
RETURN 4841
;洩矢諏訪子
@FUSION_SPECIAL_4402_4843,ARG,ARG:1
RETURN 4841

;=====================================================
;조마×聖蓮船連中＋마미조우　＝　Chara4873_뱌쿠렌
;=====================================================
;나즈린
@FUSION_SPECIAL_4402_4867,ARG,ARG:1
RETURN 4873
;多々良小傘
@FUSION_SPECIAL_4402_4868,ARG,ARG:1
RETURN 4873
;雲居一輪
@FUSION_SPECIAL_4402_4869,ARG,ARG:1
RETURN 4873
;무라사
@FUSION_SPECIAL_4402_4871,ARG,ARG:1
RETURN 4873
;쇼우
@FUSION_SPECIAL_4402_4872,ARG,ARG:1
RETURN 4873
;누에
@FUSION_SPECIAL_4402_4874,ARG,ARG:1
RETURN 4873
;마미조우
@FUSION_SPECIAL_4402_4883,ARG,ARG:1
RETURN 4873
;=====================================================
;조마×신령廟連中－마미조우　＝　토요사토미미노 미코
;=====================================================
;요시카
@FUSION_SPECIAL_4402_4878,ARG,ARG:1
RETURN 4882
;청아
@FUSION_SPECIAL_4402_4879,ARG,ARG:1
RETURN 4882
;토지코
@FUSION_SPECIAL_4402_4880,ARG,ARG:1
RETURN 4882
;후토
@FUSION_SPECIAL_4402_4881,ARG,ARG:1
RETURN 4882


;=====================================================
;조마×신묘마루or모코우or카센　＝　스미레코
;=====================================================
;모코우
@FUSION_SPECIAL_4402_4830,ARG,ARG:1
RETURN 5810
;신묘마루
@FUSION_SPECIAL_4402_5807,ARG,ARG:1
RETURN 5810
;카센
@FUSION_SPECIAL_4402_4876,ARG,ARG:1
RETURN 5810

;=====================================================
;벤벤＊야츠하시＝　라이코
;=====================================================
@FUSION_SPECIAL_5804_5805,ARG,ARG:1
RETURN 5808

;=====================================================
;클라운피스＊순호＝　헤카티아
;=====================================================
@FUSION_SPECIAL_5815_5816,ARG,ARG:1
RETURN 5817

